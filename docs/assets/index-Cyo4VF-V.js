(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();class ys{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const ba={PROPERTYCHANGE:"propertychange"};class lf{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function Gx(i,t,e){let n,s;e=e||ks;let a=0,l=i.length,u=!1;for(;a<l;)n=a+(l-a>>1),s=+e(i[n],t),s<0?a=n+1:(l=n,u=!s);return u?a:~a}function ks(i,t){return i>t?1:i<t?-1:0}function Ch(i,t,e){if(i[0]<=t)return 0;const n=i.length;if(t<=i[n-1])return n-1;if(typeof e=="function"){for(let s=1;s<n;++s){const a=i[s];if(a===t)return s;if(a<t)return e(t,i[s-1],a)>0?s-1:s}return n-1}if(e>0){for(let s=1;s<n;++s)if(i[s]<t)return s-1;return n-1}if(e<0){for(let s=1;s<n;++s)if(i[s]<=t)return s;return n-1}for(let s=1;s<n;++s){if(i[s]==t)return s;if(i[s]<t)return i[s-1]-t<t-i[s]?s-1:s}return n-1}function zx(i,t,e){for(;t<e;){const n=i[t];i[t]=i[e],i[e]=n,++t,--e}}function $n(i,t){const e=Array.isArray(t)?t:[t],n=e.length;for(let s=0;s<n;s++)i[i.length]=e[s]}function yr(i,t){const e=i.length;if(e!==t.length)return!1;for(let n=0;n<e;n++)if(i[n]!==t[n])return!1;return!0}function Ux(i,t,e){const n=t||ks;return i.every(function(s,a){if(a===0)return!0;const l=n(i[a-1],s);return!(l>0||e&&l===0)})}function co(){return!0}function Ah(){return!1}function Ea(){}function Jp(i){let t=!1,e,n,s;return function(){const a=Array.prototype.slice.call(arguments);return(!t||this!==s||!yr(a,n))&&(t=!0,s=this,n=a,e=i.apply(this,arguments)),e}}function Qp(i){function t(){let e;try{e=i()}catch(n){return Promise.reject(n)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function qo(i){for(const t in i)delete i[t]}function Gr(i){let t;for(t in i)return!1;return!t}class $o extends lf{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),s=n[t]||(n[t]=[]);s.includes(e)||s.push(e)}dispatchEvent(t){const e=typeof t=="string",n=e?t:t.type,s=this.listeners_&&this.listeners_[n];if(!s)return;const a=e?new ys(t):t;a.target||(a.target=this.eventTarget_||this);const l=this.dispatching_||(this.dispatching_={}),u=this.pendingRemovals_||(this.pendingRemovals_={});n in l||(l[n]=0,u[n]=0),++l[n];let c;for(let p=0,y=s.length;p<y;++p)if("handleEvent"in s[p]?c=s[p].handleEvent(a):c=s[p].call(this,a),c===!1||a.propagationStopped){c=!1;break}if(--l[n]===0){let p=u[n];for(delete u[n];p--;)this.removeEventListener(n,Ea);delete l[n]}return c}disposeInternal(){this.listeners_&&qo(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const s=n.indexOf(e);s!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[s]=Ea,++this.pendingRemovals_[t]):(n.splice(s,1),n.length===0&&delete this.listeners_[t]))}}const _e={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function We(i,t,e,n,s){if(n&&n!==i&&(e=e.bind(n)),s){const l=e;e=function(){i.removeEventListener(t,e),l.apply(this,arguments)}}const a={target:i,type:t,listener:e};return i.addEventListener(t,e),a}function Ql(i,t,e,n){return We(i,t,e,n,!0)}function oi(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),qo(i))}class Jo extends $o{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(_e.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,s=new Array(n);for(let a=0;a<n;++a)s[a]=We(this,t[a],e);return s}return We(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const s=t.length;n=new Array(s);for(let a=0;a<s;++a)n[a]=Ql(this,t[a],e)}else n=Ql(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)Wx(n);else if(Array.isArray(t))for(let s=0,a=t.length;s<a;++s)this.removeEventListener(t[s],e);else this.removeEventListener(t,e)}}Jo.prototype.on;Jo.prototype.once;Jo.prototype.un;function Wx(i){if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)oi(i[t]);else oi(i)}function xe(){throw new Error("Unimplemented abstract method.")}let Xx=0;function ti(i){return i.ol_uid||(i.ol_uid=String(++Xx))}class w0 extends ys{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}class es extends Jo{constructor(t){super(),this.on,this.once,this.un,ti(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new w0(n,t,e)),n=ba.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new w0(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const s=this.values_||(this.values_={});if(n)s[t]=e;else{const a=s[t];s[t]=e,a!==e&&this.notify(t,a)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],Gr(this.values_)&&(this.values_=null),e||this.notify(t,n)}}}const yn={ADD:"add",REMOVE:"remove"},b0={LENGTH:"length"};class Sl extends ys{constructor(t,e,n){super(t),this.element=e,this.index=n}}class hs extends es{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let n=0,s=this.array_.length;n<s;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,s=e.length;n<s;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(b0.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Sl(yn.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,s=e.length;n<s;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Sl(yn.REMOVE,e,t)),e}setAt(t,e){const n=this.getLength();if(t>=n){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const s=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Sl(yn.REMOVE,s,t)),this.dispatchEvent(new Sl(yn.ADD,e,t))}updateLength_(){this.set(b0.LENGTH,this.array_.length)}assertUnique_(t,e){for(let n=0,s=this.array_.length;n<s;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}}function qe(i,t){if(!i)throw new Error(t)}class Ur extends es{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new Ur(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(oi(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=We(t,_e.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?jx(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function jx(i){if(typeof i=="function")return i;let t;return Array.isArray(i)?t=i:(qe(typeof i.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[i]),function(){return t}}new Array(6);function Jn(){return[1,0,0,1,0,0]}function Hx(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i}function Vi(i,t){const e=t[0],n=t[1];return t[0]=i[0]*e+i[2]*n+i[4],t[1]=i[1]*e+i[3]*n+i[5],t}function ms(i,t,e,n,s,a,l,u){const c=Math.sin(a),p=Math.cos(a);return i[0]=n*p,i[1]=s*c,i[2]=-n*c,i[3]=s*p,i[4]=l*n*p-u*n*c+t,i[5]=l*s*c+u*s*p+e,i}function t2(i,t){const e=Yx(t);qe(e!==0,"Transformation matrix cannot be inverted");const n=t[0],s=t[1],a=t[2],l=t[3],u=t[4],c=t[5];return i[0]=l/e,i[1]=-s/e,i[2]=-a/e,i[3]=n/e,i[4]=(a*c-l*u)/e,i[5]=-(n*c-s*u)/e,i}function Yx(i){return i[0]*i[3]-i[1]*i[2]}const E0=[1e6,1e6,1e6,1e6,2,2];function Zx(i){return"matrix("+i.map((e,n)=>Math.round(e*E0[n])/E0[n]).join(", ")+")"}const Bi={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function I0(i){const t=zn();for(let e=0,n=i.length;e<n;++e)lo(t,i[e]);return t}function hf(i,t,e){return e?(e[0]=i[0]-t,e[1]=i[1]-t,e[2]=i[2]+t,e[3]=i[3]+t,e):[i[0]-t,i[1]-t,i[2]+t,i[3]+t]}function e2(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i.slice()}function Wr(i,t,e){let n,s;return t<i[0]?n=i[0]-t:i[2]<t?n=t-i[2]:n=0,e<i[1]?s=i[1]-e:i[3]<e?s=e-i[3]:s=0,n*n+s*s}function zr(i,t){return uf(i,t[0],t[1])}function us(i,t){return i[0]<=t[0]&&t[2]<=i[2]&&i[1]<=t[1]&&t[3]<=i[3]}function uf(i,t,e){return i[0]<=t&&t<=i[2]&&i[1]<=e&&e<=i[3]}function pc(i,t){const e=i[0],n=i[1],s=i[2],a=i[3],l=t[0],u=t[1];let c=Bi.UNKNOWN;return l<e?c=c|Bi.LEFT:l>s&&(c=c|Bi.RIGHT),u<n?c=c|Bi.BELOW:u>a&&(c=c|Bi.ABOVE),c===Bi.UNKNOWN&&(c=Bi.INTERSECTING),c}function zn(){return[1/0,1/0,-1/0,-1/0]}function gr(i,t,e,n,s){return s?(s[0]=i,s[1]=t,s[2]=e,s[3]=n,s):[i,t,e,n]}function Qo(i){return gr(1/0,1/0,-1/0,-1/0,i)}function i2(i,t){const e=i[0],n=i[1];return gr(e,n,e,n,t)}function cf(i,t,e,n,s){const a=Qo(s);return s2(a,i,t,e,n)}function Ia(i,t){return i[0]==t[0]&&i[2]==t[2]&&i[1]==t[1]&&i[3]==t[3]}function n2(i,t){return t[0]<i[0]&&(i[0]=t[0]),t[2]>i[2]&&(i[2]=t[2]),t[1]<i[1]&&(i[1]=t[1]),t[3]>i[3]&&(i[3]=t[3]),i}function lo(i,t){t[0]<i[0]&&(i[0]=t[0]),t[0]>i[2]&&(i[2]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[1]>i[3]&&(i[3]=t[1])}function s2(i,t,e,n,s){for(;e<n;e+=s)Kx(i,t[e],t[e+1]);return i}function Kx(i,t,e){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}function r2(i,t){let e;return e=t(Rh(i)),e||(e=t(Sh(i)),e)||(e=t(Th(i)),e)||(e=t(Xr(i)),e)?e:!1}function yc(i){let t=0;return Na(i)||(t=Ve(i)*Oi(i)),t}function Rh(i){return[i[0],i[1]]}function Sh(i){return[i[2],i[1]]}function ps(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function qx(i,t){let e;if(t==="bottom-left")e=Rh(i);else if(t==="bottom-right")e=Sh(i);else if(t==="top-left")e=Xr(i);else if(t==="top-right")e=Th(i);else throw new Error("Invalid corner");return e}function th(i,t,e,n,s){const[a,l,u,c,p,y,_,E]=xc(i,t,e,n);return gr(Math.min(a,u,p,_),Math.min(l,c,y,E),Math.max(a,u,p,_),Math.max(l,c,y,E),s)}function xc(i,t,e,n){const s=t*n[0]/2,a=t*n[1]/2,l=Math.cos(e),u=Math.sin(e),c=s*l,p=s*u,y=a*l,_=a*u,E=i[0],I=i[1];return[E-c+_,I-p-y,E-c-_,I-p+y,E+c-_,I+p+y,E+c+_,I+p-y,E-c+_,I-p-y]}function Oi(i){return i[3]-i[1]}function kr(i,t,e){const n=e||zn();return en(i,t)?(i[0]>t[0]?n[0]=i[0]:n[0]=t[0],i[1]>t[1]?n[1]=i[1]:n[1]=t[1],i[2]<t[2]?n[2]=i[2]:n[2]=t[2],i[3]<t[3]?n[3]=i[3]:n[3]=t[3]):Qo(n),n}function Xr(i){return[i[0],i[3]]}function Th(i){return[i[2],i[3]]}function Ve(i){return i[2]-i[0]}function en(i,t){return i[0]<=t[2]&&i[2]>=t[0]&&i[1]<=t[3]&&i[3]>=t[1]}function Na(i){return i[2]<i[0]||i[3]<i[1]}function $x(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}function Jx(i,t,e){let n=!1;const s=pc(i,t),a=pc(i,e);if(s===Bi.INTERSECTING||a===Bi.INTERSECTING)n=!0;else{const l=i[0],u=i[1],c=i[2],p=i[3],y=t[0],_=t[1],E=e[0],I=e[1],S=(I-_)/(E-y);let R,D;a&Bi.ABOVE&&!(s&Bi.ABOVE)&&(R=E-(I-p)/S,n=R>=l&&R<=c),!n&&a&Bi.RIGHT&&!(s&Bi.RIGHT)&&(D=I-(E-c)*S,n=D>=u&&D<=p),!n&&a&Bi.BELOW&&!(s&Bi.BELOW)&&(R=E-(I-u)/S,n=R>=l&&R<=c),!n&&a&Bi.LEFT&&!(s&Bi.LEFT)&&(D=I-(E-l)*S,n=D>=u&&D<=p)}return n}function a2(i,t){const e=t.getExtent(),n=ps(i);if(t.canWrapX()&&(n[0]<e[0]||n[0]>=e[2])){const s=Ve(e),l=Math.floor((n[0]-e[0])/s)*s;i[0]-=l,i[2]-=l}return i}function o2(i,t,e){if(t.canWrapX()){const n=t.getExtent();if(!isFinite(i[0])||!isFinite(i[2]))return[[n[0],i[1],n[2],i[3]]];a2(i,t);const s=Ve(n);if(Ve(i)>s&&!e)return[[n[0],i[1],n[2],i[3]]];if(i[0]<n[0])return[[i[0]+s,i[1],n[2],i[3]],[n[0],i[1],i[2],i[3]]];if(i[2]>n[2])return[[i[0],i[1],n[2],i[3]],[n[0],i[1],i[2]-s,i[3]]]}return[i]}const fo={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Qx{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||fo[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const ff=Qx,tl=6378137,ma=Math.PI*tl,t_=[-ma,-ma,ma,ma],e_=[-180,-85,180,85],Tl=tl*Math.log(Math.tan(Math.PI/2));class ea extends ff{constructor(t){super({code:t,units:"m",extent:t_,global:!0,worldExtent:e_,getPointResolution:function(e,n){return e/Math.cosh(n[1]/tl)}})}}const C0=[new ea("EPSG:3857"),new ea("EPSG:102100"),new ea("EPSG:102113"),new ea("EPSG:900913"),new ea("http://www.opengis.net/def/crs/EPSG/0/3857"),new ea("http://www.opengis.net/gml/srs/epsg.xml#3857")];function i_(i,t,e){const n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let s=0;s<n;s+=e){t[s]=ma*i[s]/180;let a=tl*Math.log(Math.tan(Math.PI*(+i[s+1]+90)/360));a>Tl?a=Tl:a<-Tl&&(a=-Tl),t[s+1]=a}return t}function n_(i,t,e){const n=i.length;e=e>1?e:2,t===void 0&&(e>2?t=i.slice():t=new Array(n));for(let s=0;s<n;s+=e)t[s]=180*i[s]/ma,t[s+1]=360*Math.atan(Math.exp(i[s+1]/tl))/Math.PI-90;return t}const s_=6378137,A0=[-180,-90,180,90],r_=Math.PI*s_/180;class Tr extends ff{constructor(t,e){super({code:t,units:"degrees",extent:A0,axisOrientation:e,global:!0,metersPerUnit:r_,worldExtent:A0})}}const R0=[new Tr("CRS:84"),new Tr("EPSG:4326","neu"),new Tr("urn:ogc:def:crs:OGC:1.3:CRS84"),new Tr("urn:ogc:def:crs:OGC:2:84"),new Tr("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Tr("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Tr("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let _c={};function a_(i){return _c[i]||_c[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function o_(i,t){_c[i]=t}let ya={};function Ca(i,t,e){const n=i.getCode(),s=t.getCode();n in ya||(ya[n]={}),ya[n][s]=e}function l2(i,t){let e;return i in ya&&t in ya[i]&&(e=ya[i][t]),e}function Ei(i,t,e){return Math.min(Math.max(i,t),e)}function l_(i,t,e,n,s,a){const l=s-e,u=a-n;if(l!==0||u!==0){const c=((i-e)*l+(t-n)*u)/(l*l+u*u);c>1?(e=s,n=a):c>0&&(e+=l*c,n+=u*c)}return Fr(i,t,e,n)}function Fr(i,t,e,n){const s=e-i,a=n-t;return s*s+a*a}function h_(i){const t=i.length;for(let n=0;n<t;n++){let s=n,a=Math.abs(i[n][n]);for(let u=n+1;u<t;u++){const c=Math.abs(i[u][n]);c>a&&(a=c,s=u)}if(a===0)return null;const l=i[s];i[s]=i[n],i[n]=l;for(let u=n+1;u<t;u++){const c=-i[u][n]/i[n][n];for(let p=n;p<t+1;p++)n==p?i[u][p]=0:i[u][p]+=c*i[n][p]}}const e=new Array(t);for(let n=t-1;n>=0;n--){e[n]=i[n][t]/i[n][n];for(let s=n-1;s>=0;s--)i[s][t]-=i[s][n]*e[n]}return e}function Yl(i){return i*Math.PI/180}function xa(i,t){const e=i%t;return e*t<0?e+t:e}function Rn(i,t,e){return i+e*(t-i)}function df(i,t){const e=Math.pow(10,t);return Math.round(i*e)/e}function Dl(i,t){return Math.floor(df(i,t))}function ar(i,t){return Math.ceil(df(i,t))}function Ya(i,t,e){const n=e!==void 0?i.toFixed(e):""+i;let s=n.indexOf(".");return s=s===-1?n.length:s,s>t?n:new Array(1+t-s).join("0")+n}function u_(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function eh(i,t){let e=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=t[n]){e=!1;break}return e}function gf(i,t){const e=Math.cos(t),n=Math.sin(t),s=i[0]*e-i[1]*n,a=i[1]*e+i[0]*n;return i[0]=s,i[1]=a,i}function c_(i,t){return i[0]*=t,i[1]*=t,i}function h2(i,t){if(t.canWrapX()){const e=Ve(t.getExtent()),n=u2(i,t,e);n&&(i[0]-=n*e)}return i}function u2(i,t,e){const n=t.getExtent();let s=0;return t.canWrapX()&&(i[0]<n[0]||i[0]>n[2])&&(e=e||Ve(n),s=Math.floor((i[0]-n[0])/e)),s}const f_=63710088e-1;function S0(i,t,e){e=e||f_;const n=Yl(i[1]),s=Yl(t[1]),a=(s-n)/2,l=Yl(t[0]-i[0])/2,u=Math.sin(a)*Math.sin(a)+Math.sin(l)*Math.sin(l)*Math.cos(n)*Math.cos(s);return 2*e*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}function c2(...i){console.warn(...i)}let wc=!0;function d_(i){wc=!(i===void 0?!0:i)}function mf(i,t){if(t!==void 0){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];t=t}else t=i.slice();return t}function f2(i,t){if(t!==void 0&&i!==t){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];i=t}return i}function d2(i){o_(i.getCode(),i),Ca(i,i,mf)}function g_(i){i.forEach(d2)}function li(i){return typeof i=="string"?a_(i):i||null}function T0(i,t,e,n){i=li(i);let s;const a=i.getPointResolutionFunc();if(a){if(s=a(t,e),n&&n!==i.getUnits()){const l=i.getMetersPerUnit();l&&(s=s*l/fo[n])}}else{const l=i.getUnits();if(l=="degrees"&&!n||n=="degrees")s=t;else{const u=Dh(i,li("EPSG:4326"));if(u===f2&&l!=="degrees")s=t*i.getMetersPerUnit();else{let p=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];p=u(p,p,2);const y=S0(p.slice(0,2),p.slice(2,4)),_=S0(p.slice(4,6),p.slice(6,8));s=(y+_)/2}const c=n?fo[n]:i.getMetersPerUnit();c!==void 0&&(s/=c)}}return s}function bc(i){g_(i),i.forEach(function(t){i.forEach(function(e){t!==e&&Ca(t,e,mf)})})}function m_(i,t,e,n){i.forEach(function(s){t.forEach(function(a){Ca(s,a,e),Ca(a,s,n)})})}function pf(i,t){return i?typeof i=="string"?li(i):i:li(t)}function D0(i){return function(t,e,n){const s=t.length;n=n!==void 0?n:2,e=e!==void 0?e:new Array(s);for(let a=0;a<s;a+=n){const l=i(t.slice(a,a+n)),u=l.length;for(let c=0,p=n;c<p;++c)e[a+c]=c>=u?t[a+c]:l[c]}return e}}function p_(i,t,e,n){const s=li(i),a=li(t);Ca(s,a,D0(e)),Ca(a,s,D0(n))}function Ns(i,t){if(i===t)return!0;const e=i.getUnits()===t.getUnits();return(i.getCode()===t.getCode()||Dh(i,t)===mf)&&e}function Dh(i,t){const e=i.getCode(),n=t.getCode();let s=l2(e,n);return s||(s=f2),s}function go(i,t){const e=li(i),n=li(t);return Dh(e,n)}function y_(i,t,e){return go(t,e)(i,void 0,i.length)}let x_=null;function __(){return x_}function Ec(i,t){return i}function Ts(i,t){return wc&&!eh(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(wc=!1,c2("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function yf(i,t){return i}function Ls(i,t){return i}function M0(i,t,e){return function(n){let s,a;if(i.canWrapX()){const l=i.getExtent(),u=Ve(l);n=n.slice(0),a=u2(n,i,u),a&&(n[0]=n[0]-a*u),n[0]=Ei(n[0],l[0],l[2]),n[1]=Ei(n[1],l[1],l[3]),s=e(n)}else s=e(n);return a&&t.canWrapX()&&(s[0]+=a*Ve(t.getExtent())),s}}function w_(){bc(C0),bc(R0),m_(R0,C0,i_,n_)}w_();function fr(i,t,e,n,s,a){a=a||[];let l=0;for(let u=t;u<e;u+=n){const c=i[u],p=i[u+1];a[l++]=s[0]*c+s[2]*p+s[4],a[l++]=s[1]*c+s[3]*p+s[5]}return a&&a.length!=l&&(a.length=l),a}function g2(i,t,e,n,s,a,l){l=l||[];const u=Math.cos(s),c=Math.sin(s),p=a[0],y=a[1];let _=0;for(let E=t;E<e;E+=n){const I=i[E]-p,S=i[E+1]-y;l[_++]=p+I*u-S*c,l[_++]=y+I*c+S*u;for(let R=E+2;R<E+n;++R)l[_++]=i[R]}return l&&l.length!=_&&(l.length=_),l}function b_(i,t,e,n,s,a,l,u){u=u||[];const c=l[0],p=l[1];let y=0;for(let _=t;_<e;_+=n){const E=i[_]-c,I=i[_+1]-p;u[y++]=c+s*E,u[y++]=p+a*I;for(let S=_+2;S<_+n;++S)u[y++]=i[S]}return u&&u.length!=y&&(u.length=y),u}function E_(i,t,e,n,s,a,l){l=l||[];let u=0;for(let c=t;c<e;c+=n){l[u++]=i[c]+s,l[u++]=i[c+1]+a;for(let p=c+2;p<c+n;++p)l[u++]=i[p]}return l&&l.length!=u&&(l.length=u),l}const v0=Jn();class m2 extends es{constructor(){super(),this.extent_=zn(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Jp((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const s=this.clone();return s.applyTransform(n),s.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return xe()}closestPointXY(t,e,n,s){return xe()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return xe()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Qo(e),this.extentRevision_=this.getRevision()}return $x(this.extent_,t)}rotate(t,e){xe()}scale(t,e,n){xe()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return xe()}getType(){return xe()}applyTransform(t){xe()}intersectsExtent(t){return xe()}translate(t,e){xe()}transform(t,e){const n=li(t),s=n.getUnits()=="tile-pixels"?function(a,l,u){const c=n.getExtent(),p=n.getWorldExtent(),y=Oi(p)/Oi(c);return ms(v0,p[0],p[3],y,-y,0,0,0),fr(a,0,a.length,u,v0,l),go(n,e)(a,l,u)}:go(n,e);return this.applyTransform(s),this}}class jr extends m2{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return cf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return xe()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=O0(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){xe()}setLayout(t,e,n){let s;if(t)s=O0(t);else{for(let a=0;a<n;++a){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}s=e.length,t=Hr(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();g2(n,0,n.length,s,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=ps(this.getExtent()));const s=this.getFlatCoordinates();if(s){const a=this.getStride();b_(s,0,s.length,a,t,e,n,s),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();E_(n,0,n.length,s,t,e,n),this.changed()}}}function Hr(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function O0(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}function I_(i,t,e){const n=i.getFlatCoordinates();if(!n)return null;const s=i.getStride();return fr(n,0,n.length,s,t,e)}function P0(i,t,e,n,s,a,l){const u=i[t],c=i[t+1],p=i[e]-u,y=i[e+1]-c;let _;if(p===0&&y===0)_=t;else{const E=((s-u)*p+(a-c)*y)/(p*p+y*y);if(E>1)_=e;else if(E>0){for(let I=0;I<n;++I)l[I]=Rn(i[t+I],i[e+I],E);l.length=n;return}else _=t}for(let E=0;E<n;++E)l[E]=i[_+E];l.length=n}function xf(i,t,e,n,s){let a=i[t],l=i[t+1];for(t+=n;t<e;t+=n){const u=i[t],c=i[t+1],p=Fr(a,l,u,c);p>s&&(s=p),a=u,l=c}return s}function _f(i,t,e,n,s){for(let a=0,l=e.length;a<l;++a){const u=e[a];s=xf(i,t,u,n,s),t=u}return s}function C_(i,t,e,n,s){for(let a=0,l=e.length;a<l;++a){const u=e[a];s=_f(i,t,u,n,s),t=u[u.length-1]}return s}function wf(i,t,e,n,s,a,l,u,c,p,y){if(t==e)return p;let _,E;if(s===0){if(E=Fr(l,u,i[t],i[t+1]),E<p){for(_=0;_<n;++_)c[_]=i[t+_];return c.length=n,E}return p}y=y||[NaN,NaN];let I=t+n;for(;I<e;)if(P0(i,I-n,I,n,l,u,y),E=Fr(l,u,y[0],y[1]),E<p){for(p=E,_=0;_<n;++_)c[_]=y[_];c.length=n,I+=n}else I+=n*Math.max((Math.sqrt(E)-Math.sqrt(p))/s|0,1);if(a&&(P0(i,e-n,t,n,l,u,y),E=Fr(l,u,y[0],y[1]),E<p)){for(p=E,_=0;_<n;++_)c[_]=y[_];c.length=n}return p}function bf(i,t,e,n,s,a,l,u,c,p,y){y=y||[NaN,NaN];for(let _=0,E=e.length;_<E;++_){const I=e[_];p=wf(i,t,I,n,s,a,l,u,c,p,y),t=I}return p}function A_(i,t,e,n,s,a,l,u,c,p,y){y=y||[NaN,NaN];for(let _=0,E=e.length;_<E;++_){const I=e[_];p=bf(i,t,I,n,s,a,l,u,c,p,y),t=I[I.length-1]}return p}function R_(i,t,e,n){for(let s=0,a=e.length;s<a;++s)i[t++]=e[s];return t}function Mh(i,t,e,n){for(let s=0,a=e.length;s<a;++s){const l=e[s];for(let u=0;u<n;++u)i[t++]=l[u]}return t}function el(i,t,e,n,s){s=s||[];let a=0;for(let l=0,u=e.length;l<u;++l){const c=Mh(i,t,e[l],n);s[a++]=c,t=c}return s.length=a,s}function p2(i,t,e,n,s){s=s||[];let a=0;for(let l=0,u=e.length;l<u;++l){const c=el(i,t,e[l],n,s[a]);c.length===0&&(c[0]=t),s[a++]=c,t=c[c.length-1]}return s.length=a,s}function vh(i,t,e,n,s,a,l){const u=(e-t)/n;if(u<3){for(;t<e;t+=n)a[l++]=i[t],a[l++]=i[t+1];return l}const c=new Array(u);c[0]=1,c[u-1]=1;const p=[t,e-n];let y=0;for(;p.length>0;){const _=p.pop(),E=p.pop();let I=0;const S=i[E],R=i[E+1],D=i[_],T=i[_+1];for(let v=E+n;v<_;v+=n){const k=i[v],X=i[v+1],H=l_(k,X,S,R,D,T);H>I&&(y=v,I=H)}I>s&&(c[(y-t)/n]=1,E+n<y&&p.push(E,y),y+n<_&&p.push(y,_))}for(let _=0;_<u;++_)c[_]&&(a[l++]=i[t+_*n],a[l++]=i[t+_*n+1]);return l}function y2(i,t,e,n,s,a,l,u){for(let c=0,p=e.length;c<p;++c){const y=e[c];l=vh(i,t,y,n,s,a,l),u.push(l),t=y}return l}function vr(i,t){return t*Math.round(i/t)}function S_(i,t,e,n,s,a,l){if(t==e)return l;let u=vr(i[t],s),c=vr(i[t+1],s);t+=n,a[l++]=u,a[l++]=c;let p,y;do if(p=vr(i[t],s),y=vr(i[t+1],s),t+=n,t==e)return a[l++]=p,a[l++]=y,l;while(p==u&&y==c);for(;t<e;){const _=vr(i[t],s),E=vr(i[t+1],s);if(t+=n,_==p&&E==y)continue;const I=p-u,S=y-c,R=_-u,D=E-c;if(I*D==S*R&&(I<0&&R<I||I==R||I>0&&R>I)&&(S<0&&D<S||S==D||S>0&&D>S)){p=_,y=E;continue}a[l++]=p,a[l++]=y,u=p,c=y,p=_,y=E}return a[l++]=p,a[l++]=y,l}function Ef(i,t,e,n,s,a,l,u){for(let c=0,p=e.length;c<p;++c){const y=e[c];l=S_(i,t,y,n,s,a,l),u.push(l),t=y}return l}function T_(i,t,e,n,s,a,l,u){for(let c=0,p=e.length;c<p;++c){const y=e[c],_=[];l=Ef(i,t,y,n,s,a,l,_),u.push(_),t=y[y.length-1]}return l}function or(i,t,e,n,s){s=s!==void 0?s:[];let a=0;for(let l=t;l<e;l+=n)s[a++]=i.slice(l,l+n);return s.length=a,s}function mo(i,t,e,n,s){s=s!==void 0?s:[];let a=0;for(let l=0,u=e.length;l<u;++l){const c=e[l];s[a++]=or(i,t,c,n,s[a]),t=c}return s.length=a,s}function Ic(i,t,e,n,s){s=s!==void 0?s:[];let a=0;for(let l=0,u=e.length;l<u;++l){const c=e[l];s[a++]=c.length===1&&c[0]===t?[]:mo(i,t,c,n,s[a]),t=c[c.length-1]}return s.length=a,s}function x2(i,t,e,n){let s=0,a=i[e-n],l=i[e-n+1];for(;t<e;t+=n){const u=i[t],c=i[t+1];s+=l*u-a*c,a=u,l=c}return s/2}function _2(i,t,e,n){let s=0;for(let a=0,l=e.length;a<l;++a){const u=e[a];s+=x2(i,t,u,n),t=u}return s}function D_(i,t,e,n){let s=0;for(let a=0,l=e.length;a<l;++a){const u=e[a];s+=_2(i,t,u,n),t=u[u.length-1]}return s}class po extends jr{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new po(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,s){return s<Wr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(xf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),wf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,s))}getArea(){return x2(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return or(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=vh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new po(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Mh(this.flatCoordinates,0,t,this.stride),this.changed()}}let yo=class w2 extends jr{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new w2(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){const a=this.flatCoordinates,l=Fr(t,e,a[0],a[1]);if(l<s){const u=this.stride;for(let c=0;c<u;++c)n[c]=a[c];return n.length=u,l}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return i2(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return uf(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=R_(this.flatCoordinates,0,t,this.stride),this.changed()}};function M_(i,t,e,n,s){return!r2(s,function(l){return!Or(i,t,e,n,l[0],l[1])})}function Or(i,t,e,n,s,a){let l=0,u=i[e-n],c=i[e-n+1];for(;t<e;t+=n){const p=i[t],y=i[t+1];c<=a?y>a&&(p-u)*(a-c)-(s-u)*(y-c)>0&&l++:y<=a&&(p-u)*(a-c)-(s-u)*(y-c)<0&&l--,u=p,c=y}return l!==0}function If(i,t,e,n,s,a){if(e.length===0||!Or(i,t,e[0],n,s,a))return!1;for(let l=1,u=e.length;l<u;++l)if(Or(i,e[l-1],e[l],n,s,a))return!1;return!0}function v_(i,t,e,n,s,a){if(e.length===0)return!1;for(let l=0,u=e.length;l<u;++l){const c=e[l];if(If(i,t,c,n,s,a))return!0;t=c[c.length-1]}return!1}function Cf(i,t,e,n,s,a,l){let u,c,p,y,_,E,I;const S=s[a+1],R=[];for(let v=0,k=e.length;v<k;++v){const X=e[v];for(y=i[X-n],E=i[X-n+1],u=t;u<X;u+=n)_=i[u],I=i[u+1],(S<=E&&I<=S||E<=S&&S<=I)&&(p=(S-E)/(I-E)*(_-y)+y,R.push(p)),y=_,E=I}let D=NaN,T=-1/0;for(R.sort(ks),y=R[0],u=1,c=R.length;u<c;++u){_=R[u];const v=Math.abs(_-y);v>T&&(p=(y+_)/2,If(i,t,e,n,p,S)&&(D=p,T=v)),y=_}return isNaN(D)&&(D=s[a]),l?(l.push(D,S,T),l):[D,S,T]}function b2(i,t,e,n,s){let a=[];for(let l=0,u=e.length;l<u;++l){const c=e[l];a=Cf(i,t,c,n,s,2*l,a),t=c[c.length-1]}return a}function E2(i,t,e,n,s){let a;for(t+=n;t<e;t+=n)if(a=s(i.slice(t-n,t),i.slice(t,t+n)),a)return a;return!1}function Oh(i,t,e,n,s){const a=s2(zn(),i,t,e,n);return en(s,a)?us(s,a)||a[0]>=s[0]&&a[2]<=s[2]||a[1]>=s[1]&&a[3]<=s[3]?!0:E2(i,t,e,n,function(l,u){return Jx(s,l,u)}):!1}function O_(i,t,e,n,s){for(let a=0,l=e.length;a<l;++a){if(Oh(i,t,e[a],n,s))return!0;t=e[a]}return!1}function I2(i,t,e,n,s){return!!(Oh(i,t,e,n,s)||Or(i,t,e,n,s[0],s[1])||Or(i,t,e,n,s[0],s[3])||Or(i,t,e,n,s[2],s[1])||Or(i,t,e,n,s[2],s[3]))}function C2(i,t,e,n,s){if(!I2(i,t,e[0],n,s))return!1;if(e.length===1)return!0;for(let a=1,l=e.length;a<l;++a)if(M_(i,e[a-1],e[a],n,s)&&!Oh(i,e[a-1],e[a],n,s))return!1;return!0}function P_(i,t,e,n,s){for(let a=0,l=e.length;a<l;++a){const u=e[a];if(C2(i,t,u,n,s))return!0;t=u[u.length-1]}return!1}function N_(i,t,e,n){for(;t<e-n;){for(let s=0;s<n;++s){const a=i[t+s];i[t+s]=i[e-n+s],i[e-n+s]=a}t+=n,e-=n}}function Af(i,t,e,n){let s=0,a=i[e-n],l=i[e-n+1];for(;t<e;t+=n){const u=i[t],c=i[t+1];s+=(u-a)*(c+l),a=u,l=c}return s===0?void 0:s>0}function Rf(i,t,e,n,s){s=s!==void 0?s:!1;for(let a=0,l=e.length;a<l;++a){const u=e[a],c=Af(i,t,u,n);if(a===0){if(s&&c||!s&&!c)return!1}else if(s&&!c||!s&&c)return!1;t=u}return!0}function A2(i,t,e,n,s){for(let a=0,l=e.length;a<l;++a){const u=e[a];if(!Rf(i,t,u,n,s))return!1;u.length&&(t=u[u.length-1])}return!0}function ih(i,t,e,n,s){s=s!==void 0?s:!1;for(let a=0,l=e.length;a<l;++a){const u=e[a],c=Af(i,t,u,n);(a===0?s&&c||!s&&!c:s&&!c||!s&&c)&&N_(i,t,u,n),t=u}return t}function Cc(i,t,e,n,s){for(let a=0,l=e.length;a<l;++a)t=ih(i,t,e[a],n,s);return t}function L_(i,t){const e=[];let n=0,s=0,a;for(let l=0,u=t.length;l<u;++l){const c=t[l],p=Af(i,n,c,2);if(a===void 0&&(a=p),p===a)e.push(t.slice(s,l+1));else{if(e.length===0)continue;e[e.length-1].push(t[s])}s=l+1,n=c}return e}let xo=class Ac extends jr{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?$n(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Ac(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Wr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_f(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bf(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,s))}containsXY(t,e){return If(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return _2(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),ih(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,mo(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=ps(this.getExtent());this.flatInteriorPoint_=Cf(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new yo(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new po(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,s=[];let a=0;for(let l=0,u=n.length;l<u;++l){const c=n[l],p=new po(e.slice(a,c),t);s.push(p),a=c}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Rf(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=ih(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=Ef(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new Ac(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return C2(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=el(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}};function N0(i){if(Na(i))throw new Error("Cannot create polygon from empty extent");const t=i[0],e=i[1],n=i[2],s=i[3],a=[t,e,t,s,n,s,n,e,t,e];return new xo(a,"XY",[a.length])}const Gn={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},se={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},_o={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var ji={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};ji.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}};ji.max=ji.whitepoint[2].D65;ji.rgb=function(i,t){t=t||ji.whitepoint[2].E;var e=i[0]/t[0],n=i[1]/t[1],s=i[2]/t[2],a,l,u;return a=e*3.240969941904521+n*-1.537383177570093+s*-.498610760293,l=e*-.96924363628087+n*1.87596750150772+s*.041555057407175,u=e*.055630079696993+n*-.20397695888897+s*1.056971514242878,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,l=l>.0031308?1.055*Math.pow(l,1/2.4)-.055:l=l*12.92,u=u>.0031308?1.055*Math.pow(u,1/2.4)-.055:u=u*12.92,a=Math.min(Math.max(0,a),1),l=Math.min(Math.max(0,l),1),u=Math.min(Math.max(0,u),1),[a*255,l*255,u*255]};_o.xyz=function(i,t){var e=i[0]/255,n=i[1]/255,s=i[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92;var a=e*.41239079926595+n*.35758433938387+s*.18048078840183,l=e*.21263900587151+n*.71516867876775+s*.072192315360733,u=e*.019330818715591+n*.11919477979462+s*.95053215224966;return t=t||ji.whitepoint[2].E,[a*t[0],l*t[1],u*t[2]]};const Sf={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(i,t,e){var n,s,a,l,u,c,p,y,_,E,I,S,R;if(a=i[0],l=i[1],u=i[2],a===0)return[0,0,0];var D=.0011070564598794539;return t=t||"D65",e=e||2,_=ji.whitepoint[e][t][0],E=ji.whitepoint[e][t][1],I=ji.whitepoint[e][t][2],S=4*_/(_+15*E+3*I),R=9*E/(_+15*E+3*I),n=l/(13*a)+S||0,s=u/(13*a)+R||0,p=a>8?E*Math.pow((a+16)/116,3):E*a*D,c=p*9*n/(4*s)||0,y=p*(12-3*n-20*s)/(4*s)||0,[c,p,y]}};ji.luv=function(i,t,e){var n,s,a,l,u,c,p,y,_,E,I,S,R,D=.008856451679035631,T=903.2962962962961;t=t||"D65",e=e||2,_=ji.whitepoint[e][t][0],E=ji.whitepoint[e][t][1],I=ji.whitepoint[e][t][2],S=4*_/(_+15*E+3*I),R=9*E/(_+15*E+3*I),c=i[0],p=i[1],y=i[2],n=4*c/(c+15*p+3*y)||0,s=9*p/(c+15*p+3*y)||0;var v=p/E;return a=v<=D?T*v:116*Math.pow(v,1/3)-16,l=13*a*(n-S),u=13*a*(s-R),[a,l,u]};var R2={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(i){var t=i[0],e=i[1],n=i[2],s,a,l;return l=n/360*2*Math.PI,s=e*Math.cos(l),a=e*Math.sin(l),[t,s,a]},xyz:function(i){return Sf.xyz(R2.luv(i))}};Sf.lchuv=function(i){var t=i[0],e=i[1],n=i[2],s=Math.sqrt(e*e+n*n),a=Math.atan2(n,e),l=a*360/2/Math.PI;return l<0&&(l+=360),[t,s,l]};ji.lchuv=function(i){return Sf.lchuv(ji.luv(i))};const L0={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var k0={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function k_(i){var t,e=[],n=1,s;if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(typeof i=="number")return{space:"rgb",values:[i>>>16,(i&65280)>>>8,i&255],alpha:1};if(i=String(i).toLowerCase(),L0[i])e=L0[i].slice(),s="rgb";else if(i==="transparent")n=0,s="rgb",e=[0,0,0];else if(i[0]==="#"){var a=i.slice(1),l=a.length,u=l<=4;n=1,u?(e=[parseInt(a[0]+a[0],16),parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16)],l===4&&(n=parseInt(a[3]+a[3],16)/255)):(e=[parseInt(a[0]+a[1],16),parseInt(a[2]+a[3],16),parseInt(a[4]+a[5],16)],l===8&&(n=parseInt(a[6]+a[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),s="rgb"}else if(t=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(i)){var c=t[1];s=c.replace(/a$/,"");var p=s==="cmyk"?4:s==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/),s==="color"&&(s=e.shift()),e=e.map(function(y,_){if(y[y.length-1]==="%")return y=parseFloat(y)/100,_===3?y:s==="rgb"?y*255:s[0]==="h"||s[0]==="l"&&!_?y*100:s==="lab"?y*125:s==="lch"?_<2?y*150:y*360:s[0]==="o"&&!_?y:s==="oklab"?y*.4:s==="oklch"?_<2?y*.4:y*360:y;if(s[_]==="h"||_===2&&s[s.length-1]==="h"){if(k0[y]!==void 0)return k0[y];if(y.endsWith("deg"))return parseFloat(y);if(y.endsWith("turn"))return parseFloat(y)*360;if(y.endsWith("grad"))return parseFloat(y)*360/400;if(y.endsWith("rad"))return parseFloat(y)*180/Math.PI}return y==="none"?0:parseFloat(y)}),n=e.length>p?e.pop():1}else/[0-9](?:\s|\/|,)/.test(i)&&(e=i.match(/([0-9]+)/g).map(function(y){return parseFloat(y)}),s=i.match(/([a-z])/ig)?.join("")?.toLowerCase()||"rgb");return{space:s,values:e,alpha:n}}const bu={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(i){var t=i[0]/360,e=i[1]/100,n=i[2]/100,s,a,l,u,c,p=0;if(e===0)return c=n*255,[c,c,c];for(a=n<.5?n*(1+e):n+e-n*e,s=2*n-a,u=[0,0,0];p<3;)l=t+1/3*-(p-1),l<0?l++:l>1&&l--,c=6*l<1?s+(a-s)*6*l:2*l<1?a:3*l<2?s+(a-s)*(2/3-l)*6:s,u[p++]=c*255;return u}};_o.hsl=function(i){var t=i[0]/255,e=i[1]/255,n=i[2]/255,s=Math.min(t,e,n),a=Math.max(t,e,n),l=a-s,u,c,p;return a===s?u=0:t===a?u=(e-n)/l:e===a?u=2+(n-t)/l:n===a&&(u=4+(t-e)/l),u=Math.min(u*60,360),u<0&&(u+=360),p=(s+a)/2,a===s?c=0:p<=.5?c=l/(a+s):c=l/(2-a-s),[u,c*100,p*100]};function F_(i){Array.isArray(i)&&i.raw&&(i=String.raw(...arguments)),i instanceof Number&&(i=+i);var t,e=k_(i);if(!e.space)return[];const n=e.space[0]==="h"?bu.min:_o.min,s=e.space[0]==="h"?bu.max:_o.max;return t=Array(3),t[0]=Math.min(Math.max(e.values[0],n[0]),s[0]),t[1]=Math.min(Math.max(e.values[1],n[1]),s[1]),t[2]=Math.min(Math.max(e.values[2],n[2]),s[2]),e.space[0]==="h"&&(t=bu.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t}function B_(i){return typeof i=="string"?i:Df(i)}const V_=1024,Za={};let Eu=0;function G_(i){if(i.length===4)return i;const t=i.slice();return t[3]=1,t}function F0(i){const t=ji.lchuv(_o.xyz(i));return t[3]=i[3],t}function z_(i){const t=ji.rgb(R2.xyz(i));return t[3]=i[3],t}function Tf(i){if(Za.hasOwnProperty(i))return Za[i];if(Eu>=V_){let e=0;for(const n in Za)e++&3||(delete Za[n],--Eu)}const t=F_(i);if(t.length!==4)throw new Error('Failed to parse "'+i+'" as color');for(const e of t)if(isNaN(e))throw new Error('Failed to parse "'+i+'" as color');return S2(t),Za[i]=t,++Eu,t}function wo(i){return Array.isArray(i)?i:Tf(i)}function S2(i){return i[0]=Ei(i[0]+.5|0,0,255),i[1]=Ei(i[1]+.5|0,0,255),i[2]=Ei(i[2]+.5|0,0,255),i[3]=Ei(i[3],0,1),i}function Df(i){let t=i[0];t!=(t|0)&&(t=t+.5|0);let e=i[1];e!=(e|0)&&(e=e+.5|0);let n=i[2];n!=(n|0)&&(n=n+.5|0);const s=i[3]===void 0?1:Math.round(i[3]*1e3)/1e3;return"rgba("+t+","+e+","+n+","+s+")"}function U_(i){try{return Tf(i),!0}catch{return!1}}const mr=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",W_=mr.includes("firefox"),X_=mr.includes("safari")&&!mr.includes("chrom");X_&&(mr.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(mr));const j_=mr.includes("webkit")&&!mr.includes("edge"),T2=mr.includes("macintosh"),D2=typeof devicePixelRatio<"u"?devicePixelRatio:1,M2=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Mf=typeof Image<"u"&&Image.prototype.decode,H_=typeof createImageBitmap=="function",v2=function(){let i=!1;try{const t=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return i}();function Hi(i,t,e,n){let s;return e&&e.length?s=e.shift():M2?s=new OffscreenCanvas(i||300,t||300):s=document.createElement("canvas"),i&&(s.width=i),t&&(s.height=t),s.getContext("2d",n)}let Iu;function nh(){return Iu||(Iu=Hi(1,1)),Iu}function Ph(i){const t=i.canvas;t.width=1,t.height=1,i.clearRect(0,0,1,1)}function Y_(i){let t=i.offsetWidth;const e=getComputedStyle(i);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),t}function Z_(i){let t=i.offsetHeight;const e=getComputedStyle(i);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),t}function B0(i,t){const e=t.parentNode;e&&e.replaceChild(i,t)}function sh(i){return i&&i.parentNode?i.parentNode.removeChild(i):null}function O2(i){for(;i.lastChild;)i.removeChild(i.lastChild)}function K_(i,t){const e=i.childNodes;for(let n=0;;++n){const s=e[n],a=t[n];if(!s&&!a)break;if(s!==a){if(!s){i.appendChild(a);continue}if(!a){i.removeChild(s),--n;continue}i.insertBefore(a,s)}}}class q_ extends $o{constructor(t,e,n,s){super(),this.extent=t,this.pixelRatio_=n,this.resolution=e,this.state=typeof s=="function"?se.IDLE:s,this.image_=null,this.loader=typeof s=="function"?s:null}changed(){this.dispatchEvent(_e.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==se.IDLE&&this.loader){this.state=se.LOADING,this.changed();const t=this.getResolution(),e=Array.isArray(t)?t[0]:t;Qp(()=>this.loader(this.getExtent(),e,this.getPixelRatio())).then(n=>{"image"in n&&(this.image_=n.image),"extent"in n&&(this.extent=n.extent),"resolution"in n&&(this.resolution=n.resolution),"pixelRatio"in n&&(this.pixelRatio_=n.pixelRatio),(n instanceof HTMLImageElement||n instanceof ImageBitmap||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement)&&(this.image_=n),this.state=se.LOADED}).catch(n=>{this.state=se.ERROR,console.error(n)}).finally(()=>this.changed())}}setImage(t){this.image_=t}setResolution(t){this.resolution=t}}function $_(i,t,e){const n=i;let s=!0,a=!1,l=!1;const u=[Ql(n,_e.LOAD,function(){l=!0,a||t()})];return n.src&&Mf?(a=!0,n.decode().then(function(){s&&t()}).catch(function(c){s&&(l?t():e())})):u.push(Ql(n,_e.ERROR,e)),function(){s=!1,u.forEach(oi)}}function J_(i,t){return new Promise((e,n)=>{function s(){l(),e(i)}function a(){l(),n(new Error("Image load error"))}function l(){i.removeEventListener("load",s),i.removeEventListener("error",a)}i.addEventListener("load",s),i.addEventListener("error",a),t&&(i.src=t)})}function P2(i,t){return t&&(i.src=t),i.src&&Mf?new Promise((e,n)=>i.decode().then(()=>e(i)).catch(s=>i.complete&&i.width?e(i):n(s))):J_(i)}function N2(i,t){return t&&(i.src=t),i.src&&Mf&&H_?i.decode().then(()=>createImageBitmap(i)).catch(e=>{if(i.complete&&i.width)return i;throw e}):P2(i)}const vf=q_;class Q_{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];!(t++&3)&&!n.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,n){const s=Cu(t,e,n);return s in this.cache_?this.cache_[s]:null}getPattern(t,e,n){const s=Cu(t,e,n);return s in this.patternCache_?this.patternCache_[s]:null}set(t,e,n,s,a){const l=Cu(t,e,n),u=l in this.cache_;this.cache_[l]=s,a&&(s.getImageState()===se.IDLE&&s.load(),s.getImageState()===se.LOADING?s.ready().then(()=>{this.patternCache_[l]=nh().createPattern(s.getImage(1),"repeat")}):this.patternCache_[l]=nh().createPattern(s.getImage(1),"repeat")),u||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function Cu(i,t,e){const n=e?wo(e):"null";return t+":"+i+":"+n}const cs=new Q_;let Ka=null;class tw extends $o{constructor(t,e,n,s,a){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=a,this.imageState_=s===void 0?se.IDLE:s,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===se.LOADED){Ka||(Ka=Hi(1,1,void 0,{willReadFrequently:!0})),Ka.drawImage(this.image_,0,0);try{Ka.getImageData(0,0,1,1),this.tainted_=!1}catch{Ka=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(_e.CHANGE)}handleImageError_(){this.imageState_=se.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=se.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],n=Hi(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===se.IDLE){this.image_||this.initializeImage_(),this.imageState_=se.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&P2(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==se.LOADED)return;const e=this.image_,n=document.createElement("canvas");n.width=Math.ceil(e.width*t),n.height=Math.ceil(e.height*t);const s=n.getContext("2d");s.scale(t,t),s.drawImage(e,0,0),s.globalCompositeOperation="multiply",s.fillStyle=B_(this.color_),s.fillRect(0,0,n.width/t,n.height/t),s.globalCompositeOperation="destination-in",s.drawImage(e,0,0),this.canvas_[t]=n}ready(){return this.ready_||(this.ready_=new Promise(t=>{this.imageState_===se.LOADED||this.imageState_===se.ERROR?t():this.addEventListener(_e.CHANGE,function e(){(this.imageState_===se.LOADED||this.imageState_===se.ERROR)&&(this.removeEventListener(_e.CHANGE,e),t())})})),this.ready_}}function Of(i,t,e,n,s,a){let l=t===void 0?void 0:cs.get(t,e,s);return l||(l=new tw(i,i&&"src"in i?i.src||void 0:t,e,n,s),cs.set(t,e,s,l,a)),a&&l&&!cs.getPattern(t,e,s)&&cs.set(t,e,s,l,a),l}class il{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new il({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=Of(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===se.IDLE&&e.load(),e.getImageState()===se.LOADING&&(this.patternImage_=e)}this.color_=t}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function rh(i,t,e,n,s,a,l){let u,c;const p=(e-t)/n;if(p===1)u=t;else if(p===2)u=t,c=s;else if(p!==0){let y=i[t],_=i[t+1],E=0;const I=[0];for(let D=t+n;D<e;D+=n){const T=i[D],v=i[D+1];E+=Math.sqrt((T-y)*(T-y)+(v-_)*(v-_)),I.push(E),y=T,_=v}const S=s*E,R=Gx(I,S);R<0?(c=(S-I[-R-2])/(I[-R-1]-I[-R-2]),u=t+(-R-2)*n):u=t+R*n}l=l>1?l:2,a=a||new Array(l);for(let y=0;y<l;++y)a[y]=u===void 0?NaN:c===void 0?i[u+y]:Rn(i[u+y],i[u+n+y],c);return a}function Rc(i,t,e,n,s,a){if(e==t)return null;let l;if(s<i[t+n-1])return a?(l=i.slice(t,t+n),l[n-1]=s,l):null;if(i[e-1]<s)return a?(l=i.slice(e-n,e),l[n-1]=s,l):null;if(s==i[t+n-1])return i.slice(t,t+n);let u=t/n,c=e/n;for(;u<c;){const E=u+c>>1;s<i[(E+1)*n-1]?c=E:u=E+1}const p=i[u*n-1];if(s==p)return i.slice((u-1)*n,(u-1)*n+n);const y=i[(u+1)*n-1],_=(s-p)/(y-p);l=[];for(let E=0;E<n-1;++E)l.push(Rn(i[(u-1)*n+E],i[u*n+E],_));return l.push(s),l}function ew(i,t,e,n,s,a,l){if(l)return Rc(i,t,e[e.length-1],n,s,a);let u;if(s<i[n-1])return a?(u=i.slice(0,n),u[n-1]=s,u):null;if(i[i.length-1]<s)return a?(u=i.slice(i.length-n),u[n-1]=s,u):null;for(let c=0,p=e.length;c<p;++c){const y=e[c];if(t!=y){if(s<i[t+n-1])return null;if(s<=i[y-1])return Rc(i,t,y,n,s,!1);t=y}}return null}function L2(i,t,e,n){let s=i[t],a=i[t+1],l=0;for(let u=t+n;u<e;u+=n){const c=i[u],p=i[u+1];l+=Math.sqrt((c-s)*(c-s)+(p-a)*(p-a)),s=c,a=p}return l}let ah=class Sc extends jr{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){$n(this.flatCoordinates,t),this.changed()}clone(){const t=new Sc(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Wr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(xf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),wf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,s))}forEachSegment(t){return E2(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,Rc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return or(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return rh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return L2(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=vh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Sc(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Oh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Mh(this.flatCoordinates,0,t,this.stride),this.changed()}};class Nh{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new Nh({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}function V0(i){return i[0]>0&&i[1]>0}function iw(i,t,e){return e===void 0&&(e=[0,0]),e[0]=i[0]*t+.5|0,e[1]=i[1]*t+.5|0,e}function Tn(i,t){return Array.isArray(i)?i:(t===void 0?t=[i,i]:(t[0]=i,t[1]=i),t)}class Lh{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Tn(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Lh({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return xe()}getImage(t){return xe()}getHitDetectionImage(){return xe()}getPixelRatio(t){return 1}getImageState(){return xe()}getImageSize(){return xe()}getOrigin(){return xe()}getSize(){return xe()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Tn(t)}listenImageChange(t){xe()}load(){xe()}unlistenImageChange(t){xe()}ready(){return Promise.resolve()}}function fs(i){return i?Array.isArray(i)?Df(i):typeof i=="object"&&"src"in i?nw(i):i:null}function nw(i){if(!i.offset||!i.size)return cs.getPattern(i.src,"anonymous",i.color);const t=i.src+":"+i.offset,e=cs.getPattern(t,void 0,i.color);if(e)return e;const n=cs.get(i.src,"anonymous",null);if(n.getImageState()!==se.LOADED)return null;const s=Hi(i.size[0],i.size[1]);return s.drawImage(n.getImage(1),i.offset[0],i.offset[1],i.size[0],i.size[1],0,0,i.size[0],i.size[1]),Of(s.canvas,t,void 0,se.LOADED,i.color,!0),cs.getPattern(t,void 0,i.color)}const Ml="ol-hidden",sw="ol-selectable",kh="ol-unselectable",Pf="ol-control",G0="ol-collapsed",rw=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),z0=["style","variant","weight","size","lineHeight","family"],k2=function(i){const t=i.match(rw);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let n=0,s=z0.length;n<s;++n){const a=t[n+1];a!==void 0&&(e[z0[n]]=a)}return e.families=e.family.split(/,\s?/),e},F2="10px sans-serif",xn="#000",Aa="round",Fs=[],Bs=0,Ra="round",bo=10,Eo="#000",Io="center",oh="middle",Pr=[0,0,0,0],Co=1,Ds=new es;let ca=null,Tc;const Dc={},aw=function(){const t="32px ",e=["monospace","serif"],n=e.length,s="wmytzilWMYTZIL@#/&?$%10";let a,l;function u(p,y,_){let E=!0;for(let I=0;I<n;++I){const S=e[I];if(l=lh(p+" "+y+" "+t+S,s),_!=S){const R=lh(p+" "+y+" "+t+_+","+S,s);E=E&&R!=l}}return!!E}function c(){let p=!0;const y=Ds.getKeys();for(let _=0,E=y.length;_<E;++_){const I=y[_];Ds.get(I)<100&&(u.apply(this,I.split(`
`))?(qo(Dc),ca=null,Tc=void 0,Ds.set(I,100)):(Ds.set(I,Ds.get(I)+1,!0),p=!1))}p&&(clearInterval(a),a=void 0)}return function(p){const y=k2(p);if(!y)return;const _=y.families;for(let E=0,I=_.length;E<I;++E){const S=_[E],R=y.style+`
`+y.weight+`
`+S;Ds.get(R)===void 0&&(Ds.set(R,100,!0),u(y.style,y.weight,S)||(Ds.set(R,0,!0),a===void 0&&(a=setInterval(c,32))))}}}(),ow=function(){let i;return function(t){let e=Dc[t];if(e==null){if(M2){const n=k2(t),s=B2(t,"Žg");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=t,document.body.appendChild(i),e=i.offsetHeight,document.body.removeChild(i);Dc[t]=e}return e}}();function B2(i,t){return ca||(ca=Hi(1,1)),i!=Tc&&(ca.font=i,Tc=ca.font),ca.measureText(t)}function lh(i,t){return B2(i,t).width}function U0(i,t,e){if(t in e)return e[t];const n=t.split(`
`).reduce((s,a)=>Math.max(s,lh(i,a)),0);return e[t]=n,n}function lw(i,t){const e=[],n=[],s=[];let a=0,l=0,u=0,c=0;for(let p=0,y=t.length;p<=y;p+=2){const _=t[p];if(_===`
`||p===y){a=Math.max(a,l),s.push(l),l=0,u+=c,c=0;continue}const E=t[p+1]||i.font,I=lh(E,_);e.push(I),l+=I;const S=ow(E);n.push(S),c=Math.max(c,S)}return{width:a,height:u,widths:e,heights:n,lineWidths:s}}function hw(i,t,e,n,s,a,l,u,c,p,y){i.save(),e!==1&&(i.globalAlpha===void 0?i.globalAlpha=_=>_.globalAlpha*=e:i.globalAlpha*=e),t&&i.transform.apply(i,t),n.contextInstructions?(i.translate(c,p),i.scale(y[0],y[1]),uw(n,i)):y[0]<0||y[1]<0?(i.translate(c,p),i.scale(y[0],y[1]),i.drawImage(n,s,a,l,u,0,0,l,u)):i.drawImage(n,s,a,l,u,c,p,l*y[0],u*y[1]),i.restore()}function uw(i,t){const e=i.contextInstructions;for(let n=0,s=e.length;n<s;n+=2)Array.isArray(e[n+1])?t[e[n]].apply(t,e[n+1]):t[e[n]]=e[n+1]}class Fh extends Lh{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?se.LOADING:se.LOADED,this.imageState_===se.LOADING&&this.ready().then(()=>this.imageState_=se.LOADED),this.render()}clone(){const t=this.getScale(),e=new Fh({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const n=this.renderOptions_,s=Hi(n.size*t,n.size*t);this.draw_(n,s,t),e=s.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,n){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let s=this.radius_,a=this.radius2_===void 0?s:this.radius2_;if(s<a){const K=s;s=a,a=K}const l=this.radius2_===void 0?this.points_:this.points_*2,u=2*Math.PI/l,c=a*Math.sin(u),p=Math.sqrt(a*a-c*c),y=s-p,_=Math.sqrt(c*c+y*y),E=_/c;if(t==="miter"&&E<=n)return E*e;const I=e/2/E,S=e/2*(y/_),D=Math.sqrt((s+I)*(s+I)+S*S)-s;if(this.radius2_===void 0||t==="bevel")return D*2;const T=s*Math.sin(u),v=Math.sqrt(s*s-T*T),k=a-v,H=Math.sqrt(T*T+k*k)/T;if(H<=n){const K=H*e/2-a-s;return 2*Math.max(D,K)}return D*2}createRenderOptions(){let t=Aa,e=Ra,n=0,s=null,a=0,l,u=0;this.stroke_&&(l=fs(this.stroke_.getColor()??Eo),u=this.stroke_.getWidth()??Co,s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Ra,t=this.stroke_.getLineCap()??Aa,n=this.stroke_.getMiterLimit()??bo);const c=this.calculateLineJoinSize_(e,u,n),p=Math.max(this.radius_,this.radius2_||0),y=Math.ceil(2*p+c);return{strokeStyle:l,strokeWidth:u,size:y,lineCap:t,lineDash:s,lineDashOffset:a,lineJoin:e,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let s=this.fill_.getColor();s===null&&(s=xn),e.fillStyle=fs(s),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let n=this.fill_.getColor(),s=0;typeof n=="string"&&(n=wo(n)),n===null?s=1:Array.isArray(n)&&(s=n.length===4?n[3]:1),s===0&&(e=Hi(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const n=this.radius_;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{const s=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(e*=2);const a=this.angle_-Math.PI/2,l=2*Math.PI/e;for(let u=0;u<e;u++){const c=a+u*l,p=u%2===0?n:s;t.lineTo(p*Math.cos(c),p*Math.sin(c))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=xn,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Bh extends Fh{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Bh({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}class Vh{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=W0,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Vh({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=W0,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function cw(i){let t;if(typeof i=="function")t=i;else{let e;Array.isArray(i)?e=i:(qe(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[i]),t=function(){return e}}return t}let Au=null;function V2(i,t){if(!Au){const e=new il({color:"rgba(255,255,255,0.4)"}),n=new Nh({color:"#3399CC",width:1.25});Au=[new Vh({image:new Bh({fill:e,stroke:n,radius:5}),fill:e,stroke:n})]}return Au}function W0(i){return i.getGeometry()}const Zl=Vh,fw="#333";class Nf{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Tn(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new il({color:fw}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Nf({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Tn(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const ni={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class G2 extends es{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[ni.OPACITY]=t.opacity!==void 0?t.opacity:1,qe(typeof e[ni.OPACITY]=="number","Layer opacity must be a number"),e[ni.VISIBLE]=t.visible!==void 0?t.visible:!0,e[ni.Z_INDEX]=t.zIndex,e[ni.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[ni.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[ni.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[ni.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return e.opacity=Ei(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=n===void 0&&!e.managed?1/0:n,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return xe()}getLayerStatesArray(t){return xe()}getExtent(){return this.get(ni.EXTENT)}getMaxResolution(){return this.get(ni.MAX_RESOLUTION)}getMinResolution(){return this.get(ni.MIN_RESOLUTION)}getMinZoom(){return this.get(ni.MIN_ZOOM)}getMaxZoom(){return this.get(ni.MAX_ZOOM)}getOpacity(){return this.get(ni.OPACITY)}getSourceState(){return xe()}getVisible(){return this.get(ni.VISIBLE)}getZIndex(){return this.get(ni.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(ni.EXTENT,t)}setMaxResolution(t){this.set(ni.MAX_RESOLUTION,t)}setMinResolution(t){this.set(ni.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(ni.MAX_ZOOM,t)}setMinZoom(t){this.set(ni.MIN_ZOOM,t)}setOpacity(t){qe(typeof t=="number","Layer opacity must be a number"),this.set(ni.OPACITY,t)}setVisible(t){this.set(ni.VISIBLE,t)}setZIndex(t){this.set(ni.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const Gi={ANIMATING:0,INTERACTING:1},Zn={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},dw=42,Lf=256;function X0(i,t,e){return function(n,s,a,l,u){if(!n)return;if(!s&&!t)return n;const c=t?0:a[0]*s,p=t?0:a[1]*s,y=u?u[0]:0,_=u?u[1]:0;let E=i[0]+c/2+y,I=i[2]-c/2+y,S=i[1]+p/2+_,R=i[3]-p/2+_;E>I&&(E=(I+E)/2,I=E),S>R&&(S=(R+S)/2,R=S);let D=Ei(n[0],E,I),T=Ei(n[1],S,R);if(l&&e&&s){const v=30*s;D+=-v*Math.log(1+Math.max(0,E-n[0])/v)+v*Math.log(1+Math.max(0,n[0]-I)/v),T+=-v*Math.log(1+Math.max(0,S-n[1])/v)+v*Math.log(1+Math.max(0,n[1]-R)/v)}return[D,T]}}function gw(i){return i}function kf(i,t,e,n){const s=Ve(t)/e[0],a=Oi(t)/e[1];return n?Math.min(i,Math.max(s,a)):Math.min(i,Math.min(s,a))}function Ff(i,t,e){let n=Math.min(i,t);const s=50;return n*=Math.log(1+s*Math.max(0,i/t-1))/s+1,e&&(n=Math.max(n,e),n/=Math.log(1+s*Math.max(0,e/i-1))/s+1),Ei(n,e/2,t*2)}function mw(i,t,e,n){return t=t!==void 0?t:!0,function(s,a,l,u){if(s!==void 0){const c=i[0],p=i[i.length-1],y=e?kf(c,e,l,n):c;if(u)return t?Ff(s,y,p):Ei(s,p,y);const _=Math.min(y,s),E=Math.floor(Ch(i,_,a));return i[E]>y&&E<i.length-1?i[E+1]:i[E]}}}function pw(i,t,e,n,s,a){return n=n!==void 0?n:!0,e=e!==void 0?e:0,function(l,u,c,p){if(l!==void 0){const y=s?kf(t,s,c,a):t;if(p)return n?Ff(l,y,e):Ei(l,e,y);const _=1e-9,E=Math.ceil(Math.log(t/y)/Math.log(i)-_),I=-u*(.5-_)+.5,S=Math.min(y,l),R=Math.floor(Math.log(t/S)/Math.log(i)+I),D=Math.max(E,R),T=t/Math.pow(i,D);return Ei(T,e,y)}}}function j0(i,t,e,n,s){return e=e!==void 0?e:!0,function(a,l,u,c){if(a!==void 0){const p=n?kf(i,n,u,s):i;return!e||!c?Ei(a,t,p):Ff(a,p,t)}}}function Bf(i){if(i!==void 0)return 0}function H0(i){if(i!==void 0)return i}function yw(i){const t=2*Math.PI/i;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function xw(i){const t=i===void 0?Yl(5):i;return function(e,n){return n||e===void 0?e:Math.abs(e)<=t?0:e}}function z2(i){return Math.pow(i,3)}function La(i){return 1-z2(1-i)}function _w(i){return 3*i*i-2*i*i*i}function ww(i){return i}const Ru=0;class bw extends es{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=pf(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&d_(),t.center&&(t.center=Ts(t.center,this.projection_)),t.extent&&(t.extent=Ls(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const u in Zn)delete e[u];this.setProperties(e,!0);const n=Iw(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const s=Ew(t),a=n.constraint,l=Cw(t);this.constraints_={center:s,resolution:a,rotation:l},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const s=t||[0,0,0,0];e=e||[0,0,0,0];const a=this.getResolution(),l=a/2*(s[3]-e[3]+e[1]-s[1]),u=a/2*(s[0]-e[0]+e[2]-s[2]);this.setCenterInternal([n[0]+l,n[1]-u])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let n=0;n<e.length;++n){let s=arguments[n];s.center&&(s=Object.assign({},s),s.center=Ts(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=Ts(s.anchor,this.getProjection())),e[n]=s}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,n;e>1&&typeof arguments[e-1]=="function"&&(n=arguments[e-1],--e);let s=0;for(;s<e&&!this.isDef();++s){const y=arguments[s];y.center&&this.setCenterInternal(y.center),y.zoom!==void 0?this.setZoom(y.zoom):y.resolution&&this.setResolution(y.resolution),y.rotation!==void 0&&this.setRotation(y.rotation)}if(s===e){n&&vl(n,!0);return}let a=Date.now(),l=this.targetCenter_.slice(),u=this.targetResolution_,c=this.targetRotation_;const p=[];for(;s<e;++s){const y=arguments[s],_={start:a,complete:!1,anchor:y.anchor,duration:y.duration!==void 0?y.duration:1e3,easing:y.easing||_w,callback:n};if(y.center&&(_.sourceCenter=l,_.targetCenter=y.center.slice(),l=_.targetCenter),y.zoom!==void 0?(_.sourceResolution=u,_.targetResolution=this.getResolutionForZoom(y.zoom),u=_.targetResolution):y.resolution&&(_.sourceResolution=u,_.targetResolution=y.resolution,u=_.targetResolution),y.rotation!==void 0){_.sourceRotation=c;const E=xa(y.rotation-c+Math.PI,2*Math.PI)-Math.PI;_.targetRotation=c+E,c=_.targetRotation}Aw(_)?_.complete=!0:a+=_.duration,p.push(_)}this.animations_.push(p),this.setHint(Gi.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Gi.ANIMATING]>0}getInteracting(){return this.hints_[Gi.INTERACTING]>0}cancelAnimations(){this.setHint(Gi.ANIMATING,-this.hints_[Gi.ANIMATING]);let t;for(let e=0,n=this.animations_.length;e<n;++e){const s=this.animations_[e];if(s[0].callback&&vl(s[0].callback,!1),!t)for(let a=0,l=s.length;a<l;++a){const u=s[a];if(!u.complete){t=u.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const s=this.animations_[n];let a=!0;for(let l=0,u=s.length;l<u;++l){const c=s[l];if(c.complete)continue;const p=t-c.start;let y=c.duration>0?p/c.duration:1;y>=1?(c.complete=!0,y=1):a=!1;const _=c.easing(y);if(c.sourceCenter){const E=c.sourceCenter[0],I=c.sourceCenter[1],S=c.targetCenter[0],R=c.targetCenter[1];this.nextCenter_=c.targetCenter;const D=E+_*(S-E),T=I+_*(R-I);this.targetCenter_=[D,T]}if(c.sourceResolution&&c.targetResolution){const E=_===1?c.targetResolution:c.sourceResolution+_*(c.targetResolution-c.sourceResolution);if(c.anchor){const I=this.getViewportSize_(this.getRotation()),S=this.constraints_.resolution(E,0,I,!0);this.targetCenter_=this.calculateCenterZoom(S,c.anchor)}this.nextResolution_=c.targetResolution,this.targetResolution_=E,this.applyTargetState_(!0)}if(c.sourceRotation!==void 0&&c.targetRotation!==void 0){const E=_===1?xa(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+_*(c.targetRotation-c.sourceRotation);if(c.anchor){const I=this.constraints_.rotation(E,!0);this.targetCenter_=this.calculateCenterRotate(I,c.anchor)}this.nextRotation_=c.targetRotation,this.targetRotation_=E}if(this.applyTargetState_(!0),e=!0,!c.complete)break}if(a){this.animations_[n]=null,this.setHint(Gi.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const l=s[0].callback;l&&vl(l,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const s=this.getCenterInternal();return s!==void 0&&(n=[s[0]-e[0],s[1]-e[1]],gf(n,t-this.getRotation()),u_(n,e)),n}calculateCenterZoom(t,e){let n;const s=this.getCenterInternal(),a=this.getResolution();if(s!==void 0&&a!==void 0){const l=e[0]-t*(e[0]-s[0])/a,u=e[1]-t*(e[1]-s[1])/a;n=[l,u]}return n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],s=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(s*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(s*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Ec(t,this.getProjection())}getCenterInternal(){return this.get(Zn.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return yf(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();qe(e,"The view center is not defined");const n=this.getResolution();qe(n!==void 0,"The view resolution is not defined");const s=this.getRotation();return qe(s!==void 0,"The view rotation is not defined"),th(e,n,s,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Zn.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Ls(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=Ve(t)/e[0],s=Oi(t)/e[1];return Math.max(n,s)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(e/n)/Math.log(t);return function(a){return e/Math.pow(t,a*s)}}getRotation(){return this.get(Zn.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,a=Math.log(n/s)/e;return function(l){return Math.log(n/l)/e/a}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let s=this.getCenterInternal();const a=this.padding_;if(a){const l=this.getViewportSizeMinusPadding_();s=Su(s,this.getViewportSize_(),[l[0]/2+a[3],l[1]/2+a[0]],e,n)}return{center:s.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,n,s;if(this.resolutions_){const a=Ch(this.resolutions_,t,1);e=a,n=this.resolutions_[a],a==this.resolutions_.length-1?s=2:s=n/this.resolutions_[a+1]}else n=this.maxResolution_,s=this.zoomFactor_;return e+Math.log(n/t)/Math.log(s)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=Ei(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,Ei(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(qe(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){qe(!Na(t),"Cannot fit empty extent provided as `geometry`");const s=Ls(t,this.getProjection());n=N0(s)}else if(t.getType()==="Circle"){const s=Ls(t.getExtent(),this.getProjection());n=N0(s),n.rotate(this.getRotation(),ps(s))}else n=t;this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),s=Math.sin(-e),a=t.getFlatCoordinates(),l=t.getStride();let u=1/0,c=1/0,p=-1/0,y=-1/0;for(let _=0,E=a.length;_<E;_+=l){const I=a[_]*n-a[_+1]*s,S=a[_]*s+a[_+1]*n;u=Math.min(u,I),c=Math.min(c,S),p=Math.max(p,I),y=Math.max(y,S)}return[u,c,p,y]}fitInternal(t,e){e=e||{};let n=e.size;n||(n=this.getViewportSizeMinusPadding_());const s=e.padding!==void 0?e.padding:[0,0,0,0],a=e.nearest!==void 0?e.nearest:!1;let l;e.minResolution!==void 0?l=e.minResolution:e.maxZoom!==void 0?l=this.getResolutionForZoom(e.maxZoom):l=0;const u=this.rotatedExtentForGeometry(t);let c=this.getResolutionForExtentInternal(u,[n[0]-s[1]-s[3],n[1]-s[0]-s[2]]);c=isNaN(c)?l:Math.max(c,l),c=this.getConstrainedResolution(c,a?0:1);const p=this.getRotation(),y=Math.sin(p),_=Math.cos(p),E=ps(u);E[0]+=(s[1]-s[3])/2*c,E[1]+=(s[0]-s[2])/2*c;const I=E[0]*_-E[1]*y,S=E[1]*_+E[0]*y,R=this.getConstrainedCenter([I,S],c),D=e.callback?e.callback:Ea;e.duration!==void 0?this.animateInternal({resolution:c,center:R,duration:e.duration,easing:e.easing},D):(this.targetResolution_=c,this.targetCenter_=R,this.applyTargetState_(!1,!0),vl(D,!0))}centerOn(t,e,n){this.centerOnInternal(Ts(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(Su(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,s){let a;const l=this.padding_;if(l&&t){const u=this.getViewportSizeMinusPadding_(-n),c=Su(t,s,[u[0]/2+l[3],u[1]/2+l[0]],e,n);a=[t[0]-c[0],t[1]-c[1]]}return a}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Ec(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Ts(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),a=this.constraints_.resolution(this.targetResolution_*t,0,s,n);e&&(this.targetCenter_=this.calculateCenterZoom(a,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Ts(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(s,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Ts(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,s=this.constraints_.rotation(this.targetRotation_,n),a=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,0,a,n),u=this.constraints_.center(this.targetCenter_,l,a,n,this.calculateCenterShift(this.targetCenter_,l,s,a));this.get(Zn.ROTATION)!==s&&this.set(Zn.ROTATION,s),this.get(Zn.RESOLUTION)!==l&&(this.set(Zn.RESOLUTION,l),this.set("zoom",this.getZoom(),!0)),(!u||!this.get(Zn.CENTER)||!eh(this.get(Zn.CENTER),u))&&this.set(Zn.CENTER,u),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=t!==void 0?t:200;const s=e||0,a=this.constraints_.rotation(this.targetRotation_),l=this.getViewportSize_(a),u=this.constraints_.resolution(this.targetResolution_,s,l),c=this.constraints_.center(this.targetCenter_,u,l,!1,this.calculateCenterShift(this.targetCenter_,u,a,l));if(t===0&&!this.cancelAnchor_){this.targetResolution_=u,this.targetRotation_=a,this.targetCenter_=c,this.applyTargetState_();return}n=n||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==u||this.getRotation()!==a||!this.getCenterInternal()||!eh(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:a,center:c,resolution:u,duration:t,easing:La,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Gi.INTERACTING,1)}endInteraction(t,e,n){n=n&&Ts(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(Gi.INTERACTING,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}function vl(i,t){setTimeout(function(){i(t)},0)}function Ew(i){if(i.extent!==void 0){const e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return X0(i.extent,i.constrainOnlyCenter,e)}const t=pf(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,X0(e,!1,!1)}return gw}function Iw(i){let t,e,n,l=i.minZoom!==void 0?i.minZoom:Ru,u=i.maxZoom!==void 0?i.maxZoom:28;const c=i.zoomFactor!==void 0?i.zoomFactor:2,p=i.multiWorld!==void 0?i.multiWorld:!1,y=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,_=i.showFullExtent!==void 0?i.showFullExtent:!1,E=pf(i.projection,"EPSG:3857"),I=E.getExtent();let S=i.constrainOnlyCenter,R=i.extent;if(!p&&!R&&E.isGlobal()&&(S=!1,R=I),i.resolutions!==void 0){const D=i.resolutions;e=D[l],n=D[u]!==void 0?D[u]:D[D.length-1],i.constrainResolution?t=mw(D,y,!S&&R,_):t=j0(e,n,y,!S&&R,_)}else{const T=(I?Math.max(Ve(I),Oi(I)):360*fo.degrees/E.getMetersPerUnit())/Lf/Math.pow(2,Ru),v=T/Math.pow(2,28-Ru);e=i.maxResolution,e!==void 0?l=0:e=T/Math.pow(c,l),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=e/Math.pow(c,u):n=T/Math.pow(c,u):n=v),u=l+Math.floor(Math.log(e/n)/Math.log(c)),n=e/Math.pow(c,u-l),i.constrainResolution?t=pw(c,e,n,y,!S&&R,_):t=j0(e,n,y,!S&&R,_)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:l,zoomFactor:c}}function Cw(i){if(i.enableRotation!==void 0?i.enableRotation:!0){const e=i.constrainRotation;return e===void 0||e===!0?xw():e===!1?H0:typeof e=="number"?yw(e):H0}return Bf}function Aw(i){return!(i.sourceCenter&&i.targetCenter&&!eh(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function Su(i,t,e,n,s){const a=Math.cos(-s);let l=Math.sin(-s),u=i[0]*a-i[1]*l,c=i[1]*a+i[0]*l;u+=(t[0]/2-e[0])*n,c+=(e[1]-t[1]/2)*n,l=-l;const p=u*a-c*l,y=c*a+u*l;return[p,y]}const os=bw;class nl extends G2{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(ni.SOURCE,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(ni.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(oi(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=We(t,_e.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const n=this.getMapInternal();!t&&n&&(t=n.getView()),t instanceof os?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let s;e.layerStatesArray?s=e.layerStatesArray.find(l=>l.layer===this):s=this.getLayerState();const a=this.getExtent();return Vf(s,e.viewState)&&(!a||en(a,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];const s=t instanceof os?t.getViewStateAndExtent():t;let a=e(s);return Array.isArray(a)||(a=[a]),a}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(ni.MAP,t)}getMapInternal(){return this.get(ni.MAP)}setMap(t){this.mapPrecomposeKey_&&(oi(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(oi(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=We(t,Gn.PRECOMPOSE,function(e){const s=e.frameState.layerStatesArray,a=this.getLayerState(!1);qe(!s.some(function(l){return l.layer===a.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),s.push(a)},this),this.mapRenderKey_=We(this,_e.CHANGE,t.render,t),this.changed())}setSource(t){this.set(ni.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function Vf(i,t){if(!i.visible)return!1;const e=t.resolution;if(e<i.minResolution||e>=i.maxResolution)return!1;const n=t.zoom;return n>i.minZoom&&n<=i.maxZoom}function Rw(i,t,e,n,s){U2(i,t,e||0,n||i.length-1,s||Sw)}function U2(i,t,e,n,s){for(;n>e;){if(n-e>600){var a=n-e+1,l=t-e+1,u=Math.log(a),c=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1),y=Math.max(e,Math.floor(t-l*c/a+p)),_=Math.min(n,Math.floor(t+(a-l)*c/a+p));U2(i,t,y,_,s)}var E=i[t],I=e,S=n;for(qa(i,e,t),s(i[n],E)>0&&qa(i,e,n);I<S;){for(qa(i,I,S),I++,S--;s(i[I],E)<0;)I++;for(;s(i[S],E)>0;)S--}s(i[e],E)===0?qa(i,e,S):(S++,qa(i,S,n)),S<=t&&(e=S+1),t<=S&&(n=S-1)}}function qa(i,t,e){var n=i[t];i[t]=i[e],i[e]=n}function Sw(i,t){return i<t?-1:i>t?1:0}let Gf=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const n=[];if(!Pl(t,e))return n;const s=this.toBBox,a=[];for(;e;){for(let l=0;l<e.children.length;l++){const u=e.children[l],c=e.leaf?s(u):u;Pl(t,c)&&(e.leaf?n.push(u):Du(t,c)?this._all(u,n):a.push(u))}e=a.pop()}return n}collides(t){let e=this.data;if(!Pl(t,e))return!1;const n=[];for(;e;){for(let s=0;s<e.children.length;s++){const a=e.children[s],l=e.leaf?this.toBBox(a):a;if(Pl(t,l)){if(e.leaf||Du(t,l))return!0;n.push(a)}}e=n.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let n=0;n<t.length;n++)this.insert(t[n]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const n=this.data;this.data=e,e=n}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=fa([]),this}remove(t,e){if(!t)return this;let n=this.data;const s=this.toBBox(t),a=[],l=[];let u,c,p;for(;n||a.length;){if(n||(n=a.pop(),c=a[a.length-1],u=l.pop(),p=!0),n.leaf){const y=Tw(t,n.children,e);if(y!==-1)return n.children.splice(y,1),a.push(n),this._condense(a),this}!p&&!n.leaf&&Du(n,s)?(a.push(n),l.push(u),u=0,c=n,n=n.children[0]):c?(u++,n=c.children[u],p=!1):n=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)t.leaf?e.push(...t.children):n.push(...t.children),t=n.pop();return e}_build(t,e,n,s){const a=n-e+1;let l=this._maxEntries,u;if(a<=l)return u=fa(t.slice(e,n+1)),ia(u,this.toBBox),u;s||(s=Math.ceil(Math.log(a)/Math.log(l)),l=Math.ceil(a/Math.pow(l,s-1))),u=fa([]),u.leaf=!1,u.height=s;const c=Math.ceil(a/l),p=c*Math.ceil(Math.sqrt(l));Y0(t,e,n,p,this.compareMinX);for(let y=e;y<=n;y+=p){const _=Math.min(y+p-1,n);Y0(t,y,_,c,this.compareMinY);for(let E=y;E<=_;E+=c){const I=Math.min(E+c-1,_);u.children.push(this._build(t,E,I,s-1))}}return ia(u,this.toBBox),u}_chooseSubtree(t,e,n,s){for(;s.push(e),!(e.leaf||s.length-1===n);){let a=1/0,l=1/0,u;for(let c=0;c<e.children.length;c++){const p=e.children[c],y=Tu(p),_=vw(t,p)-y;_<l?(l=_,a=y<a?y:a,u=p):_===l&&y<a&&(a=y,u=p)}e=u||e.children[0]}return e}_insert(t,e,n){const s=n?t:this.toBBox(t),a=[],l=this._chooseSubtree(s,this.data,e,a);for(l.children.push(t),no(l,s);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(s,a,e)}_split(t,e){const n=t[e],s=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,s);const l=this._chooseSplitIndex(n,a,s),u=fa(n.children.splice(l,n.children.length-l));u.height=n.height,u.leaf=n.leaf,ia(n,this.toBBox),ia(u,this.toBBox),e?t[e-1].children.push(u):this._splitRoot(n,u)}_splitRoot(t,e){this.data=fa([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ia(this.data,this.toBBox)}_chooseSplitIndex(t,e,n){let s,a=1/0,l=1/0;for(let u=e;u<=n-e;u++){const c=io(t,0,u,this.toBBox),p=io(t,u,n,this.toBBox),y=Ow(c,p),_=Tu(c)+Tu(p);y<a?(a=y,s=u,l=_<l?_:l):y===a&&_<l&&(l=_,s=u)}return s||n-e}_chooseSplitAxis(t,e,n){const s=t.leaf?this.compareMinX:Dw,a=t.leaf?this.compareMinY:Mw,l=this._allDistMargin(t,e,n,s),u=this._allDistMargin(t,e,n,a);l<u&&t.children.sort(s)}_allDistMargin(t,e,n,s){t.children.sort(s);const a=this.toBBox,l=io(t,0,e,a),u=io(t,n-e,n,a);let c=Ol(l)+Ol(u);for(let p=e;p<n-e;p++){const y=t.children[p];no(l,t.leaf?a(y):y),c+=Ol(l)}for(let p=n-e-1;p>=e;p--){const y=t.children[p];no(u,t.leaf?a(y):y),c+=Ol(u)}return c}_adjustParentBBoxes(t,e,n){for(let s=n;s>=0;s--)no(e[s],t)}_condense(t){for(let e=t.length-1,n;e>=0;e--)t[e].children.length===0?e>0?(n=t[e-1].children,n.splice(n.indexOf(t[e]),1)):this.clear():ia(t[e],this.toBBox)}};function Tw(i,t,e){if(!e)return t.indexOf(i);for(let n=0;n<t.length;n++)if(e(i,t[n]))return n;return-1}function ia(i,t){io(i,0,i.children.length,t,i)}function io(i,t,e,n,s){s||(s=fa(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=t;a<e;a++){const l=i.children[a];no(s,i.leaf?n(l):l)}return s}function no(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function Dw(i,t){return i.minX-t.minX}function Mw(i,t){return i.minY-t.minY}function Tu(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Ol(i){return i.maxX-i.minX+(i.maxY-i.minY)}function vw(i,t){return(Math.max(t.maxX,i.maxX)-Math.min(t.minX,i.minX))*(Math.max(t.maxY,i.maxY)-Math.min(t.minY,i.minY))}function Ow(i,t){const e=Math.max(i.minX,t.minX),n=Math.max(i.minY,t.minY),s=Math.min(i.maxX,t.maxX),a=Math.min(i.maxY,t.maxY);return Math.max(0,s-e)*Math.max(0,a-n)}function Du(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function Pl(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function fa(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Y0(i,t,e,n,s){const a=[t,e];for(;a.length;){if(e=a.pop(),t=a.pop(),e-t<=n)continue;const l=t+Math.ceil((e-t)/n/2)*n;Rw(i,l,t,e,s),a.push(t,l,l,e)}}function Z0(i,t,e,n){return e!==void 0&&n!==void 0?[e/i,n/t]:e!==void 0?e/i:n!==void 0?n/t:1}class Gh extends Lh{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,n=t.rotation!==void 0?t.rotation:0,s=t.scale!==void 0?t.scale:1,a=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:n,scale:s,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:a,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const l=t.img!==void 0?t.img:null;let u=t.src;qe(!(u!==void 0&&l),"`image` and `src` cannot be provided at the same time"),(u===void 0||u.length===0)&&l&&(u=l.src||ti(l)),qe(u!==void 0&&u.length>0,"A defined and non-empty `src` or `image` must be provided"),qe(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let c;if(t.src!==void 0?c=se.IDLE:l!==void 0&&("complete"in l?l.complete?c=l.src?se.LOADED:se.IDLE:c=se.LOADING:c=se.LOADED),this.color_=t.color!==void 0?wo(t.color):null,this.iconImage_=Of(l,u,this.crossOrigin_,c,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,t.width!==void 0||t.height!==void 0){let p,y;if(t.size)[p,y]=t.size;else{const _=this.getImage(1);if(_.width&&_.height)p=_.width,y=_.height;else if(_ instanceof HTMLImageElement){this.initialOptions_=t;const E=()=>{if(this.unlistenImageChange(E),!this.initialOptions_)return;const I=this.iconImage_.getSize();this.setScale(Z0(I[0],I[1],t.width,t.height))};this.listenImageChange(E);return}}p!==void 0&&this.setScale(Z0(p,y,t.width,t.height))}}clone(){let t,e,n;return this.initialOptions_?(e=this.initialOptions_.width,n=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Gh({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:n,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=s[0]),this.anchorYUnits_=="fraction"&&(t[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+s[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]-e[0]/n[0],t[1]+e[1]/n[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=n[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==se.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==se.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(_e.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(_e.CHANGE,t)}ready(){return this.iconImage_.ready()}}let Yr=0;const ka=0,wi=1<<Yr++,ae=1<<Yr++,Sn=1<<Yr++,zi=1<<Yr++,ds=1<<Yr++,ho=1<<Yr++,Qi=Math.pow(2,Yr)-1,W2={[wi]:"boolean",[ae]:"number",[Sn]:"string",[zi]:"color",[ds]:"number[]",[ho]:"size"},Pw=Object.keys(W2).map(Number).sort(ks);function sn(i){const t=[];for(const e of Pw)Nw(i,e)&&t.push(W2[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function Nw(i,t){return(i&t)===t}function gs(i,t){return!!(i&t)}function zh(i,t){return i===t}class lr{constructor(t,e){this.type=t,this.value=e}}class Lw{constructor(t,e,...n){this.type=t,this.operator=e,this.args=n}}function X2(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,style:{}}}function kw(i){switch(i){case"string":return Sn;case"color":return zi;case"number":return ae;case"boolean":return wi;case"number[]":return ds;default:throw new Error(`Unrecognized type hint: ${i}`)}}function Qe(i,t,e){switch(typeof i){case"boolean":return new lr(wi,i);case"number":return new lr(e===ho?ho:ae,i);case"string":{let s=Sn;return U_(i)&&(s|=zi),zh(s&e,ka)||(s&=e),new lr(s,i)}}if(!Array.isArray(i))throw new Error("Expression must be an array or a primitive value");if(i.length===0)throw new Error("Empty expression");if(typeof i[0]=="string")return Zw(i,t,e);for(const s of i)if(typeof s!="number")throw new Error("Expected an array of numbers");let n=ds;return i.length===2?n|=ho:(i.length===3||i.length===4)&&(n|=zi),e&&(n&=e),new lr(n,i)}const Ot={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string"},Fw={[Ot.Get]:be(([i,t])=>t!==void 0?kw(t.value):Qi,Oe(1,2),Bw),[Ot.Var]:be(([i])=>i.type,Oe(1,1),Vw),[Ot.Id]:be(ae|Sn,$a,Gw),[Ot.Concat]:be(Sn,Oe(2,1/0),Ke(Qi)),[Ot.GeometryType]:be(Sn,$a,zw),[Ot.Resolution]:be(ae,$a),[Ot.Zoom]:be(ae,$a),[Ot.Time]:be(ae,$a),[Ot.Any]:be(wi,Oe(2,1/0),Ke(wi)),[Ot.All]:be(wi,Oe(2,1/0),Ke(wi)),[Ot.Not]:be(wi,Oe(1,1),Ke(wi)),[Ot.Equal]:be(wi,Oe(2,2),Ke(Qi),qs),[Ot.NotEqual]:be(wi,Oe(2,2),Ke(Qi),qs),[Ot.GreaterThan]:be(wi,Oe(2,2),Ke(Qi),qs),[Ot.GreaterThanOrEqualTo]:be(wi,Oe(2,2),Ke(Qi),qs),[Ot.LessThan]:be(wi,Oe(2,2),Ke(Qi),qs),[Ot.LessThanOrEqualTo]:be(wi,Oe(2,2),Ke(Qi),qs),[Ot.Multiply]:be(i=>{let t=ae|zi;for(let e=0;e<i.length;e++)t&=i[e].type;return t},Oe(2,1/0),Ke(ae|zi),qs),[Ot.Coalesce]:be(i=>{let t=Qi;for(let e=1;e<i.length;e+=2)t&=i[e].type;return t&=i[i.length-1].type,t},Oe(2,1/0),Ke(Qi),qs),[Ot.Divide]:be(ae,Oe(2,2),Ke(ae)),[Ot.Add]:be(ae,Oe(2,1/0),Ke(ae)),[Ot.Subtract]:be(ae,Oe(2,2),Ke(ae)),[Ot.Clamp]:be(ae,Oe(3,3),Ke(ae)),[Ot.Mod]:be(ae,Oe(2,2),Ke(ae)),[Ot.Pow]:be(ae,Oe(2,2),Ke(ae)),[Ot.Abs]:be(ae,Oe(1,1),Ke(ae)),[Ot.Floor]:be(ae,Oe(1,1),Ke(ae)),[Ot.Ceil]:be(ae,Oe(1,1),Ke(ae)),[Ot.Round]:be(ae,Oe(1,1),Ke(ae)),[Ot.Sin]:be(ae,Oe(1,1),Ke(ae)),[Ot.Cos]:be(ae,Oe(1,1),Ke(ae)),[Ot.Atan]:be(ae,Oe(1,2),Ke(ae)),[Ot.Sqrt]:be(ae,Oe(1,1),Ke(ae)),[Ot.Match]:be(i=>{let t=Qi;for(let e=2;e<i.length;e+=2)t&=i[e].type;return t&=i[i.length-1].type,t},Oe(4,1/0),K0,Ww),[Ot.Between]:be(wi,Oe(3,3),Ke(ae)),[Ot.Interpolate]:be(i=>{let t=zi|ae;for(let e=3;e<i.length;e+=2)t&=i[e].type;return t},Oe(6,1/0),K0,Xw),[Ot.Case]:be(i=>{let t=Qi;for(let e=1;e<i.length;e+=2)t&=i[e].type;return t&=i[i.length-1].type,t},Oe(3,1/0),Uw,jw),[Ot.In]:be(wi,Oe(2,2),Hw),[Ot.Number]:be(ae,Oe(1,1/0),Ke(Qi)),[Ot.String]:be(Sn,Oe(1,1/0),Ke(Qi)),[Ot.Array]:be(i=>i.length===2?ds|ho:i.length===3||i.length===4?ds|zi:ds,Oe(1,1/0),Ke(ae)),[Ot.Color]:be(zi,Oe(1,4),Ke(ae)),[Ot.Band]:be(ae,Oe(1,3),Ke(ae)),[Ot.Palette]:be(zi,Oe(2,2),Yw),[Ot.ToString]:be(Sn,Oe(1,1),Ke(wi|ae|Sn|zi))};function Bw(i,t){const e=Qe(i[1],t);if(!(e instanceof lr))throw new Error("Expected a literal argument for get operation");if(typeof e.value!="string")throw new Error("Expected a string argument for get operation");if(t.properties.add(e.value),i.length===3){const n=Qe(i[2],t);return[e,n]}return[e]}function Vw(i,t,e,n){const s=i[1];if(typeof s!="string")throw new Error("Expected a string argument for var operation");if(t.variables.add(s),!("variables"in t.style)||t.style.variables[s]===void 0)return[new lr(Qi,s)];const a=t.style.variables[s],l=Qe(a,t);if(l.value=s,n&&!gs(n,l.type))throw new Error(`The variable ${s} has type ${sn(l.type)} but the following type was expected: ${sn(n)}`);return[l]}function Gw(i,t){t.featureId=!0}function zw(i,t){t.geometryType=!0}function $a(i,t){const e=i[0];if(i.length!==1)throw new Error(`Expected no arguments for ${e} operation`);return[]}function Oe(i,t){return function(e,n){const s=e[0],a=e.length-1;if(i===t){if(a!==i){const l=i===1?"":"s";throw new Error(`Expected ${i} argument${l} for ${s}, got ${a}`)}}else if(a<i||a>t){const l=t===1/0?`${i} or more`:`${i} to ${t}`;throw new Error(`Expected ${l} arguments for ${s}, got ${a}`)}}}function Ke(i){return function(t,e){const n=t[0],s=t.length-1,a=new Array(s);for(let l=0;l<s;++l){const u=Qe(t[l+1],e);if(!gs(i,u.type)){const c=sn(i),p=sn(u.type);throw new Error(`Unexpected type for argument ${l} of ${n} operation, got ${c} but expected ${p}`)}u.type&=i,a[l]=u}return a}}function qs(i,t,e){const n=i[0],s=i.length-1;let a=Qi;for(let u=0;u<e.length;++u)a&=e[u].type;if(a===ka)throw new Error(`No common type could be found for arguments of ${n} operation`);const l=new Array(s);for(let u=0;u<s;++u)l[u]=Qe(i[u+1],t,a);return l}function Uw(i,t){const e=i[0],n=i.length-1;if(n%2===0)throw new Error(`An odd amount of arguments was expected for operation ${e}, got ${JSON.stringify(n)} instead`)}function K0(i,t){const e=i[0],n=i.length-1;if(n%2===1)throw new Error(`An even amount of arguments was expected for operation ${e}, got ${JSON.stringify(n)} instead`)}function Ww(i,t,e,n){const s=i.length-1;let l=Qe(i[1],t).type;const u=Qe(i[i.length-1],t);let c=n!==void 0?n&u.type:u.type;const p=new Array(s-2);for(let _=0;_<s-2;_+=2){const E=Qe(i[_+2],t),I=Qe(i[_+3],t);l&=E.type,c&=I.type,p[_]=E,p[_+1]=I}const y=Sn|ae|wi;if(!gs(y,l))throw new Error(`Expected an input of type ${sn(y)} for the interpolate operation, got ${sn(l)} instead`);if(l&=y,zh(c,ka))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(i));for(let _=0;_<s-2;_+=2){const E=Qe(i[_+2],t,l),I=Qe(i[_+3],t,c);p[_]=E,p[_+1]=I}return[Qe(i[1],t,l),...p,Qe(i[i.length-1],t,c)]}function Xw(i,t,e,n){const s=i[1];let a;switch(s[0]){case"linear":a=1;break;case"exponential":if(a=s[1],typeof a!="number")throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(a)} instead`);break;default:a=null}if(!a)throw new Error(`Invalid interpolation type: ${JSON.stringify(s)}`);a=Qe(a,t);let l=Qe(i[2],t);if(!gs(ae,l.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${sn(l.type)} instead`);l=Qe(i[2],t,ae);const u=new Array(i.length-3);for(let c=0;c<u.length;c+=2){let p=Qe(i[c+3],t);if(!gs(ae,p.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${sn(p.type)} at position ${c+2} instead`);let y=Qe(i[c+4],t);if(!gs(ae|zi,y.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${sn(y.type)} at position ${c+3} instead`);p=Qe(i[c+3],t,ae),y=Qe(i[c+4],t,ae|zi),u[c]=p,u[c+1]=y}return[a,l,...u]}function jw(i,t,e,n){const s=Qe(i[i.length-1],t,n);let a=n!==void 0?n&s.type:s.type;const l=new Array(i.length-1);for(let u=0;u<l.length-1;u+=2){const c=Qe(i[u+1],t),p=Qe(i[u+2],t,n);if(!gs(wi,c.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${sn(c.type)} at position ${u} instead`);a&=p.type,l[u]=c,l[u+1]=p}if(zh(a,ka))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(i));for(let u=0;u<l.length-1;u+=2)l[u+1]=Qe(i[u+2],t,a);return l[l.length-1]=Qe(i[i.length-1],t,a),l}function Hw(i,t){let e=i[2];if(!Array.isArray(e))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if(typeof e[0]=="string"){if(e[0]!=="literal")throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(e[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');e=e[1]}let n=Sn|ae;const s=new Array(e.length);for(let l=0;l<s.length;l++){const u=Qe(e[l],t);n&=u.type,s[l]=u}if(zh(n,ka))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(i));return[Qe(i[1],t,n),...s]}function Yw(i,t){const e=Qe(i[1],t,ae);if(e.type!==ae)throw new Error(`The first argument of palette must be an number, got ${sn(e.type)} instead`);const n=i[2];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");const s=new Array(n.length);for(let a=0;a<s.length;a++){const l=Qe(n[a],t,zi);if(!(l instanceof lr))throw new Error(`The palette color at index ${a} must be a literal value`);if(!gs(l.type,zi))throw new Error(`The palette color at index ${a} should be of type color, got ${sn(l.type)} instead`);s[a]=l}return[e,...s]}function be(i,...t){return function(e,n,s){const a=e[0];let l=[];for(let c=0;c<t.length;c++)l=t[c](e,n,l,s)||l;let u=typeof i=="function"?i(l):i;if(s!==void 0){if(!gs(u,s))throw new Error(`The following expression was expected to return ${sn(s)}, but returns ${sn(u)} instead: ${JSON.stringify(e)}`);u&=s}if(u===ka)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(e)}`);return new Lw(u,a,...l)}}function Zw(i,t,e){const n=i[0],s=Fw[n];if(!s)throw new Error(`Unknown operator: ${n}`);return s(i,t,e)}function j2(i){if(!i)return"";const t=i.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return j2(i.getGeometries()[0]);default:return""}}function H2(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function zs(i,t,e){const n=Qe(i,e);if(!gs(t,n.type)){const s=sn(t),a=sn(n.type);throw new Error(`Expected expression to be of type ${s}, got ${a}`)}return Qn(n)}function Qn(i,t){if(i instanceof lr){if(i.type===zi&&typeof i.value=="string"){const n=Tf(i.value);return function(){return n}}return function(){return i.value}}const e=i.operator;switch(e){case Ot.Number:case Ot.String:case Ot.Coalesce:return Kw(i);case Ot.Get:case Ot.Var:return qw(i);case Ot.Id:return n=>n.featureId;case Ot.GeometryType:return n=>n.geometryType;case Ot.Concat:{const n=i.args.map(s=>Qn(s));return s=>"".concat(...n.map(a=>a(s).toString()))}case Ot.Resolution:return n=>n.resolution;case Ot.Any:case Ot.All:case Ot.Between:case Ot.In:case Ot.Not:return Jw(i);case Ot.Equal:case Ot.NotEqual:case Ot.LessThan:case Ot.LessThanOrEqualTo:case Ot.GreaterThan:case Ot.GreaterThanOrEqualTo:return $w(i);case Ot.Multiply:case Ot.Divide:case Ot.Add:case Ot.Subtract:case Ot.Clamp:case Ot.Mod:case Ot.Pow:case Ot.Abs:case Ot.Floor:case Ot.Ceil:case Ot.Round:case Ot.Sin:case Ot.Cos:case Ot.Atan:case Ot.Sqrt:return Qw(i);case Ot.Case:return tb(i);case Ot.Match:return eb(i);case Ot.Interpolate:return ib(i);case Ot.ToString:return nb(i);default:throw new Error(`Unsupported operator ${e}`)}}function Kw(i,t){const e=i.operator,n=i.args.length,s=new Array(n);for(let a=0;a<n;++a)s[a]=Qn(i.args[a]);switch(e){case Ot.Coalesce:return a=>{for(let l=0;l<n;++l){const u=s[l](a);if(typeof u<"u"&&u!==null)return u}throw new Error("Expected one of the values to be non-null")};case Ot.Number:case Ot.String:return a=>{for(let l=0;l<n;++l){const u=s[l](a);if(typeof u===e)return u}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function qw(i,t){const n=i.args[0].value;switch(i.operator){case Ot.Get:return s=>s.properties[n];case Ot.Var:return s=>s.variables[n];default:throw new Error(`Unsupported accessor operator ${i.operator}`)}}function $w(i,t){const e=i.operator,n=Qn(i.args[0]),s=Qn(i.args[1]);switch(e){case Ot.Equal:return a=>n(a)===s(a);case Ot.NotEqual:return a=>n(a)!==s(a);case Ot.LessThan:return a=>n(a)<s(a);case Ot.LessThanOrEqualTo:return a=>n(a)<=s(a);case Ot.GreaterThan:return a=>n(a)>s(a);case Ot.GreaterThanOrEqualTo:return a=>n(a)>=s(a);default:throw new Error(`Unsupported comparison operator ${e}`)}}function Jw(i,t){const e=i.operator,n=i.args.length,s=new Array(n);for(let a=0;a<n;++a)s[a]=Qn(i.args[a]);switch(e){case Ot.Any:return a=>{for(let l=0;l<n;++l)if(s[l](a))return!0;return!1};case Ot.All:return a=>{for(let l=0;l<n;++l)if(!s[l](a))return!1;return!0};case Ot.Between:return a=>{const l=s[0](a),u=s[1](a),c=s[2](a);return l>=u&&l<=c};case Ot.In:return a=>{const l=s[0](a);for(let u=1;u<n;++u)if(l===s[u](a))return!0;return!1};case Ot.Not:return a=>!s[0](a);default:throw new Error(`Unsupported logical operator ${e}`)}}function Qw(i,t){const e=i.operator,n=i.args.length,s=new Array(n);for(let a=0;a<n;++a)s[a]=Qn(i.args[a]);switch(e){case Ot.Multiply:return a=>{let l=1;for(let u=0;u<n;++u)l*=s[u](a);return l};case Ot.Divide:return a=>s[0](a)/s[1](a);case Ot.Add:return a=>{let l=0;for(let u=0;u<n;++u)l+=s[u](a);return l};case Ot.Subtract:return a=>s[0](a)-s[1](a);case Ot.Clamp:return a=>{const l=s[0](a),u=s[1](a);if(l<u)return u;const c=s[2](a);return l>c?c:l};case Ot.Mod:return a=>s[0](a)%s[1](a);case Ot.Pow:return a=>Math.pow(s[0](a),s[1](a));case Ot.Abs:return a=>Math.abs(s[0](a));case Ot.Floor:return a=>Math.floor(s[0](a));case Ot.Ceil:return a=>Math.ceil(s[0](a));case Ot.Round:return a=>Math.round(s[0](a));case Ot.Sin:return a=>Math.sin(s[0](a));case Ot.Cos:return a=>Math.cos(s[0](a));case Ot.Atan:return n===2?a=>Math.atan2(s[0](a),s[1](a)):a=>Math.atan(s[0](a));case Ot.Sqrt:return a=>Math.sqrt(s[0](a));default:throw new Error(`Unsupported numeric operator ${e}`)}}function tb(i,t){const e=i.args.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=Qn(i.args[s]);return s=>{for(let a=0;a<e-1;a+=2)if(n[a](s))return n[a+1](s);return n[e-1](s)}}function eb(i,t){const e=i.args.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=Qn(i.args[s]);return s=>{const a=n[0](s);for(let l=1;l<e;l+=2)if(a===n[l](s))return n[l+1](s);return n[e-1](s)}}function ib(i,t){const e=i.args.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=Qn(i.args[s]);return s=>{const a=n[0](s),l=n[1](s);let u,c;for(let p=2;p<e;p+=2){const y=n[p](s);let _=n[p+1](s);const E=Array.isArray(_);if(E&&(_=G_(_)),y>=l)return p===2?_:E?sb(a,l,u,c,y,_):so(a,l,u,c,y,_);u=y,c=_}return c}}function nb(i,t){const e=i.operator,n=i.args.length,s=new Array(n);for(let a=0;a<n;++a)s[a]=Qn(i.args[a]);switch(e){case Ot.ToString:return a=>{const l=s[0](a);return i.args[0].type===zi?Df(l):l.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function so(i,t,e,n,s,a){const l=s-e;if(l===0)return n;const u=t-e,c=i===1?u/l:(Math.pow(i,u)-1)/(Math.pow(i,l)-1);return n+c*(a-n)}function sb(i,t,e,n,s,a){if(s-e===0)return n;const u=F0(n),c=F0(a);let p=c[2]-u[2];p>180?p-=360:p<-180&&(p+=360);const y=[so(i,t,e,u[0],s,c[0]),so(i,t,e,u[1],s,c[1]),u[2]+so(i,t,e,0,s,p),so(i,t,e,n[3],s,a[3])];return S2(z_(y))}function rb(i){return!0}function ab(i){const t=X2(),e=ob(i,t),n=H2();return function(s,a){if(n.properties=s.getPropertiesInternal(),n.resolution=a,t.featureId){const l=s.getId();l!==void 0?n.featureId=l:n.featureId=null}return t.geometryType&&(n.geometryType=j2(s.getGeometry())),e(n)}}function q0(i){const t=X2(),e=i.length,n=new Array(e);for(let l=0;l<e;++l)n[l]=Mc(i[l],t);const s=H2(),a=new Array(e);return function(l,u){if(s.properties=l.getPropertiesInternal(),s.resolution=u,t.featureId){const p=l.getId();p!==void 0?s.featureId=p:s.featureId=null}let c=0;for(let p=0;p<e;++p){const y=n[p](s);y&&(a[c]=y,c+=1)}return a.length=c,a}}function ob(i,t){const e=i.length,n=new Array(e);for(let s=0;s<e;++s){const a=i[s],l="filter"in a?zs(a.filter,wi,t):rb;let u;if(Array.isArray(a.style)){const c=a.style.length;u=new Array(c);for(let p=0;p<c;++p)u[p]=Mc(a.style[p],t)}else u=[Mc(a.style,t)];n[s]={filter:l,styles:u}}return function(s){const a=[];let l=!1;for(let u=0;u<e;++u){const c=n[u].filter;if(c(s)&&!(i[u].else&&l)){l=!0;for(const p of n[u].styles){const y=p(s);y&&a.push(y)}}}return a}}function Mc(i,t){const e=Ao(i,"",t),n=Ro(i,"",t),s=lb(i,t),a=hb(i,t),l=_n(i,"z-index",t);if(!e&&!n&&!s&&!a&&!Gr(i))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(i));const u=new Zl;return function(c){let p=!0;if(e){const y=e(c);y&&(p=!1),u.setFill(y)}if(n){const y=n(c);y&&(p=!1),u.setStroke(y)}if(s){const y=s(c);y&&(p=!1),u.setText(y)}if(a){const y=a(c);y&&(p=!1),u.setImage(y)}return l&&u.setZIndex(l(c)),p?null:u}}function Ao(i,t,e){let n;if(t+"fill-pattern-src"in i?n=db(i,t+"fill-",e):n=zf(i,t+"fill-color",e),!n)return null;const s=new il;return function(a){const l=n(a);return l==="none"?null:(s.setColor(l),s)}}function Ro(i,t,e){const n=_n(i,t+"stroke-width",e),s=zf(i,t+"stroke-color",e);if(!n&&!s)return null;const a=Os(i,t+"stroke-line-cap",e),l=Os(i,t+"stroke-line-join",e),u=Y2(i,t+"stroke-line-dash",e),c=_n(i,t+"stroke-line-dash-offset",e),p=_n(i,t+"stroke-miter-limit",e),y=new Nh;return function(_){if(s){const E=s(_);if(E==="none")return null;y.setColor(E)}if(n&&y.setWidth(n(_)),a){const E=a(_);if(E!=="butt"&&E!=="round"&&E!=="square")throw new Error("Expected butt, round, or square line cap");y.setLineCap(E)}if(l){const E=l(_);if(E!=="bevel"&&E!=="round"&&E!=="miter")throw new Error("Expected bevel, round, or miter line join");y.setLineJoin(E)}return u&&y.setLineDash(u(_)),c&&y.setLineDashOffset(c(_)),p&&y.setMiterLimit(p(_)),y}}function lb(i,t){const e="text-",n=Os(i,e+"value",t);if(!n)return null;const s=Ao(i,e,t),a=Ao(i,e+"background-",t),l=Ro(i,e,t),u=Ro(i,e+"background-",t),c=Os(i,e+"font",t),p=_n(i,e+"max-angle",t),y=_n(i,e+"offset-x",t),_=_n(i,e+"offset-y",t),E=So(i,e+"overflow",t),I=Os(i,e+"placement",t),S=_n(i,e+"repeat",t),R=Uh(i,e+"scale",t),D=So(i,e+"rotate-with-view",t),T=_n(i,e+"rotation",t),v=Os(i,e+"align",t),k=Os(i,e+"justify",t),X=Os(i,e+"baseline",t),H=Y2(i,e+"padding",t),K=Wh(i,e+"declutter-mode"),z=new Nf({declutterMode:K});return function(q){if(z.setText(n(q)),s&&z.setFill(s(q)),a&&z.setBackgroundFill(a(q)),l&&z.setStroke(l(q)),u&&z.setBackgroundStroke(u(q)),c&&z.setFont(c(q)),p&&z.setMaxAngle(p(q)),y&&z.setOffsetX(y(q)),_&&z.setOffsetY(_(q)),E&&z.setOverflow(E(q)),I){const V=I(q);if(V!=="point"&&V!=="line")throw new Error("Expected point or line for text-placement");z.setPlacement(V)}if(S&&z.setRepeat(S(q)),R&&z.setScale(R(q)),D&&z.setRotateWithView(D(q)),T&&z.setRotation(T(q)),v){const V=v(q);if(V!=="left"&&V!=="center"&&V!=="right"&&V!=="end"&&V!=="start")throw new Error("Expected left, right, center, start, or end for text-align");z.setTextAlign(V)}if(k){const V=k(q);if(V!=="left"&&V!=="right"&&V!=="center")throw new Error("Expected left, right, or center for text-justify");z.setJustify(V)}if(X){const V=X(q);if(V!=="bottom"&&V!=="top"&&V!=="middle"&&V!=="alphabetic"&&V!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");z.setTextBaseline(V)}return H&&z.setPadding(H(q)),z}}function hb(i,t){return"icon-src"in i?ub(i,t):"shape-points"in i?cb(i,t):"circle-radius"in i?fb(i,t):null}function ub(i,t){const e="icon-",n=e+"src",s=Z2(i[n],n),a=hh(i,e+"anchor",t),l=Uh(i,e+"scale",t),u=_n(i,e+"opacity",t),c=hh(i,e+"displacement",t),p=_n(i,e+"rotation",t),y=So(i,e+"rotate-with-view",t),_=J0(i,e+"anchor-origin"),E=Q0(i,e+"anchor-x-units"),I=Q0(i,e+"anchor-y-units"),S=yb(i,e+"color"),R=mb(i,e+"cross-origin"),D=pb(i,e+"offset"),T=J0(i,e+"offset-origin"),v=uh(i,e+"width"),k=uh(i,e+"height"),X=gb(i,e+"size"),H=Wh(i,e+"declutter-mode"),K=new Gh({src:s,anchorOrigin:_,anchorXUnits:E,anchorYUnits:I,color:S,crossOrigin:R,offset:D,offsetOrigin:T,height:k,width:v,size:X,declutterMode:H});return function(z){return u&&K.setOpacity(u(z)),c&&K.setDisplacement(c(z)),p&&K.setRotation(p(z)),y&&K.setRotateWithView(y(z)),l&&K.setScale(l(z)),a&&K.setAnchor(a(z)),K}}function cb(i,t){const e="shape-",n=e+"points",s=e+"radius",a=vc(i[n],n),l=vc(i[s],s),u=Ao(i,e,t),c=Ro(i,e,t),p=Uh(i,e+"scale",t),y=hh(i,e+"displacement",t),_=_n(i,e+"rotation",t),E=So(i,e+"rotate-with-view",t),I=uh(i,e+"radius2"),S=uh(i,e+"angle"),R=Wh(i,e+"declutter-mode"),D=new Fh({points:a,radius:l,radius2:I,angle:S,declutterMode:R});return function(T){return u&&D.setFill(u(T)),c&&D.setStroke(c(T)),y&&D.setDisplacement(y(T)),_&&D.setRotation(_(T)),E&&D.setRotateWithView(E(T)),p&&D.setScale(p(T)),D}}function fb(i,t){const e="circle-",n=Ao(i,e,t),s=Ro(i,e,t),a=_n(i,e+"radius",t),l=Uh(i,e+"scale",t),u=hh(i,e+"displacement",t),c=_n(i,e+"rotation",t),p=So(i,e+"rotate-with-view",t),y=Wh(i,e+"declutter-mode"),_=new Bh({radius:5,declutterMode:y});return function(E){return a&&_.setRadius(a(E)),n&&_.setFill(n(E)),s&&_.setStroke(s(E)),u&&_.setDisplacement(u(E)),c&&_.setRotation(c(E)),p&&_.setRotateWithView(p(E)),l&&_.setScale(l(E)),_}}function _n(i,t,e){if(!(t in i))return;const n=zs(i[t],ae,e);return function(s){return vc(n(s),t)}}function Os(i,t,e){if(!(t in i))return null;const n=zs(i[t],Sn,e);return function(s){return Z2(n(s),t)}}function db(i,t,e){const n=Os(i,t+"pattern-src",e),s=$0(i,t+"pattern-offset",e),a=$0(i,t+"pattern-size",e),l=zf(i,t+"color",e);return function(u){return{src:n(u),offset:s&&s(u),size:a&&a(u),color:l&&l(u)}}}function So(i,t,e){if(!(t in i))return null;const n=zs(i[t],wi,e);return function(s){const a=n(s);if(typeof a!="boolean")throw new Error(`Expected a boolean for ${t}`);return a}}function zf(i,t,e){if(!(t in i))return null;const n=zs(i[t],zi|Sn,e);return function(s){return K2(n(s),t)}}function Y2(i,t,e){if(!(t in i))return null;const n=zs(i[t],ds,e);return function(s){return sl(n(s),t)}}function hh(i,t,e){if(!(t in i))return null;const n=zs(i[t],ds,e);return function(s){const a=sl(n(s),t);if(a.length!==2)throw new Error(`Expected two numbers for ${t}`);return a}}function $0(i,t,e){if(!(t in i))return null;const n=zs(i[t],ds,e);return function(s){return q2(n(s),t)}}function Uh(i,t,e){if(!(t in i))return null;const n=zs(i[t],ds|ae,e);return function(s){return xb(n(s),t)}}function uh(i,t){const e=i[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function gb(i,t){const e=i[t];if(e!==void 0){if(typeof e=="number")return Tn(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function mb(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function J0(i,t){const e=i[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function Q0(i,t){const e=i[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function pb(i,t){const e=i[t];if(e!==void 0)return sl(e,t)}function Wh(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function yb(i,t){const e=i[t];if(e!==void 0)return K2(e,t)}function sl(i,t){if(!Array.isArray(i))throw new Error(`Expected an array for ${t}`);const e=i.length;for(let n=0;n<e;++n)if(typeof i[n]!="number")throw new Error(`Expected an array of numbers for ${t}`);return i}function Z2(i,t){if(typeof i!="string")throw new Error(`Expected a string for ${t}`);return i}function vc(i,t){if(typeof i!="number")throw new Error(`Expected a number for ${t}`);return i}function K2(i,t){if(typeof i=="string")return i;const e=sl(i,t),n=e.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function q2(i,t){const e=sl(i,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function xb(i,t){return typeof i=="number"?i:q2(i,t)}const t1={RENDER_ORDER:"renderOrder"};class $2 extends nl{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(t1.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const n=this.getDeclutter();n in t.declutter||(t.declutter[n]=new Gf(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(t1.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?V2:t;const e=_b(t);this.styleFunction_=t===null?void 0:cw(e),this.changed()}}function _b(i){if(i===void 0)return V2;if(!i)return null;if(typeof i=="function"||i instanceof Zl)return i;if(!Array.isArray(i))return q0([i]);if(i.length===0)return[];const t=i.length,e=i[0];if(e instanceof Zl){const s=new Array(t);for(let a=0;a<t;++a){const l=i[a];if(!(l instanceof Zl))throw new Error("Expected a list of style instances");s[a]=l}return s}if("style"in e){const s=new Array(t);for(let a=0;a<t;++a){const l=i[a];if(!("style"in l))throw new Error("Expected a list of rules with a style property");s[a]=l}return ab(s)}return q0(i)}const he={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Nl=[he.FILL],hr=[he.STROKE],Nr=[he.BEGIN_PATH],e1=[he.CLOSE_PATH];class J2{drawCustom(t,e,n,s,a){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,n){}drawFeature(t,e,n){}drawGeometryCollection(t,e,n){}drawLineString(t,e,n){}drawMultiLineString(t,e,n){}drawMultiPoint(t,e,n){}drawMultiPolygon(t,e,n){}drawPoint(t,e,n){}drawPolygon(t,e,n){}drawText(t,e,n){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}class rl extends J2{constructor(t,e,n,s){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(n){return n*e})}appendFlatPointCoordinates(t,e){const n=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,a=this.coordinates;let l=a.length;for(let u=0,c=t.length;u<c;u+=e)s[0]=t[u],s[1]=t[u+1],zr(n,s)&&(a[l++]=s[0],a[l++]=s[1]);return l}appendFlatLineCoordinates(t,e,n,s,a,l){const u=this.coordinates;let c=u.length;const p=this.getBufferedMaxExtent();l&&(e+=s);let y=t[e],_=t[e+1];const E=this.tmpCoordinate_;let I=!0,S,R,D;for(S=e+s;S<n;S+=s)E[0]=t[S],E[1]=t[S+1],D=pc(p,E),D!==R?(I&&(u[c++]=y,u[c++]=_,I=!1),u[c++]=E[0],u[c++]=E[1]):D===Bi.INTERSECTING?(u[c++]=E[0],u[c++]=E[1],I=!1):I=!0,y=E[0],_=E[1],R=D;return(a&&I||S===e+s)&&(u[c++]=y,u[c++]=_),c}drawCustomCoordinates_(t,e,n,s,a){for(let l=0,u=n.length;l<u;++l){const c=n[l],p=this.appendFlatLineCoordinates(t,e,c,s,!1,!1);a.push(p),e=c}return e}drawCustom(t,e,n,s,a){this.beginGeometry(t,e,a);const l=t.getType(),u=t.getStride(),c=this.coordinates.length;let p,y,_,E,I;switch(l){case"MultiPolygon":p=t.getOrientedFlatCoordinates(),E=[];const S=t.getEndss();I=0;for(let R=0,D=S.length;R<D;++R){const T=[];I=this.drawCustomCoordinates_(p,I,S[R],u,T),E.push(T)}this.instructions.push([he.CUSTOM,c,E,t,n,Ic,a]),this.hitDetectionInstructions.push([he.CUSTOM,c,E,t,s||n,Ic,a]);break;case"Polygon":case"MultiLineString":_=[],p=l=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),I=this.drawCustomCoordinates_(p,0,t.getEnds(),u,_),this.instructions.push([he.CUSTOM,c,_,t,n,mo,a]),this.hitDetectionInstructions.push([he.CUSTOM,c,_,t,s||n,mo,a]);break;case"LineString":case"Circle":p=t.getFlatCoordinates(),y=this.appendFlatLineCoordinates(p,0,p.length,u,!1,!1),this.instructions.push([he.CUSTOM,c,y,t,n,or,a]),this.hitDetectionInstructions.push([he.CUSTOM,c,y,t,s||n,or,a]);break;case"MultiPoint":p=t.getFlatCoordinates(),y=this.appendFlatPointCoordinates(p,u),y>c&&(this.instructions.push([he.CUSTOM,c,y,t,n,or,a]),this.hitDetectionInstructions.push([he.CUSTOM,c,y,t,s||n,or,a]));break;case"Point":p=t.getFlatCoordinates(),this.coordinates.push(p[0],p[1]),y=this.coordinates.length,this.instructions.push([he.CUSTOM,c,y,t,n,void 0,a]),this.hitDetectionInstructions.push([he.CUSTOM,c,y,t,s||n,void 0,a]);break}this.endGeometry(e)}beginGeometry(t,e,n){this.beginGeometryInstruction1_=[he.BEGIN_GEOMETRY,e,0,t,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[he.BEGIN_GEOMETRY,e,0,t,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const n=t.length;let s,a,l=-1;for(e=0;e<n;++e)s=t[e],a=s[0],a==he.END_GEOMETRY?l=e:a==he.BEGIN_GEOMETRY&&(s[2]=e,zx(this.hitDetectionInstructions,l,e),l=-1)}setFillStrokeStyle(t,e){const n=this.state;if(t){const s=t.getColor();n.fillPatternScale=s&&typeof s=="object"&&"src"in s?this.pixelRatio:1,n.fillStyle=fs(s||xn)}else n.fillStyle=void 0;if(e){const s=e.getColor();n.strokeStyle=fs(s||Eo);const a=e.getLineCap();n.lineCap=a!==void 0?a:Aa;const l=e.getLineDash();n.lineDash=l?l.slice():Fs;const u=e.getLineDashOffset();n.lineDashOffset=u||Bs;const c=e.getLineJoin();n.lineJoin=c!==void 0?c:Ra;const p=e.getWidth();n.lineWidth=p!==void 0?p:Co;const y=e.getMiterLimit();n.miterLimit=y!==void 0?y:bo,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}createFill(t){const e=t.fillStyle,n=[he.SET_FILL_STYLE,e];return typeof e!="string"&&n.push(t.fillPatternScale),n}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[he.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const n=t.fillStyle;(typeof n!="string"||t.currentFillStyle!=n)&&(n!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}updateStrokeStyle(t,e){const n=t.strokeStyle,s=t.lineCap,a=t.lineDash,l=t.lineDashOffset,u=t.lineJoin,c=t.lineWidth,p=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=s||a!=t.currentLineDash&&!yr(t.currentLineDash,a)||t.currentLineDashOffset!=l||t.currentLineJoin!=u||t.currentLineWidth!=c||t.currentMiterLimit!=p)&&(n!==void 0&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=s,t.currentLineDash=a,t.currentLineDashOffset=l,t.currentLineJoin=u,t.currentLineWidth=c,t.currentMiterLimit=p)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[he.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=e2(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;hf(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class wb extends rl{constructor(t,e,n,s){super(t,e,n,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,n){if(!this.image_||this.maxExtent&&!zr(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,n);const s=t.getFlatCoordinates(),a=t.getStride(),l=this.coordinates.length,u=this.appendFlatPointCoordinates(s,a);this.instructions.push([he.DRAW_IMAGE,l,u,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([he.DRAW_IMAGE,l,u,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,n){if(!this.image_)return;this.beginGeometry(t,e,n);const s=t.getFlatCoordinates(),a=[];for(let c=0,p=s.length;c<p;c+=t.getStride())(!this.maxExtent||zr(this.maxExtent,s.slice(c,c+2)))&&a.push(s[c],s[c+1]);const l=this.coordinates.length,u=this.appendFlatPointCoordinates(a,2);this.instructions.push([he.DRAW_IMAGE,l,u,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([he.DRAW_IMAGE,l,u,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const n=t.getAnchor(),s=t.getSize(),a=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=a[0],this.originY_=a[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const bb=wb;class Eb extends rl{constructor(t,e,n,s){super(t,e,n,s)}drawFlatCoordinates_(t,e,n,s){const a=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,n,s,!1,!1),u=[he.MOVE_TO_LINE_TO,a,l];return this.instructions.push(u),this.hitDetectionInstructions.push(u),n}drawLineString(t,e,n){const s=this.state,a=s.strokeStyle,l=s.lineWidth;if(a===void 0||l===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Fs,Bs],Nr);const u=t.getFlatCoordinates(),c=t.getStride();this.drawFlatCoordinates_(u,0,u.length,c),this.hitDetectionInstructions.push(hr),this.endGeometry(e)}drawMultiLineString(t,e,n){const s=this.state,a=s.strokeStyle,l=s.lineWidth;if(a===void 0||l===void 0)return;this.updateStrokeStyle(s,this.applyStroke),this.beginGeometry(t,e,n),this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Fs,Bs],Nr);const u=t.getEnds(),c=t.getFlatCoordinates(),p=t.getStride();let y=0;for(let _=0,E=u.length;_<E;++_)y=this.drawFlatCoordinates_(c,y,u[_],p);this.hitDetectionInstructions.push(hr),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(hr),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(hr),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Nr)}}const Ib=Eb;class Cb extends rl{constructor(t,e,n,s){super(t,e,n,s)}drawFlatCoordinatess_(t,e,n,s){const a=this.state,l=a.fillStyle!==void 0,u=a.strokeStyle!==void 0,c=n.length;this.instructions.push(Nr),this.hitDetectionInstructions.push(Nr);for(let p=0;p<c;++p){const y=n[p],_=this.coordinates.length,E=this.appendFlatLineCoordinates(t,e,y,s,!0,!u),I=[he.MOVE_TO_LINE_TO,_,E];this.instructions.push(I),this.hitDetectionInstructions.push(I),u&&(this.instructions.push(e1),this.hitDetectionInstructions.push(e1)),e=y}return l&&(this.instructions.push(Nl),this.hitDetectionInstructions.push(Nl)),u&&(this.instructions.push(hr),this.hitDetectionInstructions.push(hr)),e}drawCircle(t,e,n){const s=this.state,a=s.fillStyle,l=s.strokeStyle;if(a===void 0&&l===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_FILL_STYLE,xn]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Fs,Bs]);const u=t.getFlatCoordinates(),c=t.getStride(),p=this.coordinates.length;this.appendFlatLineCoordinates(u,0,u.length,c,!1,!1);const y=[he.CIRCLE,p];this.instructions.push(Nr,y),this.hitDetectionInstructions.push(Nr,y),s.fillStyle!==void 0&&(this.instructions.push(Nl),this.hitDetectionInstructions.push(Nl)),s.strokeStyle!==void 0&&(this.instructions.push(hr),this.hitDetectionInstructions.push(hr)),this.endGeometry(e)}drawPolygon(t,e,n){const s=this.state,a=s.fillStyle,l=s.strokeStyle;if(a===void 0&&l===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_FILL_STYLE,xn]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Fs,Bs]);const u=t.getEnds(),c=t.getOrientedFlatCoordinates(),p=t.getStride();this.drawFlatCoordinatess_(c,0,u,p),this.endGeometry(e)}drawMultiPolygon(t,e,n){const s=this.state,a=s.fillStyle,l=s.strokeStyle;if(a===void 0&&l===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,n),s.fillStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_FILL_STYLE,xn]),s.strokeStyle!==void 0&&this.hitDetectionInstructions.push([he.SET_STROKE_STYLE,s.strokeStyle,s.lineWidth,s.lineCap,s.lineJoin,s.miterLimit,Fs,Bs]);const u=t.getEndss(),c=t.getOrientedFlatCoordinates(),p=t.getStride();let y=0;for(let _=0,E=u.length;_<E;++_)y=this.drawFlatCoordinatess_(c,y,u[_],p);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let n=0,s=e.length;n<s;++n)e[n]=vr(e[n],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}const i1=Cb;function Ab(i,t,e,n,s){const a=[];let l=e,u=0,c=t.slice(e,2);for(;u<i&&l+s<n;){const[p,y]=c.slice(-2),_=t[l+s],E=t[l+s+1],I=Math.sqrt((_-p)*(_-p)+(E-y)*(E-y));if(u+=I,u>=i){const S=(i-u+I)/I,R=Rn(p,_,S),D=Rn(y,E,S);c.push(R,D),a.push(c),c=[R,D],u==i&&(l+=s),u=0}else if(u<i)c.push(t[l+s],t[l+s+1]),l+=s;else{const S=I-u,R=Rn(p,_,S/I),D=Rn(y,E,S/I);c.push(R,D),a.push(c),c=[R,D],u=0,l+=s}}return u>0&&a.push(c),a}function Rb(i,t,e,n,s){let a=e,l=e,u=0,c=0,p=e,y,_,E,I,S,R,D,T,v,k;for(_=e;_<n;_+=s){const X=t[_],H=t[_+1];S!==void 0&&(v=X-S,k=H-R,I=Math.sqrt(v*v+k*k),D!==void 0&&(c+=E,y=Math.acos((D*v+T*k)/(E*I)),y>i&&(c>u&&(u=c,a=p,l=_),c=0,p=_-s)),E=I,D=v,T=k),S=X,R=H}return c+=I,c>u?[p,_]:[a,l]}const ch={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Sb extends rl{constructor(t,e,n,s){super(t,e,n,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[xn]={fillStyle:xn},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,n){const s=this.textFillState_,a=this.textStrokeState_,l=this.textState_;if(this.text_===""||!l||!s&&!a)return;const u=this.coordinates;let c=u.length;const p=t.getType();let y=null,_=t.getStride();if(l.placement==="line"&&(p=="LineString"||p=="MultiLineString"||p=="Polygon"||p=="MultiPolygon")){if(!en(this.maxExtent,t.getExtent()))return;let E;if(y=t.getFlatCoordinates(),p=="LineString")E=[y.length];else if(p=="MultiLineString")E=t.getEnds();else if(p=="Polygon")E=t.getEnds().slice(0,1);else if(p=="MultiPolygon"){const D=t.getEndss();E=[];for(let T=0,v=D.length;T<v;++T)E.push(D[T][0])}this.beginGeometry(t,e,n);const I=l.repeat,S=I?void 0:l.textAlign;let R=0;for(let D=0,T=E.length;D<T;++D){let v;I?v=Ab(I*this.resolution,y,R,E[D],_):v=[y.slice(R,E[D])];for(let k=0,X=v.length;k<X;++k){const H=v[k];let K=0,z=H.length;if(S==null){const V=Rb(l.maxAngle,H,0,H.length,2);K=V[0],z=V[1]}for(let V=K;V<z;V+=_)u.push(H[V],H[V+1]);const q=u.length;R=E[D],this.drawChars_(c,q),c=q}}this.endGeometry(e)}else{let E=l.overflow?null:[];switch(p){case"Point":case"MultiPoint":y=t.getFlatCoordinates();break;case"LineString":y=t.getFlatMidpoint();break;case"Circle":y=t.getCenter();break;case"MultiLineString":y=t.getFlatMidpoints(),_=2;break;case"Polygon":y=t.getFlatInteriorPoint(),l.overflow||E.push(y[2]/this.resolution),_=3;break;case"MultiPolygon":const v=t.getFlatInteriorPoints();y=[];for(let k=0,X=v.length;k<X;k+=3)l.overflow||E.push(v[k+2]/this.resolution),y.push(v[k],v[k+1]);if(y.length===0)return;_=2;break}const I=this.appendFlatPointCoordinates(y,_);if(I===c)return;if(E&&(I-c)/2!==y.length/_){let v=c/2;E=E.filter((k,X)=>{const H=u[(v+X)*2]===y[X*_]&&u[(v+X)*2+1]===y[X*_+1];return H||--v,H})}this.saveTextStates_(),(l.backgroundFill||l.backgroundStroke)&&(this.setFillStrokeStyle(l.backgroundFill,l.backgroundStroke),l.backgroundFill&&this.updateFillStyle(this.state,this.createFill),l.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,n);let S=l.padding;if(S!=Pr&&(l.scale[0]<0||l.scale[1]<0)){let v=l.padding[0],k=l.padding[1],X=l.padding[2],H=l.padding[3];l.scale[0]<0&&(k=-k,H=-H),l.scale[1]<0&&(v=-v,X=-X),S=[v,k,X,H]}const R=this.pixelRatio;this.instructions.push([he.DRAW_IMAGE,c,I,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,S==Pr?Pr:S.map(function(v){return v*R}),!!l.backgroundFill,!!l.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,E]);const D=1/R,T=this.state.fillStyle;l.backgroundFill&&(this.state.fillStyle=xn,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([he.DRAW_IMAGE,c,I,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[D,D],NaN,this.declutterMode_,this.declutterImageWithText_,S,!!l.backgroundFill,!!l.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?xn:this.fillKey_,this.textOffsetX_,this.textOffsetY_,E]),l.backgroundFill&&(this.state.fillStyle=T,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,s=this.strokeKey_;t&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const a=this.textKey_;a in this.textStates||(this.textStates[a]={font:e.font,textAlign:e.textAlign||Io,justify:e.justify,textBaseline:e.textBaseline||oh,scale:e.scale});const l=this.fillKey_;n&&(l in this.fillStates||(this.fillStates[l]={fillStyle:n.fillStyle}))}drawChars_(t,e){const n=this.textStrokeState_,s=this.textState_,a=this.strokeKey_,l=this.textKey_,u=this.fillKey_;this.saveTextStates_();const c=this.pixelRatio,p=ch[s.textBaseline],y=this.textOffsetY_*c,_=this.text_,E=n?n.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([he.DRAW_CHARS,t,e,p,s.overflow,u,s.maxAngle,c,y,a,E*c,_,l,1,this.declutterMode_]),this.hitDetectionInstructions.push([he.DRAW_CHARS,t,e,p,s.overflow,u&&xn,s.maxAngle,c,y,a,E*c,_,l,1/c,this.declutterMode_])}setTextStyle(t,e){let n,s,a;if(!t)this.text_="";else{const l=t.getFill();l?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=fs(l.getColor()||xn)):(s=null,this.textFillState_=s);const u=t.getStroke();if(!u)a=null,this.textStrokeState_=a;else{a=this.textStrokeState_,a||(a={},this.textStrokeState_=a);const S=u.getLineDash(),R=u.getLineDashOffset(),D=u.getWidth(),T=u.getMiterLimit();a.lineCap=u.getLineCap()||Aa,a.lineDash=S?S.slice():Fs,a.lineDashOffset=R===void 0?Bs:R,a.lineJoin=u.getLineJoin()||Ra,a.lineWidth=D===void 0?Co:D,a.miterLimit=T===void 0?bo:T,a.strokeStyle=fs(u.getColor()||Eo)}n=this.textState_;const c=t.getFont()||F2;aw(c);const p=t.getScaleArray();n.overflow=t.getOverflow(),n.font=c,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||oh,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||Pr,n.scale=p===void 0?[1,1]:p;const y=t.getOffsetX(),_=t.getOffsetY(),E=t.getRotateWithView(),I=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=y===void 0?0:y,this.textOffsetY_=_===void 0?0:_,this.textRotateWithView_=E===void 0?!1:E,this.textRotation_=I===void 0?0:I,this.strokeKey_=a?(typeof a.strokeStyle=="string"?a.strokeStyle:ti(a.strokeStyle))+a.lineCap+a.lineDashOffset+"|"+a.lineWidth+a.lineJoin+a.miterLimit+"["+a.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=s&&s.fillStyle?typeof s.fillStyle=="string"?s.fillStyle:"|"+ti(s.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const Tb={Circle:i1,Default:rl,Image:bb,LineString:Ib,Polygon:i1,Text:Sb};class Db{constructor(t,e,n,s){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=s,this.resolution_=n,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const n=this.buildersByZIndex_[e];for(const s in n){const a=n[s].finish();t[e][s]=a}}return t}getBuilder(t,e){const n=t!==void 0?t.toString():"0";let s=this.buildersByZIndex_[n];s===void 0&&(s={},this.buildersByZIndex_[n]=s);let a=s[e];if(a===void 0){const l=Tb[e];a=new l(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[e]=a}return a}}class Mb extends Jo{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t}getFeatures(t){return xe()}getData(t){return null}prepareFrame(t){return xe()}renderFrame(t,e){return xe()}loadedTileCallback(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}createLoadedTileFinder(t,e,n){return(s,a)=>{const l=this.loadedTileCallback.bind(this,n,s);return t.forEachLoadedTile(e,s,a,l)}}forEachFeatureAtCoordinate(t,e,n,s,a){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===se.LOADED||e.getState()===se.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=se.LOADED&&e!=se.ERROR&&t.addEventListener(_e.CHANGE,this.boundHandleImageChange_),e==se.IDLE&&(t.load(),e=t.getState()),e==se.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}class Q2 extends ys{constructor(t,e,n,s){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=s}}class ty{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(nh(),{get:(t,e)=>{if(typeof nh()[e]=="function")return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e),this.pushMethodArgs_},set:(t,e,n)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e,n),!0)})}pushMethodArgs_=(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this);pushFunction(t){this.instructions_[this.zIndex+this.offset_].push(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let n=0,s=e.length;n<s;++n){const a=e[n];if(typeof a=="function"){a(t);continue}const l=e[++n];if(typeof t[a]=="function")t[a](...l);else{if(typeof l=="function"){t[a]=l(t);continue}t[a]=l}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const n1=[];let da=null;function vb(){da=Hi(1,1,void 0,{willReadFrequently:!0})}class Uf extends Mb{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=Jn(),this.pixelTransform=Jn(),this.inversePixelTransform=Jn(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,n){da||vb(),da.clearRect(0,0,1,1);let s;try{da.drawImage(t,e,n,1,1,0,0,1,1),s=da.getImageData(0,0,1,1).data}catch{return da=null,null}return s}getBackground(t){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(t.viewState.resolution)),n||void 0}useContainer(t,e,n){const s=this.getLayer().getClassName();let a,l;if(t&&t.className===s&&(!n||t&&t.style.backgroundColor&&yr(wo(t.style.backgroundColor),wo(n)))){const u=t.firstElementChild;u instanceof HTMLCanvasElement&&(l=u.getContext("2d"))}if(l&&l.canvas.style.transform===e?(this.container=t,this.context=l,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){a=document.createElement("div"),a.className=s;let u=a.style;u.position="absolute",u.width="100%",u.height="100%",l=Hi();const c=l.canvas;a.appendChild(c),u=c.style,u.position="absolute",u.left="0",u.transformOrigin="top left",this.container=a,this.context=l}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const s=Xr(n),a=Th(n),l=Sh(n),u=Rh(n);Vi(e.coordinateToPixelTransform,s),Vi(e.coordinateToPixelTransform,a),Vi(e.coordinateToPixelTransform,l),Vi(e.coordinateToPixelTransform,u);const c=this.inversePixelTransform;Vi(c,s),Vi(c,a),Vi(c,l),Vi(c,u),t.save(),t.beginPath(),t.moveTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(l[0]),Math.round(l[1])),t.lineTo(Math.round(u[0]),Math.round(u[1])),t.clip()}prepareContainer(t,e){const n=t.extent,s=t.viewState.resolution,a=t.viewState.rotation,l=t.pixelRatio,u=Math.round(Ve(n)/s*l),c=Math.round(Oi(n)/s*l);ms(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/l,1/l,a,-u/2,-c/2),t2(this.inversePixelTransform,this.pixelTransform);const p=Zx(this.pixelTransform);if(this.useContainer(e,p,this.getBackground(t)),!this.containerReused){const y=this.context.canvas;y.width!=u||y.height!=c?(y.width=u,y.height=c):this.context.clearRect(0,0,u,c),p!==y.style.transform&&(y.style.transform=p)}}dispatchRenderEvent_(t,e,n){const s=this.getLayer();if(s.hasListener(t)){const a=new Q2(t,this.inversePixelTransform,n,e);s.dispatchEvent(a)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(Gn.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Gn.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new ty),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Gn.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Gn.POSTRENDER,this.context,t))}getRenderTransform(t,e,n,s,a,l,u){const c=a/2,p=l/2,y=s/e,_=-y,E=-t[0]+u,I=-t[1];return ms(this.tempTransform,c,p,y,_,-n,E,I)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function Ob(i,t,e,n,s,a,l,u,c,p,y,_){let E=i[t],I=i[t+1],S=0,R=0,D=0,T=0;function v(){S=E,R=I,t+=n,E=i[t],I=i[t+1],T+=D,D=Math.sqrt((E-S)*(E-S)+(I-R)*(I-R))}do v();while(t<e-n&&T+D<a);let k=D===0?0:(a-T)/D;const X=Rn(S,E,k),H=Rn(R,I,k),K=t-n,z=T,q=a+u*c(p,s,y);for(;t<e-n&&T+D<q;)v();k=D===0?0:(q-T)/D;const V=Rn(S,E,k),nt=Rn(R,I,k);let ot;if(_){const ft=[X,H,V,nt];g2(ft,0,4,2,_,ft,ft),ot=ft[0]>ft[2]}else ot=X>V;const j=Math.PI,tt=[],N=K+n===t;t=K,D=0,T=z,E=i[t],I=i[t+1];let Z;if(N){v(),Z=Math.atan2(I-R,E-S),ot&&(Z+=Z>0?-j:j);const ft=(V+X)/2,rt=(nt+H)/2;return tt[0]=[ft,rt,(q-a)/2,Z,s],tt}s=s.replace(/\n/g," ");for(let ft=0,rt=s.length;ft<rt;){v();let At=Math.atan2(I-R,E-S);if(ot&&(At+=At>0?-j:j),Z!==void 0){let mt=At-Z;if(mt+=mt>j?-2*j:mt<-j?2*j:0,Math.abs(mt)>l)return null}Z=At;const bt=ft;let Dt=0;for(;ft<rt;++ft){const mt=ot?rt-ft-1:ft,Lt=u*c(p,s[mt],y);if(t+n<e&&T+D<a+Dt+Lt/2)break;Dt+=Lt}if(ft===bt)continue;const ct=ot?s.substring(rt-bt,rt-ft):s.substring(bt,ft);k=D===0?0:(a+Dt/2-T)/D;const at=Rn(S,E,k),Pt=Rn(R,I,k);tt.push([at,Pt,Dt/2,At,ct]),a+=Dt}return tt}const na=zn(),$s=[],As=[],Rs=[],Js=[];function s1(i){return i[3].declutterBox}const r1=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function Mu(i,t){return t==="start"?t=r1.test(i)?"right":"left":t==="end"&&(t=r1.test(i)?"left":"right"),ch[t]}function Pb(i,t,e){return e>0&&i.push(`
`,""),i.push(t,""),i}class Nb{constructor(t,e,n,s,a){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=Jn(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=a?new ty:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,n,s){const a=t+e+n+s;if(this.labels_[a])return this.labels_[a];const l=s?this.strokeStates[s]:null,u=n?this.fillStates[n]:null,c=this.textStates[e],p=this.pixelRatio,y=[c.scale[0]*p,c.scale[1]*p],_=Array.isArray(t),E=c.justify?ch[c.justify]:Mu(Array.isArray(t)?t[0]:t,c.textAlign||Io),I=s&&l.lineWidth?l.lineWidth:0,S=_?t:t.split(`
`).reduce(Pb,[]),{width:R,height:D,widths:T,heights:v,lineWidths:k}=lw(c,S),X=R+I,H=[],K=(X+2)*y[0],z=(D+I)*y[1],q={width:K<0?Math.floor(K):Math.ceil(K),height:z<0?Math.floor(z):Math.ceil(z),contextInstructions:H};(y[0]!=1||y[1]!=1)&&H.push("scale",y),s&&(H.push("strokeStyle",l.strokeStyle),H.push("lineWidth",I),H.push("lineCap",l.lineCap),H.push("lineJoin",l.lineJoin),H.push("miterLimit",l.miterLimit),H.push("setLineDash",[l.lineDash]),H.push("lineDashOffset",l.lineDashOffset)),n&&H.push("fillStyle",u.fillStyle),H.push("textBaseline","middle"),H.push("textAlign","center");const V=.5-E;let nt=E*X+V*I;const ot=[],j=[];let tt=0,N=0,Z=0,ft=0,rt;for(let At=0,bt=S.length;At<bt;At+=2){const Dt=S[At];if(Dt===`
`){N+=tt,tt=0,nt=E*X+V*I,++ft;continue}const ct=S[At+1]||c.font;ct!==rt&&(s&&ot.push("font",ct),n&&j.push("font",ct),rt=ct),tt=Math.max(tt,v[Z]);const at=[Dt,nt+V*T[Z]+E*(T[Z]-k[ft]),.5*(I+tt)+N];nt+=T[Z],s&&ot.push("strokeText",at),n&&j.push("fillText",at),++Z}return Array.prototype.push.apply(H,ot),Array.prototype.push.apply(H,j),this.labels_[a]=q,q}replayTextBackground_(t,e,n,s,a,l,u){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,s),t.lineTo.apply(t,a),t.lineTo.apply(t,e),l&&(this.alignAndScaleFill_=l[2],this.fill_(t)),u&&(this.setStrokeStyle_(t,u),t.stroke())}calculateImageOrLabelDimensions_(t,e,n,s,a,l,u,c,p,y,_,E,I,S,R,D){u*=E[0],c*=E[1];let T=n-u,v=s-c;const k=a+p>t?t-p:a,X=l+y>e?e-y:l,H=S[3]+k*E[0]+S[1],K=S[0]+X*E[1]+S[2],z=T-S[3],q=v-S[0];(R||_!==0)&&($s[0]=z,Js[0]=z,$s[1]=q,As[1]=q,As[0]=z+H,Rs[0]=As[0],Rs[1]=q+K,Js[1]=Rs[1]);let V;return _!==0?(V=ms(Jn(),n,s,1,1,_,-n,-s),Vi(V,$s),Vi(V,As),Vi(V,Rs),Vi(V,Js),gr(Math.min($s[0],As[0],Rs[0],Js[0]),Math.min($s[1],As[1],Rs[1],Js[1]),Math.max($s[0],As[0],Rs[0],Js[0]),Math.max($s[1],As[1],Rs[1],Js[1]),na)):gr(Math.min(z,z+H),Math.min(q,q+K),Math.max(z,z+H),Math.max(q,q+K),na),I&&(T=Math.round(T),v=Math.round(v)),{drawImageX:T,drawImageY:v,drawImageW:k,drawImageH:X,originX:p,originY:y,declutterBox:{minX:na[0],minY:na[1],maxX:na[2],maxY:na[3],value:D},canvasTransform:V,scale:E}}replayImageOrLabel_(t,e,n,s,a,l,u){const c=!!(l||u),p=s.declutterBox,y=u?u[2]*s.scale[0]/2:0;return p.minX-y<=e[0]&&p.maxX+y>=0&&p.minY-y<=e[1]&&p.maxY+y>=0&&(c&&this.replayTextBackground_(t,$s,As,Rs,Js,l,u),hw(t,s.canvasTransform,a,n,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const n=Vi(this.renderedTransform_,[0,0]),s=512*this.pixelRatio;t.save(),t.translate(n[0]%s,n[1]%s),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,n,s){const a=this.textStates[e],l=this.createLabel(t,e,s,n),u=this.strokeStates[n],c=this.pixelRatio,p=Mu(Array.isArray(t)?t[0]:t,a.textAlign||Io),y=ch[a.textBaseline||oh],_=u&&u.lineWidth?u.lineWidth:0,E=l.width/c-2*a.scale[0],I=p*E+2*(.5-p)*_,S=y*l.height/c+2*(.5-y)*_;return{label:l,anchorX:I,anchorY:S}}execute_(t,e,n,s,a,l,u,c){const p=this.zIndexContext_;let y;this.pixelCoordinates_&&yr(n,this.renderedTransform_)?y=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),y=fr(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),Hx(this.renderedTransform_,n));let _=0;const E=s.length;let I=0,S,R,D,T,v,k,X,H,K,z,q,V,nt,ot=0,j=0,tt=null,N=null;const Z=this.coordinateCache_,ft=this.viewRotation_,rt=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,At={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:ft},bt=this.instructions!=s||this.overlaps?0:200;let Dt,ct,at,Pt;for(;_<E;){const mt=s[_];switch(mt[0]){case he.BEGIN_GEOMETRY:Dt=mt[1],Pt=mt[3],Dt.getGeometry()?u!==void 0&&!en(u,Pt.getExtent())?_=mt[2]+1:++_:_=mt[2],p&&(p.zIndex=mt[4]);break;case he.BEGIN_PATH:ot>bt&&(this.fill_(t),ot=0),j>bt&&(t.stroke(),j=0),!ot&&!j&&(t.beginPath(),v=NaN,k=NaN),++_;break;case he.CIRCLE:I=mt[1];const Vt=y[I],Ee=y[I+1],te=y[I+2],me=y[I+3],Ie=te-Vt,Ce=me-Ee,Ge=Math.sqrt(Ie*Ie+Ce*Ce);t.moveTo(Vt+Ge,Ee),t.arc(Vt,Ee,Ge,0,2*Math.PI,!0),++_;break;case he.CLOSE_PATH:t.closePath(),++_;break;case he.CUSTOM:I=mt[1],S=mt[2];const de=mt[3],F=mt[4],St=mt[5];At.geometry=de,At.feature=Dt,_ in Z||(Z[_]=[]);const Et=Z[_];St?St(y,I,S,2,Et):(Et[0]=y[I],Et[1]=y[I+1],Et.length=2),p&&(p.zIndex=mt[6]),F(Et,At),++_;break;case he.DRAW_IMAGE:I=mt[1],S=mt[2],K=mt[3],R=mt[4],D=mt[5];let et=mt[6];const $=mt[7],lt=mt[8],vt=mt[9],gt=mt[10];let pt=mt[11];const kt=mt[12];let Ht=mt[13];T=mt[14]||"declutter";const Ft=mt[15];if(!K&&mt.length>=20){z=mt[19],q=mt[20],V=mt[21],nt=mt[22];const Xe=this.drawLabelWithPointPlacement_(z,q,V,nt);K=Xe.label,mt[3]=K;const Ue=mt[23];R=(Xe.anchorX-Ue)*this.pixelRatio,mt[4]=R;const ge=mt[24];D=(Xe.anchorY-ge)*this.pixelRatio,mt[5]=D,et=K.height,mt[6]=et,Ht=K.width,mt[13]=Ht}let qt;mt.length>25&&(qt=mt[25]);let ve,re,pe;mt.length>17?(ve=mt[16],re=mt[17],pe=mt[18]):(ve=Pr,re=!1,pe=!1),gt&&rt?pt+=ft:!gt&&!rt&&(pt-=ft);let Mn=0;for(;I<S;I+=2){if(qt&&qt[Mn++]<Ht/this.pixelRatio)continue;const Xe=this.calculateImageOrLabelDimensions_(K.width,K.height,y[I],y[I+1],Ht,et,R,D,lt,vt,pt,kt,a,ve,re||pe,Dt),Ue=[t,e,K,Xe,$,re?tt:null,pe?N:null];if(c){let ge,Ci,we;if(Ft){const ei=S-I;if(!Ft[ei]){Ft[ei]={args:Ue,declutterMode:T};continue}const je=Ft[ei];ge=je.args,Ci=je.declutterMode,delete Ft[ei],we=s1(ge)}let hi,Pi;if(ge&&(Ci!=="declutter"||!c.collides(we))&&(hi=!0),(T!=="declutter"||!c.collides(Xe.declutterBox))&&(Pi=!0),Ci==="declutter"&&T==="declutter"){const ei=hi&&Pi;hi=ei,Pi=ei}hi&&(Ci!=="none"&&c.insert(we),this.replayImageOrLabel_.apply(this,ge)),Pi&&(T!=="none"&&c.insert(Xe.declutterBox),this.replayImageOrLabel_.apply(this,Ue))}else this.replayImageOrLabel_.apply(this,Ue)}++_;break;case he.DRAW_CHARS:const Mi=mt[1],rn=mt[2],le=mt[3],jt=mt[4];nt=mt[5];const He=mt[6],ye=mt[7],ze=mt[8];V=mt[9];const bn=mt[10];z=mt[11],q=mt[12];const vn=[mt[13],mt[13]];T=mt[14]||"declutter";const un=this.textStates[q],Tt=un.font,Ii=[un.scale[0]*ye,un.scale[1]*ye];let an;Tt in this.widths_?an=this.widths_[Tt]:(an={},this.widths_[Tt]=an);const Er=L2(y,Mi,rn,2),Ut=Math.abs(Ii[0])*U0(Tt,z,an);if(jt||Ut<=Er){const Xe=this.textStates[q].textAlign,Ue=(Er-Ut)*Mu(z,Xe),ge=Ob(y,Mi,rn,2,z,Ue,He,Math.abs(Ii[0]),U0,Tt,an,rt?0:this.viewRotation_);t:if(ge){const Ci=[];let we,hi,Pi,ei,je;if(V)for(we=0,hi=ge.length;we<hi;++we){je=ge[we],Pi=je[4],ei=this.createLabel(Pi,q,"",V),R=je[2]+(Ii[0]<0?-bn:bn),D=le*ei.height+(.5-le)*2*bn*Ii[1]/Ii[0]-ze;const gi=this.calculateImageOrLabelDimensions_(ei.width,ei.height,je[0],je[1],ei.width,ei.height,R,D,0,0,je[3],vn,!1,Pr,!1,Dt);if(c&&T==="declutter"&&c.collides(gi.declutterBox))break t;Ci.push([t,e,ei,gi,1,null,null])}if(nt)for(we=0,hi=ge.length;we<hi;++we){je=ge[we],Pi=je[4],ei=this.createLabel(Pi,q,nt,""),R=je[2],D=le*ei.height-ze;const gi=this.calculateImageOrLabelDimensions_(ei.width,ei.height,je[0],je[1],ei.width,ei.height,R,D,0,0,je[3],vn,!1,Pr,!1,Dt);if(c&&T==="declutter"&&c.collides(gi.declutterBox))break t;Ci.push([t,e,ei,gi,1,null,null])}c&&T!=="none"&&c.load(Ci.map(s1));for(let gi=0,Yi=Ci.length;gi<Yi;++gi)this.replayImageOrLabel_.apply(this,Ci[gi])}}++_;break;case he.END_GEOMETRY:if(l!==void 0){Dt=mt[1];const Xe=l(Dt,Pt,T);if(Xe)return Xe}++_;break;case he.FILL:bt?ot++:this.fill_(t),++_;break;case he.MOVE_TO_LINE_TO:for(I=mt[1],S=mt[2],ct=y[I],at=y[I+1],t.moveTo(ct,at),v=ct+.5|0,k=at+.5|0,I+=2;I<S;I+=2)ct=y[I],at=y[I+1],X=ct+.5|0,H=at+.5|0,(I==S-2||X!==v||H!==k)&&(t.lineTo(ct,at),v=X,k=H);++_;break;case he.SET_FILL_STYLE:tt=mt,this.alignAndScaleFill_=mt[2],ot&&(this.fill_(t),ot=0,j&&(t.stroke(),j=0)),t.fillStyle=mt[1],++_;break;case he.SET_STROKE_STYLE:N=mt,j&&(t.stroke(),j=0),this.setStrokeStyle_(t,mt),++_;break;case he.STROKE:bt?j++:t.stroke(),++_;break;default:++_;break}}ot&&this.fill_(t),j&&t.stroke()}execute(t,e,n,s,a,l){this.viewRotation_=s,this.execute_(t,e,n,this.instructions,a,void 0,void 0,l)}executeHitDetection(t,e,n,s,a){return this.viewRotation_=n,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,s,a)}}const pa=["Polygon","Circle","LineString","Image","Text","Default"],ey=["Image","Text"],Lb=pa.filter(i=>!ey.includes(i));class kb{constructor(t,e,n,s,a,l,u){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=l,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Jn(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(a,u)}clip(t,e){const n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}createExecutors_(t,e){for(const n in t){let s=this.executorsByZIndex_[n];s===void 0&&(s={},this.executorsByZIndex_[n]=s);const a=t[n];for(const l in a){const u=a[l];s[l]=new Nb(this.resolution_,this.pixelRatio_,this.overlaps_,u,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const n=this.executorsByZIndex_[e];for(let s=0,a=t.length;s<a;++s)if(t[s]in n)return!0}return!1}forEachFeatureAtCoordinate(t,e,n,s,a,l){s=Math.round(s);const u=s*2+1,c=ms(this.hitDetectionTransform_,s+.5,s+.5,1/e,-1/e,-n,-t[0],-t[1]),p=!this.hitDetectionContext_;p&&(this.hitDetectionContext_=Hi(u,u,void 0,{willReadFrequently:!0}));const y=this.hitDetectionContext_;y.canvas.width!==u||y.canvas.height!==u?(y.canvas.width=u,y.canvas.height=u):p||y.clearRect(0,0,u,u);let _;this.renderBuffer_!==void 0&&(_=zn(),lo(_,t),hf(_,e*(this.renderBuffer_+s),_));const E=Fb(s);let I;function S(H,K,z){const q=y.getImageData(0,0,u,u).data;for(let V=0,nt=E.length;V<nt;V++)if(q[E[V]]>0){if(!l||z==="none"||I!=="Image"&&I!=="Text"||l.includes(H)){const ot=(E[V]-3)/4,j=s-ot%u,tt=s-(ot/u|0),N=a(H,K,j*j+tt*tt);if(N)return N}y.clearRect(0,0,u,u);break}}const R=Object.keys(this.executorsByZIndex_).map(Number);R.sort(ks);let D,T,v,k,X;for(D=R.length-1;D>=0;--D){const H=R[D].toString();for(v=this.executorsByZIndex_[H],T=pa.length-1;T>=0;--T)if(I=pa[T],k=v[I],k!==void 0&&(X=k.executeHitDetection(y,c,n,S,_),X))return X}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const n=e[0],s=e[1],a=e[2],l=e[3],u=[n,s,n,l,a,l,a,s];return fr(u,0,8,2,t,u),u}isEmpty(){return Gr(this.executorsByZIndex_)}execute(t,e,n,s,a,l,u){const c=Object.keys(this.executorsByZIndex_).map(Number);c.sort(ks),l=l||pa;const p=pa.length;let y,_,E,I,S;for(u&&c.reverse(),y=0,_=c.length;y<_;++y){const R=c[y].toString();for(S=this.executorsByZIndex_[R],E=0,I=l.length;E<I;++E){const D=l[E],T=S[D];if(T!==void 0){const v=u===null?void 0:T.getZIndexContext(),k=v?v.getContext():t,X=this.maxExtent_&&D!=="Image"&&D!=="Text";if(X&&(k.save(),this.clip(k,n)),!v||D==="Text"||D==="Image"?T.execute(k,e,n,s,a,u):v.pushFunction(H=>T.execute(H,e,n,s,a,u)),X&&k.restore(),v){v.offset();const H=c[y]*p+E;this.deferredZIndexContexts_[H]||(this.deferredZIndexContexts_[H]=[]),this.deferredZIndexContexts_[H].push(v)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(ks);for(let n=0,s=e.length;n<s;++n)t[e[n]].forEach(a=>{a.draw(this.renderedContext_),a.clear()}),t[e[n]].length=0}}const vu={};function Fb(i){if(vu[i]!==void 0)return vu[i];const t=i*2+1,e=i*i,n=new Array(e+1);for(let a=0;a<=i;++a)for(let l=0;l<=i;++l){const u=a*a+l*l;if(u>e)break;let c=n[u];c||(c=[],n[u]=c),c.push(((i+a)*t+(i+l))*4+3),a>0&&c.push(((i-a)*t+(i+l))*4+3),l>0&&(c.push(((i+a)*t+(i-l))*4+3),a>0&&c.push(((i-a)*t+(i-l))*4+3))}const s=[];for(let a=0,l=n.length;a<l;++a)n[a]&&s.push(...n[a]);return vu[i]=s,s}class Bb extends J2{constructor(t,e,n,s,a,l,u){super(),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=s,this.transformRotation_=s?df(Math.atan2(s[1],s[0]),10):0,this.viewRotation_=a,this.squaredTolerance_=l,this.userTransform_=u,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Jn()}drawImages_(t,e,n,s){if(!this.image_)return;const a=fr(t,e,n,s,this.transform_,this.pixelCoordinates_),l=this.context_,u=this.tmpLocalTransform_,c=l.globalAlpha;this.imageOpacity_!=1&&(l.globalAlpha=c*this.imageOpacity_);let p=this.imageRotation_;this.transformRotation_===0&&(p-=this.viewRotation_),this.imageRotateWithView_&&(p+=this.viewRotation_);for(let y=0,_=a.length;y<_;y+=2){const E=a[y]-this.imageAnchorX_,I=a[y+1]-this.imageAnchorY_;if(p!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const S=E+this.imageAnchorX_,R=I+this.imageAnchorY_;ms(u,S,R,1,1,p,-S,-R),l.save(),l.transform.apply(l,u),l.translate(S,R),l.scale(this.imageScale_[0],this.imageScale_[1]),l.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),l.restore()}else l.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,E,I,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(l.globalAlpha=c)}drawText_(t,e,n,s){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const a=fr(t,e,n,s,this.transform_,this.pixelCoordinates_),l=this.context_;let u=this.textRotation_;for(this.transformRotation_===0&&(u-=this.viewRotation_),this.textRotateWithView_&&(u+=this.viewRotation_);e<n;e+=s){const c=a[e]+this.textOffsetX_,p=a[e+1]+this.textOffsetY_;u!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(l.save(),l.translate(c-this.textOffsetX_,p-this.textOffsetY_),l.rotate(u),l.translate(this.textOffsetX_,this.textOffsetY_),l.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&l.strokeText(this.text_,0,0),this.textFillState_&&l.fillText(this.text_,0,0),l.restore()):(this.textStrokeState_&&l.strokeText(this.text_,c,p),this.textFillState_&&l.fillText(this.text_,c,p))}}moveToLineTo_(t,e,n,s,a){const l=this.context_,u=fr(t,e,n,s,this.transform_,this.pixelCoordinates_);l.moveTo(u[0],u[1]);let c=u.length;a&&(c-=2);for(let p=2;p<c;p+=2)l.lineTo(u[p],u[p+1]);return a&&l.closePath(),n}drawRings_(t,e,n,s){for(let a=0,l=n.length;a<l;++a)e=this.moveToLineTo_(t,e,n[a],s,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!en(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=I_(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],s=e[3]-e[1],a=Math.sqrt(n*n+s*s),l=this.context_;l.beginPath(),l.arc(e[0],e[1],a,0,2*Math.PI),this.fillState_&&l.fill(),this.strokeState_&&l.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let n=0,s=e.length;n<s;++n)this.drawGeometry(e[n])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!en(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(en(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,s=t.getFlatCoordinates();let a=0;const l=t.getEnds(),u=t.getStride();n.beginPath();for(let c=0,p=l.length;c<p;++c)a=this.moveToLineTo_(s,a,l[c],u,!1);n.stroke()}if(this.text_!==""){const n=t.getFlatMidpoints();this.drawText_(n,0,n.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!en(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!en(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getOrientedFlatCoordinates();let s=0;const a=t.getEndss(),l=t.getStride();e.beginPath();for(let u=0,c=a.length;u<c;++u){const p=a[u];s=this.drawRings_(n,s,p,l)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),yr(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,n=this.contextTextState_,s=t.textAlign?t.textAlign:Io;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=s&&(n.textAlign=s,e.textAlign=s),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=s,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const n=t.getColor();this.fillState_={fillStyle:fs(n||xn)}}if(!e)this.strokeState_=null;else{const n=e.getColor(),s=e.getLineCap(),a=e.getLineDash(),l=e.getLineDashOffset(),u=e.getLineJoin(),c=e.getWidth(),p=e.getMiterLimit(),y=a||Fs;this.strokeState_={lineCap:s!==void 0?s:Aa,lineDash:this.pixelRatio_===1?y:y.map(_=>_*this.pixelRatio_),lineDashOffset:(l||Bs)*this.pixelRatio_,lineJoin:u!==void 0?u:Ra,lineWidth:(c!==void 0?c:Co)*this.pixelRatio_,miterLimit:p!==void 0?p:bo,strokeStyle:fs(n||Eo)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const n=t.getPixelRatio(this.pixelRatio_),s=t.getAnchor(),a=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=s[0]*n,this.imageAnchorY_=s[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const l=t.getScaleArray();this.imageScale_=[l[0]*this.pixelRatio_/n,l[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const I=e.getColor();this.textFillState_={fillStyle:fs(I||xn)}}const n=t.getStroke();if(!n)this.textStrokeState_=null;else{const I=n.getColor(),S=n.getLineCap(),R=n.getLineDash(),D=n.getLineDashOffset(),T=n.getLineJoin(),v=n.getWidth(),k=n.getMiterLimit();this.textStrokeState_={lineCap:S!==void 0?S:Aa,lineDash:R||Fs,lineDashOffset:D||Bs,lineJoin:T!==void 0?T:Ra,lineWidth:v!==void 0?v:Co,miterLimit:k!==void 0?k:bo,strokeStyle:fs(I||Eo)}}const s=t.getFont(),a=t.getOffsetX(),l=t.getOffsetY(),u=t.getRotateWithView(),c=t.getRotation(),p=t.getScaleArray(),y=t.getText(),_=t.getTextAlign(),E=t.getTextBaseline();this.textState_={font:s!==void 0?s:F2,textAlign:_!==void 0?_:Io,textBaseline:E!==void 0?E:oh},this.text_=y!==void 0?Array.isArray(y)?y.reduce((I,S,R)=>I+=R%2?" ":S,""):y:"",this.textOffsetX_=a!==void 0?this.pixelRatio_*a:0,this.textOffsetY_=l!==void 0?this.pixelRatio_*l:0,this.textRotateWithView_=u!==void 0?u:!1,this.textRotation_=c!==void 0?c:0,this.textScale_=[this.pixelRatio_*p[0],this.pixelRatio_*p[1]]}}}const Vb=Bb,ls=.5;function Gb(i,t,e,n,s,a,l,u,c){const p=c?yf(s):s,y=i[0]*ls,_=i[1]*ls,E=Hi(y,_);E.imageSmoothingEnabled=!1;const I=E.canvas,S=new Vb(E,ls,s,null,l,u,c?Dh(__(),c):null),R=e.length,D=Math.floor((256*256*256-1)/R),T={};for(let k=1;k<=R;++k){const X=e[k-1],H=X.getStyleFunction()||n;if(!H)continue;let K=H(X,a);if(!K)continue;Array.isArray(K)||(K=[K]);const q=(k*D).toString(16).padStart(7,"#00000");for(let V=0,nt=K.length;V<nt;++V){const ot=K[V],j=ot.getGeometryFunction()(X);if(!j||!en(p,j.getExtent()))continue;const tt=ot.clone(),N=tt.getFill();N&&N.setColor(q);const Z=tt.getStroke();Z&&(Z.setColor(q),Z.setLineDash(null)),tt.setText(void 0);const ft=ot.getImage();if(ft){const Dt=ft.getImageSize();if(!Dt)continue;const ct=Hi(Dt[0],Dt[1],void 0,{alpha:!1}),at=ct.canvas;ct.fillStyle=q,ct.fillRect(0,0,at.width,at.height),tt.setImage(new Gh({img:at,anchor:ft.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ft.getOrigin(),opacity:1,size:ft.getSize(),scale:ft.getScale(),rotation:ft.getRotation(),rotateWithView:ft.getRotateWithView()}))}const rt=tt.getZIndex()||0;let At=T[rt];At||(At={},T[rt]=At,At.Polygon=[],At.Circle=[],At.LineString=[],At.Point=[]);const bt=j.getType();if(bt==="GeometryCollection"){const Dt=j.getGeometriesArrayRecursive();for(let ct=0,at=Dt.length;ct<at;++ct){const Pt=Dt[ct];At[Pt.getType().replace("Multi","")].push(Pt,tt)}}else At[bt.replace("Multi","")].push(j,tt)}}const v=Object.keys(T).map(Number).sort(ks);for(let k=0,X=v.length;k<X;++k){const H=T[v[k]];for(const K in H){const z=H[K];for(let q=0,V=z.length;q<V;q+=2){S.setStyle(z[q+1]);for(let nt=0,ot=t.length;nt<ot;++nt)S.setTransform(t[nt]),S.drawGeometry(z[q])}}}return E.getImageData(0,0,I.width,I.height)}function zb(i,t,e){const n=[];if(e){const s=Math.floor(Math.round(i[0])*ls),a=Math.floor(Math.round(i[1])*ls),l=(Ei(s,0,e.width-1)+Ei(a,0,e.height-1)*e.width)*4,u=e.data[l],c=e.data[l+1],y=e.data[l+2]+256*(c+256*u),_=Math.floor((256*256*256-1)/t.length);y&&y%_===0&&n.push(t[y/_-1])}return n}const Ub=.5,iy={Point:qb,LineString:Yb,Polygon:Jb,MultiPoint:$b,MultiLineString:Zb,MultiPolygon:Kb,GeometryCollection:Hb,Circle:Xb};function Wb(i,t){return parseInt(ti(i),10)-parseInt(ti(t),10)}function a1(i,t){const e=ny(i,t);return e*e}function ny(i,t){return Ub*i/t}function Xb(i,t,e,n,s){const a=e.getFill(),l=e.getStroke();if(a||l){const c=i.getBuilder(e.getZIndex(),"Circle");c.setFillStrokeStyle(a,l),c.drawCircle(t,n,s)}const u=e.getText();if(u&&u.getText()){const c=i.getBuilder(e.getZIndex(),"Text");c.setTextStyle(u),c.drawText(t,n)}}function o1(i,t,e,n,s,a,l,u){const c=[],p=e.getImage();if(p){let E=!0;const I=p.getImageState();I==se.LOADED||I==se.ERROR?E=!1:I==se.IDLE&&p.load(),E&&c.push(p.ready())}const y=e.getFill();y&&y.loading()&&c.push(y.ready());const _=c.length>0;return _&&Promise.all(c).then(()=>s(null)),jb(i,t,e,n,a,l,u),_}function jb(i,t,e,n,s,a,l){const u=e.getGeometryFunction()(t);if(!u)return;const c=u.simplifyTransformed(n,s);if(e.getRenderer())sy(i,c,e,t,l);else{const y=iy[c.getType()];y(i,c,e,t,l,a)}}function sy(i,t,e,n,s){if(t.getType()=="GeometryCollection"){const l=t.getGeometries();for(let u=0,c=l.length;u<c;++u)sy(i,l[u],e,n,s);return}i.getBuilder(e.getZIndex(),"Default").drawCustom(t,n,e.getRenderer(),e.getHitDetectionRenderer(),s)}function Hb(i,t,e,n,s,a){const l=t.getGeometriesArray();let u,c;for(u=0,c=l.length;u<c;++u){const p=iy[l[u].getType()];p(i,l[u],e,n,s,a)}}function Yb(i,t,e,n,s){const a=e.getStroke();if(a){const u=i.getBuilder(e.getZIndex(),"LineString");u.setFillStrokeStyle(null,a),u.drawLineString(t,n,s)}const l=e.getText();if(l&&l.getText()){const u=i.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l),u.drawText(t,n,s)}}function Zb(i,t,e,n,s){const a=e.getStroke();if(a){const u=i.getBuilder(e.getZIndex(),"LineString");u.setFillStrokeStyle(null,a),u.drawMultiLineString(t,n,s)}const l=e.getText();if(l&&l.getText()){const u=i.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l),u.drawText(t,n,s)}}function Kb(i,t,e,n,s){const a=e.getFill(),l=e.getStroke();if(l||a){const c=i.getBuilder(e.getZIndex(),"Polygon");c.setFillStrokeStyle(a,l),c.drawMultiPolygon(t,n,s)}const u=e.getText();if(u&&u.getText()){const c=i.getBuilder(e.getZIndex(),"Text");c.setTextStyle(u),c.drawText(t,n,s)}}function qb(i,t,e,n,s,a){const l=e.getImage(),u=e.getText(),c=u&&u.getText(),p=a&&l&&c?{}:void 0;if(l){if(l.getImageState()!=se.LOADED)return;const y=i.getBuilder(e.getZIndex(),"Image");y.setImageStyle(l,p),y.drawPoint(t,n,s)}if(c){const y=i.getBuilder(e.getZIndex(),"Text");y.setTextStyle(u,p),y.drawText(t,n,s)}}function $b(i,t,e,n,s,a){const l=e.getImage(),u=l&&l.getOpacity()!==0,c=e.getText(),p=c&&c.getText(),y=a&&u&&p?{}:void 0;if(u){if(l.getImageState()!=se.LOADED)return;const _=i.getBuilder(e.getZIndex(),"Image");_.setImageStyle(l,y),_.drawMultiPoint(t,n,s)}if(p){const _=i.getBuilder(e.getZIndex(),"Text");_.setTextStyle(c,y),_.drawText(t,n,s)}}function Jb(i,t,e,n,s){const a=e.getFill(),l=e.getStroke();if(a||l){const c=i.getBuilder(e.getZIndex(),"Polygon");c.setFillStrokeStyle(a,l),c.drawPolygon(t,n,s)}const u=e.getText();if(u&&u.getText()){const c=i.getBuilder(e.getZIndex(),"Text");c.setTextStyle(u),c.drawText(t,n,s)}}class Qb extends Uf{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=zn(),this.wrappedRenderedExtent_=zn(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,n){const s=e.extent,a=e.viewState,l=a.center,u=a.resolution,c=a.projection,p=a.rotation,y=c.getExtent(),_=this.getLayer().getSource(),E=this.getLayer().getDeclutter(),I=e.pixelRatio,S=e.viewHints,R=!(S[Gi.ANIMATING]||S[Gi.INTERACTING]),D=this.context,T=Math.round(Ve(s)/u*I),v=Math.round(Oi(s)/u*I),k=_.getWrapX()&&c.canWrapX(),X=k?Ve(y):null,H=k?Math.ceil((s[2]-y[2])/X)+1:1;let K=k?Math.floor((s[0]-y[0])/X):0;do{let z=this.getRenderTransform(l,u,0,I,T,v,K*X);e.declutter&&(z=z.slice(0)),t.execute(D,[D.canvas.width,D.canvas.height],z,p,R,n===void 0?pa:n?ey:Lb,n?E&&e.declutter[E]:void 0)}while(++K<H)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Hi(this.context.canvas.width,this.context.canvas.height,n1))}resetDrawContext_(){if(this.opacity_!==1){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Ph(this.context),n1.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex];this.opacity_=n.opacity;const s=t.viewState;this.prepareContainer(t,e);const a=this.context,l=this.replayGroup_;let u=l&&!l.isEmpty();if(!u&&!(this.getLayer().hasListener(Gn.PRERENDER)||this.getLayer().hasListener(Gn.POSTRENDER)))return null;if(this.setDrawContext_(),this.preRender(a,t),s.projection,this.clipped_=!1,u&&n.extent&&this.clipping){const c=Ls(n.extent);u=en(c,t.extent),this.clipped_=u&&!us(c,t.extent),this.clipped_&&this.clipUnrotated(a,t,c)}return u&&this.renderWorlds(l,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&a.restore(),this.postRender(a,t),this.renderedRotation_!==s.rotation&&(this.renderedRotation_=s.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const n=this.frameState.size.slice(),s=this.renderedCenter_,a=this.renderedResolution_,l=this.renderedRotation_,u=this.renderedProjection_,c=this.wrappedRenderedExtent_,p=this.getLayer(),y=[],_=n[0]*ls,E=n[1]*ls;y.push(this.getRenderTransform(s,a,l,ls,_,E,0).slice());const I=p.getSource(),S=u.getExtent();if(I.getWrapX()&&u.canWrapX()&&!us(S,c)){let R=c[0];const D=Ve(S);let T=0,v;for(;R<S[0];)--T,v=D*T,y.push(this.getRenderTransform(s,a,l,ls,_,E,v).slice()),R+=D;for(T=0,R=c[2];R>S[2];)++T,v=D*T,y.push(this.getRenderTransform(s,a,l,ls,_,E,v).slice()),R-=D}this.hitDetectionImageData_=Gb(n,y,this.renderedFeatures_,p.getStyleFunction(),c,a,l,a1(a,this.renderedPixelRatio_),null)}e(zb(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,n,s,a){if(!this.replayGroup_)return;const l=e.viewState.resolution,u=e.viewState.rotation,c=this.getLayer(),p={},y=function(S,R,D){const T=ti(S),v=p[T];if(v){if(v!==!0&&D<v.distanceSq){if(D===0)return p[T]=!0,a.splice(a.lastIndexOf(v),1),s(S,c,R);v.geometry=R,v.distanceSq=D}}else{if(D===0)return p[T]=!0,s(S,c,R);a.push(p[T]={feature:S,layer:c,geometry:R,distanceSq:D,callback:s})}};let _;const E=[this.replayGroup_],I=this.getLayer().getDeclutter();return E.some(S=>_=S.forEachFeatureAtCoordinate(t,l,u,n,y,I&&e.declutter[I]?e.declutter[I].all().map(R=>R.value):null)),_}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),n=e.getSource();if(!n)return!1;const s=t.viewHints[Gi.ANIMATING],a=t.viewHints[Gi.INTERACTING],l=e.getUpdateWhileAnimating(),u=e.getUpdateWhileInteracting();if(this.ready&&!l&&s||!u&&a)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const c=t.extent,p=t.viewState,y=p.projection,_=p.resolution,E=t.pixelRatio,I=e.getRevision(),S=e.getRenderBuffer();let R=e.getRenderOrder();R===void 0&&(R=Wb);const D=p.center.slice(),T=hf(c,S*_),v=T.slice(),k=[T.slice()],X=y.getExtent();if(n.getWrapX()&&y.canWrapX()&&!us(X,t.extent)){const N=Ve(X),Z=Math.max(Ve(T)/2,N);T[0]=X[0]-Z,T[2]=X[2]+Z,h2(D,y);const ft=a2(k[0],y);ft[0]<X[0]&&ft[2]<X[2]?k.push([ft[0]+N,ft[1],ft[2]+N,ft[3]]):ft[0]>X[0]&&ft[2]>X[2]&&k.push([ft[0]-N,ft[1],ft[2]-N,ft[3]])}if(this.ready&&this.renderedResolution_==_&&this.renderedRevision_==I&&this.renderedRenderOrder_==R&&this.renderedFrameDeclutter_===!!t.declutter&&us(this.wrappedRenderedExtent_,T))return yr(this.renderedExtent_,v)||(this.hitDetectionImageData_=null,this.renderedExtent_=v),this.renderedCenter_=D,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const H=new Db(ny(_,E),T,_,E);let K;for(let N=0,Z=k.length;N<Z;++N)n.loadFeatures(k[N],_,y);const z=a1(_,E);let q=!0;const V=(N,Z)=>{let ft;const rt=N.getStyleFunction()||e.getStyleFunction();if(rt&&(ft=rt(N,_)),ft){const At=this.renderFeature(N,z,ft,H,K,this.getLayer().getDeclutter(),Z);q=q&&!At}},nt=yf(T),ot=n.getFeaturesInExtent(nt);R&&ot.sort(R);for(let N=0,Z=ot.length;N<Z;++N)V(ot[N],N);this.renderedFeatures_=ot,this.ready=q;const j=H.finish(),tt=new kb(T,_,E,n.getOverlaps(),j,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=_,this.renderedRevision_=I,this.renderedRenderOrder_=R,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=v,this.wrappedRenderedExtent_=T,this.renderedCenter_=D,this.renderedProjection_=y,this.renderedPixelRatio_=E,this.replayGroup_=tt,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,n,s,a,l,u){if(!n)return!1;let c=!1;if(Array.isArray(n))for(let p=0,y=n.length;p<y;++p)c=o1(s,t,n[p],e,this.boundHandleStyleImageChange_,a,l,u)||c;else c=o1(s,t,n,e,this.boundHandleStyleImageChange_,a,l,u);return c}}class t3 extends $2{constructor(t){super(t)}createRenderer(){return new Qb(this)}}const Ou=t3;class l1{constructor(t){this.rbush_=new Gf(t),this.items_={}}insert(t,e){const n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[ti(e)]=n}load(t,e){const n=new Array(e.length);for(let s=0,a=e.length;s<a;s++){const l=t[s],u=e[s],c={minX:l[0],minY:l[1],maxX:l[2],maxY:l[3],value:u};n[s]=c,this.items_[ti(u)]=c}this.rbush_.load(n)}remove(t){const e=ti(t),n=this.items_[e];return delete this.items_[e],this.rbush_.remove(n)!==null}update(t,e){const n=this.items_[ti(e)],s=[n.minX,n.minY,n.maxX,n.maxY];Ia(s,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(s){return s.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let n;for(let s=0,a=t.length;s<a;s++)if(n=e(t[s]),n)return n;return n}isEmpty(){return Gr(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return gr(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class fh extends m2{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(oi),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,n=t.length;e<n;++e)this.changeEventsKeys_.push(We(t[e],_e.CHANGE,this.changed,this))}clone(){const t=new fh(Pu(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,n,s){if(s<Wr(this.getExtent(),t,e))return s;const a=this.geometries_;for(let l=0,u=a.length;l<u;++l)s=a[l].closestPointXY(t,e,n,s);return s}containsXY(t,e){const n=this.geometries_;for(let s=0,a=n.length;s<a;++s)if(n[s].containsXY(t,e))return!0;return!1}computeExtent(t){Qo(t);const e=this.geometries_;for(let n=0,s=e.length;n<s;++n)n2(t,e[n].getExtent());return t}getGeometries(){return Pu(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let n=0,s=e.length;n<s;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],n=this.geometries_;let s=!1;for(let a=0,l=n.length;a<l;++a){const u=n[a],c=u.getSimplifiedGeometry(t);e.push(c),c!==u&&(s=!0)}return s?new fh(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let n=0,s=e.length;n<s;++n)if(e[n].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const n=this.geometries_;for(let s=0,a=n.length;s<a;++s)n[s].rotate(t,e);this.changed()}scale(t,e,n){n||(n=ps(this.getExtent()));const s=this.geometries_;for(let a=0,l=s.length;a<l;++a)s[a].scale(t,e,n);this.changed()}setGeometries(t){this.setGeometriesArray(Pu(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let n=0,s=e.length;n<s;++n)e[n].applyTransform(t);this.changed()}translate(t,e){const n=this.geometries_;for(let s=0,a=n.length;s<a;++s)n[s].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Pu(i){return i.map(t=>t.clone())}const e3=fh;class To extends jr{constructor(t,e,n){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&n)this.setFlatCoordinates(e,t),this.ends_=n;else{const s=t,a=[],l=[];for(let c=0,p=s.length;c<p;++c){const y=s[c];$n(a,y.getFlatCoordinates()),l.push(a.length)}const u=s.length===0?this.getLayout():s[0].getLayout();this.setFlatCoordinates(u,a),this.ends_=l}}appendLineString(t){$n(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new To(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Wr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_f(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bf(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,s))}getCoordinateAtM(t,e,n){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,n=n!==void 0?n:!1,ew(this.flatCoordinates,0,this.ends_,this.stride,t,e,n))}getCoordinates(){return mo(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new ah(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,n=this.layout,s=[];let a=0;for(let l=0,u=e.length;l<u;++l){const c=e[l],p=new ah(t.slice(a,c),n);s.push(p),a=c}return s}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let n=0;const s=this.ends_,a=this.stride;for(let l=0,u=s.length;l<u;++l){const c=s[l],p=rh(e,n,c,a,.5);$n(t,p),n=c}return t}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=y2(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,n),new To(e,"XY",n)}getType(){return"MultiLineString"}intersectsExtent(t){return O_(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=el(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}class Wf extends jr{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){$n(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new Wf(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){if(s<Wr(this.getExtent(),t,e))return s;const a=this.flatCoordinates,l=this.stride;for(let u=0,c=a.length;u<c;u+=l){const p=Fr(t,e,a[u],a[u+1]);if(p<s){s=p;for(let y=0;y<l;++y)n[y]=a[u+y];n.length=l}}return s}getCoordinates(){return or(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new yo(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,n=this.stride,s=[];for(let a=0,l=t.length;a<l;a+=n){const u=new yo(t.slice(a,a+n),e);s.push(u)}return s}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,n=this.stride;for(let s=0,a=e.length;s<a;s+=n){const l=e[s],u=e[s+1];if(uf(t,l,u))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Mh(this.flatCoordinates,0,t,this.stride),this.changed()}}const ry=Wf;function ay(i,t,e,n){const s=[];let a=zn();for(let l=0,u=e.length;l<u;++l){const c=e[l];a=cf(i,t,c[0],n),s.push((a[0]+a[2])/2,(a[1]+a[3])/2),t=c[c.length-1]}return s}class dh extends jr{constructor(t,e,n){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!n&&!Array.isArray(t[0])){const s=t,a=[],l=[];for(let u=0,c=s.length;u<c;++u){const p=s[u],y=a.length,_=p.getEnds();for(let E=0,I=_.length;E<I;++E)_[E]+=y;$n(a,p.getFlatCoordinates()),l.push(_)}e=s.length===0?this.getLayout():s[0].getLayout(),t=a,n=l}e!==void 0&&n?(this.setFlatCoordinates(e,t),this.endss_=n):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const n=this.flatCoordinates.length;$n(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let s=0,a=e.length;s<a;++s)e[s]+=n}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let s=0;s<t;++s)e[s]=this.endss_[s].slice();const n=new dh(this.flatCoordinates.slice(),this.layout,e);return n.applyProperties(this),n}closestPointXY(t,e,n,s){return s<Wr(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(C_(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),A_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,n,s))}containsXY(t,e){return v_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return D_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Cc(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Ic(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=ay(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=b2(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ry(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;A2(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Cc(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=T_(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,n),new dh(e,"XY",n)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const a=this.endss_[t-1];e=a[a.length-1]}const n=this.endss_[t].slice(),s=n[n.length-1];if(e!==0)for(let a=0,l=n.length;a<l;++a)n[a]-=e;return new xo(this.flatCoordinates.slice(e,s),this.layout,n)}getPolygons(){const t=this.layout,e=this.flatCoordinates,n=this.endss_,s=[];let a=0;for(let l=0,u=n.length;l<u;++l){const c=n[l].slice(),p=c[c.length-1];if(a!==0)for(let _=0,E=c.length;_<E;++_)c[_]-=a;const y=new xo(e.slice(a,p),t,c);s.push(y),a=p}return s}getType(){return"MultiPolygon"}intersectsExtent(t){return P_(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const n=p2(this.flatCoordinates,0,t,this.stride,this.endss_);if(n.length===0)this.flatCoordinates.length=0;else{const s=n[n.length-1];this.flatCoordinates.length=s.length===0?0:s[s.length-1]}this.changed()}}const i3=dh,h1=Jn();class pn{constructor(t,e,n,s,a,l){this.styleFunction,this.extent_,this.id_=l,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n||null,this.properties_=a,this.squaredTolerance_,this.stride_=s,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?i2(this.flatCoordinates_):cf(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=ps(this.getExtent());this.flatInteriorPoints_=Cf(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=L_(this.flatCoordinates_,this.ends_),e=ay(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=b2(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=rh(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const n=this.ends_;for(let s=0,a=n.length;s<a;++s){const l=n[s],u=rh(t,e,l,2,.5);$n(this.flatMidpoints_,u),e=l}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=li(t);const e=t.getExtent(),n=t.getWorldExtent();if(e&&n){const s=Oi(n)/Oi(e);ms(h1,n[0],n[3],s,-s,0,0,0),fr(this.flatCoordinates_,0,this.flatCoordinates_.length,2,h1,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new pn(this.type_,this.flatCoordinates_.slice(),this.ends_?.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Jp((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const n=this.simplifiedGeometry_.getFlatCoordinates();let s;switch(this.type_){case"LineString":n.length=vh(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,n,0),s=[n.length];break;case"MultiLineString":s=[],n.length=y2(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,n,0,s);break;case"Polygon":s=[],n.length=Ef(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),n,0,s);break}return s&&(this.simplifiedGeometry_=new pn(this.type_,n,s,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}pn.prototype.getFlatCoordinates=pn.prototype.getOrientedFlatCoordinates;class Xf extends es{constructor(t){super(),this.projection=li(t.projection),this.attributions_=u1(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(n,s){e.viewResolver=n,e.viewRejector=s})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=u1(t),this.changed()}setState(t){this.state_=t,this.changed()}}function u1(i){return i?Array.isArray(i)?function(t){return i}:typeof i=="function"?i:function(t){return[i]}:null}const Fn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function n3(i,t){return[[-1/0,-1/0,1/0,1/0]]}let s3=!1;function r3(i,t,e,n,s,a,l){const u=new XMLHttpRequest;u.open("GET",typeof i=="function"?i(e,n,s):i,!0),t.getType()=="arraybuffer"&&(u.responseType="arraybuffer"),u.withCredentials=s3,u.onload=function(c){if(!u.status||u.status>=200&&u.status<300){const p=t.getType();try{let y;p=="text"||p=="json"?y=u.responseText:p=="xml"?y=u.responseXML||u.responseText:p=="arraybuffer"&&(y=u.response),y?a(t.readFeatures(y,{extent:e,featureProjection:s}),t.readProjection(y)):l()}catch{l()}}else l()},u.onerror=l,u.send()}function c1(i,t){return function(e,n,s,a,l){const u=this;r3(i,t,e,n,s,function(c,p){u.addFeatures(c),a!==void 0&&a(c)},l||Ea)}}class Qs extends ys{constructor(t,e,n){super(t),this.feature=e,this.features=n}}class a3 extends Xf{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Ea,this.format_=t.format,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(qe(this.format_,"`format` must be set when `url` is set"),this.loader_=c1(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:n3;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new l1:null,this.loadedExtentsRtree_=new l1,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let n,s;Array.isArray(t.features)?s=t.features:t.features&&(n=t.features,s=n.getArray()),!e&&n===void 0&&(n=new hs(s)),s!==void 0&&this.addFeaturesInternal(s),n!==void 0&&this.bindFeaturesCollection_(n)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=ti(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const n=t.getGeometry();if(n){const s=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(s,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Qs(Fn.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof pn||(this.featureChangeKeys_[t]=[We(e,_e.CHANGE,this.handleFeatureChange_,this),We(e,ba.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let n=!0;if(e.getId()!==void 0){const s=String(e.getId());if(!(s in this.idIndex_))this.idIndex_[s]=e;else if(e instanceof pn){const a=this.idIndex_[s];a instanceof pn?Array.isArray(a)?a.push(e):this.idIndex_[s]=[a,e]:n=!1}else n=!1}return n&&(qe(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],n=[],s=[];for(let a=0,l=t.length;a<l;a++){const u=t[a],c=ti(u);this.addToIndex_(c,u)&&n.push(u)}for(let a=0,l=n.length;a<l;a++){const u=n[a],c=ti(u);this.setupChangeEvents_(c,u);const p=u.getGeometry();if(p){const y=p.getExtent();e.push(y),s.push(u)}else this.nullGeometryFeatures_[c]=u}if(this.featuresRtree_&&this.featuresRtree_.load(e,s),this.hasListener(Fn.ADDFEATURE))for(let a=0,l=n.length;a<l;a++)this.dispatchEvent(new Qs(Fn.ADDFEATURE,n[a]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(Fn.ADDFEATURE,function(n){e||(e=!0,t.push(n.feature),e=!1)}),this.addEventListener(Fn.REMOVEFEATURE,function(n){e||(e=!0,t.remove(n.feature),e=!1)}),t.addEventListener(yn.ADD,n=>{e||(e=!0,this.addFeature(n.element),e=!1)}),t.addEventListener(yn.REMOVE,n=>{e||(e=!0,this.removeFeature(n.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(oi);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const n=s=>{this.removeFeatureInternal(s)};this.featuresRtree_.forEach(n);for(const s in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[s])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Qs(Fn.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(s){const a=s.getGeometry();if(a instanceof pn||a.intersectsCoordinate(t))return e(s)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(n){const s=n.getGeometry();if(s instanceof pn||s.intersectsExtent(t)){const a=e(n);if(a)return a}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Gr(this.nullGeometryFeatures_)||$n(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(n){e.push(n)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const s=o2(t,e);return[].concat(...s.map(a=>this.featuresRtree_.getInExtent(a)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const n=t[0],s=t[1];let a=null;const l=[NaN,NaN];let u=1/0;const c=[-1/0,-1/0,1/0,1/0];return e=e||co,this.featuresRtree_.forEachInExtent(c,function(p){if(e(p)){const y=p.getGeometry(),_=u;if(u=y instanceof pn?0:y.closestPointXY(n,s,l,u),u<_){a=p;const E=Math.sqrt(u);c[0]=n-E,c[1]=s-E,c[2]=n+E,c[3]=s+E}}}),a}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,n=ti(e),s=e.getGeometry();if(!s)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);else{const l=s.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(l,e)):this.featuresRtree_&&this.featuresRtree_.update(l,e)}const a=e.getId();if(a!==void 0){const l=a.toString();this.idIndex_[l]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[l]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new Qs(Fn.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:ti(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Gr(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,n){const s=this.loadedExtentsRtree_,a=this.strategy_(t,e,n);for(let l=0,u=a.length;l<u;++l){const c=a[l];s.forEachInExtent(c,function(y){return us(y.extent,c)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Qs(Fn.FEATURESLOADSTART)),this.loader_.call(this,c,e,n,y=>{--this.loadingExtentsCount_,this.dispatchEvent(new Qs(Fn.FEATURESLOADEND,void 0,y))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Qs(Fn.FEATURESLOADERROR))}),s.insert(c,{extent:c.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let n;e.forEachInExtent(t,function(s){if(Ia(s.extent,t))return n=s,!0}),n&&e.remove(n)}removeFeatures(t){const e=[];for(let n=0,s=t.length;n<s;++n){const a=t[n],l=this.removeFeatureInternal(a);l&&e.push(l)}e.length>0&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=ti(t);if(!(e in this.uidIndex_))return;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.featureChangeKeys_[e]?.forEach(oi),delete this.featureChangeKeys_[e];const s=t.getId();if(s!==void 0){const a=s.toString(),l=this.idIndex_[a];l===t?delete this.idIndex_[a]:Array.isArray(l)&&(l.splice(l.indexOf(t),1),l.length===1&&(this.idIndex_[a]=l[0]))}return delete this.uidIndex_[e],this.hasListener(Fn.REMOVEFEATURE)&&this.dispatchEvent(new Qs(Fn.REMOVEFEATURE,t)),t}removeFromIdIndex_(t){let e=!1;for(const n in this.idIndex_){const s=this.idIndex_[n];if(t instanceof pn&&Array.isArray(s)&&s.includes(t))s.splice(s.indexOf(t),1);else if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){qe(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(c1(t,this.format_))}}const Nu=a3,ue={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class oy extends $o{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(_e.CHANGE)}release(){this.state===ue.ERROR&&this.setState(ue.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(t.getState()==ue.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(t.getState()==ue.LOADED){t.interimTile=null;break}t.getState()==ue.LOADING?e=t:t.getState()==ue.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==ue.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){xe()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(!n)n=e,this.transitionStarts_[t]=n;else if(n===-1)return 1;const s=e-n+1e3/60;return s>=this.transition_?1:z2(s/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}}class ly extends oy{constructor(t,e,n,s,a,l){super(t,e,l),this.crossOrigin_=s,this.src_=n,this.key=n,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=a}getImage(){return this.image_}setImage(t){this.image_=t,this.state=ue.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=ue.ERROR,this.unlistenImage_(),this.image_=o3(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=ue.LOADED:this.state=ue.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==ue.ERROR&&(this.state=ue.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ue.IDLE&&(this.state=ue.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=$_(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function o3(){const i=Hi(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}class l3{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const s=this.points_[e+2]-this.points_[n+2];if(s<1e3/60)return!1;const a=this.points_[e]-this.points_[n],l=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(l,a),this.initialVelocity_=Math.sqrt(a*a+l*l)/s,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class h3 extends lf{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){xe()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,s=t.pixelToCoordinateTransform;ms(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),t2(s,n)}forEachFeatureAtCoordinate(t,e,n,s,a,l,u,c){let p;const y=e.viewState;function _(X,H,K,z){return a.call(l,H,X?K:null,z)}const E=y.projection,I=h2(t.slice(),E),S=[[0,0]];if(E.canWrapX()&&s){const X=E.getExtent(),H=Ve(X);S.push([-H,0],[H,0])}const R=e.layerStatesArray,D=R.length,T=[],v=[];for(let X=0;X<S.length;X++)for(let H=D-1;H>=0;--H){const K=R[H],z=K.layer;if(z.hasRenderer()&&Vf(K,y)&&u.call(c,z)){const q=z.getRenderer(),V=z.getSource();if(q&&V){const nt=V.getWrapX()?I:t,ot=_.bind(null,K.managed);v[0]=nt[0]+S[X][0],v[1]=nt[1]+S[X][1],p=q.forEachFeatureAtCoordinate(v,e,n,ot,T)}if(p)return p}}if(T.length===0)return;const k=1/T.length;return T.forEach((X,H)=>X.distanceSq+=H*k),T.sort((X,H)=>X.distanceSq-H.distanceSq),T.some(X=>p=X.callback(X.feature,X.layer,X.geometry)),p}hasFeatureAtCoordinate(t,e,n,s,a,l){return this.forEachFeatureAtCoordinate(t,e,n,s,co,this,a,l)!==void 0}getMap(){return this.map_}renderFrame(t){xe()}scheduleExpireIconCache(t){cs.canExpireCache()&&t.postRenderFunctions.push(u3)}}function u3(i,t){cs.expire()}class c3 extends h3{constructor(t){super(t),this.fontChangeListenerKey_=We(Ds,ba.PROPERTYCHANGE,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=kh+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const s=new Q2(t,void 0,e);n.dispatchEvent(s)}}disposeInternal(){oi(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(Gn.PRECOMPOSE,t);const e=t.layerStatesArray.sort(function(u,c){return u.zIndex-c.zIndex});e.some(u=>u.layer instanceof $2&&u.layer.getDeclutter())&&(t.declutter={});const s=t.viewState;this.children_.length=0;const a=[];let l=null;for(let u=0,c=e.length;u<c;++u){const p=e[u];t.layerIndex=u;const y=p.layer,_=y.getSourceState();if(!Vf(p,s)||_!="ready"&&_!="undefined"){y.unrender();continue}const E=y.render(t,l);E&&(E!==l&&(this.children_.push(E),l=E),a.push(p))}this.declutter(t,a),K_(this.element_,this.children_),this.dispatchRenderEvent(Gn.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let n=e.length-1;n>=0;--n){const s=e[n],a=s.layer;a.getDeclutter()&&a.renderDeclutter(t,s)}e.forEach(n=>n.layer.renderDeferred(t))}}}class sr extends ys{constructor(t,e){super(t),this.layer=e}}const Lu={LAYERS:"layers"};class Fa extends G2{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Lu.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new hs(n.slice(),{unique:!0}):qe(typeof n.getArray=="function","Expected `layers` to be an array or a `Collection`"):n=new hs(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(oi),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(We(t,yn.ADD,this.handleLayersAdd_,this),We(t,yn.REMOVE,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(oi);qo(this.listenerKeys_);const e=t.getArray();for(let n=0,s=e.length;n<s;n++){const a=e[n];this.registerLayerListeners_(a),this.dispatchEvent(new sr("addlayer",a))}this.changed()}registerLayerListeners_(t){const e=[We(t,ba.PROPERTYCHANGE,this.handleLayerChange_,this),We(t,_e.CHANGE,this.handleLayerChange_,this)];t instanceof Fa&&e.push(We(t,"addlayer",this.handleLayerGroupAdd_,this),We(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[ti(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new sr("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new sr("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new sr("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=ti(e);this.listenerKeys_[n].forEach(oi),delete this.listenerKeys_[n],this.dispatchEvent(new sr("removelayer",e)),this.changed()}getLayers(){return this.get(Lu.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const n=e.getArray();for(let s=0,a=n.length;s<a;++s)this.dispatchEvent(new sr("removelayer",n[s]))}this.set(Lu.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],n=e.length;this.getLayers().forEach(function(l){l.getLayerStatesArray(e)});const s=this.getLayerState();let a=s.zIndex;!t&&s.zIndex===void 0&&(a=0);for(let l=n,u=e.length;l<u;l++){const c=e[l];c.opacity*=s.opacity,c.visible=c.visible&&s.visible,c.maxResolution=Math.min(c.maxResolution,s.maxResolution),c.minResolution=Math.max(c.minResolution,s.minResolution),c.minZoom=Math.max(c.minZoom,s.minZoom),c.maxZoom=Math.min(c.maxZoom,s.maxZoom),s.extent!==void 0&&(c.extent!==void 0?c.extent=kr(c.extent,s.extent):c.extent=s.extent),c.zIndex===void 0&&(c.zIndex=a)}return e}getSourceState(){return"ready"}}class ga extends ys{constructor(t,e,n){super(t),this.map=e,this.frameState=n!==void 0?n:null}}class ir extends ga{constructor(t,e,n,s,a,l){super(t,e,a),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=s!==void 0?s:!1,this.activePointers=l}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const bi={SINGLECLICK:"singleclick",CLICK:_e.CLICK,DBLCLICK:_e.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Oc={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class f3 extends $o{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=We(n,Oc.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=We(n,Oc.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(_e.TOUCHMOVE,this.boundHandleTouchMove_,v2?{passive:!1}:!1)}emulateClick_(t){let e=new ir(bi.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new ir(bi.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const n=new ir(bi.SINGLECLICK,this.map_,t);this.dispatchEvent(n)},250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==bi.POINTERUP||e.type==bi.POINTERCANCEL){delete this.trackedTouches_[n];for(const s in this.trackedTouches_)if(this.trackedTouches_[s].target!==e.target){delete this.trackedTouches_[s];break}}else(e.type==bi.POINTERDOWN||e.type==bi.POINTERMOVE)&&(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new ir(bi.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(oi),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new ir(bi.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(We(n,bi.POINTERMOVE,this.handlePointerMove_,this),We(n,bi.POINTERUP,this.handlePointerUp_,this),We(this.element_,bi.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(We(this.element_.getRootNode(),bi.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new ir(bi.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new ir(bi.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(oi(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(_e.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(oi(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(oi),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Ms={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},tn={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},gh=1/0;class d3{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,qo(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const s=this.keyFunction_(n);return delete this.queuedElements_[s],n}enqueue(t){qe(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=gh?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,s=e.length,a=e[t],l=n[t],u=t;for(;t<s>>1;){const c=this.getLeftChildIndex_(t),p=this.getRightChildIndex_(t),y=p<s&&n[p]<n[c]?p:c;e[t]=e[y],n[t]=n[y],t=y}e[t]=a,n[t]=l,this.siftDown_(u,t)}siftDown_(t,e){const n=this.elements_,s=this.priorities_,a=n[e],l=s[e];for(;e>t;){const u=this.getParentIndex_(e);if(s[u]>l)n[e]=n[u],s[e]=s[u],e=u;else break}n[e]=a,s[e]=l}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let s=0;const a=e.length;let l,u,c;for(u=0;u<a;++u)l=e[u],c=t(l),c==gh?delete this.queuedElements_[this.keyFunction_(l)]:(n[s]=c,e[s++]=l);e.length=s,n.length=s,this.heapify_()}}class g3 extends d3{constructor(t,e){super(function(n){return t.apply(null,n)},function(n){return n[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(_e.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(n===ue.LOADED||n===ue.ERROR||n===ue.EMPTY){n!==ue.ERROR&&e.removeEventListener(_e.CHANGE,this.boundHandleTileChange_);const s=e.getKey();s in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[s],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n=0,s,a,l;for(;this.tilesLoading_<t&&n<e&&this.getCount()>0;)a=this.dequeue()[0],l=a.getKey(),s=a.getState(),s===ue.IDLE&&!(l in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[l]=!0,++this.tilesLoading_,++n,a.load())}}function m3(i,t,e,n,s){if(!i||!(e in i.wantedTiles)||!i.wantedTiles[e][t.getKey()])return gh;const a=i.viewState.center,l=n[0]-a[0],u=n[1]-a[1];return 65536*Math.log(s)+Math.sqrt(l*l+u*u)/s}class jf extends es{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){sh(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&sh(this.element);for(let e=0,n=this.listenerKeys.length;e<n;++e)oi(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Ea&&this.listenerKeys.push(We(t,Ms.POSTRENDER,this.render,this)),t.render())}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class p3 extends jf{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1);const e=t.className!==void 0?t.className:"ol-attribution",n=t.tipLabel!==void 0?t.tipLabel:"Attributions",s=t.expandClassName!==void 0?t.expandClassName:e+"-expand",a=t.collapseLabel!==void 0?t.collapseLabel:"›",l=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof a=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=a,this.collapseLabel_.className=l):this.collapseLabel_=a;const u=t.label!==void 0?t.label:"i";typeof u=="string"?(this.label_=document.createElement("span"),this.label_.textContent=u,this.label_.className=s):this.label_=u;const c=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(c),this.toggleButton_.addEventListener(_e.CLICK,this.handleClick_.bind(this),!1);const p=e+" "+kh+" "+Pf+(this.collapsed_&&this.collapsible_?" "+G0:"")+(this.collapsible_?"":" ol-uncollapsible"),y=this.element;y.className=p,y.appendChild(this.toggleButton_),y.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap(s=>s.getAttributions(t)))),n=!this.getMap().getAllLayers().some(s=>s.getSource()&&s.getSource().getAttributionsCollapsible()===!1);return this.overrideCollapsible_||this.setCollapsible(n),e}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(s=>Qp(()=>s))),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!yr(e,this.renderedAttributions_)){O2(this.ulElement_);for(let s=0,a=e.length;s<a;++s){const l=document.createElement("li");l.innerHTML=e[s],this.ulElement_.appendChild(l)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(G0),this.collapsed_?B0(this.collapseLabel_,this.label_):B0(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}const y3=p3;class x3 extends jf{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",n=t.label!==void 0?t.label:"⇧",s=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=s,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(s));const a=t.tipLabel?t.tipLabel:"Reset rotation",l=document.createElement("button");l.className=e+"-reset",l.setAttribute("type","button"),l.title=a,l.appendChild(this.label_),l.addEventListener(_e.CLICK,this.handleClick_.bind(this),!1);const u=e+" "+kh+" "+Pf,c=this.element;c.className=u,c.appendChild(l),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Ml)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const n=e.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:La}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const s="rotate("+n+"rad)";if(this.autoHide_){const a=this.element.classList.contains(Ml);!a&&n===0?this.element.classList.add(Ml):a&&n!==0&&this.element.classList.remove(Ml)}this.label_.style.transform=s}this.rotation_=n}}const _3=x3;class w3 extends jf{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",n=t.delta!==void 0?t.delta:1,s=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",a=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",l=t.zoomInLabel!==void 0?t.zoomInLabel:"+",u=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",c=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",p=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",y=document.createElement("button");y.className=s,y.setAttribute("type","button"),y.title=c,y.appendChild(typeof l=="string"?document.createTextNode(l):l),y.addEventListener(_e.CLICK,this.handleClick_.bind(this,n),!1);const _=document.createElement("button");_.className=a,_.setAttribute("type","button"),_.title=p,_.appendChild(typeof u=="string"?document.createTextNode(u):u),_.addEventListener(_e.CLICK,this.handleClick_.bind(this,-n),!1);const E=e+" "+kh+" "+Pf,I=this.element;I.className=E,I.appendChild(y),I.appendChild(_),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const n=this.getMap().getView();if(!n)return;const s=n.getZoom();if(s!==void 0){const a=n.getConstrainedZoom(s+t);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:a,duration:this.duration_,easing:La})):n.setZoom(a)}}}const b3=w3;function E3(i){i=i||{};const t=new hs;return(i.zoom!==void 0?i.zoom:!0)&&t.push(new b3(i.zoomOptions)),(i.rotate!==void 0?i.rotate:!0)&&t.push(new _3(i.rotateOptions)),(i.attribution!==void 0?i.attribution:!0)&&t.push(new y3(i.attributionOptions)),t}const f1={ACTIVE:"active"};class al extends es{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(f1.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(f1.ACTIVE,t)}setMap(t){this.map_=t}}function I3(i,t,e){const n=i.getCenterInternal();if(n){const s=[n[0]+t[0],n[1]+t[1]];i.animateInternal({duration:e!==void 0?e:250,easing:ww,center:i.getConstrainedCenter(s)})}}function Hf(i,t,e,n){const s=i.getZoom();if(s===void 0)return;const a=i.getConstrainedZoom(s+t),l=i.getResolutionForZoom(a);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:l,anchor:e,duration:n!==void 0?n:250,easing:La})}class C3 extends al{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==bi.DBLCLICK){const n=t.originalEvent,s=t.map,a=t.coordinate,l=n.shiftKey?-this.delta_:this.delta_,u=s.getView();Hf(u,l,a,this.duration_),n.preventDefault(),e=!0}return!e}}const A3=C3;class ol extends al{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==bi.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==bi.POINTERUP){const n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==bi.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==bi.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function Yf(i){const t=i.length;let e=0,n=0;for(let s=0;s<t;s++)e+=i[s].clientX,n+=i[s].clientY;return{clientX:e/t,clientY:n/t}}function Pc(i){const t=arguments;return function(e){let n=!0;for(let s=0,a=t.length;s<a&&(n=n&&t[s](e),!!n);++s);return n}}const R3=function(i){const t=i.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},S3=function(i){const t=i.map.getTargetElement(),e=i.map.getOwnerDocument().activeElement;return t.contains(e)},hy=function(i){return i.map.getTargetElement().hasAttribute("tabindex")?S3(i):!0},T3=co,uy=function(i){const t=i.originalEvent;return t.button==0&&!(j_&&T2&&t.ctrlKey)},cy=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},D3=function(i){const t=i.originalEvent;return T2?t.metaKey:t.ctrlKey},M3=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},fy=function(i){const t=i.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},ku=function(i){const t=i.originalEvent;return qe(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.pointerType=="mouse"},v3=function(i){const t=i.originalEvent;return qe(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&t.button===0};class O3 extends ol{constructor(t){super({stopDown:Ah}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Pc(cy,v3);this.condition_=t.onFocusOnly?Pc(hy,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,s=e.getEventPixel(Yf(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(s[0],s[1]),this.lastCentroid){const a=[this.lastCentroid[0]-s[0],s[1]-this.lastCentroid[1]],u=t.map.getView();c_(a,u.getResolution()),gf(a,u.getRotation()),u.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=s,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const s=this.kinetic_.getDistance(),a=this.kinetic_.getAngle(),l=n.getCenterInternal(),u=e.getPixelFromCoordinateInternal(l),c=e.getCoordinateFromPixelInternal([u[0]-s*Math.cos(a),u[1]-s*Math.sin(a)]);n.animateInternal({center:n.getConstrainedCenter(c),duration:500,easing:La})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}const P3=O3;class N3 extends ol{constructor(t){t=t||{},super({stopDown:Ah}),this.condition_=t.condition?t.condition:R3,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!ku(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===Bf)return;const s=e.getSize(),a=t.pixel,l=Math.atan2(s[1]/2-a[1],a[0]-s[0]/2);if(this.lastAngle_!==void 0){const u=l-this.lastAngle_;n.adjustRotationInternal(-u)}this.lastAngle_=l}handleUpEvent(t){return ku(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return ku(t)&&uy(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class L3 extends lf{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",s=this.element_.style;s.left=Math.min(t[0],e[0])+n,s.top=Math.min(t[1],e[1])+n,s.width=Math.abs(e[0]-t[0])+n,s.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,s=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);s[4]=s[0].slice(),this.geometry_?this.geometry_.setCoordinates([s]):this.geometry_=new xo([s])}getGeometry(){return this.geometry_}}const Ja={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Ll extends ys{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}class k3 extends ol{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new L3(t.className||"ol-dragbox"),this.minArea_=t.minArea!==void 0?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:uy,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const s=n[0]-e[0],a=n[1]-e[1];return s*s+a*a>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Ll(Ja.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Ll(e?Ja.BOXEND:Ja.BOXCANCEL,t.coordinate,t)),!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Ll(Ja.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Ll(Ja.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}}class F3 extends k3{constructor(t){t=t||{};const e=t.condition?t.condition:M3;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const n=this.getMap().getView();let s=this.getGeometry();if(this.out_){const a=n.rotatedExtentForGeometry(s),l=n.getResolutionForExtentInternal(a),u=n.getResolution()/l;s=s.clone(),s.scale(u*u)}n.fitInternal(s,{duration:this.duration_,easing:La})}}const B3=F3,Dr={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class V3 extends al{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return cy(e)&&fy(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==_e.KEYDOWN){const n=t.originalEvent,s=n.key;if(this.condition_(t)&&(s==Dr.DOWN||s==Dr.LEFT||s==Dr.RIGHT||s==Dr.UP)){const l=t.map.getView(),u=l.getResolution()*this.pixelDelta_;let c=0,p=0;s==Dr.DOWN?p=-u:s==Dr.LEFT?c=-u:s==Dr.RIGHT?c=u:p=u;const y=[c,p];gf(y,l.getRotation()),I3(l,y,this.duration_),n.preventDefault(),e=!0}}return!e}}class G3 extends al{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!D3(e)&&fy(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==_e.KEYDOWN||t.type==_e.KEYPRESS){const n=t.originalEvent,s=n.key;if(this.condition_(t)&&(s==="+"||s==="-")){const a=t.map,l=s==="+"?this.delta_:-this.delta_,u=a.getView();Hf(u,l,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}}const z3=G3;class U3 extends al{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:T3;this.condition_=t.onFocusOnly?Pc(hy,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t)||t.type!==_e.WHEEL)return!0;const n=t.map,s=t.originalEvent;s.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);let a;if(t.type==_e.WHEEL&&(a=s.deltaY,W_&&s.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(a/=D2),s.deltaMode===WheelEvent.DOM_DELTA_LINE&&(a*=40)),a===0)return!1;this.lastDelta_=a;const l=Date.now();this.startTime_===void 0&&(this.startTime_=l),(!this.mode_||l-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(a)<4?"trackpad":"wheel");const u=n.getView();if(this.mode_==="trackpad"&&!(u.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(u.getAnimating()&&u.cancelAnimations(),u.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),u.adjustZoom(-a/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=l,!1;this.totalDelta_+=a;const c=Math.max(this.timeout_-(l-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),c),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-Ei(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Hf(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}const W3=U3;class X3 extends ol{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Ah),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],s=this.targetPointers[1],a=Math.atan2(s.clientY-n.clientY,s.clientX-n.clientX);if(this.lastAngle_!==void 0){const c=a-this.lastAngle_;this.rotationDelta_+=c,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=c}this.lastAngle_=a;const l=t.map,u=l.getView();u.getConstraints().rotation!==Bf&&(this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Yf(this.targetPointers))),this.rotating_&&(l.render(),u.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class j3 extends ol{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Ah),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],s=this.targetPointers[1],a=n.clientX-s.clientX,l=n.clientY-s.clientY,u=Math.sqrt(a*a+l*l);this.lastDistance_!==void 0&&(e=this.lastDistance_/u),this.lastDistance_=u;const c=t.map,p=c.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=c.getCoordinateFromPixelInternal(c.getEventPixel(Yf(this.targetPointers))),c.render(),p.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const n=t.map.getView(),s=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,s),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}const H3=j3;function Y3(i){i=i||{};const t=new hs,e=new l3(-.005,.05,100);return(i.altShiftDragRotate!==void 0?i.altShiftDragRotate:!0)&&t.push(new N3),(i.doubleClickZoom!==void 0?i.doubleClickZoom:!0)&&t.push(new A3({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan!==void 0?i.dragPan:!0)&&t.push(new P3({onFocusOnly:i.onFocusOnly,kinetic:e})),(i.pinchRotate!==void 0?i.pinchRotate:!0)&&t.push(new X3),(i.pinchZoom!==void 0?i.pinchZoom:!0)&&t.push(new H3({duration:i.zoomDuration})),(i.keyboard!==void 0?i.keyboard:!0)&&(t.push(new V3),t.push(new z3({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom!==void 0?i.mouseWheelZoom:!0)&&t.push(new W3({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom!==void 0?i.shiftDragZoom:!0)&&t.push(new B3({duration:i.zoomDuration})),t}function dy(i){if(i instanceof nl){i.setMapInternal(null);return}i instanceof Fa&&i.getLayers().forEach(dy)}function gy(i,t){if(i instanceof nl){i.setMapInternal(t);return}if(i instanceof Fa){const e=i.getLayers().getArray();for(let n=0,s=e.length;n<s;++n)gy(e[n],t)}}let Z3=class extends es{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=K3(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:D2,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Jn(),this.pixelToCoordinateTransform_=Jn(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||E3(),this.interactions=e.interactions||Y3({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new g3(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(tn.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(tn.VIEW,this.handleViewChanged_),this.addChangeListener(tn.SIZE,this.handleSizeChanged_),this.addChangeListener(tn.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const n=this;t.view&&!(t.view instanceof os)&&t.view.then(function(s){n.setView(new os(s))}),this.controls.addEventListener(yn.ADD,s=>{s.element.setMap(this)}),this.controls.addEventListener(yn.REMOVE,s=>{s.element.setMap(null)}),this.interactions.addEventListener(yn.ADD,s=>{s.element.setMap(this)}),this.interactions.addEventListener(yn.REMOVE,s=>{s.element.setMap(null)}),this.overlays_.addEventListener(yn.ADD,s=>{this.addOverlayInternal_(s.element)}),this.overlays_.addEventListener(yn.REMOVE,s=>{const a=s.element.getId();a!==void 0&&delete this.overlayIdIndex_[a.toString()],s.element.setMap(null)}),this.controls.forEach(s=>{s.setMap(this)}),this.interactions.forEach(s=>{s.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){gy(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const s=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};const a=n.hitTolerance!==void 0?n.hitTolerance:0,l=n.layerFilter!==void 0?n.layerFilter:co,u=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(s,this.frameState_,a,u,e,null,l,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,function(s){n.push(s)},e),n}getAllLayers(){const t=[];function e(n){n.forEach(function(s){s instanceof Fa?e(s.getLayers()):t.push(s)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const s=e.layerFilter!==void 0?e.layerFilter:co,a=e.hitTolerance!==void 0?e.hitTolerance:0,l=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,a,l,s,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const n=this.viewport_.getBoundingClientRect(),s=this.getSize(),a=n.width/s[0],l=n.height/s[1],u="changedTouches"in t?t.changedTouches[0]:t;return[(u.clientX-n.left)/a,(u.clientY-n.top)/l]}getTarget(){return this.get(tn.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Ec(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Vi(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(tn.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof hs){e.setLayers(t);return}const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const s=t[e];if(!s.visible)continue;const a=s.layer.getRenderer();if(a&&!a.ready)return!0;const l=s.layer.getSource();if(l&&l.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Ts(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Vi(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(tn.SIZE)}getView(){return this.get(tn.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,s){return m3(this.frameState_,t,e,n,s)}handleBrowserEvent(t,e){e=e||t.type;const n=new ir(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===Oc.POINTERDOWN||n===_e.WHEEL||n===_e.KEYDOWN){const s=this.getOwnerDocument(),a=this.viewport_.getRootNode?this.viewport_.getRootNode():s,l=e.target;if(this.overlayContainerStopEvent_.contains(l)||!(a===s?s.documentElement:a).contains(l))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const s=this.getInteractions().getArray().slice();for(let a=s.length-1;a>=0;a--){const l=s[a];if(l.getMap()!==this||!l.getActive()||!this.getTargetElement())continue;if(!l.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let s=this.maxTilesLoading_,a=s;if(t){const l=t.viewHints;if(l[Gi.ANIMATING]||l[Gi.INTERACTING]){const u=Date.now()-t.time>8;s=u?0:8,a=u?0:2}}e.getTilesLoading()<s&&(e.reprioritize(),e.loadMoreTiles(s,a))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(Gn.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Gn.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new ga(Ms.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new ga(Ms.LOADSTART,this,t))));const n=this.postRenderFunctions_;for(let s=0,a=n.length;s<a;++s)n[s](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,s=this.targetChangeHandlerKeys_.length;n<s;++n)oi(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(_e.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(_e.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,sh(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new c3(this)),this.mapBrowserEventHandler_=new f3(this,this.moveTolerance_);for(const a in bi)this.mapBrowserEventHandler_.addEventListener(bi[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(_e.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(_e.WHEEL,this.boundHandleBrowserEvent_,v2?{passive:!1}:!1);const n=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[We(n,_e.KEYDOWN,this.handleBrowserEvent,this),We(n,_e.KEYPRESS,this.handleBrowserEvent,this)];const s=e.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(oi(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(oi(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=We(t,ba.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=We(t,_e.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(oi),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new sr("addlayer",t)),this.layerGroupPropertyListenerKeys_=[We(t,ba.PROPERTYCHANGE,this.render,this),We(t,_e.CHANGE,this.render,this),We(t,"addlayer",this.handleLayerAdd_,this),We(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const s=t[e].layer;s.hasRenderer()&&s.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){dy(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),s=this.frameState_;let a=null;if(e!==void 0&&V0(e)&&n&&n.isDef()){const l=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),u=n.getState();if(a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:th(u.center,u.resolution,u.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:u,viewHints:l,wantedTiles:{},mapId:ti(this),renderTargets:{}},u.nextCenter&&u.nextResolution){const c=isNaN(u.nextRotation)?u.rotation:u.nextRotation;a.nextExtent=th(u.nextCenter,u.nextResolution,c,e)}}this.frameState_=a,this.renderer_.renderFrame(a),a&&(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),s&&(!this.previousExtent_||!Na(this.previousExtent_)&&!Ia(a.extent,this.previousExtent_))&&(this.dispatchEvent(new ga(Ms.MOVESTART,this,s)),this.previousExtent_=Qo(this.previousExtent_)),this.previousExtent_&&!a.viewHints[Gi.ANIMATING]&&!a.viewHints[Gi.INTERACTING]&&!Ia(a.extent,this.previousExtent_)&&(this.dispatchEvent(new ga(Ms.MOVEEND,this,a)),e2(a.extent,this.previousExtent_))),this.dispatchEvent(new ga(Ms.POSTRENDER,this,a)),this.renderComplete_=this.hasListener(Ms.LOADSTART)||this.hasListener(Ms.LOADEND)||this.hasListener(Gn.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new sr("removelayer",e)),this.set(tn.LAYERGROUP,t)}setSize(t){this.set(tn.SIZE,t)}setTarget(t){this.set(tn.TARGET,t)}setView(t){if(!t||t instanceof os){this.set(tn.VIEW,t);return}this.set(tn.VIEW,new os);const e=this;t.then(function(n){e.setView(new os(n))})}updateSize(){const t=this.getTargetElement();let e;if(t){const s=getComputedStyle(t),a=t.offsetWidth-parseFloat(s.borderLeftWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)-parseFloat(s.borderRightWidth),l=t.offsetHeight-parseFloat(s.borderTopWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom)-parseFloat(s.borderBottomWidth);!isNaN(a)&&!isNaN(l)&&(e=[a,l],!V0(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&c2("No map visible because the map container's width or height are 0."))}const n=this.getSize();e&&(!n||!yr(e,n))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function K3(i){let t=null;i.keyboardEventTarget!==void 0&&(t=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);const e={},n=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new Fa({layers:i.layers});e[tn.LAYERGROUP]=n,e[tn.TARGET]=i.target,e[tn.VIEW]=i.view instanceof os?i.view:new os;let s;i.controls!==void 0&&(Array.isArray(i.controls)?s=new hs(i.controls.slice()):(qe(typeof i.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),s=i.controls));let a;i.interactions!==void 0&&(Array.isArray(i.interactions)?a=new hs(i.interactions.slice()):(qe(typeof i.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),a=i.interactions));let l;return i.overlays!==void 0?Array.isArray(i.overlays)?l=new hs(i.overlays.slice()):(qe(typeof i.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),l=i.overlays):l=new hs,{controls:s,interactions:a,keyboardEventTarget:t,overlays:l,values:e}}const q3=Z3,$i={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class $3 extends es{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=t.insertFirst!==void 0?t.insertFirst:!0,this.stopEvent=t.stopEvent!==void 0?t.stopEvent:!0,this.element=document.createElement("div"),this.element.className=t.className!==void 0?t.className:"ol-overlay-container "+sw,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=t.autoPan===!0?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener($i.ELEMENT,this.handleElementChanged),this.addChangeListener($i.MAP,this.handleMapChanged),this.addChangeListener($i.OFFSET,this.handleOffsetChanged),this.addChangeListener($i.POSITION,this.handlePositionChanged),this.addChangeListener($i.POSITIONING,this.handlePositioningChanged),t.element!==void 0&&this.setElement(t.element),this.setOffset(t.offset!==void 0?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),t.position!==void 0&&this.setPosition(t.position)}getElement(){return this.get($i.ELEMENT)}getId(){return this.id}getMap(){return this.get($i.MAP)||null}getOffset(){return this.get($i.OFFSET)}getPosition(){return this.get($i.POSITION)}getPositioning(){return this.get($i.POSITIONING)}handleElementChanged(){O2(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(sh(this.element),oi(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=We(t,Ms.POSTRENDER,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set($i.ELEMENT,t)}setMap(t){this.set($i.MAP,t)}setOffset(t){this.set($i.OFFSET,t)}setPosition(t){this.set($i.POSITION,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get($i.POSITION))return;const n=this.getRect(e.getTargetElement(),e.getSize()),s=this.getElement(),a=this.getRect(s,[Y_(s),Z_(s)]);t=t||{};const l=t.margin===void 0?20:t.margin;if(!us(n,a)){const u=a[0]-n[0],c=n[2]-a[2],p=a[1]-n[1],y=n[3]-a[3],_=[0,0];if(u<0?_[0]=u-l:c<0&&(_[0]=Math.abs(c)+l),p<0?_[1]=p-l:y<0&&(_[1]=Math.abs(y)+l),_[0]!==0||_[1]!==0){const E=e.getView().getCenterInternal(),I=e.getPixelFromCoordinateInternal(E);if(!I)return;const S=[I[0]+_[0],I[1]+_[1]],R=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(S),duration:R.duration,easing:R.easing})}}}getRect(t,e){const n=t.getBoundingClientRect(),s=n.left+window.pageXOffset,a=n.top+window.pageYOffset;return[s,a,s+e[0],a+e[1]]}setPositioning(t){this.set($i.POSITIONING,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e){this.setVisible(!1);return}const n=t.getPixelFromCoordinate(e),s=t.getSize();this.updateRenderedPosition(n,s)}updateRenderedPosition(t,e){const n=this.element.style,s=this.getOffset(),a=this.getPositioning();this.setVisible(!0);const l=Math.round(t[0]+s[0])+"px",u=Math.round(t[1]+s[1])+"px";let c="0%",p="0%";a=="bottom-right"||a=="center-right"||a=="top-right"?c="-100%":(a=="bottom-center"||a=="center-center"||a=="top-center")&&(c="-50%"),a=="bottom-left"||a=="bottom-center"||a=="bottom-right"?p="-100%":(a=="center-left"||a=="center-center"||a=="center-right")&&(p="-50%");const y=`translate(${c}, ${p}) translate(${l}, ${u})`;this.rendered.transform_!=y&&(this.rendered.transform_=y,n.transform=y)}getOptions(){return this.options}}class J3{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return qe(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return qe(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.key_;return t}getValues(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){qe(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}}function d1(i,t,e,n){return n!==void 0?(n[0]=i,n[1]=t,n[2]=e,n):[i,t,e]}function Xh(i,t,e){return i+"/"+t+"/"+e}function my(i){return Xh(i[0],i[1],i[2])}function Q3(i){return i.split("/").map(Number)}function tE(i){return(i[1]<<i[0])+i[2]}function eE(i,t){const e=i[0],n=i[1],s=i[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const a=t.getFullTileRange(e);return a?a.containsXY(n,s):!0}class py extends J3{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const t=this.peekFirstKey(),n=Q3(t)[0];this.forEach(s=>{s.tileCoord[0]!==n&&(this.remove(my(s.tileCoord)),s.release())})}}class Zf{constructor(t,e,n,s){this.minX=t,this.maxX=e,this.minY=n,this.maxY=s}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function sa(i,t,e,n,s){return s!==void 0?(s.minX=i,s.maxX=t,s.minY=e,s.maxY=n,s):new Zf(i,t,e,n)}const kl={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class iE extends nl{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getPreload(){return this.get(kl.PRELOAD)}setPreload(t){this.set(kl.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(kl.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(kl.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}const yy=.5,nE=10,g1=.25;class xy{constructor(t,e,n,s,a,l){this.sourceProj_=t,this.targetProj_=e;let u={};const c=go(this.targetProj_,this.sourceProj_);this.transformInv_=function(v){const k=v[0]+"/"+v[1];return u[k]||(u[k]=c(v)),u[k]},this.maxSourceExtent_=s,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&Ve(s)>=Ve(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Ve(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Ve(this.targetProj_.getExtent()):null;const p=Xr(n),y=Th(n),_=Sh(n),E=Rh(n),I=this.transformInv_(p),S=this.transformInv_(y),R=this.transformInv_(_),D=this.transformInv_(E),T=nE+(l?Math.max(0,Math.ceil(Math.log2(yc(n)/(l*l*256*256)))):0);if(this.addQuad_(p,y,_,E,I,S,R,D,T),this.wrapsXInSource_){let v=1/0;this.triangles_.forEach(function(k,X,H){v=Math.min(v,k.source[0][0],k.source[1][0],k.source[2][0])}),this.triangles_.forEach(k=>{if(Math.max(k.source[0][0],k.source[1][0],k.source[2][0])-v>this.sourceWorldWidth_/2){const X=[[k.source[0][0],k.source[0][1]],[k.source[1][0],k.source[1][1]],[k.source[2][0],k.source[2][1]]];X[0][0]-v>this.sourceWorldWidth_/2&&(X[0][0]-=this.sourceWorldWidth_),X[1][0]-v>this.sourceWorldWidth_/2&&(X[1][0]-=this.sourceWorldWidth_),X[2][0]-v>this.sourceWorldWidth_/2&&(X[2][0]-=this.sourceWorldWidth_);const H=Math.min(X[0][0],X[1][0],X[2][0]);Math.max(X[0][0],X[1][0],X[2][0])-H<this.sourceWorldWidth_/2&&(k.source=X)}})}u={}}addTriangle_(t,e,n,s,a,l){this.triangles_.push({source:[s,a,l],target:[t,e,n]})}addQuad_(t,e,n,s,a,l,u,c,p){const y=I0([a,l,u,c]),_=this.sourceWorldWidth_?Ve(y)/this.sourceWorldWidth_:null,E=this.sourceWorldWidth_,I=this.sourceProj_.canWrapX()&&_>.5&&_<1;let S=!1;if(p>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const D=I0([t,e,n,s]);S=Ve(D)/this.targetWorldWidth_>g1||S}!I&&this.sourceProj_.isGlobal()&&_&&(S=_>g1||S)}if(!S&&this.maxSourceExtent_&&isFinite(y[0])&&isFinite(y[1])&&isFinite(y[2])&&isFinite(y[3])&&!en(y,this.maxSourceExtent_))return;let R=0;if(!S&&(!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(u[0])||!isFinite(u[1])||!isFinite(c[0])||!isFinite(c[1]))){if(p>0)S=!0;else if(R=(!isFinite(a[0])||!isFinite(a[1])?8:0)+(!isFinite(l[0])||!isFinite(l[1])?4:0)+(!isFinite(u[0])||!isFinite(u[1])?2:0)+(!isFinite(c[0])||!isFinite(c[1])?1:0),R!=1&&R!=2&&R!=4&&R!=8)return}if(p>0){if(!S){const D=[(t[0]+n[0])/2,(t[1]+n[1])/2],T=this.transformInv_(D);let v;I?v=(xa(a[0],E)+xa(u[0],E))/2-xa(T[0],E):v=(a[0]+u[0])/2-T[0];const k=(a[1]+u[1])/2-T[1];S=v*v+k*k>this.errorThresholdSquared_}if(S){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const D=[(e[0]+n[0])/2,(e[1]+n[1])/2],T=this.transformInv_(D),v=[(s[0]+t[0])/2,(s[1]+t[1])/2],k=this.transformInv_(v);this.addQuad_(t,e,D,v,a,l,T,k,p-1),this.addQuad_(v,D,n,s,k,T,u,c,p-1)}else{const D=[(t[0]+e[0])/2,(t[1]+e[1])/2],T=this.transformInv_(D),v=[(n[0]+s[0])/2,(n[1]+s[1])/2],k=this.transformInv_(v);this.addQuad_(t,D,v,s,a,T,k,c,p-1),this.addQuad_(D,e,n,v,T,l,u,k,p-1)}return}}if(I){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}R&11||this.addTriangle_(t,n,s,a,u,c),R&14||this.addTriangle_(t,n,e,a,u,l),R&&(R&13||this.addTriangle_(e,s,t,l,c,a),R&7||this.addTriangle_(e,s,n,l,c,u))}calculateSourceExtent(){const t=zn();return this.triangles_.forEach(function(e,n,s){const a=e.source;lo(t,a[0]),lo(t,a[1]),lo(t,a[2])}),t}getTriangles(){return this.triangles_}}let Fu;const _a=[];function m1(i,t,e,n,s){i.beginPath(),i.moveTo(0,0),i.lineTo(t,e),i.lineTo(n,s),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(t,n)+1,Math.max(e,s)),i.restore()}function Bu(i,t){return Math.abs(i[t*4]-210)>2||Math.abs(i[t*4+3]-.75*255)>2}function sE(){if(Fu===void 0){const i=Hi(6,6,_a);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",m1(i,4,5,4,0),m1(i,4,5,0,5);const t=i.getImageData(0,0,3,3).data;Fu=Bu(t,0)||Bu(t,4)||Bu(t,8),Ph(i),_a.push(i.canvas)}return Fu}function Nc(i,t,e,n){const s=y_(e,t,i);let a=T0(t,n,e);const l=t.getMetersPerUnit();l!==void 0&&(a*=l);const u=i.getMetersPerUnit();u!==void 0&&(a/=u);const c=i.getExtent();if(!c||zr(c,s)){const p=T0(i,a,s)/a;isFinite(p)&&p>0&&(a/=p)}return a}function rE(i,t,e,n){const s=ps(e);let a=Nc(i,t,s,n);return(!isFinite(a)||a<=0)&&r2(e,function(l){return a=Nc(i,t,l,n),isFinite(a)&&a>0}),a}function _y(i,t,e,n,s,a,l,u,c,p,y,_,E,I){const S=Hi(Math.round(e*i),Math.round(e*t),_a);if(_||(S.imageSmoothingEnabled=!1),c.length===0)return S.canvas;S.scale(e,e);function R(H){return Math.round(H*e)/e}S.globalCompositeOperation="lighter";const D=zn();c.forEach(function(H,K,z){n2(D,H.extent)});let T;const v=e/n,k=(_?1:1+Math.pow(2,-24))/v;if(!E||c.length!==1||p!==0){if(T=Hi(Math.round(Ve(D)*v),Math.round(Oi(D)*v),_a),_||(T.imageSmoothingEnabled=!1),s&&I){const H=(s[0]-D[0])*v,K=-(s[3]-D[3])*v,z=Ve(s)*v,q=Oi(s)*v;T.rect(H,K,z,q),T.clip()}c.forEach(function(H,K,z){if(H.image.width>0&&H.image.height>0){if(H.clipExtent){T.save();const j=(H.clipExtent[0]-D[0])*v,tt=-(H.clipExtent[3]-D[3])*v,N=Ve(H.clipExtent)*v,Z=Oi(H.clipExtent)*v;T.rect(_?j:Math.round(j),_?tt:Math.round(tt),_?N:Math.round(j+N)-Math.round(j),_?Z:Math.round(tt+Z)-Math.round(tt)),T.clip()}const q=(H.extent[0]-D[0])*v,V=-(H.extent[3]-D[3])*v,nt=Ve(H.extent)*v,ot=Oi(H.extent)*v;T.drawImage(H.image,p,p,H.image.width-2*p,H.image.height-2*p,_?q:Math.round(q),_?V:Math.round(V),_?nt:Math.round(q+nt)-Math.round(q),_?ot:Math.round(V+ot)-Math.round(V)),H.clipExtent&&T.restore()}})}const X=Xr(l);return u.getTriangles().forEach(function(H,K,z){const q=H.source,V=H.target;let nt=q[0][0],ot=q[0][1],j=q[1][0],tt=q[1][1],N=q[2][0],Z=q[2][1];const ft=R((V[0][0]-X[0])/a),rt=R(-(V[0][1]-X[1])/a),At=R((V[1][0]-X[0])/a),bt=R(-(V[1][1]-X[1])/a),Dt=R((V[2][0]-X[0])/a),ct=R(-(V[2][1]-X[1])/a),at=nt,Pt=ot;nt=0,ot=0,j-=at,tt-=Pt,N-=at,Z-=Pt;const mt=[[j,tt,0,0,At-ft],[N,Z,0,0,Dt-ft],[0,0,j,tt,bt-rt],[0,0,N,Z,ct-rt]],Lt=h_(mt);if(!Lt)return;if(S.save(),S.beginPath(),sE()||!_){S.moveTo(At,bt);const Ee=4,te=ft-At,me=rt-bt;for(let Ie=0;Ie<Ee;Ie++)S.lineTo(At+R((Ie+1)*te/Ee),bt+R(Ie*me/(Ee-1))),Ie!=Ee-1&&S.lineTo(At+R((Ie+1)*te/Ee),bt+R((Ie+1)*me/(Ee-1)));S.lineTo(Dt,ct)}else S.moveTo(At,bt),S.lineTo(ft,rt),S.lineTo(Dt,ct);S.clip(),S.transform(Lt[0],Lt[2],Lt[1],Lt[3],ft,rt),S.translate(D[0]-at,D[3]-Pt);let Vt;if(T)Vt=T.canvas,S.scale(k,-k);else{const Ee=c[0],te=Ee.extent;Vt=Ee.image,S.scale(Ve(te)/Vt.width,-Oi(te)/Vt.height)}S.drawImage(Vt,0,0),S.restore()}),T&&(Ph(T),_a.push(T.canvas)),y&&(S.save(),S.globalCompositeOperation="source-over",S.strokeStyle="black",S.lineWidth=1,u.getTriangles().forEach(function(H,K,z){const q=H.target,V=(q[0][0]-X[0])/a,nt=-(q[0][1]-X[1])/a,ot=(q[1][0]-X[0])/a,j=-(q[1][1]-X[1])/a,tt=(q[2][0]-X[0])/a,N=-(q[2][1]-X[1])/a;S.beginPath(),S.moveTo(ot,j),S.lineTo(V,nt),S.lineTo(tt,N),S.closePath(),S.stroke()}),S.restore()),S.canvas}class Lc extends oy{constructor(t,e,n,s,a,l,u,c,p,y,_,E){super(a,ue.IDLE,E),this.renderEdges_=_!==void 0?_:!1,this.pixelRatio_=u,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=s,this.wrappedTileCoord_=l||a,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const I=s.getTileCoordExtent(this.wrappedTileCoord_),S=this.targetTileGrid_.getExtent();let R=this.sourceTileGrid_.getExtent();const D=S?kr(I,S):I;if(yc(D)===0){this.state=ue.EMPTY;return}const T=t.getExtent();T&&(R?R=kr(R,T):R=T);const v=s.getResolution(this.wrappedTileCoord_[0]),k=rE(t,n,D,v);if(!isFinite(k)||k<=0){this.state=ue.EMPTY;return}const X=y!==void 0?y:yy;if(this.triangulation_=new xy(t,n,D,R,k*X,v),this.triangulation_.getTriangles().length===0){this.state=ue.EMPTY;return}this.sourceZ_=e.getZForResolution(k);let H=this.triangulation_.calculateSourceExtent();if(R&&(t.canWrapX()?(H[1]=Ei(H[1],R[1],R[3]),H[3]=Ei(H[3],R[1],R[3])):H=kr(H,R)),!yc(H))this.state=ue.EMPTY;else{let K=0,z=0;t.canWrapX()&&(K=Ve(T),z=Math.floor((H[0]-T[0])/K)),o2(H.slice(),t,!0).forEach(V=>{const nt=e.getTileRangeForExtentAndZ(V,this.sourceZ_);for(let ot=nt.minX;ot<=nt.maxX;ot++)for(let j=nt.minY;j<=nt.maxY;j++){const tt=p(this.sourceZ_,ot,j,u);if(tt){const N=z*K;this.sourceTiles_.push({tile:tt,offset:N})}}++z}),this.sourceTiles_.length===0&&(this.state=ue.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{const n=e.tile;if(n&&n.getState()==ue.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);s[0]+=e.offset,s[2]+=e.offset;const a=this.clipExtent_?.slice();a&&(a[0]+=e.offset,a[2]+=e.offset),t.push({extent:s,clipExtent:a,image:n.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=ue.ERROR;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),s=typeof n=="number"?n:n[0],a=typeof n=="number"?n:n[1],l=this.targetTileGrid_.getResolution(e),u=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=_y(s,a,this.pixelRatio_,u,this.sourceTileGrid_.getExtent(),l,c,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=ue.LOADED}this.changed()}load(){if(this.state==ue.IDLE){this.state=ue.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const n=e.getState();if(n==ue.IDLE||n==ue.LOADING){t++;const s=We(e,_e.CHANGE,function(a){const l=e.getState();(l==ue.LOADED||l==ue.ERROR||l==ue.EMPTY)&&(oi(s),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(s)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},n,s){e.getState()==ue.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(oi),this.sourcesListenerKeys_=null}release(){this.canvas_&&(Ph(this.canvas_.getContext("2d")),_a.push(this.canvas_),this.canvas_=null),super.release()}}class aE extends Uf{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=zn(),this.tmpTileRange_=new Zf(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),n=t.getState(),s=e.getUseInterimTilesOnError();return n==ue.LOADED||n==ue.EMPTY||n==ue.ERROR&&!s}getTile(t,e,n,s){const a=s.pixelRatio,l=s.viewState.projection,u=this.getLayer();let p=u.getSource().getTile(t,e,n,a,l);return p.getState()==ue.ERROR&&u.getUseInterimTilesOnError()&&u.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(p)||(p=p.getInterimTile()),p}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),s=Vi(e.pixelToCoordinateTransform,t.slice()),a=n.getExtent();if(a&&!zr(a,s))return null;const l=e.pixelRatio,u=e.viewState.projection,c=e.viewState,p=n.getRenderSource(),y=p.getTileGridForProjection(c.projection),_=p.getTilePixelRatio(e.pixelRatio);for(let E=y.getZForResolution(c.resolution);E>=y.getMinZoom();--E){const I=y.getTileCoordForCoordAndZ(s,E),S=p.getTile(E,I[1],I[2],l,u);if(!(S instanceof ly||S instanceof Lc)||S instanceof Lc&&S.getState()===ue.EMPTY)return null;if(S.getState()!==ue.LOADED)continue;const R=y.getOrigin(E),D=Tn(y.getTileSize(E)),T=y.getResolution(E),v=Math.floor(_*((s[0]-R[0])/T-I[1]*D[0])),k=Math.floor(_*((R[1]-s[1])/T-I[2]*D[1])),X=Math.round(_*p.getGutterForProjection(c.projection));return this.getImageData(S.getImage(),v+X,k+X)}return null}loadedTileCallback(t,e,n){return this.isDrawableTile(n)?super.loadedTileCallback(t,e,n):!1}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex],s=t.viewState,a=s.projection,l=s.resolution,u=s.center,c=s.rotation,p=t.pixelRatio,y=this.getLayer(),_=y.getSource(),E=_.getRevision(),I=_.getTileGridForProjection(a),S=I.getZForResolution(l,_.zDirection),R=I.getResolution(S);let D=t.extent;const T=t.viewState.resolution,v=_.getTilePixelRatio(p);this.prepareContainer(t,e);const k=this.context.canvas.width,X=this.context.canvas.height,H=n.extent&&Ls(n.extent);H&&(D=kr(D,Ls(n.extent)));const K=R*k/2/v,z=R*X/2/v,q=[u[0]-K,u[1]-z,u[0]+K,u[1]+z],V=I.getTileRangeForExtentAndZ(D,S),nt={};nt[S]={};const ot=this.createLoadedTileFinder(_,a,nt),j=this.tmpExtent,tt=this.tmpTileRange_;this.newTiles_=!1;const N=c?xc(s.center,T,c,t.size):void 0;for(let ct=V.minX;ct<=V.maxX;++ct)for(let at=V.minY;at<=V.maxY;++at){if(c&&!I.tileCoordIntersectsViewport([S,ct,at],N))continue;const Pt=this.getTile(S,ct,at,t);if(this.isDrawableTile(Pt)){const Vt=ti(this);if(Pt.getState()==ue.LOADED){nt[S][Pt.tileCoord.toString()]=Pt;let Ee=Pt.inTransition(Vt);Ee&&n.opacity!==1&&(Pt.endTransition(Vt),Ee=!1),!this.newTiles_&&(Ee||!this.renderedTiles.includes(Pt))&&(this.newTiles_=!0)}if(Pt.getAlpha(Vt,t.time)===1)continue}const mt=I.getTileCoordChildTileRange(Pt.tileCoord,tt,j);let Lt=!1;mt&&(Lt=ot(S+1,mt)),Lt||I.forEachTileCoordParentTileRange(Pt.tileCoord,ot,tt,j)}const Z=R/l*p/v,ft=this.getRenderContext(t);ms(this.tempTransform,k/2,X/2,Z,Z,0,-k/2,-X/2),H&&this.clipUnrotated(ft,t,H),_.getInterpolate()||(ft.imageSmoothingEnabled=!1),this.preRender(ft,t),this.renderedTiles.length=0;let rt=Object.keys(nt).map(Number);rt.sort(ks);let At,bt,Dt;n.opacity===1&&(!this.containerReused||_.getOpaque(t.viewState.projection))?rt=rt.reverse():(At=[],bt=[]);for(let ct=rt.length-1;ct>=0;--ct){const at=rt[ct],Pt=_.getTilePixelSize(at,p,a),Lt=I.getResolution(at)/R,Vt=Pt[0]*Lt*Z,Ee=Pt[1]*Lt*Z,te=I.getTileCoordForCoordAndZ(Xr(q),at),me=I.getTileCoordExtent(te),Ie=Vi(this.tempTransform,[v*(me[0]-q[0])/R,v*(q[3]-me[3])/R]),Ce=v*_.getGutterForProjection(a),Ge=nt[at];for(const de in Ge){const F=Ge[de],St=F.tileCoord,Et=te[1]-St[1],et=Math.round(Ie[0]-(Et-1)*Vt),$=te[2]-St[2],lt=Math.round(Ie[1]-($-1)*Ee),vt=Math.round(Ie[0]-Et*Vt),gt=Math.round(Ie[1]-$*Ee),pt=et-vt,kt=lt-gt,Ht=S===at,Ft=Ht&&F.getAlpha(ti(this),t.time)!==1;let qt=!1;if(!Ft)if(At){Dt=[vt,gt,vt+pt,gt,vt+pt,gt+kt,vt,gt+kt];for(let ve=0,re=At.length;ve<re;++ve)if(S!==at&&at<bt[ve]){const pe=At[ve];en([vt,gt,vt+pt,gt+kt],[pe[0],pe[3],pe[4],pe[7]])&&(qt||(ft.save(),qt=!0),ft.beginPath(),ft.moveTo(Dt[0],Dt[1]),ft.lineTo(Dt[2],Dt[3]),ft.lineTo(Dt[4],Dt[5]),ft.lineTo(Dt[6],Dt[7]),ft.moveTo(pe[6],pe[7]),ft.lineTo(pe[4],pe[5]),ft.lineTo(pe[2],pe[3]),ft.lineTo(pe[0],pe[1]),ft.clip())}At.push(Dt),bt.push(at)}else ft.clearRect(vt,gt,pt,kt);this.drawTileImage(F,t,vt,gt,pt,kt,Ce,Ht),At&&!Ft?(qt&&ft.restore(),this.renderedTiles.unshift(F)):this.renderedTiles.push(F),this.updateUsedTiles(t.usedTiles,_,F)}}return this.renderedRevision=E,this.renderedResolution=R,this.extentChanged=!this.renderedExtent_||!Ia(this.renderedExtent_,q),this.renderedExtent_=q,this.renderedPixelRatio=p,this.renderedProjection=a,this.manageTilePyramid(t,_,I,p,a,D,S,y.getPreload()),this.scheduleExpireCache(t,_),this.postRender(this.context,t),n.extent&&ft.restore(),ft.imageSmoothingEnabled=!0,this.container}drawTileImage(t,e,n,s,a,l,u,c){const p=this.getTileImage(t);if(!p)return;const y=this.getRenderContext(e),_=ti(this),E=e.layerStatesArray[e.layerIndex],I=E.opacity*(c?t.getAlpha(_,e.time):1),S=I!==y.globalAlpha;S&&(y.save(),y.globalAlpha=I),y.drawImage(p,u,u,p.width-2*u,p.height-2*u,n,s,a,l),S&&y.restore(),I!==E.opacity?e.animate=!0:c&&t.endTransition(_)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const n=function(s,a,l){const u=ti(s);u in l.usedTiles&&s.expireCache(l.viewState.projection,l.usedTiles[u])}.bind(null,e);t.postRenderFunctions.push(n)}}updateUsedTiles(t,e,n){const s=ti(e);s in t||(t[s]={}),t[s][n.getKey()]=!0}manageTilePyramid(t,e,n,s,a,l,u,c,p){const y=ti(e);y in t.wantedTiles||(t.wantedTiles[y]={});const _=t.wantedTiles[y],E=t.tileQueue,I=n.getMinZoom(),S=t.viewState.rotation,R=S?xc(t.viewState.center,t.viewState.resolution,S,t.size):void 0;let D=0,T,v,k,X,H,K;for(K=I;K<=u;++K)for(v=n.getTileRangeForExtentAndZ(l,K,v),k=n.getResolution(K),X=v.minX;X<=v.maxX;++X)for(H=v.minY;H<=v.maxY;++H)S&&!n.tileCoordIntersectsViewport([K,X,H],R)||(u-K<=c?(++D,T=e.getTile(K,X,H,s,a),T.getState()==ue.IDLE&&(_[T.getKey()]=!0,E.isKeyQueued(T.getKey())||E.enqueue([T,y,n.getTileCoordCenter(T.tileCoord),k])),p!==void 0&&p(T)):e.useTile(K,X,H,a));e.updateCacheSize(D,a)}}class oE extends iE{constructor(t){super(t)}createRenderer(){return new aE(this)}}const lE=oE,Vu={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},ra=[0,0,0],tr=5;class hE{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,qe(Ux(this.resolutions_,(s,a)=>a-s,!0),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let s=0,a=this.resolutions_.length-1;s<a;++s)if(!e)e=this.resolutions_[s]/this.resolutions_[s+1];else if(this.resolutions_[s]/this.resolutions_[s+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,qe(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=t.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Xr(n)),qe(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,qe(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:Lf,qe(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((s,a)=>{const l=new Zf(Math.min(0,s[0]),Math.max(s[0]-1,-1),Math.min(0,s[1]),Math.max(s[1]-1,-1));if(n){const u=this.getTileRangeForExtentAndZ(n,a);l.minX=Math.max(u.minX,l.minX),l.maxX=Math.min(u.maxX,l.maxX),l.minY=Math.max(u.minY,l.minY),l.maxY=Math.min(u.maxY,l.maxY)}return l}):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const s=this.getTileRangeForExtentAndZ(t,e);for(let a=s.minX,l=s.maxX;a<=l;++a)for(let u=s.minY,c=s.maxY;u<=c;++u)n([e,a,u])}forEachTileCoordParentTileRange(t,e,n,s){let a,l,u,c=null,p=t[0]-1;for(this.zoomFactor_===2?(l=t[1],u=t[2]):c=this.getTileCoordExtent(t,s);p>=this.minZoom;){if(l!==void 0&&u!==void 0?(l=Math.floor(l/2),u=Math.floor(u/2),a=sa(l,l,u,u,n)):a=this.getTileRangeForExtentAndZ(c,p,n),e(p,a))return!0;--p}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const a=t[1]*2,l=t[2]*2;return sa(a,a+1,l,l+1,e)}const s=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const s=t[0],a=t[1],l=t[2];if(e===s)return sa(a,l,a,l,n);if(this.zoomFactor_){const c=Math.pow(this.zoomFactor_,e-s),p=Math.floor(a*c),y=Math.floor(l*c);if(e<s)return sa(p,p,y,y,n);const _=Math.floor(c*(a+1))-1,E=Math.floor(c*(l+1))-1;return sa(p,_,y,E,n)}const u=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(u,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,ra);const s=ra[1],a=ra[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,ra);const l=ra[1],u=ra[2];return sa(s,l,a,u,n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),s=Tn(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*s[0]*n,e[1]-(t[2]+.5)*s[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),s=this.getResolution(t[0]),a=Tn(this.getTileSize(t[0]),this.tmpSize_),l=n[0]+t[1]*a[0]*s,u=n[1]-(t[2]+1)*a[1]*s,c=l+a[0]*s,p=u+a[1]*s;return gr(l,u,c,p,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,s,a){const l=this.getZForResolution(n),u=n/this.getResolution(l),c=this.getOrigin(l),p=Tn(this.getTileSize(l),this.tmpSize_);let y=u*(t-c[0])/n/p[0],_=u*(c[1]-e)/n/p[1];return s?(y=ar(y,tr)-1,_=ar(_,tr)-1):(y=Dl(y,tr),_=Dl(_,tr)),d1(l,y,_,a)}getTileCoordForXYAndZ_(t,e,n,s,a){const l=this.getOrigin(n),u=this.getResolution(n),c=Tn(this.getTileSize(n),this.tmpSize_);let p=(t-l[0])/u/c[0],y=(l[1]-e)/u/c[1];return s?(p=ar(p,tr)-1,y=ar(y,tr)-1):(p=Dl(p,tr),y=Dl(y,tr)),d1(n,p,y,a)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const n=Ch(this.resolutions_,t,e||0);return Ei(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return I2(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let s=this.minZoom;s<e;++s)n[s]=this.getTileRangeForExtentAndZ(t,s);this.fullTileRanges_=n}}const wy=hE;function by(i){let t=i.getDefaultTileGrid();return t||(t=dE(i),i.setDefaultTileGrid(t)),t}function uE(i,t,e){const n=t[0],s=i.getTileCoordCenter(t),a=Kf(e);if(!zr(a,s)){const l=Ve(a),u=Math.ceil((a[0]-s[0])/l);return s[0]+=l*u,i.getTileCoordForCoordAndZ(s,n)}return t}function cE(i,t,e,n){n=n!==void 0?n:"top-left";const s=Ey(i,t,e);return new wy({extent:i,origin:qx(i,n),resolutions:s,tileSize:e})}function fE(i){const t=i||{},e=t.extent||li("EPSG:3857").getExtent(),n={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:Ey(e,t.maxZoom,t.tileSize,t.maxResolution)};return new wy(n)}function Ey(i,t,e,n){t=t!==void 0?t:dw,e=Tn(e!==void 0?e:Lf);const s=Oi(i),a=Ve(i);n=n>0?n:Math.max(a/e[0],s/e[1]);const l=t+1,u=new Array(l);for(let c=0;c<l;++c)u[c]=n/Math.pow(2,c);return u}function dE(i,t,e,n){const s=Kf(i);return cE(s,t,e,n)}function Kf(i){i=li(i);let t=i.getExtent();if(!t){const e=180*fo.degrees/i.getMetersPerUnit();t=gr(-e,-e,e,e)}return t}class gE extends Xf{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=t.opaque!==void 0?t.opaque:!1,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&Tn(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tileCache=new py(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}forEachLoadedTile(t,e,n,s){const a=this.getTileCacheForProjection(t);if(!a)return!1;let l=!0,u,c,p;for(let y=n.minX;y<=n.maxX;++y)for(let _=n.minY;_<=n.maxY;++_)c=Xh(e,y,_),p=!1,a.containsKey(c)&&(u=a.get(c),p=u.getState()===ue.LOADED,p&&(p=s(u)!==!1)),p||(l=!1);return l}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,s,a){return xe()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:by(t)}getTileCacheForProjection(t){const e=this.getProjection();return qe(e===null||Ns(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const s=this.getTileGridForProjection(n),a=this.getTilePixelRatio(e),l=Tn(s.getTileSize(t),this.tmpSize);return a==1?l:iw(l,a,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=e!==void 0?e:this.getProjection();const n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=uE(n,t,e)),eE(t,n)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}useTile(t,e,n,s){}}class mE extends ys{constructor(t,e){super(t),this.tile=e}}function pE(i,t){const e=/\{z\}/g,n=/\{x\}/g,s=/\{y\}/g,a=/\{-y\}/g;return function(l,u,c){if(l)return i.replace(e,l[0].toString()).replace(n,l[1].toString()).replace(s,l[2].toString()).replace(a,function(){const p=l[0],y=t.getFullTileRange(p);if(!y)throw new Error("The {-y} placeholder requires a tile grid with extent");return(y.getHeight()-l[2]-1).toString()})}}function yE(i,t){const e=i.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=pE(i[s],t);return xE(n)}function xE(i){return i.length===1?i[0]:function(t,e,n){if(!t)return;const s=tE(t),a=xa(s,i.length);return i[a](t,e,n)}}function _E(i){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(i);if(e){const n=e[1].charCodeAt(0),s=e[2].charCodeAt(0);let a;for(a=n;a<=s;++a)t.push(i.replace(e[0],String.fromCharCode(a)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(i),e){const n=parseInt(e[2],10);for(let s=parseInt(e[1],10);s<=n;s++)t.push(i.replace(e[0],s.toString()));return t}return t.push(i),t}class qf extends gE{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===qf.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=ti(e),s=e.getState();let a;s==ue.LOADING?(this.tileLoadingKeys_[n]=!0,a=Vu.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],a=s==ue.ERROR?Vu.TILELOADERROR:s==ue.LOADED?Vu.TILELOADEND:void 0),a!=null&&this.dispatchEvent(new mE(a,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=_E(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(yE(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}useTile(t,e,n){const s=Xh(t,e,n);this.tileCache.containsKey(s)&&this.tileCache.get(s)}}class wE extends qf{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:bE,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:ly,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?e:{});for(const s in this.tileCacheForProjection){const a=this.tileCacheForProjection[s];a.expireCache(a==n?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!Ns(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return this.getProjection()&&t&&!Ns(this.getProjection(),t)?!1:super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Ns(e,t)))return this.tileGrid;const n=ti(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=by(t)),this.tileGridForProjection[n]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||Ns(e,t))return this.tileCache;const n=ti(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new py(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}createTile_(t,e,n,s,a,l){const u=[t,e,n],c=this.getTileCoordForTileUrlFunction(u,a),p=c?this.tileUrlFunction(c,s,a):void 0,y=new this.tileClass(u,p!==void 0?ue.IDLE:ue.EMPTY,p!==void 0?p:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return y.key=l,y.addEventListener(_e.CHANGE,this.handleTileChange.bind(this)),y}getTile(t,e,n,s,a){const l=this.getProjection();if(!l||!a||Ns(l,a))return this.getTileInternal(t,e,n,s,l||a);const u=this.getTileCacheForProjection(a),c=[t,e,n];let p;const y=my(c);u.containsKey(y)&&(p=u.get(y));const _=this.getKey();if(p&&p.key==_)return p;const E=this.getTileGridForProjection(l),I=this.getTileGridForProjection(a),S=this.getTileCoordForTileUrlFunction(c,a),R=new Lc(l,E,a,I,c,S,this.getTilePixelRatio(s),this.getGutter(),(D,T,v,k)=>this.getTileInternal(D,T,v,k,l),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return R.key=_,p?(R.interimTile=p,R.refreshInterimChain(),u.replace(y,R)):u.set(y,R),R}getTileInternal(t,e,n,s,a){let l=null;const u=Xh(t,e,n),c=this.getKey();if(!this.tileCache.containsKey(u))l=this.createTile_(t,e,n,s,a,c),this.tileCache.set(u,l);else if(l=this.tileCache.get(u),l.key!=c){const p=l;l=this.createTile_(t,e,n,s,a,c),p.getState()==ue.IDLE?l.interimTile=p.interimTile:l.interimTile=p,l.refreshInterimChain(),this.tileCache.replace(u,l)}return l}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){const n=li(t);if(n){const s=ti(n);s in this.tileGridForProjection||(this.tileGridForProjection[s]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}function bE(i,t){i.getImage().src=t}class EE extends wE{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",n=t.tileGrid!==void 0?t.tileGrid:fE({extent:Kf(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}class Iy{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=Ur,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let n=e.dataProjection?li(e.dataProjection):this.readProjection(t);e.extent&&n&&n.getUnits()==="tile-pixels"&&(n=li(n),n.setWorldExtent(e.extent)),e={dataProjection:n,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return xe()}readFeature(t,e){return xe()}readFeatures(t,e){return xe()}readGeometry(t,e){return xe()}readProjection(t){return xe()}writeFeature(t,e){return xe()}writeFeatures(t,e){return xe()}writeGeometry(t,e){return xe()}}function Us(i,t,e){const n=e?li(e.featureProjection):null,s=e?li(e.dataProjection):null;let a=i;if(n&&s&&!Ns(n,s)){t&&(a=i.clone());const l=t?n:s,u=t?s:n;l.getUnits()==="tile-pixels"?a.transform(l,u):a.applyTransform(go(l,u))}if(t&&e&&e.decimals!==void 0){const l=Math.pow(10,e.decimals),u=function(c){for(let p=0,y=c.length;p<y;++p)c[p]=Math.round(c[p]*l)/l;return c};a===i&&(a=i.clone()),a.applyTransform(u)}return a}const IE={Point:yo,LineString:ah,Polygon:xo,MultiPoint:ry,MultiLineString:To,MultiPolygon:i3};function CE(i,t,e){return Array.isArray(t[0])?(A2(i,0,t,e)||(i=i.slice(),Cc(i,0,t,e)),i):(Rf(i,0,t,e)||(i=i.slice(),ih(i,0,t,e)),i)}function Cy(i,t){const e=i.geometry;if(!e)return[];if(Array.isArray(e))return e.map(a=>Cy({...i,geometry:a})).flat();const n=e.type==="MultiPolygon"?"Polygon":e.type;if(n==="GeometryCollection"||n==="Circle")throw new Error("Unsupported geometry type: "+n);const s=e.layout.length;return Us(new pn(n,n==="Polygon"?CE(e.flatCoordinates,e.ends,s):e.flatCoordinates,e.ends?.flat(),s,i.properties||{},i.id).enableSimplifyTransformed(),!1,t)}function $f(i,t){if(!i)return null;if(Array.isArray(i)){const n=i.map(s=>$f(s,t));return new e3(n)}const e=IE[i.type];return Us(new e(i.flatCoordinates,i.layout,i.ends),!1,t)}const p1="http://www.w3.org/2001/XMLSchema-instance";function Jf(i,t){return ll().createElementNS(i,t)}function jh(i,t){return Ay(i,t,[]).join("")}function Ay(i,t,e){if(i.nodeType==Node.CDATA_SECTION_NODE||i.nodeType==Node.TEXT_NODE)t?e.push(String(i.nodeValue).replace(/(\r\n|\r|\n)/g,"")):e.push(i.nodeValue);else{let n;for(n=i.firstChild;n;n=n.nextSibling)Ay(n,t,e)}return e}function ro(i){return"documentElement"in i}function ao(i){return new DOMParser().parseFromString(i,"application/xml")}function Gu(i,t){return function(e,n){const s=i.call(t!==void 0?t:this,e,n);s!==void 0&&n[n.length-1].push(s)}}function Ae(i,t,e){return function(n,s){const a=i.call(e!==void 0?e:this,n,s);if(a!==void 0){const l=s[s.length-1],u=t!==void 0?t:n.localName;l[u]=a}}}function Pe(i,t){return function(e,n,s){i.call(t!==void 0?t:this,e,n,s),s[s.length-1].node.appendChild(e)}}function Ry(i,t){let e,n;return function(s,a,l){if(e===void 0){e={};const u={};u[s.localName]=i,e[s.namespaceURI]=u,n=Qf(s.localName)}Sy(e,n,a,l)}}function Qf(i,t){return function(e,n,s){const l=n[n.length-1].node;let u=i;u===void 0&&(u=s);const c=t!==void 0?t:l.namespaceURI;return Jf(c,u)}}const Hh=Qf();function td(i,t){const e=t.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=i[t[s]];return n}function Di(i,t,e){e=e!==void 0?e:{};let n,s;for(n=0,s=i.length;n<s;++n)e[i[n]]=t;return e}function ed(i,t,e,n){let s;for(s=t.firstElementChild;s;s=s.nextElementSibling){const a=i[s.namespaceURI];if(a!==void 0){const l=a[s.localName];l!==void 0&&l.call(n,s,e)}}}function Gs(i,t,e,n,s){return n.push(i),ed(t,e,n,s),n.pop()}function Sy(i,t,e,n,s,a){const l=(s!==void 0?s:e).length;let u,c;for(let p=0;p<l;++p)u=e[p],u!==void 0&&(c=t.call(a!==void 0?a:this,u,n,s!==void 0?s[p]:void 0),c!==void 0&&i[c.namespaceURI][c.localName].call(a,c,u,n))}function Ba(i,t,e,n,s,a,l){return s.push(i),Sy(t,e,n,s,a,l),s.pop()}let zu;function AE(){return zu===void 0&&typeof XMLSerializer<"u"&&(zu=new XMLSerializer),zu}let Uu;function ll(){return Uu===void 0&&typeof document<"u"&&(Uu=document.implementation.createDocument("","",null)),Uu}class RE extends Iy{constructor(){super(),this.xmlSerializer_=AE()}getType(){return"xml"}readFeature(t,e){if(!t)return null;if(typeof t=="string"){const n=ao(t);return this.readFeatureFromDocument(n,e)}return ro(t)?this.readFeatureFromDocument(t,e):this.readFeatureFromNode(t,e)}readFeatureFromDocument(t,e){const n=this.readFeaturesFromDocument(t,e);return n.length>0?n[0]:null}readFeatureFromNode(t,e){return null}readFeatures(t,e){if(!t)return[];if(typeof t=="string"){const n=ao(t);return this.readFeaturesFromDocument(n,e)}return ro(t)?this.readFeaturesFromDocument(t,e):this.readFeaturesFromNode(t,e)}readFeaturesFromDocument(t,e){const n=[];for(let s=t.firstChild;s;s=s.nextSibling)s.nodeType==Node.ELEMENT_NODE&&$n(n,this.readFeaturesFromNode(s,e));return n}readFeaturesFromNode(t,e){return xe()}readGeometry(t,e){if(!t)return null;if(typeof t=="string"){const n=ao(t);return this.readGeometryFromDocument(n,e)}return ro(t)?this.readGeometryFromDocument(t,e):this.readGeometryFromNode(t,e)}readGeometryFromDocument(t,e){return null}readGeometryFromNode(t,e){return null}readProjection(t){if(!t)return null;if(typeof t=="string"){const e=ao(t);return this.readProjectionFromDocument(e)}return ro(t)?this.readProjectionFromDocument(t):this.readProjectionFromNode(t)}readProjectionFromDocument(t){return this.dataProjection}readProjectionFromNode(t){return this.dataProjection}writeFeature(t,e){const n=this.writeFeatureNode(t,e);return this.xmlSerializer_.serializeToString(n)}writeFeatureNode(t,e){return null}writeFeatures(t,e){const n=this.writeFeaturesNode(t,e);return this.xmlSerializer_.serializeToString(n)}writeFeaturesNode(t,e){return null}writeGeometry(t,e){const n=this.writeGeometryNode(t,e);return this.xmlSerializer_.serializeToString(n)}writeGeometryNode(t,e){return null}}function Yh(i){const t=jh(i,!1),e=Date.parse(t);return isNaN(e)?void 0:e/1e3}function vs(i){const t=jh(i,!1);return SE(t)}function SE(i){const t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(i);if(t)return parseFloat(t[1])}function Do(i){const t=jh(i,!1);return TE(t)}function TE(i){const t=/^\s*(\d+)\s*$/.exec(i);if(t)return parseInt(t[1],10)}function di(i){return jh(i,!1).trim()}function DE(i,t){const e=new Date(t*1e3),n=e.getUTCFullYear()+"-"+Ya(e.getUTCMonth()+1,2)+"-"+Ya(e.getUTCDate(),2)+"T"+Ya(e.getUTCHours(),2)+":"+Ya(e.getUTCMinutes(),2)+":"+Ya(e.getUTCSeconds(),2)+"Z";i.appendChild(ll().createTextNode(n))}function Mr(i,t){const e=t.toPrecision();i.appendChild(ll().createTextNode(e))}function mh(i,t){const e=t.toString();i.appendChild(ll().createTextNode(e))}function ki(i,t){i.appendChild(ll().createTextNode(t))}const ui=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],ME="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",vE={rte:Ty,trk:Dy,wpt:My},OE=Di(ui,{rte:Gu(Ty),trk:Gu(Dy),wpt:Gu(My)}),PE=Di(ui,{text:Ae(di,"linkText"),type:Ae(di,"linkType")}),NE=Di(ui,{name:Ae(di),email:oI,link:hl}),LE=Di(ui,{name:Ae(di),desc:Ae(di),author:Ae(sI),copyright:Ae(rI),link:hl,time:Ae(Yh),keywords:Ae(di),bounds:aI,extensions:Zh}),kE=Di(ui,{year:Ae(Do),license:Ae(di)}),FE=Di(ui,{rte:Pe(cI),trk:Pe(fI),wpt:Pe(gI)});class BE extends RE{constructor(t){super(),t=t||{},this.dataProjection=li("EPSG:4326"),this.readExtensions_=t.readExtensions}handleReadExtensions_(t){t||(t=[]);for(let e=0,n=t.length;e<n;++e){const s=t[e];if(this.readExtensions_){const a=s.get("extensionsNode_")||null;this.readExtensions_(s,a)}s.set("extensionsNode_",void 0)}}readMetadata(t){return t?typeof t=="string"?this.readMetadataFromDocument(ao(t)):ro(t)?this.readMetadataFromDocument(t):this.readMetadataFromNode(t):null}readMetadataFromDocument(t){for(let e=t.firstChild;e;e=e.nextSibling)if(e.nodeType===Node.ELEMENT_NODE){const n=this.readMetadataFromNode(e);if(n)return n}return null}readMetadataFromNode(t){if(!ui.includes(t.namespaceURI))return null;for(let e=t.firstElementChild;e;e=e.nextElementSibling)if(ui.includes(e.namespaceURI)&&e.localName==="metadata")return Gs({},LE,e,[]);return null}readFeatureFromNode(t,e){if(!ui.includes(t.namespaceURI))return null;const n=vE[t.localName];if(!n)return null;const s=n(t,[this.getReadOptions(t,e)]);return s?(this.handleReadExtensions_([s]),s):null}readFeaturesFromNode(t,e){if(!ui.includes(t.namespaceURI))return[];if(t.localName=="gpx"){const n=Gs([],OE,t,[this.getReadOptions(t,e)]);return n?(this.handleReadExtensions_(n),n):[]}return[]}writeFeaturesNode(t,e){e=this.adaptOptions(e);const n=Jf("http://www.topografix.com/GPX/1/1","gpx");return n.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",p1),n.setAttributeNS(p1,"xsi:schemaLocation",ME),n.setAttribute("version","1.1"),n.setAttribute("creator","OpenLayers"),Ba({node:n},FE,nI,t,[e]),n}}const VE=Di(ui,{name:Ae(di),cmt:Ae(di),desc:Ae(di),src:Ae(di),link:hl,number:Ae(Do),extensions:Zh,type:Ae(di),rtept:lI}),GE=Di(ui,{ele:Ae(vs),time:Ae(Yh)}),zE=Di(ui,{name:Ae(di),cmt:Ae(di),desc:Ae(di),src:Ae(di),link:hl,number:Ae(Do),type:Ae(di),extensions:Zh,trkseg:uI}),UE=Di(ui,{trkpt:hI}),WE=Di(ui,{ele:Ae(vs),time:Ae(Yh)}),XE=Di(ui,{ele:Ae(vs),time:Ae(Yh),magvar:Ae(vs),geoidheight:Ae(vs),name:Ae(di),cmt:Ae(di),desc:Ae(di),src:Ae(di),link:hl,sym:Ae(di),type:Ae(di),fix:Ae(di),sat:Ae(Do),hdop:Ae(vs),vdop:Ae(vs),pdop:Ae(vs),ageofdgpsdata:Ae(vs),dgpsid:Ae(Do),extensions:Zh}),jE=["text","type"],HE=Di(ui,{text:Pe(ki),type:Pe(ki)}),YE=Di(ui,["name","cmt","desc","src","link","number","type","rtept"]),ZE=Di(ui,{name:Pe(ki),cmt:Pe(ki),desc:Pe(ki),src:Pe(ki),link:Pe(sd),number:Pe(mh),type:Pe(ki),rtept:Ry(Pe(rd))}),KE=Di(ui,["ele","time"]),qE=Di(ui,["name","cmt","desc","src","link","number","type","trkseg"]),$E=Di(ui,{name:Pe(ki),cmt:Pe(ki),desc:Pe(ki),src:Pe(ki),link:Pe(sd),number:Pe(mh),type:Pe(ki),trkseg:Ry(Pe(dI))}),JE=Qf("trkpt"),QE=Di(ui,{trkpt:Pe(rd)}),tI=Di(ui,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),eI=Di(ui,{ele:Pe(Mr),time:Pe(DE),magvar:Pe(Mr),geoidheight:Pe(Mr),name:Pe(ki),cmt:Pe(ki),desc:Pe(ki),src:Pe(ki),link:Pe(sd),sym:Pe(ki),type:Pe(ki),fix:Pe(ki),sat:Pe(mh),hdop:Pe(Mr),vdop:Pe(Mr),pdop:Pe(Mr),ageofdgpsdata:Pe(Mr),dgpsid:Pe(mh)}),iI={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function nI(i,t,e){const n=i.getGeometry();if(n){const s=iI[n.getType()];if(s){const a=t[t.length-1].node;return Jf(a.namespaceURI,s)}}}function id(i,t,e,n){return i.push(parseFloat(e.getAttribute("lon")),parseFloat(e.getAttribute("lat"))),"ele"in n?(i.push(n.ele),delete n.ele,t.hasZ=!0):i.push(0),"time"in n?(i.push(n.time),delete n.time,t.hasM=!0):i.push(0),i}function nd(i,t,e){let n="XY",s=2;if(i.hasZ&&i.hasM?(n="XYZM",s=4):i.hasZ?(n="XYZ",s=3):i.hasM&&(n="XYM",s=3),s!==4){for(let a=0,l=t.length/4;a<l;a++)t[a*s]=t[a*4],t[a*s+1]=t[a*4+1],i.hasZ&&(t[a*s+2]=t[a*4+2]),i.hasM&&(t[a*s+2]=t[a*4+3]);if(t.length=t.length/4*s,e)for(let a=0,l=e.length;a<l;a++)e[a]=e[a]/4*s}return n}function sI(i,t){const e=Gs({},NE,i,t);if(e)return e}function rI(i,t){const e=Gs({},kE,i,t);if(e){const n=i.getAttribute("author");return n!==null&&(e.author=n),e}}function aI(i,t){const e=t[t.length-1],n=i.getAttribute("minlat"),s=i.getAttribute("minlon"),a=i.getAttribute("maxlat"),l=i.getAttribute("maxlon");s!==null&&n!==null&&l!==null&&a!==null&&(e.bounds=[[parseFloat(s),parseFloat(n)],[parseFloat(l),parseFloat(a)]])}function oI(i,t){const e=t[t.length-1],n=i.getAttribute("id"),s=i.getAttribute("domain");n!==null&&s!==null&&(e.email=`${n}@${s}`)}function hl(i,t){const e=t[t.length-1],n=i.getAttribute("href");n!==null&&(e.link=n),ed(PE,i,t)}function Zh(i,t){const e=t[t.length-1];e.extensionsNode_=i}function lI(i,t){const e=Gs({},GE,i,t);if(e){const n=t[t.length-1],s=n.flatCoordinates,a=n.layoutOptions;id(s,a,i,e)}}function hI(i,t){const e=Gs({},WE,i,t);if(e){const n=t[t.length-1],s=n.flatCoordinates,a=n.layoutOptions;id(s,a,i,e)}}function uI(i,t){const e=t[t.length-1];ed(UE,i,t);const n=e.flatCoordinates;e.ends.push(n.length)}function Ty(i,t){const e=t[0],n=Gs({flatCoordinates:[],layoutOptions:{}},VE,i,t);if(!n)return;const s=n.flatCoordinates;delete n.flatCoordinates;const a=n.layoutOptions;delete n.layoutOptions;const l=nd(a,s),u=new ah(s,l);Us(u,!1,e);const c=new Ur(u);return c.setProperties(n,!0),c}function Dy(i,t){const e=t[0],n=Gs({flatCoordinates:[],ends:[],layoutOptions:{}},zE,i,t);if(!n)return;const s=n.flatCoordinates;delete n.flatCoordinates;const a=n.ends;delete n.ends;const l=n.layoutOptions;delete n.layoutOptions;const u=nd(l,s,a),c=new To(s,u,a);Us(c,!1,e);const p=new Ur(c);return p.setProperties(n,!0),p}function My(i,t){const e=t[0],n=Gs({},XE,i,t);if(!n)return;const s={},a=id([],s,i,n),l=nd(s,a),u=new yo(a,l);Us(u,!1,e);const c=new Ur(u);return c.setProperties(n,!0),c}function sd(i,t,e){i.setAttribute("href",t);const s=e[e.length-1].properties,a=[s.linkText,s.linkType];Ba({node:i},HE,Hh,a,e,jE)}function rd(i,t,e){const n=e[e.length-1],a=n.node.namespaceURI,l=n.properties;switch(i.setAttributeNS(null,"lat",String(t[1])),i.setAttributeNS(null,"lon",String(t[0])),n.geometryLayout){case"XYZM":t[3]!==0&&(l.time=t[3]);case"XYZ":t[2]!==0&&(l.ele=t[2]);break;case"XYM":t[2]!==0&&(l.time=t[2]);break}const c=i.nodeName=="rtept"?KE[a]:tI[a],p=td(l,c);Ba({node:i,properties:l},eI,Hh,p,e,c)}function cI(i,t,e){const n=e[0],s=t.getProperties(),a={node:i};a.properties=s;const l=t.getGeometry();if(l.getType()=="LineString"){const y=Us(l,!0,n);a.geometryLayout=y.getLayout(),s.rtept=y.getCoordinates()}const u=e[e.length-1].node,c=YE[u.namespaceURI],p=td(s,c);Ba(a,ZE,Hh,p,e,c)}function fI(i,t,e){const n=e[0],s=t.getProperties(),a={node:i};a.properties=s;const l=t.getGeometry();if(l.getType()=="MultiLineString"){const y=Us(l,!0,n);s.trkseg=y.getLineStrings()}const u=e[e.length-1].node,c=qE[u.namespaceURI],p=td(s,c);Ba(a,$E,Hh,p,e,c)}function dI(i,t,e){const n={node:i};n.geometryLayout=t.getLayout(),n.properties={},Ba(n,QE,JE,t.getCoordinates(),e)}function gI(i,t,e){const n=e[0],s=e[e.length-1];s.properties=t.getProperties();const a=t.getGeometry();if(a.getType()=="Point"){const l=Us(a,!0,n);s.geometryLayout=l.getLayout(),rd(i,l.getCoordinates(),e)}}class mI extends Iy{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Fl(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Fl(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return xe()}readFeaturesFromObject(t,e){return xe()}readGeometry(t,e){return this.readGeometryFromObject(Fl(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return xe()}readProjection(t){return this.readProjectionFromObject(Fl(t))}readProjectionFromObject(t){return xe()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return xe()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return xe()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return xe()}}function Fl(i){if(typeof i=="string"){const t=JSON.parse(i);return t||null}return i!==null?i:null}class y1 extends mI{constructor(t){t=t||{},super(),this.dataProjection=li(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=li(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let n=null;t.type==="Feature"?n=t:n={type:"Feature",geometry:t,properties:null};const s=ad(n.geometry);if(this.featureClass===pn)return Cy({geometry:s,id:n.id,properties:n.properties},e);const a=new Ur;return this.geometryName_?a.setGeometryName(this.geometryName_):this.extractGeometryName_&&n.geometry_name&&a.setGeometryName(n.geometry_name),a.setGeometry($f(s,e)),"id"in n&&a.setId(n.id),n.properties&&a.setProperties(n.properties,!0),a}readFeaturesFromObject(t,e){const n=t;let s=null;if(n.type==="FeatureCollection"){const a=t;s=[];const l=a.features;for(let u=0,c=l.length;u<c;++u){const p=this.readFeatureFromObject(l[u],e);p&&s.push(p)}}else s=[this.readFeatureFromObject(t,e)];return s.flat()}readGeometryFromObject(t,e){return pI(t,e)}readProjectionFromObject(t){const e=t.crs;let n;if(e)if(e.type=="name")n=li(e.properties.name);else if(e.type==="EPSG")n=li("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else n=this.dataProjection;return n}writeFeatureObject(t,e){e=this.adaptOptions(e);const n={type:"Feature",geometry:null,properties:null},s=t.getId();if(s!==void 0&&(n.id=s),!t.hasProperties())return n;const a=t.getProperties(),l=t.getGeometry();return l&&(n.geometry=kc(l,e),delete a[t.getGeometryName()]),Gr(a)||(n.properties=a),n}writeFeaturesObject(t,e){e=this.adaptOptions(e);const n=[];for(let s=0,a=t.length;s<a;++s)n.push(this.writeFeatureObject(t[s],e));return{type:"FeatureCollection",features:n}}writeGeometryObject(t,e){return kc(t,this.adaptOptions(e))}}function ad(i,t){if(!i)return null;let e;switch(i.type){case"Point":{e=xI(i);break}case"LineString":{e=_I(i);break}case"Polygon":{e=II(i);break}case"MultiPoint":{e=bI(i);break}case"MultiLineString":{e=wI(i);break}case"MultiPolygon":{e=EI(i);break}case"GeometryCollection":{e=yI(i);break}default:throw new Error("Unsupported GeoJSON type: "+i.type)}return e}function pI(i,t){const e=ad(i);return $f(e,t)}function yI(i,t){return i.geometries.map(function(n){return ad(n)})}function xI(i){const t=i.coordinates;return{type:"Point",flatCoordinates:t,layout:Hr(t.length)}}function _I(i){const t=i.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:Hr(t[0]?.length||2)}}function wI(i){const t=i.coordinates,e=t[0]?.[0]?.length||2,n=[],s=el(n,0,t,e);return{type:"MultiLineString",flatCoordinates:n,ends:s,layout:Hr(e)}}function bI(i){const t=i.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:Hr(t[0]?.length||2)}}function EI(i){const t=i.coordinates,e=[],n=t[0]?.[0]?.[0].length||2,s=p2(e,0,t,n);return{type:"MultiPolygon",flatCoordinates:e,ends:s,layout:Hr(n)}}function II(i){const t=i.coordinates,e=[],n=t[0]?.[0]?.length,s=el(e,0,t,n);return{type:"Polygon",flatCoordinates:e,ends:s,layout:Hr(n)}}function kc(i,t){i=Us(i,!0,t);const e=i.getType();let n;switch(e){case"Point":{n=DI(i);break}case"LineString":{n=AI(i);break}case"Polygon":{n=MI(i,t);break}case"MultiPoint":{n=SI(i);break}case"MultiLineString":{n=RI(i);break}case"MultiPolygon":{n=TI(i,t);break}case"GeometryCollection":{n=CI(i,t);break}case"Circle":{n={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return n}function CI(i,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:i.getGeometriesArray().map(function(n){return kc(n,t)})}}function AI(i,t){return{type:"LineString",coordinates:i.getCoordinates()}}function RI(i,t){return{type:"MultiLineString",coordinates:i.getCoordinates()}}function SI(i,t){return{type:"MultiPoint",coordinates:i.getCoordinates()}}function TI(i,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:i.getCoordinates(e)}}function DI(i,t){return{type:"Point",coordinates:i.getCoordinates()}}function MI(i,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:i.getCoordinates(e)}}var hn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function od(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var vy={exports:{}};(function(i,t){(function(e,n){i.exports=n()})(hn,function(){function e(g,b){if(g[b])return g[b];for(var C,P=Object.keys(g),M=b.toLowerCase().replace(ei,""),G=-1;++G<P.length;)if(C=P[G],C.toLowerCase().replace(ei,"")===M)return g[C]}function n(g){if(typeof g!="string")throw new Error("not a string");this.text=g.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=gi}function s(g){return new n(g).output()}function a(g,b,C){Array.isArray(b)&&(C.unshift(b),b=null);var P=b?{}:g,M=C.reduce(function(G,W){return l(W,G),G},P);b&&(g[b]=M)}function l(g,b){if(Array.isArray(g)){var C=g.shift();if(C==="PARAMETER"&&(C=g.shift()),g.length===1)return Array.isArray(g[0])?(b[C]={},void l(g[0],b[C])):void(b[C]=g[0]);if(g.length)if(C!=="TOWGS84"){if(C==="AXIS")return C in b||(b[C]=[]),void b[C].push(g);Array.isArray(C)||(b[C]={});var P;switch(C){case"UNIT":case"PRIMEM":case"VERT_DATUM":return b[C]={name:g[0].toLowerCase(),convert:g[1]},void(g.length===3&&l(g[2],b[C]));case"SPHEROID":case"ELLIPSOID":return b[C]={name:g[0],a:g[1],rf:g[2]},void(g.length===4&&l(g[3],b[C]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return g[0]=["name",g[0]],void a(b,C,g);default:for(P=-1;++P<g.length;)if(!Array.isArray(g[P]))return l(g,b[C]);return a(b,C,g)}}else b[C]=g;else b[C]=!0}else b[g]=!0}function u(g,b){var C=b[0],P=b[1];!(C in g)&&P in g&&(g[C]=g[P],b.length===3&&(g[C]=b[2](g[C])))}function c(g){return g*js}function p(g){function b(U){return U*(g.to_meter||1)}if(g.type==="GEOGCS"?g.projName="longlat":g.type==="LOCAL_CS"?(g.projName="identity",g.local=!0):typeof g.PROJECTION=="object"?g.projName=Object.keys(g.PROJECTION)[0]:g.projName=g.PROJECTION,g.AXIS){for(var C="",P=0,M=g.AXIS.length;P<M;++P){var G=[g.AXIS[P][0].toLowerCase(),g.AXIS[P][1].toLowerCase()];G[0].indexOf("north")!==-1||(G[0]==="y"||G[0]==="lat")&&G[1]==="north"?C+="n":G[0].indexOf("south")!==-1||(G[0]==="y"||G[0]==="lat")&&G[1]==="south"?C+="s":G[0].indexOf("east")!==-1||(G[0]==="x"||G[0]==="lon")&&G[1]==="east"?C+="e":G[0].indexOf("west")===-1&&(G[0]!=="x"&&G[0]!=="lon"||G[1]!=="west")||(C+="w")}C.length===2&&(C+="u"),C.length===3&&(g.axis=C)}g.UNIT&&(g.units=g.UNIT.name.toLowerCase(),g.units==="metre"&&(g.units="meter"),g.UNIT.convert&&(g.type==="GEOGCS"?g.DATUM&&g.DATUM.SPHEROID&&(g.to_meter=g.UNIT.convert*g.DATUM.SPHEROID.a):g.to_meter=g.UNIT.convert));var W=g.GEOGCS;g.type==="GEOGCS"&&(W=g),W&&(W.DATUM?g.datumCode=W.DATUM.name.toLowerCase():g.datumCode=W.name.toLowerCase(),g.datumCode.slice(0,2)==="d_"&&(g.datumCode=g.datumCode.slice(2)),g.datumCode!=="new_zealand_geodetic_datum_1949"&&g.datumCode!=="new_zealand_1949"||(g.datumCode="nzgd49"),g.datumCode!=="wgs_1984"&&g.datumCode!=="world_geodetic_system_1984"||(g.PROJECTION==="Mercator_Auxiliary_Sphere"&&(g.sphere=!0),g.datumCode="wgs84"),g.datumCode.slice(-6)==="_ferro"&&(g.datumCode=g.datumCode.slice(0,-6)),g.datumCode.slice(-8)==="_jakarta"&&(g.datumCode=g.datumCode.slice(0,-8)),~g.datumCode.indexOf("belge")&&(g.datumCode="rnb72"),W.DATUM&&W.DATUM.SPHEROID&&(g.ellps=W.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),g.ellps.toLowerCase().slice(0,13)==="international"&&(g.ellps="intl"),g.a=W.DATUM.SPHEROID.a,g.rf=parseFloat(W.DATUM.SPHEROID.rf,10)),W.DATUM&&W.DATUM.TOWGS84&&(g.datum_params=W.DATUM.TOWGS84),~g.datumCode.indexOf("osgb_1936")&&(g.datumCode="osgb36"),~g.datumCode.indexOf("osni_1952")&&(g.datumCode="osni52"),(~g.datumCode.indexOf("tm65")||~g.datumCode.indexOf("geodetic_datum_of_1965"))&&(g.datumCode="ire65"),g.datumCode==="ch1903+"&&(g.datumCode="ch1903"),~g.datumCode.indexOf("israel")&&(g.datumCode="isr93")),g.b&&!isFinite(g.b)&&(g.b=g.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",c],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",c],["x0","false_easting",b],["y0","false_northing",b],["long0","central_meridian",c],["lat0","latitude_of_origin",c],["lat0","standard_parallel_1",c],["lat1","standard_parallel_1",c],["lat2","standard_parallel_2",c],["azimuth","Azimuth"],["alpha","azimuth",c],["srsCode","name"]].forEach(function(U){return u(g,U)}),g.long0||!g.longc||g.projName!=="Albers_Conic_Equal_Area"&&g.projName!=="Lambert_Azimuthal_Equal_Area"||(g.long0=g.longc),g.lat_ts||!g.lat1||g.projName!=="Stereographic_South_Pole"&&g.projName!=="Polar Stereographic (variant B)"?!g.lat_ts&&g.lat0&&g.projName==="Polar_Stereographic"&&(g.lat_ts=g.lat0,g.lat0=c(g.lat0>0?90:-90)):(g.lat0=c(g.lat1>0?90:-90),g.lat_ts=g.lat1)}function y(g){var b=this;if(arguments.length===2){var C=arguments[1];typeof C=="string"?C.charAt(0)==="+"?y[g]=je(arguments[1]):y[g]=Ir(arguments[1]):y[g]=C}else if(arguments.length===1){if(Array.isArray(g))return g.map(function(P){Array.isArray(P)?y.apply(b,P):y(P)});if(typeof g=="string"){if(g in y)return y[g]}else"EPSG"in g?y["EPSG:"+g.EPSG]=g:"ESRI"in g?y["ESRI:"+g.ESRI]=g:"IAU2000"in g?y["IAU2000:"+g.IAU2000]=g:console.log(g);return}}function _(g){return typeof g=="string"}function E(g){return g in y}function I(g){return Zr.some(function(b){return g.indexOf(b)>-1})}function S(g){var b=e(g,"authority");if(b){var C=e(b,"epsg");return C&&On.indexOf(C)>-1}}function R(g){var b=e(g,"extension");if(b)return e(b,"proj4")}function D(g){return g[0]==="+"}function T(g){if(!_(g))return g;if(E(g))return y[g];if(I(g)){var b=Ir(g);if(S(b))return y["EPSG:3857"];var C=R(b);return C?je(C):b}return D(g)?je(g):void 0}function v(g){return g}function k(g,b){var C=Nt.length;return g.names?(Nt[C]=g,g.names.forEach(function(P){Ys[P.toLowerCase()]=C}),this):(console.log(b),!0)}function X(g,b,C,P){var M=g*g,G=b*b,W=(M-G)/M,U=0;return P?(M=(g*=1-W*(Ii+W*(an+W*Er)))*g,W=0):U=Math.sqrt(W),{es:W,e:U,ep2:(M-G)/G}}function H(g,b,C,P,M){if(!g){var G=e(Qt,P);G||(G=Zs),g=G.a,b=G.b,C=G.rf}return C&&!b&&(b=(1-1/C)*g),(C===0||Math.abs(g-b)<Ut)&&(M=!0,b=g),{a:g,b,rf:C,sphere:M}}function K(g,b,C,P,M,G,W){var U={};return U.datum_type=g===void 0||g==="none"?vn:bn,b&&(U.datum_params=b.map(parseFloat),U.datum_params[0]===0&&U.datum_params[1]===0&&U.datum_params[2]===0||(U.datum_type=He),U.datum_params.length>3&&(U.datum_params[3]===0&&U.datum_params[4]===0&&U.datum_params[5]===0&&U.datum_params[6]===0||(U.datum_type=ye,U.datum_params[3]*=un,U.datum_params[4]*=un,U.datum_params[5]*=un,U.datum_params[6]=U.datum_params[6]/1e6+1))),W&&(U.datum_type=ze,U.grids=W),U.a=C,U.b=P,U.es=M,U.ep2=G,U}function z(g){return g===void 0?null:g.split(",").map(q)}function q(g){if(g.length===0)return null;var b=g[0]==="@";return b&&(g=g.slice(1)),g==="null"?{name:"null",mandatory:!b,grid:null,isNull:!0}:{name:g,mandatory:!b,grid:Ye[g]||null,isNull:!1}}function V(g){return g/3600*Math.PI/180}function nt(g){var b=g.getInt32(8,!1);return b!==11&&((b=g.getInt32(8,!0))!==11&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}function ot(g,b){return{nFields:g.getInt32(8,b),nSubgridFields:g.getInt32(24,b),nSubgrids:g.getInt32(40,b),shiftType:j(g,56,64).trim(),fromSemiMajorAxis:g.getFloat64(120,b),fromSemiMinorAxis:g.getFloat64(136,b),toSemiMajorAxis:g.getFloat64(152,b),toSemiMinorAxis:g.getFloat64(168,b)}}function j(g,b,C){return String.fromCharCode.apply(null,new Uint8Array(g.buffer.slice(b,C)))}function tt(g,b,C){for(var P=176,M=[],G=0;G<b.nSubgrids;G++){var W=Z(g,P,C),U=ft(g,P,W,C),it=Math.round(1+(W.upperLongitude-W.lowerLongitude)/W.longitudeInterval),st=Math.round(1+(W.upperLatitude-W.lowerLatitude)/W.latitudeInterval);M.push({ll:[V(W.lowerLongitude),V(W.lowerLatitude)],del:[V(W.longitudeInterval),V(W.latitudeInterval)],lim:[it,st],count:W.gridNodeCount,cvs:N(U)}),P+=176+16*W.gridNodeCount}return M}function N(g){return g.map(function(b){return[V(b.longitudeShift),V(b.latitudeShift)]})}function Z(g,b,C){return{name:j(g,b+8,b+16).trim(),parent:j(g,b+24,b+24+8).trim(),lowerLatitude:g.getFloat64(b+72,C),upperLatitude:g.getFloat64(b+88,C),lowerLongitude:g.getFloat64(b+104,C),upperLongitude:g.getFloat64(b+120,C),latitudeInterval:g.getFloat64(b+136,C),longitudeInterval:g.getFloat64(b+152,C),gridNodeCount:g.getInt32(b+168,C)}}function ft(g,b,C,P){for(var M=b+176,G=[],W=0;W<C.gridNodeCount;W++){var U={latitudeShift:g.getFloat32(M+16*W,P),longitudeShift:g.getFloat32(M+16*W+4,P),latitudeAccuracy:g.getFloat32(M+16*W+8,P),longitudeAccuracy:g.getFloat32(M+16*W+12,P)};G.push(U)}return G}function rt(g,b){if(!(this instanceof rt))return new rt(g);b=b||function(st){if(st)throw st};var C=T(g);if(typeof C=="object"){var P=rt.projections.get(C.projName);if(P){if(C.datumCode&&C.datumCode!=="none"){var M=e(Ai,C.datumCode);M&&(C.datum_params=C.datum_params||(M.towgs84?M.towgs84.split(","):null),C.ellps=M.ellipse,C.datumName=M.datumName?M.datumName:C.datumCode)}C.k0=C.k0||1,C.axis=C.axis||"enu",C.ellps=C.ellps||"wgs84",C.lat1=C.lat1||C.lat0;var G=H(C.a,C.b,C.rf,C.ellps,C.sphere),W=X(G.a,G.b,G.rf,C.R_A),U=z(C.nadgrids),it=C.datum||K(C.datumCode,C.datum_params,G.a,G.b,W.es,W.ep2,U);ml(this,C),ml(this,P),this.a=G.a,this.b=G.b,this.rf=G.rf,this.sphere=G.sphere,this.es=W.es,this.e=W.e,this.ep2=W.ep2,this.datum=it,this.init(),b(null,this)}else b(g)}else b(g)}function At(g,b){return g.datum_type===b.datum_type&&!(g.a!==b.a||Math.abs(g.es-b.es)>5e-11)&&(g.datum_type===He?g.datum_params[0]===b.datum_params[0]&&g.datum_params[1]===b.datum_params[1]&&g.datum_params[2]===b.datum_params[2]:g.datum_type!==ye||g.datum_params[0]===b.datum_params[0]&&g.datum_params[1]===b.datum_params[1]&&g.datum_params[2]===b.datum_params[2]&&g.datum_params[3]===b.datum_params[3]&&g.datum_params[4]===b.datum_params[4]&&g.datum_params[5]===b.datum_params[5]&&g.datum_params[6]===b.datum_params[6])}function bt(g,b,C){var P,M,G,W,U=g.x,it=g.y,st=g.z?g.z:0;if(it<-Tt&&it>-1.001*Tt)it=-Tt;else if(it>Tt&&it<1.001*Tt)it=Tt;else{if(it<-Tt)return{x:-1/0,y:-1/0,z:g.z};if(it>Tt)return{x:1/0,y:1/0,z:g.z}}return U>Math.PI&&(U-=2*Math.PI),M=Math.sin(it),W=Math.cos(it),G=M*M,P=C/Math.sqrt(1-b*G),{x:(P+st)*W*Math.cos(U),y:(P+st)*W*Math.sin(U),z:(P*(1-b)+st)*M}}function Dt(g,b,C,P){var M,G,W,U,it,st,dt,wt,Mt,Gt,Rt,Yt,L,r,o,h,f=g.x,d=g.y,m=g.z?g.z:0;if(M=Math.sqrt(f*f+d*d),G=Math.sqrt(f*f+d*d+m*m),M/C<1e-12){if(r=0,G/C<1e-12)return o=Tt,h=-P,{x:g.x,y:g.y,z:g.z}}else r=Math.atan2(d,f);W=m/G,wt=(U=M/G)*(1-b)*(it=1/Math.sqrt(1-b*(2-b)*U*U)),Mt=W*it,L=0;do L++,st=b*(dt=C/Math.sqrt(1-b*Mt*Mt))/(dt+(h=M*wt+m*Mt-dt*(1-b*Mt*Mt))),Yt=(Rt=W*(it=1/Math.sqrt(1-st*(2-st)*U*U)))*wt-(Gt=U*(1-st)*it)*Mt,wt=Gt,Mt=Rt;while(Yt*Yt>1e-24&&L<30);return o=Math.atan(Rt/Math.abs(Gt)),{x:r,y:o,z:h}}function ct(g,b,C){if(b===He)return{x:g.x+C[0],y:g.y+C[1],z:g.z+C[2]};if(b===ye){var P=C[0],M=C[1],G=C[2],W=C[3],U=C[4],it=C[5],st=C[6];return{x:st*(g.x-it*g.y+U*g.z)+P,y:st*(it*g.x+g.y-W*g.z)+M,z:st*(-U*g.x+W*g.y+g.z)+G}}}function at(g,b,C){if(b===He)return{x:g.x-C[0],y:g.y-C[1],z:g.z-C[2]};if(b===ye){var P=C[0],M=C[1],G=C[2],W=C[3],U=C[4],it=C[5],st=C[6],dt=(g.x-P)/st,wt=(g.y-M)/st,Mt=(g.z-G)/st;return{x:dt+it*wt-U*Mt,y:-it*dt+wt+W*Mt,z:U*dt-W*wt+Mt}}}function Pt(g){return g===He||g===ye}function mt(g,b,C){if(g.grids===null||g.grids.length===0)return console.log("Grid shift grids not found"),-1;var P={x:-C.x,y:C.y},M={x:Number.NaN,y:Number.NaN},G=[];t:for(var W=0;W<g.grids.length;W++){var U=g.grids[W];if(G.push(U.name),U.isNull){M=P;break}if(U.grid!==null)for(var it=U.grid.subgrids,st=0,dt=it.length;st<dt;st++){var wt=it[st],Mt=(Math.abs(wt.del[1])+Math.abs(wt.del[0]))/1e4,Gt=wt.ll[0]-Mt,Rt=wt.ll[1]-Mt,Yt=wt.ll[0]+(wt.lim[0]-1)*wt.del[0]+Mt,L=wt.ll[1]+(wt.lim[1]-1)*wt.del[1]+Mt;if(!(Rt>P.y||Gt>P.x||L<P.y||Yt<P.x)&&(M=Lt(P,b,wt),!isNaN(M.x)))break t}else if(U.mandatory)return console.log("Unable to find mandatory grid '"+U.name+"'"),-1}return isNaN(M.x)?(console.log("Failed to find a grid shift table for location '"+-P.x*Ue+" "+P.y*Ue+" tried: '"+G+"'"),-1):(C.x=-M.x,C.y=M.y,0)}function Lt(g,b,C){var P={x:Number.NaN,y:Number.NaN};if(isNaN(g.x))return P;var M={x:g.x,y:g.y};M.x-=C.ll[0],M.y-=C.ll[1],M.x=Kt(M.x-Math.PI)+Math.PI;var G=Vt(M,C);if(b){if(isNaN(G.x))return P;G.x=M.x-G.x,G.y=M.y-G.y;var W,U,it=9;do{if(U=Vt(G,C),isNaN(U.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}W={x:M.x-(U.x+G.x),y:M.y-(U.y+G.y)},G.x+=W.x,G.y+=W.y}while(it--&&Math.abs(W.x)>1e-12&&Math.abs(W.y)>1e-12);if(it<0)return console.log("Inverse grid shift iterator failed to converge."),P;P.x=Kt(G.x+C.ll[0]),P.y=G.y+C.ll[1]}else isNaN(G.x)||(P.x=g.x+G.x,P.y=g.y+G.y);return P}function Vt(g,b){var C,P={x:g.x/b.del[0],y:g.y/b.del[1]},M={x:Math.floor(P.x),y:Math.floor(P.y)},G={x:P.x-1*M.x,y:P.y-1*M.y},W={x:Number.NaN,y:Number.NaN};if(M.x<0||M.x>=b.lim[0]||M.y<0||M.y>=b.lim[1])return W;C=M.y*b.lim[0]+M.x;var U={x:b.cvs[C][0],y:b.cvs[C][1]};C++;var it={x:b.cvs[C][0],y:b.cvs[C][1]};C+=b.lim[0];var st={x:b.cvs[C][0],y:b.cvs[C][1]};C--;var dt={x:b.cvs[C][0],y:b.cvs[C][1]},wt=G.x*G.y,Mt=G.x*(1-G.y),Gt=(1-G.x)*(1-G.y),Rt=(1-G.x)*G.y;return W.x=Gt*U.x+Mt*it.x+Rt*dt.x+wt*st.x,W.y=Gt*U.y+Mt*it.y+Rt*dt.y+wt*st.y,W}function Ee(g){if(typeof Number.isFinite=="function"){if(Number.isFinite(g))return;throw new TypeError("coordinates must be finite numbers")}if(typeof g!="number"||g!==g||!isFinite(g))throw new TypeError("coordinates must be finite numbers")}function te(g,b){return(g.datum.datum_type===He||g.datum.datum_type===ye||g.datum.datum_type===ze)&&b.datumCode!=="WGS84"||(b.datum.datum_type===He||b.datum.datum_type===ye||b.datum.datum_type===ze)&&g.datumCode!=="WGS84"}function me(g,b,C,P){var M,G=(C=Array.isArray(C)?Kr(C):{x:C.x,y:C.y,z:C.z,m:C.m}).z!==void 0;if(za(C),g.datum&&b.datum&&te(g,b)&&(C=me(g,M=new rt("WGS84"),C,P),g=M),P&&g.axis!=="enu"&&(C=Ne(g,!1,C)),g.projName==="longlat")C={x:C.x*Xe,y:C.y*Xe,z:C.z||0};else if(g.to_meter&&(C={x:C.x*g.to_meter,y:C.y*g.to_meter,z:C.z||0}),!(C=g.inverse(C)))return;if(g.from_greenwich&&(C.x+=g.from_greenwich),C=Ze(g.datum,b.datum,C))return b.from_greenwich&&(C={x:C.x-b.from_greenwich,y:C.y,z:C.z||0}),b.projName==="longlat"?C={x:C.x*Ue,y:C.y*Ue,z:C.z||0}:(C=b.forward(C),b.to_meter&&(C={x:C.x/b.to_meter,y:C.y/b.to_meter,z:C.z||0})),P&&b.axis!=="enu"?Ne(b,!0,C):(C&&!G&&delete C.z,C)}function Ie(g,b,C,P){var M,G,W;return Array.isArray(C)?(M=me(g,b,C,P)||{x:NaN,y:NaN},C.length>2?g.name!==void 0&&g.name==="geocent"||b.name!==void 0&&b.name==="geocent"?typeof M.z=="number"?[M.x,M.y,M.z].concat(C.splice(3)):[M.x,M.y,C[2]].concat(C.splice(3)):[M.x,M.y].concat(C.splice(2)):[M.x,M.y]):(G=me(g,b,C,P),(W=Object.keys(C)).length===2||W.forEach(function(U){if(g.name!==void 0&&g.name==="geocent"||b.name!==void 0&&b.name==="geocent"){if(U==="x"||U==="y"||U==="z")return}else if(U==="x"||U==="y")return;G[U]=C[U]}),G)}function Ce(g){return g instanceof rt?g:g.oProj?g.oProj:rt(g)}function Ge(g,b,C){g=Ce(g);var P,M=!1;return b===void 0?(b=g,g=qr,M=!0):(b.x!==void 0||Array.isArray(b))&&(C=b,b=g,g=qr,M=!0),b=Ce(b),C?Ie(g,b,C):(P={forward:function(G,W){return Ie(g,b,G,W)},inverse:function(G,W){return Ie(b,g,G,W)}},M&&(P.oProj=b),P)}function de(g,b){return b=b||5,vt(et({lat:g[1],lon:g[0]}),b)}function F(g){var b=$(Ht(g.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat]:[(b.left+b.right)/2,(b.top+b.bottom)/2]}function St(g){return g*(Math.PI/180)}function Et(g){return g/Math.PI*180}function et(g){var b,C,P,M,G,W,U=g.lat,it=g.lon,st=6378137,dt=St(U),wt=St(it);W=Math.floor((it+180)/6)+1,it===180&&(W=60),U>=56&&U<64&&it>=3&&it<12&&(W=32),U>=72&&U<84&&(it>=0&&it<9?W=31:it>=9&&it<21?W=33:it>=21&&it<33?W=35:it>=33&&it<42&&(W=37)),G=St(6*(W-1)-180+3),b=st/Math.sqrt(1-.00669438*Math.sin(dt)*Math.sin(dt)),C=Math.tan(dt)*Math.tan(dt),P=.006739496752268451*Math.cos(dt)*Math.cos(dt);var Mt=.9996*b*((M=Math.cos(dt)*(wt-G))+(1-C+P)*M*M*M/6+(5-18*C+C*C+72*P-.39089081163157013)*M*M*M*M*M/120)+5e5,Gt=.9996*(st*(.9983242984503243*dt-.002514607064228144*Math.sin(2*dt)+2639046602129982e-21*Math.sin(4*dt)-3418046101696858e-24*Math.sin(6*dt))+b*Math.tan(dt)*(M*M/2+(5-C+9*P+4*P*P)*M*M*M*M/24+(61-58*C+C*C+600*P-2.2240339282485886)*M*M*M*M*M*M/720));return U<0&&(Gt+=1e7),{northing:Math.round(Gt),easting:Math.round(Mt),zoneNumber:W,zoneLetter:lt(U)}}function $(g){var b=g.northing,C=g.easting,P=g.zoneLetter,M=g.zoneNumber;if(M<0||M>60)return null;var G,W,U,it,st,dt,wt,Mt,Gt=6378137,Rt=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),Yt=C-5e5,L=b;P<"N"&&(L-=1e7),dt=6*(M-1)-180+3,Mt=(wt=L/.9996/6367449145945056e-9)+(3*Rt/2-27*Rt*Rt*Rt/32)*Math.sin(2*wt)+(21*Rt*Rt/16-55*Rt*Rt*Rt*Rt/32)*Math.sin(4*wt)+151*Rt*Rt*Rt/96*Math.sin(6*wt),G=Gt/Math.sqrt(1-.00669438*Math.sin(Mt)*Math.sin(Mt)),W=Math.tan(Mt)*Math.tan(Mt),U=.006739496752268451*Math.cos(Mt)*Math.cos(Mt),it=.99330562*Gt/Math.pow(1-.00669438*Math.sin(Mt)*Math.sin(Mt),1.5),st=Yt/(.9996*G);var r=Mt-G*Math.tan(Mt)/it*(st*st/2-(5+3*W+10*U-4*U*U-.06065547077041606)*st*st*st*st/24+(61+90*W+298*U+45*W*W-1.6983531815716497-3*U*U)*st*st*st*st*st*st/720);r=Et(r);var o=(st-(1+2*W+U)*st*st*st/6+(5-2*U+28*W-3*U*U+.05391597401814761+24*W*W)*st*st*st*st*st/120)/Math.cos(Mt);o=dt+Et(o);var h;if(g.accuracy){var f=$({northing:g.northing+g.accuracy,easting:g.easting+g.accuracy,zoneLetter:g.zoneLetter,zoneNumber:g.zoneNumber});h={top:f.lat,right:f.lon,bottom:r,left:o}}else h={lat:r,lon:o};return h}function lt(g){var b="Z";return 84>=g&&g>=72?b="X":72>g&&g>=64?b="W":64>g&&g>=56?b="V":56>g&&g>=48?b="U":48>g&&g>=40?b="T":40>g&&g>=32?b="S":32>g&&g>=24?b="R":24>g&&g>=16?b="Q":16>g&&g>=8?b="P":8>g&&g>=0?b="N":0>g&&g>=-8?b="M":-8>g&&g>=-16?b="L":-16>g&&g>=-24?b="K":-24>g&&g>=-32?b="J":-32>g&&g>=-40?b="H":-40>g&&g>=-48?b="G":-48>g&&g>=-56?b="F":-56>g&&g>=-64?b="E":-64>g&&g>=-72?b="D":-72>g&&g>=-80&&(b="C"),b}function vt(g,b){var C="00000"+g.easting,P="00000"+g.northing;return g.zoneNumber+g.zoneLetter+gt(g.easting,g.northing,g.zoneNumber)+C.substr(C.length-5,b)+P.substr(P.length-5,b)}function gt(g,b,C){var P=pt(C);return kt(Math.floor(g/1e5),Math.floor(b/1e5)%20,P)}function pt(g){var b=g%xi;return b===0&&(b=xi),b}function kt(g,b,C){var P=C-1,M=Un.charCodeAt(P),G=pl.charCodeAt(P),W=M+g-1,U=G+b,it=!1;return W>$e&&(W=W-$e+si-1,it=!0),(W===mi||M<mi&&W>mi||(W>mi||M<mi)&&it)&&W++,(W===cn||M<cn&&W>cn||(W>cn||M<cn)&&it)&&++W===mi&&W++,W>$e&&(W=W-$e+si-1),U>Nn?(U=U-Nn+si-1,it=!0):it=!1,(U===mi||G<mi&&U>mi||(U>mi||G<mi)&&it)&&U++,(U===cn||G<cn&&U>cn||(U>cn||G<cn)&&it)&&++U===mi&&U++,U>Nn&&(U=U-Nn+si-1),String.fromCharCode(W)+String.fromCharCode(U)}function Ht(g){if(g&&g.length===0)throw"MGRSPoint coverting from nothing";for(var b,C=g.length,P=null,M="",G=0;!/[A-Z]/.test(b=g.charAt(G));){if(G>=2)throw"MGRSPoint bad conversion from: "+g;M+=b,G++}var W=parseInt(M,10);if(G===0||G+3>C)throw"MGRSPoint bad conversion from: "+g;var U=g.charAt(G++);if(U<="A"||U==="B"||U==="Y"||U>="Z"||U==="I"||U==="O")throw"MGRSPoint zone letter "+U+" not handled: "+g;P=g.substring(G,G+=2);for(var it=pt(W),st=Ft(P.charAt(0),it),dt=qt(P.charAt(1),it);dt<ve(U);)dt+=2e6;var wt=C-G;if(wt%2!=0)throw`MGRSPoint has to have an even number 
of digits after the zone letter and two 100km letters - front 
half for easting meters, second half for 
northing meters`+g;var Mt,Gt,Rt,Yt,L,r=wt/2,o=0,h=0;return r>0&&(Mt=1e5/Math.pow(10,r),Gt=g.substring(G,G+r),o=parseFloat(Gt)*Mt,Rt=g.substring(G+r),h=parseFloat(Rt)*Mt),Yt=o+st,L=h+dt,{easting:Yt,northing:L,zoneLetter:U,zoneNumber:W,accuracy:Mt}}function Ft(g,b){for(var C=Un.charCodeAt(b-1),P=1e5,M=!1;C!==g.charCodeAt(0);){if(++C===mi&&C++,C===cn&&C++,C>$e){if(M)throw"Bad character: "+g;C=si,M=!0}P+=1e5}return P}function qt(g,b){if(g>"V")throw"MGRSPoint given invalid Northing "+g;for(var C=pl.charCodeAt(b-1),P=0,M=!1;C!==g.charCodeAt(0);){if(++C===mi&&C++,C===cn&&C++,C>Nn){if(M)throw"Bad character: "+g;C=si,M=!0}P+=1e5}return P}function ve(g){var b;switch(g){case"C":b=11e5;break;case"D":b=2e6;break;case"E":b=28e5;break;case"F":b=37e5;break;case"G":b=46e5;break;case"H":b=55e5;break;case"J":b=64e5;break;case"K":b=73e5;break;case"L":b=82e5;break;case"M":b=91e5;break;case"N":b=0;break;case"P":b=8e5;break;case"Q":b=17e5;break;case"R":b=26e5;break;case"S":b=35e5;break;case"T":b=44e5;break;case"U":b=53e5;break;case"V":b=62e5;break;case"W":b=7e6;break;case"X":b=79e5;break;default:b=-1}if(b>=0)return b;throw"Invalid zone letter: "+g}function re(g,b,C){if(!(this instanceof re))return new re(g,b,C);if(Array.isArray(g))this.x=g[0],this.y=g[1],this.z=g[2]||0;else if(typeof g=="object")this.x=g.x,this.y=g.y,this.z=g.z||0;else if(typeof g=="string"&&b===void 0){var P=g.split(",");this.x=parseFloat(P[0],10),this.y=parseFloat(P[1],10),this.z=parseFloat(P[2],10)||0}else this.x=g,this.y=b,this.z=C||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}function pe(g){var b=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],C=typeof g.PROJECTION=="object"?Object.keys(g.PROJECTION)[0]:g.PROJECTION;return"no_uoff"in g||"no_off"in g||b.indexOf(C)!==-1}function Mn(g){var b,C=[];return C[0]=g*wl,b=g*g,C[0]+=b*bl,C[1]=b*fu,b*=g,C[0]+=b*cu,C[1]+=b*du,C[2]=b*Je,C}function Mi(g,b){var C=g+g;return g+b[0]*Math.sin(C)+b[1]*Math.sin(C+C)+b[2]*Math.sin(C+C+C)}function rn(g,b,C,P){var M;return g<Ut?(P.value=Zt.AREA_0,M=0):(M=Math.atan2(b,C),Math.abs(M)<=ge?P.value=Zt.AREA_0:M>ge&&M<=Tt+ge?(P.value=Zt.AREA_1,M-=Tt):M>Tt+ge||M<=-(Tt+ge)?(P.value=Zt.AREA_2,M=M>=0?M-we:M+we):(P.value=Zt.AREA_3,M+=Tt)),M}function le(g,b){var C=g+b;return C<-we?C+=Ci:C>+we&&(C-=Ci),C}function jt(g,b,C,P){for(var M=b;P;--P){var G=g(M);if(M-=G,Math.abs(G)<C)break}return M}var He=1,ye=2,ze=3,bn=4,vn=5,un=484813681109536e-20,Tt=Math.PI/2,Ii=.16666666666666666,an=.04722222222222222,Er=.022156084656084655,Ut=1e-10,Xe=.017453292519943295,Ue=57.29577951308232,ge=Math.PI/4,Ci=2*Math.PI,we=3.14159265359,hi={};hi.greenwich=0,hi.lisbon=-9.131906111111,hi.paris=2.337229166667,hi.bogota=-74.080916666667,hi.madrid=-3.687938888889,hi.rome=12.452333333333,hi.bern=7.439583333333,hi.jakarta=106.807719444444,hi.ferro=-17.666666666667,hi.brussels=4.367975,hi.stockholm=18.058277777778,hi.athens=23.7163375,hi.oslo=10.722916666667;var Pi={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},ei=/[\s_\-\/\(\)]/g,je=function(g){var b,C,P,M={},G=g.split("+").map(function(U){return U.trim()}).filter(function(U){return U}).reduce(function(U,it){var st=it.split("=");return st.push(!0),U[st[0].toLowerCase()]=st[1],U},{}),W={proj:"projName",datum:"datumCode",rf:function(U){M.rf=parseFloat(U)},lat_0:function(U){M.lat0=U*Xe},lat_1:function(U){M.lat1=U*Xe},lat_2:function(U){M.lat2=U*Xe},lat_ts:function(U){M.lat_ts=U*Xe},lon_0:function(U){M.long0=U*Xe},lon_1:function(U){M.long1=U*Xe},lon_2:function(U){M.long2=U*Xe},alpha:function(U){M.alpha=parseFloat(U)*Xe},gamma:function(U){M.rectified_grid_angle=parseFloat(U)},lonc:function(U){M.longc=U*Xe},x_0:function(U){M.x0=parseFloat(U)},y_0:function(U){M.y0=parseFloat(U)},k_0:function(U){M.k0=parseFloat(U)},k:function(U){M.k0=parseFloat(U)},a:function(U){M.a=parseFloat(U)},b:function(U){M.b=parseFloat(U)},r_a:function(){M.R_A=!0},zone:function(U){M.zone=parseInt(U,10)},south:function(){M.utmSouth=!0},towgs84:function(U){M.datum_params=U.split(",").map(function(it){return parseFloat(it)})},to_meter:function(U){M.to_meter=parseFloat(U)},units:function(U){M.units=U;var it=e(Pi,U);it&&(M.to_meter=it.to_meter)},from_greenwich:function(U){M.from_greenwich=U*Xe},pm:function(U){var it=e(hi,U);M.from_greenwich=(it||parseFloat(U))*Xe},nadgrids:function(U){U==="@null"?M.datumCode="none":M.nadgrids=U},axis:function(U){U.length===3&&"ewnsud".indexOf(U.substr(0,1))!==-1&&"ewnsud".indexOf(U.substr(1,1))!==-1&&"ewnsud".indexOf(U.substr(2,1))!==-1&&(M.axis=U)},approx:function(){M.approx=!0}};for(b in G)C=G[b],b in W?typeof(P=W[b])=="function"?P(C):M[P]=C:M[b]=C;return typeof M.datumCode=="string"&&M.datumCode!=="WGS84"&&(M.datumCode=M.datumCode.toLowerCase()),M},gi=1,Yi=/\s/,Jt=/[A-Za-z]/,Ws=/[A-Za-z84_]/,Xs=/[,\]]/,Ui=/[\d\.E\-\+]/;n.prototype.readCharicter=function(){var g=this.text[this.place++];if(this.state!==4)for(;Yi.test(g);){if(this.place>=this.text.length)return;g=this.text[this.place++]}switch(this.state){case gi:return this.neutral(g);case 2:return this.keyword(g);case 4:return this.quoted(g);case 5:return this.afterquote(g);case 3:return this.number(g);case-1:return}},n.prototype.afterquote=function(g){if(g==='"')return this.word+='"',void(this.state=4);if(Xs.test(g))return this.word=this.word.trim(),void this.afterItem(g);throw new Error(`havn't handled "`+g+'" in afterquote yet, index '+this.place)},n.prototype.afterItem=function(g){return g===","?(this.word!==null&&this.currentObject.push(this.word),this.word=null,void(this.state=gi)):g==="]"?(this.level--,this.word!==null&&(this.currentObject.push(this.word),this.word=null),this.state=gi,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},n.prototype.number=function(g){if(!Ui.test(g)){if(Xs.test(g))return this.word=parseFloat(this.word),void this.afterItem(g);throw new Error(`havn't handled "`+g+'" in number yet, index '+this.place)}this.word+=g},n.prototype.quoted=function(g){g!=='"'?this.word+=g:this.state=5},n.prototype.keyword=function(g){if(Ws.test(g))this.word+=g;else{if(g==="["){var b=[];return b.push(this.word),this.level++,this.root===null?this.root=b:this.currentObject.push(b),this.stack.push(this.currentObject),this.currentObject=b,void(this.state=gi)}if(!Xs.test(g))throw new Error(`havn't handled "`+g+'" in keyword yet, index '+this.place);this.afterItem(g)}},n.prototype.neutral=function(g){if(Jt.test(g))return this.word=g,void(this.state=2);if(g==='"')return this.word="",void(this.state=4);if(Ui.test(g))return this.word=g,void(this.state=3);{if(!Xs.test(g))throw new Error(`havn't handled "`+g+'" in neutral yet, index '+this.place);this.afterItem(g)}},n.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(this.state===-1)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var js=.017453292519943295,Ir=function(g){var b=s(g),C=b.shift(),P=b.shift();b.unshift(["name",P]),b.unshift(["type",C]);var M={};return l(b,M),p(M),M};(function(g){g("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),g("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),g("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),g.WGS84=g["EPSG:4326"],g["EPSG:3785"]=g["EPSG:3857"],g.GOOGLE=g["EPSG:3857"],g["EPSG:900913"]=g["EPSG:3857"],g["EPSG:102113"]=g["EPSG:3857"]})(y);var Zr=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],On=["3857","900913","3785","102113"],ml=function(g,b){g=g||{};var C,P;if(!b)return g;for(P in b)(C=b[P])!==void 0&&(g[P]=C);return g},Pn=function(g,b,C){var P=g*b;return C/Math.sqrt(1-P*P)},Zi=function(g){return g<0?-1:1},Kt=function(g){return Math.abs(g)<=we?g:g-Zi(g)*Ci},Fe=function(g,b,C){var P=g*C,M=.5*g;return P=Math.pow((1-P)/(1+P),M),Math.tan(.5*(Tt-b))/P},Hs=function(g,b){for(var C,P,M=.5*g,G=Tt-2*Math.atan(b),W=0;W<=15;W++)if(C=g*Math.sin(G),P=Tt-2*Math.atan(b*Math.pow((1-C)/(1+C),M))-G,G+=P,Math.abs(P)<=1e-10)return G;return-9999},is=[{init:function(){var g=this.b/this.a;this.es=1-g*g,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=Pn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(g){var b=g.x,C=g.y;if(C*Ue>90&&C*Ue<-90&&b*Ue>180&&b*Ue<-180)return null;var P,M;if(Math.abs(Math.abs(C)-Tt)<=Ut)return null;if(this.sphere)P=this.x0+this.a*this.k0*Kt(b-this.long0),M=this.y0+this.a*this.k0*Math.log(Math.tan(ge+.5*C));else{var G=Math.sin(C),W=Fe(this.e,C,G);P=this.x0+this.a*this.k0*Kt(b-this.long0),M=this.y0-this.a*this.k0*Math.log(W)}return g.x=P,g.y=M,g},inverse:function(g){var b,C,P=g.x-this.x0,M=g.y-this.y0;if(this.sphere)C=Tt-2*Math.atan(Math.exp(-M/(this.a*this.k0)));else{var G=Math.exp(-M/(this.a*this.k0));if((C=Hs(this.e,G))===-9999)return null}return b=Kt(this.long0+P/(this.a*this.k0)),g.x=b,g.y=C,g},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:v,inverse:v,names:["longlat","identity"]}],Ys={},Nt=[],au={start:function(){is.forEach(k)},add:k,get:function(g){if(!g)return!1;var b=g.toLowerCase();return Ys[b]!==void 0&&Nt[Ys[b]]?Nt[Ys[b]]:void 0}},Qt={};Qt.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},Qt.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},Qt.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},Qt.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},Qt.airy={a:6377563396e-3,b:635625691e-2,ellipseName:"Airy 1830"},Qt.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},Qt.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},Qt.mod_airy={a:6377340189e-3,b:6356034446e-3,ellipseName:"Modified Airy"},Qt.andrae={a:637710443e-2,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},Qt.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},Qt.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},Qt.bessel={a:6377397155e-3,rf:299.1528128,ellipseName:"Bessel 1841"},Qt.bess_nam={a:6377483865e-3,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},Qt.clrk66={a:63782064e-1,b:63565838e-1,ellipseName:"Clarke 1866"},Qt.clrk80={a:6378249145e-3,rf:293.4663,ellipseName:"Clarke 1880 mod."},Qt.clrk80ign={a:63782492e-1,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},Qt.clrk58={a:6378293645208759e-9,rf:294.2606763692654,ellipseName:"Clarke 1858"},Qt.CPM={a:63757387e-1,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},Qt.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},Qt.engelis={a:637813605e-2,rf:298.2566,ellipseName:"Engelis 1985"},Qt.evrst30={a:6377276345e-3,rf:300.8017,ellipseName:"Everest 1830"},Qt.evrst48={a:6377304063e-3,rf:300.8017,ellipseName:"Everest 1948"},Qt.evrst56={a:6377301243e-3,rf:300.8017,ellipseName:"Everest 1956"},Qt.evrst69={a:6377295664e-3,rf:300.8017,ellipseName:"Everest 1969"},Qt.evrstSS={a:6377298556e-3,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},Qt.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},Qt.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},Qt.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},Qt.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},Qt.hough={a:6378270,rf:297,ellipseName:"Hough"},Qt.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},Qt.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},Qt.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},Qt.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},Qt.new_intl={a:63781575e-1,b:63567722e-1,ellipseName:"New International 1967"},Qt.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},Qt.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},Qt.SEasia={a:6378155,b:63567733205e-4,ellipseName:"Southeast Asia"},Qt.walbeck={a:6376896,b:63558348467e-4,ellipseName:"Walbeck"},Qt.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},Qt.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},Qt.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"};var Zs=Qt.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Qt.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Ai={};Ai.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},Ai.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},Ai.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},Ai.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},Ai.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},Ai.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},Ai.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},Ai.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},Ai.militargeographische_institut={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},Ai.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},Ai.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},Ai.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},Ai.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},Ai.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},Ai.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},Ai.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},Ai.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},Ai.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var Ye={};rt.projections=au,rt.projections.start();var Ze=function(g,b,C){if(At(g,b)||g.datum_type===vn||b.datum_type===vn)return C;var P=g.a,M=g.es;if(g.datum_type===ze){if(mt(g,!1,C)!==0)return;P=6378137,M=.0066943799901413165}var G=b.a,W=b.b,U=b.es;return b.datum_type===ze&&(G=6378137,W=6356752314e-3,U=.0066943799901413165),M!==U||P!==G||Pt(g.datum_type)||Pt(b.datum_type)?(C=bt(C,M,P),Pt(g.datum_type)&&(C=ct(C,g.datum_type,g.datum_params)),Pt(b.datum_type)&&(C=at(C,b.datum_type,b.datum_params)),C=Dt(C,U,G,W),b.datum_type!==ze||mt(b,!0,C)===0?C:void 0):C},Ne=function(g,b,C){var P,M,G,W=C.x,U=C.y,it=C.z||0,st={};for(G=0;G<3;G++)if(!b||G!==2||C.z!==void 0)switch(G===0?(P=W,M="ew".indexOf(g.axis[G])!==-1?"x":"y"):G===1?(P=U,M="ns".indexOf(g.axis[G])!==-1?"y":"x"):(P=it,M="z"),g.axis[G]){case"e":st[M]=P;break;case"w":st[M]=-P;break;case"n":st[M]=P;break;case"s":st[M]=-P;break;case"u":C[M]!==void 0&&(st.z=P);break;case"d":C[M]!==void 0&&(st.z=-P);break;default:return null}return st},Kr=function(g){var b={x:g[0],y:g[1]};return g.length>2&&(b.z=g[2]),g.length>3&&(b.m=g[3]),b},za=function(g){Ee(g.x),Ee(g.y)},qr=rt("WGS84"),xi=6,Un="AJSAJS",pl="AFAFAF",si=65,mi=73,cn=79,Nn=86,$e=90,Fi={forward:de,inverse:function(g){var b=$(Ht(g.toUpperCase()));return b.lat&&b.lon?[b.lon,b.lat,b.lon,b.lat]:[b.left,b.bottom,b.right,b.top]},toPoint:F};re.fromMGRS=function(g){return new re(F(g))},re.prototype.toMGRS=function(g){return de([this.x,this.y],g)};var xt=.01068115234375,J=function(g){var b=[];b[0]=1-g*(.25+g*(.046875+g*(.01953125+g*xt))),b[1]=g*(.75-g*(.046875+g*(.01953125+g*xt)));var C=g*g;return b[2]=C*(.46875-g*(.013020833333333334+.007120768229166667*g)),C*=g,b[3]=C*(.3645833333333333-.005696614583333333*g),b[4]=C*g*.3076171875,b},ee=function(g,b,C,P){return C*=b,b*=b,P[0]*g-C*(P[1]+b*(P[2]+b*(P[3]+b*P[4])))},Ri=function(g,b,C){for(var P=1/(1-b),M=g,G=20;G;--G){var W=Math.sin(M),U=1-b*W*W;if(U=(ee(M,W,Math.cos(M),C)-g)*(U*Math.sqrt(U))*P,M-=U,Math.abs(U)<Ut)return M}return M},Wi={init:function(){this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.es&&(this.en=J(this.es),this.ml0=ee(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(g){var b,C,P,M=g.x,G=g.y,W=Kt(M-this.long0),U=Math.sin(G),it=Math.cos(G);if(this.es){var st=it*W,dt=Math.pow(st,2),wt=this.ep2*Math.pow(it,2),Mt=Math.pow(wt,2),Gt=Math.abs(it)>Ut?Math.tan(G):0,Rt=Math.pow(Gt,2),Yt=Math.pow(Rt,2);b=1-this.es*Math.pow(U,2),st/=Math.sqrt(b);var L=ee(G,U,it,this.en);C=this.a*(this.k0*st*(1+dt/6*(1-Rt+wt+dt/20*(5-18*Rt+Yt+14*wt-58*Rt*wt+dt/42*(61+179*Yt-Yt*Rt-479*Rt)))))+this.x0,P=this.a*(this.k0*(L-this.ml0+U*W*st/2*(1+dt/12*(5-Rt+9*wt+4*Mt+dt/30*(61+Yt-58*Rt+270*wt-330*Rt*wt+dt/56*(1385+543*Yt-Yt*Rt-3111*Rt))))))+this.y0}else{var r=it*Math.sin(W);if(Math.abs(Math.abs(r)-1)<Ut)return 93;if(C=.5*this.a*this.k0*Math.log((1+r)/(1-r))+this.x0,P=it*Math.cos(W)/Math.sqrt(1-Math.pow(r,2)),(r=Math.abs(P))>=1){if(r-1>Ut)return 93;P=0}else P=Math.acos(P);G<0&&(P=-P),P=this.a*this.k0*(P-this.lat0)+this.y0}return g.x=C,g.y=P,g},inverse:function(g){var b,C,P,M,G=(g.x-this.x0)*(1/this.a),W=(g.y-this.y0)*(1/this.a);if(this.es)if(b=this.ml0+W/this.k0,C=Ri(b,this.es,this.en),Math.abs(C)<Tt){var U=Math.sin(C),it=Math.cos(C),st=Math.abs(it)>Ut?Math.tan(C):0,dt=this.ep2*Math.pow(it,2),wt=Math.pow(dt,2),Mt=Math.pow(st,2),Gt=Math.pow(Mt,2);b=1-this.es*Math.pow(U,2);var Rt=G*Math.sqrt(b)/this.k0,Yt=Math.pow(Rt,2);P=C-(b*=st)*Yt/(1-this.es)*.5*(1-Yt/12*(5+3*Mt-9*dt*Mt+dt-4*wt-Yt/30*(61+90*Mt-252*dt*Mt+45*Gt+46*dt-Yt/56*(1385+3633*Mt+4095*Gt+1574*Gt*Mt)))),M=Kt(this.long0+Rt*(1-Yt/6*(1+2*Mt+dt-Yt/20*(5+28*Mt+24*Gt+8*dt*Mt+6*dt-Yt/42*(61+662*Mt+1320*Gt+720*Gt*Mt))))/it)}else P=Tt*Zi(W),M=0;else{var L=Math.exp(G/this.k0),r=.5*(L-1/L),o=this.lat0+W/this.k0,h=Math.cos(o);b=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(r,2))),P=Math.asin(b),W<0&&(P=-P),M=r===0&&h===0?0:Kt(Math.atan2(r,h)+this.long0)}return g.x=M,g.y=P,g},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]},yl=function(g){var b=Math.exp(g);return b=(b-1/b)/2},Ki=function(g,b){g=Math.abs(g),b=Math.abs(b);var C=Math.max(g,b),P=Math.min(g,b)/(C||1);return C*Math.sqrt(1+Math.pow(P,2))},fn=function(g){var b=1+g,C=b-1;return C===0?g:g*Math.log(b)/C},oe=function(g){var b=Math.abs(g);return b=fn(b*(1+b/(Ki(1,b)+1))),g<0?-b:b},ri=function(g,b){for(var C,P=2*Math.cos(2*b),M=g.length-1,G=g[M],W=0;--M>=0;)C=P*G-W+g[M],W=G,G=C;return b+C*Math.sin(2*b)},xl=function(g,b){for(var C,P=2*Math.cos(b),M=g.length-1,G=g[M],W=0;--M>=0;)C=P*G-W+g[M],W=G,G=C;return Math.sin(b)*C},ou=function(g){var b=Math.exp(g);return b=(b+1/b)/2},$r=function(g,b,C){for(var P,M,G=Math.sin(b),W=Math.cos(b),U=yl(C),it=ou(C),st=2*W*it,dt=-2*G*U,wt=g.length-1,Mt=g[wt],Gt=0,Rt=0,Yt=0;--wt>=0;)P=Rt,M=Gt,Mt=st*(Rt=Mt)-P-dt*(Gt=Yt)+g[wt],Yt=dt*Rt-M+st*Gt;return st=G*it,dt=W*U,[st*Mt-dt*Yt,st*Yt+dt*Mt]},_s={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Wi.init.apply(this),this.forward=Wi.forward,this.inverse=Wi.inverse),this.x0=this.x0!==void 0?this.x0:0,this.y0=this.y0!==void 0?this.y0:0,this.long0=this.long0!==void 0?this.long0:0,this.lat0=this.lat0!==void 0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var g=this.es/(1+Math.sqrt(1-this.es)),b=g/(2-g),C=b;this.cgb[0]=b*(2+b*(-2/3+b*(b*(116/45+b*(26/45+b*(-2854/675)))-2))),this.cbg[0]=b*(b*(2/3+b*(4/3+b*(-82/45+b*(32/45+b*(4642/4725)))))-2),C*=b,this.cgb[1]=C*(7/3+b*(b*(-227/45+b*(2704/315+b*(2323/945)))-1.6)),this.cbg[1]=C*(5/3+b*(-16/15+b*(-13/9+b*(904/315+b*(-1522/945))))),C*=b,this.cgb[2]=C*(56/15+b*(-136/35+b*(-1262/105+b*(73814/2835)))),this.cbg[2]=C*(-26/15+b*(34/21+b*(1.6+b*(-12686/2835)))),C*=b,this.cgb[3]=C*(4279/630+b*(-332/35+b*(-399572/14175))),this.cbg[3]=C*(1237/630+b*(b*(-24832/14175)-2.4)),C*=b,this.cgb[4]=C*(4174/315+b*(-144838/6237)),this.cbg[4]=C*(-734/315+b*(109598/31185)),C*=b,this.cgb[5]=C*(601676/22275),this.cbg[5]=C*(444337/155925),C=Math.pow(b,2),this.Qn=this.k0/(1+b)*(1+C*(.25+C*(1/64+C/256))),this.utg[0]=b*(b*(2/3+b*(-37/96+b*(1/360+b*(81/512+b*(-96199/604800)))))-.5),this.gtu[0]=b*(.5+b*(-2/3+b*(5/16+b*(41/180+b*(-127/288+b*(7891/37800)))))),this.utg[1]=C*(-1/48+b*(-1/15+b*(437/1440+b*(-46/105+b*(1118711/3870720))))),this.gtu[1]=C*(13/48+b*(b*(557/1440+b*(281/630+b*(-1983433/1935360)))-.6)),C*=b,this.utg[2]=C*(-17/480+b*(37/840+b*(209/4480+b*(-5569/90720)))),this.gtu[2]=C*(61/240+b*(-103/140+b*(15061/26880+b*(167603/181440)))),C*=b,this.utg[3]=C*(-4397/161280+b*(11/504+b*(830251/7257600))),this.gtu[3]=C*(49561/161280+b*(-179/168+b*(6601661/7257600))),C*=b,this.utg[4]=C*(-4583/161280+b*(108847/3991680)),this.gtu[4]=C*(34729/80640+b*(-3418889/1995840)),C*=b,this.utg[5]=-.03233083094085698*C,this.gtu[5]=.6650675310896665*C;var P=ri(this.cbg,this.lat0);this.Zb=-this.Qn*(P+xl(this.gtu,2*P))},forward:function(g){var b=Kt(g.x-this.long0),C=g.y;C=ri(this.cbg,C);var P=Math.sin(C),M=Math.cos(C),G=Math.sin(b),W=Math.cos(b);C=Math.atan2(P,W*M),b=Math.atan2(G*M,Ki(P,M*W)),b=oe(Math.tan(b));var U=$r(this.gtu,2*C,2*b);C+=U[0],b+=U[1];var it,st;return Math.abs(b)<=2.623395162778?(it=this.a*(this.Qn*b)+this.x0,st=this.a*(this.Qn*C+this.Zb)+this.y0):(it=1/0,st=1/0),g.x=it,g.y=st,g},inverse:function(g){var b=(g.x-this.x0)*(1/this.a),C=(g.y-this.y0)*(1/this.a);C=(C-this.Zb)/this.Qn,b/=this.Qn;var P,M;if(Math.abs(b)<=2.623395162778){var G=$r(this.utg,2*C,2*b);C+=G[0],b+=G[1],b=Math.atan(yl(b));var W=Math.sin(C),U=Math.cos(C),it=Math.sin(b),st=Math.cos(b);C=Math.atan2(W*st,Ki(it,st*U)),b=Math.atan2(it,st*U),P=Kt(b+this.long0),M=ri(this.cgb,C)}else P=1/0,M=1/0;return g.x=P,g.y=M,g},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]},Ua=function(g,b){if(g===void 0){if((g=Math.floor(30*(Kt(b)+Math.PI)/Math.PI)+1)<0)return 0;if(g>60)return 60}return g},lu={init:function(){var g=Ua(this.zone,this.long0);if(g===void 0)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(g)-183)*Xe,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,_s.init.apply(this),this.forward=_s.forward,this.inverse=_s.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},_i=function(g,b){return Math.pow((1-g)/(1+g),b)},Cr=20,Ln={init:function(){var g=Math.sin(this.lat0),b=Math.cos(this.lat0);b*=b,this.rc=Math.sqrt(1-this.es)/(1-this.es*g*g),this.C=Math.sqrt(1+this.es*b*b/(1-this.es)),this.phic0=Math.asin(g/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+ge)/(Math.pow(Math.tan(.5*this.lat0+ge),this.C)*_i(this.e*g,this.ratexp))},forward:function(g){var b=g.x,C=g.y;return g.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*C+ge),this.C)*_i(this.e*Math.sin(C),this.ratexp))-Tt,g.x=this.C*b,g},inverse:function(g){for(var b=g.x/this.C,C=g.y,P=Math.pow(Math.tan(.5*C+ge)/this.K,1/this.C),M=Cr;M>0&&(C=2*Math.atan(P*_i(this.e*Math.sin(g.y),-.5*this.e))-Tt,!(Math.abs(C-g.y)<1e-14));--M)g.y=C;return M?(g.x=b,g.y=C,g):null},names:["gauss"]},ce={init:function(){Ln.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(g){var b,C,P,M;return g.x=Kt(g.x-this.long0),Ln.forward.apply(this,[g]),b=Math.sin(g.y),C=Math.cos(g.y),P=Math.cos(g.x),M=this.k0*this.R2/(1+this.sinc0*b+this.cosc0*C*P),g.x=M*C*Math.sin(g.x),g.y=M*(this.cosc0*b-this.sinc0*C*P),g.x=this.a*g.x+this.x0,g.y=this.a*g.y+this.y0,g},inverse:function(g){var b,C,P,M,G;if(g.x=(g.x-this.x0)/this.a,g.y=(g.y-this.y0)/this.a,g.x/=this.k0,g.y/=this.k0,G=Ki(g.x,g.y)){var W=2*Math.atan2(G,this.R2);b=Math.sin(W),C=Math.cos(W),M=Math.asin(C*this.sinc0+g.y*b*this.cosc0/G),P=Math.atan2(g.x*b,G*this.cosc0*C-g.y*this.sinc0*b)}else M=this.phic0,P=0;return g.x=P,g.y=M,Ln.inverse.apply(this,[g]),g.x=Kt(g.x+this.long0),g},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},hu={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ut&&(this.k0=.5*(1+Zi(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=Ut&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),this.k0===1&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=Ut&&Math.abs(Math.cos(this.lat_ts))>Ut&&(this.k0=.5*this.cons*Pn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/Fe(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=Pn(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-Tt,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(g){var b,C,P,M,G,W,U=g.x,it=g.y,st=Math.sin(it),dt=Math.cos(it),wt=Kt(U-this.long0);return Math.abs(Math.abs(U-this.long0)-Math.PI)<=Ut&&Math.abs(it+this.lat0)<=Ut?(g.x=NaN,g.y=NaN,g):this.sphere?(b=2*this.k0/(1+this.sinlat0*st+this.coslat0*dt*Math.cos(wt)),g.x=this.a*b*dt*Math.sin(wt)+this.x0,g.y=this.a*b*(this.coslat0*st-this.sinlat0*dt*Math.cos(wt))+this.y0,g):(C=2*Math.atan(this.ssfn_(it,st,this.e))-Tt,M=Math.cos(C),P=Math.sin(C),Math.abs(this.coslat0)<=Ut?(G=Fe(this.e,it*this.con,this.con*st),W=2*this.a*this.k0*G/this.cons,g.x=this.x0+W*Math.sin(U-this.long0),g.y=this.y0-this.con*W*Math.cos(U-this.long0),g):(Math.abs(this.sinlat0)<Ut?(b=2*this.a*this.k0/(1+M*Math.cos(wt)),g.y=b*P):(b=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*P+this.cosX0*M*Math.cos(wt))),g.y=b*(this.cosX0*P-this.sinX0*M*Math.cos(wt))+this.y0),g.x=b*M*Math.sin(wt)+this.x0,g))},inverse:function(g){g.x-=this.x0,g.y-=this.y0;var b,C,P,M,G,W=Math.sqrt(g.x*g.x+g.y*g.y);if(this.sphere){var U=2*Math.atan(W/(2*this.a*this.k0));return b=this.long0,C=this.lat0,W<=Ut?(g.x=b,g.y=C,g):(C=Math.asin(Math.cos(U)*this.sinlat0+g.y*Math.sin(U)*this.coslat0/W),b=Kt(Math.abs(this.coslat0)<Ut?this.lat0>0?this.long0+Math.atan2(g.x,-1*g.y):this.long0+Math.atan2(g.x,g.y):this.long0+Math.atan2(g.x*Math.sin(U),W*this.coslat0*Math.cos(U)-g.y*this.sinlat0*Math.sin(U))),g.x=b,g.y=C,g)}if(Math.abs(this.coslat0)<=Ut){if(W<=Ut)return C=this.lat0,b=this.long0,g.x=b,g.y=C,g;g.x*=this.con,g.y*=this.con,P=W*this.cons/(2*this.a*this.k0),C=this.con*Hs(this.e,P),b=this.con*Kt(this.con*this.long0+Math.atan2(g.x,-1*g.y))}else M=2*Math.atan(W*this.cosX0/(2*this.a*this.k0*this.ms1)),b=this.long0,W<=Ut?G=this.X0:(G=Math.asin(Math.cos(M)*this.sinX0+g.y*Math.sin(M)*this.cosX0/W),b=Kt(this.long0+Math.atan2(g.x*Math.sin(M),W*this.cosX0*Math.cos(M)-g.y*this.sinX0*Math.sin(M)))),C=-1*Hs(this.e,Math.tan(.5*(Tt+G)));return g.x=b,g.y=C,g},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],ssfn_:function(g,b,C){return b*=C,Math.tan(.5*(Tt+g))*Math.pow((1-b)/(1+b),.5*C)}},Te={init:function(){var g=this.lat0;this.lambda0=this.long0;var b=Math.sin(g),C=this.a,P=1/this.rf,M=2*P-Math.pow(P,2),G=this.e=Math.sqrt(M);this.R=this.k0*C*Math.sqrt(1-M)/(1-M*Math.pow(b,2)),this.alpha=Math.sqrt(1+M/(1-M)*Math.pow(Math.cos(g),4)),this.b0=Math.asin(b/this.alpha);var W=Math.log(Math.tan(Math.PI/4+this.b0/2)),U=Math.log(Math.tan(Math.PI/4+g/2)),it=Math.log((1+G*b)/(1-G*b));this.K=W-this.alpha*U+this.alpha*G/2*it},forward:function(g){var b=Math.log(Math.tan(Math.PI/4-g.y/2)),C=this.e/2*Math.log((1+this.e*Math.sin(g.y))/(1-this.e*Math.sin(g.y))),P=-this.alpha*(b+C)+this.K,M=2*(Math.atan(Math.exp(P))-Math.PI/4),G=this.alpha*(g.x-this.lambda0),W=Math.atan(Math.sin(G)/(Math.sin(this.b0)*Math.tan(M)+Math.cos(this.b0)*Math.cos(G))),U=Math.asin(Math.cos(this.b0)*Math.sin(M)-Math.sin(this.b0)*Math.cos(M)*Math.cos(G));return g.y=this.R/2*Math.log((1+Math.sin(U))/(1-Math.sin(U)))+this.y0,g.x=this.R*W+this.x0,g},inverse:function(g){for(var b=g.x-this.x0,C=g.y-this.y0,P=b/this.R,M=2*(Math.atan(Math.exp(C/this.R))-Math.PI/4),G=Math.asin(Math.cos(this.b0)*Math.sin(M)+Math.sin(this.b0)*Math.cos(M)*Math.cos(P)),W=Math.atan(Math.sin(P)/(Math.cos(this.b0)*Math.cos(P)-Math.sin(this.b0)*Math.tan(M))),U=this.lambda0+W/this.alpha,it=0,st=G,dt=-1e3,wt=0;Math.abs(st-dt)>1e-7;){if(++wt>20)return;it=1/this.alpha*(Math.log(Math.tan(Math.PI/4+G/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(st))/2)),dt=st,st=2*Math.atan(Math.exp(it))-Math.PI/2}return g.x=U,g.y=st,g},names:["somerc"]},ci=1e-7,uu={init:function(){var g,b,C,P,M,G,W,U,it,st,dt,wt=0,Mt=0,Gt=0,Rt=0,Yt=0,L=0,r=0;this.no_off=pe(this),this.no_rot="no_rot"in this;var o=!1;"alpha"in this&&(o=!0);var h=!1;if("rectified_grid_angle"in this&&(h=!0),o&&(r=this.alpha),h&&(wt=this.rectified_grid_angle*Xe),o||h)Mt=this.longc;else if(Gt=this.long1,Yt=this.lat1,Rt=this.long2,L=this.lat2,Math.abs(Yt-L)<=ci||(g=Math.abs(Yt))<=ci||Math.abs(g-Tt)<=ci||Math.abs(Math.abs(this.lat0)-Tt)<=ci||Math.abs(Math.abs(L)-Tt)<=ci)throw new Error;var f=1-this.es;b=Math.sqrt(f),Math.abs(this.lat0)>Ut?(U=Math.sin(this.lat0),C=Math.cos(this.lat0),g=1-this.es*U*U,this.B=C*C,this.B=Math.sqrt(1+this.es*this.B*this.B/f),this.A=this.B*this.k0*b/g,(M=(P=this.B*b/(C*Math.sqrt(g)))*P-1)<=0?M=0:(M=Math.sqrt(M),this.lat0<0&&(M=-M)),this.E=M+=P,this.E*=Math.pow(Fe(this.e,this.lat0,U),this.B)):(this.B=1/b,this.A=this.k0,this.E=P=M=1),o||h?(o?(dt=Math.asin(Math.sin(r)/P),h||(wt=r)):(dt=wt,r=Math.asin(P*Math.sin(dt))),this.lam0=Mt-Math.asin(.5*(M-1/M)*Math.tan(dt))/this.B):(G=Math.pow(Fe(this.e,Yt,Math.sin(Yt)),this.B),W=Math.pow(Fe(this.e,L,Math.sin(L)),this.B),M=this.E/G,it=(W-G)/(W+G),st=((st=this.E*this.E)-W*G)/(st+W*G),(g=Gt-Rt)<-Math.pi?Rt-=Ci:g>Math.pi&&(Rt+=Ci),this.lam0=Kt(.5*(Gt+Rt)-Math.atan(st*Math.tan(.5*this.B*(Gt-Rt))/it)/this.B),dt=Math.atan(2*Math.sin(this.B*Kt(Gt-this.lam0))/(M-1/M)),wt=r=Math.asin(P*Math.sin(dt))),this.singam=Math.sin(dt),this.cosgam=Math.cos(dt),this.sinrot=Math.sin(wt),this.cosrot=Math.cos(wt),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(P*P-1)/Math.cos(r))),this.lat0<0&&(this.u_0=-this.u_0)),M=.5*dt,this.v_pole_n=this.ArB*Math.log(Math.tan(ge-M)),this.v_pole_s=this.ArB*Math.log(Math.tan(ge+M))},forward:function(g){var b,C,P,M,G,W,U,it,st={};if(g.x=g.x-this.lam0,Math.abs(Math.abs(g.y)-Tt)>Ut){if(G=this.E/Math.pow(Fe(this.e,g.y,Math.sin(g.y)),this.B),W=1/G,b=.5*(G-W),C=.5*(G+W),M=Math.sin(this.B*g.x),P=(b*this.singam-M*this.cosgam)/C,Math.abs(Math.abs(P)-1)<Ut)throw new Error;it=.5*this.ArB*Math.log((1-P)/(1+P)),W=Math.cos(this.B*g.x),U=Math.abs(W)<ci?this.A*g.x:this.ArB*Math.atan2(b*this.cosgam+M*this.singam,W)}else it=g.y>0?this.v_pole_n:this.v_pole_s,U=this.ArB*g.y;return this.no_rot?(st.x=U,st.y=it):(U-=this.u_0,st.x=it*this.cosrot+U*this.sinrot,st.y=U*this.cosrot-it*this.sinrot),st.x=this.a*st.x+this.x0,st.y=this.a*st.y+this.y0,st},inverse:function(g){var b,C,P,M,G,W,U,it={};if(g.x=(g.x-this.x0)*(1/this.a),g.y=(g.y-this.y0)*(1/this.a),this.no_rot?(C=g.y,b=g.x):(C=g.x*this.cosrot-g.y*this.sinrot,b=g.y*this.cosrot+g.x*this.sinrot+this.u_0),P=Math.exp(-this.BrA*C),M=.5*(P-1/P),G=.5*(P+1/P),W=Math.sin(this.BrA*b),U=(W*this.cosgam+M*this.singam)/G,Math.abs(Math.abs(U)-1)<Ut)it.x=0,it.y=U<0?-Tt:Tt;else{if(it.y=this.E/Math.sqrt((1+U)/(1-U)),it.y=Hs(this.e,Math.pow(it.y,1/this.B)),it.y===1/0)throw new Error;it.x=-this.rB*Math.atan2(M*this.cosgam-W*this.singam,Math.cos(this.BrA*b))}return it.x+=this.lam0,it},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},Wa={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<Ut)){var g=this.b/this.a;this.e=Math.sqrt(1-g*g);var b=Math.sin(this.lat1),C=Math.cos(this.lat1),P=Pn(this.e,b,C),M=Fe(this.e,this.lat1,b),G=Math.sin(this.lat2),W=Math.cos(this.lat2),U=Pn(this.e,G,W),it=Fe(this.e,this.lat2,G),st=Fe(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>Ut?this.ns=Math.log(P/U)/Math.log(M/it):this.ns=b,isNaN(this.ns)&&(this.ns=b),this.f0=P/(this.ns*Math.pow(M,this.ns)),this.rh=this.a*this.f0*Math.pow(st,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(g){var b=g.x,C=g.y;Math.abs(2*Math.abs(C)-Math.PI)<=Ut&&(C=Zi(C)*(Tt-2*Ut));var P,M,G=Math.abs(Math.abs(C)-Tt);if(G>Ut)P=Fe(this.e,C,Math.sin(C)),M=this.a*this.f0*Math.pow(P,this.ns);else{if((G=C*this.ns)<=0)return null;M=0}var W=this.ns*Kt(b-this.long0);return g.x=this.k0*(M*Math.sin(W))+this.x0,g.y=this.k0*(this.rh-M*Math.cos(W))+this.y0,g},inverse:function(g){var b,C,P,M,G,W=(g.x-this.x0)/this.k0,U=this.rh-(g.y-this.y0)/this.k0;this.ns>0?(b=Math.sqrt(W*W+U*U),C=1):(b=-Math.sqrt(W*W+U*U),C=-1);var it=0;if(b!==0&&(it=Math.atan2(C*W,C*U)),b!==0||this.ns>0){if(C=1/this.ns,P=Math.pow(b/(this.a*this.f0),C),(M=Hs(this.e,P))===-9999)return null}else M=-Tt;return G=Kt(it/this.ns+this.long0),g.x=G,g.y=M,g},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},_l={init:function(){this.a=6377397155e-3,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(g){var b,C,P,M,G,W,U,it=g.x,st=g.y,dt=Kt(it-this.long0);return b=Math.pow((1+this.e*Math.sin(st))/(1-this.e*Math.sin(st)),this.alfa*this.e/2),C=2*(Math.atan(this.k*Math.pow(Math.tan(st/2+this.s45),this.alfa)/b)-this.s45),P=-dt*this.alfa,M=Math.asin(Math.cos(this.ad)*Math.sin(C)+Math.sin(this.ad)*Math.cos(C)*Math.cos(P)),G=Math.asin(Math.cos(C)*Math.sin(P)/Math.cos(M)),W=this.n*G,U=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(M/2+this.s45),this.n),g.y=U*Math.cos(W)/1,g.x=U*Math.sin(W)/1,this.czech||(g.y*=-1,g.x*=-1),g},inverse:function(g){var b,C,P,M,G,W,U,it=g.x;g.x=g.y,g.y=it,this.czech||(g.y*=-1,g.x*=-1),G=Math.sqrt(g.x*g.x+g.y*g.y),M=Math.atan2(g.y,g.x)/Math.sin(this.s0),P=2*(Math.atan(Math.pow(this.ro0/G,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),b=Math.asin(Math.cos(this.ad)*Math.sin(P)-Math.sin(this.ad)*Math.cos(P)*Math.cos(M)),C=Math.asin(Math.cos(P)*Math.sin(M)/Math.cos(b)),g.x=this.long0-C/this.alfa,W=b,U=0;var st=0;do g.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(b/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(W))/(1-this.e*Math.sin(W)),this.e/2))-this.s45),Math.abs(W-g.y)<1e-10&&(U=1),W=g.y,st+=1;while(U===0&&st<15);return st>=15?null:g},names:["Krovak","krovak"]},pi=function(g,b,C,P,M){return g*M-b*Math.sin(2*M)+C*Math.sin(4*M)-P*Math.sin(6*M)},Ar=function(g){return 1-.25*g*(1+g/16*(3+1.25*g))},Wn=function(g){return .375*g*(1+.25*g*(1+.46875*g))},Xn=function(g){return .05859375*g*g*(1+.75*g)},jn=function(g){return g*g*g*(35/3072)},ws=function(g,b,C){var P=b*C;return g/Math.sqrt(1-P*P)},kn=function(g){return Math.abs(g)<Tt?g:g-Zi(g)*Math.PI},ns=function(g,b,C,P,M){var G,W;G=g/b;for(var U=0;U<15;U++)if(W=(g-(b*G-C*Math.sin(2*G)+P*Math.sin(4*G)-M*Math.sin(6*G)))/(b-2*C*Math.cos(2*G)+4*P*Math.cos(4*G)-6*M*Math.cos(6*G)),G+=W,Math.abs(W)<=1e-10)return G;return NaN},qi={init:function(){this.sphere||(this.e0=Ar(this.es),this.e1=Wn(this.es),this.e2=Xn(this.es),this.e3=jn(this.es),this.ml0=this.a*pi(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(g){var b,C,P=g.x,M=g.y;if(P=Kt(P-this.long0),this.sphere)b=this.a*Math.asin(Math.cos(M)*Math.sin(P)),C=this.a*(Math.atan2(Math.tan(M),Math.cos(P))-this.lat0);else{var G=Math.sin(M),W=Math.cos(M),U=ws(this.a,this.e,G),it=Math.tan(M)*Math.tan(M),st=P*Math.cos(M),dt=st*st,wt=this.es*W*W/(1-this.es);b=U*st*(1-dt*it*(1/6-(8-it+8*wt)*dt/120)),C=this.a*pi(this.e0,this.e1,this.e2,this.e3,M)-this.ml0+U*G/W*dt*(.5+(5-it+6*wt)*dt/24)}return g.x=b+this.x0,g.y=C+this.y0,g},inverse:function(g){g.x-=this.x0,g.y-=this.y0;var b,C,P=g.x/this.a,M=g.y/this.a;if(this.sphere){var G=M+this.lat0;b=Math.asin(Math.sin(G)*Math.cos(P)),C=Math.atan2(Math.tan(P),Math.cos(G))}else{var W=this.ml0/this.a+M,U=ns(W,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(U)-Tt)<=Ut)return g.x=this.long0,g.y=Tt,M<0&&(g.y*=-1),g;var it=ws(this.a,this.e,Math.sin(U)),st=it*it*it/this.a/this.a*(1-this.es),dt=Math.pow(Math.tan(U),2),wt=P*this.a/it,Mt=wt*wt;b=U-it*Math.tan(U)/st*wt*wt*(.5-(1+3*dt)*wt*wt/24),C=wt*(1-Mt*(dt/3+(1+3*dt)*dt*Mt/15))/Math.cos(U)}return g.x=Kt(C+this.long0),g.y=kn(b),g},names:["Cassini","Cassini_Soldner","cass"]},Hn=function(g,b){var C;return g>1e-7?(C=g*b,(1-g*g)*(b/(1-C*C)-.5/g*Math.log((1-C)/(1+C)))):2*b},wl=.3333333333333333,bl=.17222222222222222,cu=.10257936507936508,fu=.06388888888888888,du=.0664021164021164,Je=.016415012942191543,El={init:function(){var g=Math.abs(this.lat0);if(Math.abs(g-Tt)<Ut?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(g)<Ut?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0){var b;switch(this.qp=Hn(this.e,1),this.mmf=.5/(1-this.es),this.apa=Mn(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),b=Math.sin(this.lat0),this.sinb1=Hn(this.e,b)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*b*b)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(g){var b,C,P,M,G,W,U,it,st,dt,wt=g.x,Mt=g.y;if(wt=Kt(wt-this.long0),this.sphere){if(G=Math.sin(Mt),dt=Math.cos(Mt),P=Math.cos(wt),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((C=this.mode===this.EQUIT?1+dt*P:1+this.sinph0*G+this.cosph0*dt*P)<=Ut)return null;b=(C=Math.sqrt(2/C))*dt*Math.sin(wt),C*=this.mode===this.EQUIT?G:this.cosph0*G-this.sinph0*dt*P}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(P=-P),Math.abs(Mt+this.lat0)<Ut)return null;C=ge-.5*Mt,b=(C=2*(this.mode===this.S_POLE?Math.cos(C):Math.sin(C)))*Math.sin(wt),C*=P}}else{switch(U=0,it=0,st=0,P=Math.cos(wt),M=Math.sin(wt),G=Math.sin(Mt),W=Hn(this.e,G),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(U=W/this.qp,it=Math.sqrt(1-U*U)),this.mode){case this.OBLIQ:st=1+this.sinb1*U+this.cosb1*it*P;break;case this.EQUIT:st=1+it*P;break;case this.N_POLE:st=Tt+Mt,W=this.qp-W;break;case this.S_POLE:st=Mt-Tt,W=this.qp+W}if(Math.abs(st)<Ut)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:st=Math.sqrt(2/st),C=this.mode===this.OBLIQ?this.ymf*st*(this.cosb1*U-this.sinb1*it*P):(st=Math.sqrt(2/(1+it*P)))*U*this.ymf,b=this.xmf*st*it*M;break;case this.N_POLE:case this.S_POLE:W>=0?(b=(st=Math.sqrt(W))*M,C=P*(this.mode===this.S_POLE?st:-st)):b=C=0}}return g.x=this.a*b+this.x0,g.y=this.a*C+this.y0,g},inverse:function(g){g.x-=this.x0,g.y-=this.y0;var b,C,P,M,G,W,U,it=g.x/this.a,st=g.y/this.a;if(this.sphere){var dt,wt=0,Mt=0;if(dt=Math.sqrt(it*it+st*st),(C=.5*dt)>1)return null;switch(C=2*Math.asin(C),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(Mt=Math.sin(C),wt=Math.cos(C)),this.mode){case this.EQUIT:C=Math.abs(dt)<=Ut?0:Math.asin(st*Mt/dt),it*=Mt,st=wt*dt;break;case this.OBLIQ:C=Math.abs(dt)<=Ut?this.lat0:Math.asin(wt*this.sinph0+st*Mt*this.cosph0/dt),it*=Mt*this.cosph0,st=(wt-Math.sin(C)*this.sinph0)*dt;break;case this.N_POLE:st=-st,C=Tt-C;break;case this.S_POLE:C-=Tt}b=st!==0||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(it,st):0}else{if(U=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(it/=this.dd,st*=this.dd,(W=Math.sqrt(it*it+st*st))<Ut)return g.x=this.long0,g.y=this.lat0,g;M=2*Math.asin(.5*W/this.rq),P=Math.cos(M),it*=M=Math.sin(M),this.mode===this.OBLIQ?(U=P*this.sinb1+st*M*this.cosb1/W,G=this.qp*U,st=W*this.cosb1*P-st*this.sinb1*M):(U=st*M/W,G=this.qp*U,st=W*P)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(st=-st),!(G=it*it+st*st))return g.x=this.long0,g.y=this.lat0,g;U=1-G/this.qp,this.mode===this.S_POLE&&(U=-U)}b=Math.atan2(it,st),C=Mi(Math.asin(U),this.apa)}return g.x=Kt(this.long0+b),g.y=C,g},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},En=function(g){return Math.abs(g)>1&&(g=g>1?1:-1),Math.asin(g)},ss={init:function(){Math.abs(this.lat1+this.lat2)<Ut||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=Pn(this.e3,this.sin_po,this.cos_po),this.qs1=Hn(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=Pn(this.e3,this.sin_po,this.cos_po),this.qs2=Hn(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Hn(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>Ut?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(g){var b=g.x,C=g.y;this.sin_phi=Math.sin(C),this.cos_phi=Math.cos(C);var P=Hn(this.e3,this.sin_phi),M=this.a*Math.sqrt(this.c-this.ns0*P)/this.ns0,G=this.ns0*Kt(b-this.long0),W=M*Math.sin(G)+this.x0,U=this.rh-M*Math.cos(G)+this.y0;return g.x=W,g.y=U,g},inverse:function(g){var b,C,P,M,G,W;return g.x-=this.x0,g.y=this.rh-g.y+this.y0,this.ns0>=0?(b=Math.sqrt(g.x*g.x+g.y*g.y),P=1):(b=-Math.sqrt(g.x*g.x+g.y*g.y),P=-1),M=0,b!==0&&(M=Math.atan2(P*g.x,P*g.y)),P=b*this.ns0/this.a,this.sphere?W=Math.asin((this.c-P*P)/(2*this.ns0)):(C=(this.c-P*P)/this.ns0,W=this.phi1z(this.e3,C)),G=Kt(M/this.ns0+this.long0),g.x=G,g.y=W,g},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(g,b){var C,P,M,G,W,U=En(.5*b);if(g<Ut)return U;for(var it=g*g,st=1;st<=25;st++)if(C=Math.sin(U),P=Math.cos(U),M=g*C,G=1-M*M,W=.5*G*G/P*(b/(1-it)-C/G+.5/g*Math.log((1-M)/(1+M))),U+=W,Math.abs(W)<=1e-7)return U;return null}},gu={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(g){var b,C,P,M,G,W,U,it=g.x,st=g.y;return P=Kt(it-this.long0),b=Math.sin(st),C=Math.cos(st),M=Math.cos(P),(G=this.sin_p14*b+this.cos_p14*C*M)>0||Math.abs(G)<=Ut?(W=this.x0+1*this.a*C*Math.sin(P)/G,U=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*C*M)/G):(W=this.x0+this.infinity_dist*C*Math.sin(P),U=this.y0+this.infinity_dist*(this.cos_p14*b-this.sin_p14*C*M)),g.x=W,g.y=U,g},inverse:function(g){var b,C,P,M,G,W;return g.x=(g.x-this.x0)/this.a,g.y=(g.y-this.y0)/this.a,g.x/=this.k0,g.y/=this.k0,(b=Math.sqrt(g.x*g.x+g.y*g.y))?(M=Math.atan2(b,this.rc),C=Math.sin(M),P=Math.cos(M),W=En(P*this.sin_p14+g.y*C*this.cos_p14/b),G=Math.atan2(g.x*C,b*this.cos_p14*P-g.y*this.sin_p14*C),G=Kt(this.long0+G)):(W=this.phic0,G=0),g.x=G,g.y=W,g},names:["gnom"]},It=function(g,b){var C=1-(1-g*g)/(2*g)*Math.log((1-g)/(1+g));if(Math.abs(Math.abs(b)-C)<1e-6)return b<0?-1*Tt:Tt;for(var P,M,G,W,U=Math.asin(.5*b),it=0;it<30;it++)if(M=Math.sin(U),G=Math.cos(U),W=g*M,P=Math.pow(1-W*W,2)/(2*G)*(b/(1-g*g)-M/(1-W*W)+.5/g*Math.log((1-W)/(1+W))),U+=P,Math.abs(P)<=1e-10)return U;return NaN},Me={init:function(){this.sphere||(this.k0=Pn(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(g){var b,C,P=g.x,M=g.y,G=Kt(P-this.long0);if(this.sphere)b=this.x0+this.a*G*Math.cos(this.lat_ts),C=this.y0+this.a*Math.sin(M)/Math.cos(this.lat_ts);else{var W=Hn(this.e,Math.sin(M));b=this.x0+this.a*this.k0*G,C=this.y0+this.a*W*.5/this.k0}return g.x=b,g.y=C,g},inverse:function(g){g.x-=this.x0,g.y-=this.y0;var b,C;return this.sphere?(b=Kt(this.long0+g.x/this.a/Math.cos(this.lat_ts)),C=Math.asin(g.y/this.a*Math.cos(this.lat_ts))):(C=It(this.e,2*g.y*this.k0/this.a),b=Kt(this.long0+g.x/(this.a*this.k0))),g.x=b,g.y=C,g},names:["cea"]},Ni={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(g){var b=g.x,C=g.y,P=Kt(b-this.long0),M=kn(C-this.lat0);return g.x=this.x0+this.a*P*this.rc,g.y=this.y0+this.a*M,g},inverse:function(g){var b=g.x,C=g.y;return g.x=Kt(this.long0+(b-this.x0)/(this.a*this.rc)),g.y=kn(this.lat0+(C-this.y0)/this.a),g},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},Rr=20,Il={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ar(this.es),this.e1=Wn(this.es),this.e2=Xn(this.es),this.e3=jn(this.es),this.ml0=this.a*pi(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(g){var b,C,P,M=g.x,G=g.y,W=Kt(M-this.long0);if(P=W*Math.sin(G),this.sphere)Math.abs(G)<=Ut?(b=this.a*W,C=-1*this.a*this.lat0):(b=this.a*Math.sin(P)/Math.tan(G),C=this.a*(kn(G-this.lat0)+(1-Math.cos(P))/Math.tan(G)));else if(Math.abs(G)<=Ut)b=this.a*W,C=-1*this.ml0;else{var U=ws(this.a,this.e,Math.sin(G))/Math.tan(G);b=U*Math.sin(P),C=this.a*pi(this.e0,this.e1,this.e2,this.e3,G)-this.ml0+U*(1-Math.cos(P))}return g.x=b+this.x0,g.y=C+this.y0,g},inverse:function(g){var b,C,P,M,G,W,U,it,st;if(P=g.x-this.x0,M=g.y-this.y0,this.sphere)if(Math.abs(M+this.a*this.lat0)<=Ut)b=Kt(P/this.a+this.long0),C=0;else{W=this.lat0+M/this.a,U=P*P/this.a/this.a+W*W,it=W;var dt;for(G=Rr;G;--G)if(dt=Math.tan(it),st=-1*(W*(it*dt+1)-it-.5*(it*it+U)*dt)/((it-W)/dt-1),it+=st,Math.abs(st)<=Ut){C=it;break}b=Kt(this.long0+Math.asin(P*Math.tan(it)/this.a)/Math.sin(C))}else if(Math.abs(M+this.ml0)<=Ut)C=0,b=Kt(this.long0+P/this.a);else{W=(this.ml0+M)/this.a,U=P*P/this.a/this.a+W*W,it=W;var wt,Mt,Gt,Rt,Yt;for(G=Rr;G;--G)if(Yt=this.e*Math.sin(it),wt=Math.sqrt(1-Yt*Yt)*Math.tan(it),Mt=this.a*pi(this.e0,this.e1,this.e2,this.e3,it),Gt=this.e0-2*this.e1*Math.cos(2*it)+4*this.e2*Math.cos(4*it)-6*this.e3*Math.cos(6*it),Rt=Mt/this.a,st=(W*(wt*Rt+1)-Rt-.5*wt*(Rt*Rt+U))/(this.es*Math.sin(2*it)*(Rt*Rt+U-2*W*Rt)/(4*wt)+(W-Rt)*(wt*Gt-2/Math.sin(2*it))-Gt),it-=st,Math.abs(st)<=Ut){C=it;break}wt=Math.sqrt(1-this.es*Math.pow(Math.sin(C),2))*Math.tan(C),b=Kt(this.long0+Math.asin(P*wt/this.a)/Math.sin(C))}return g.x=b,g.y=C,g},names:["Polyconic","poly"]},mu={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(g){var b,C=g.x,P=g.y-this.lat0,M=C-this.long0,G=P/un*1e-5,W=M,U=1,it=0;for(b=1;b<=10;b++)U*=G,it+=this.A[b]*U;var st,dt=it,wt=W,Mt=1,Gt=0,Rt=0,Yt=0;for(b=1;b<=6;b++)st=Gt*dt+Mt*wt,Mt=Mt*dt-Gt*wt,Gt=st,Rt=Rt+this.B_re[b]*Mt-this.B_im[b]*Gt,Yt=Yt+this.B_im[b]*Mt+this.B_re[b]*Gt;return g.x=Yt*this.a+this.x0,g.y=Rt*this.a+this.y0,g},inverse:function(g){var b,C,P=g.x,M=g.y,G=P-this.x0,W=(M-this.y0)/this.a,U=G/this.a,it=1,st=0,dt=0,wt=0;for(b=1;b<=6;b++)C=st*W+it*U,it=it*W-st*U,st=C,dt=dt+this.C_re[b]*it-this.C_im[b]*st,wt=wt+this.C_im[b]*it+this.C_re[b]*st;for(var Mt=0;Mt<this.iterations;Mt++){var Gt,Rt=dt,Yt=wt,L=W,r=U;for(b=2;b<=6;b++)Gt=Yt*dt+Rt*wt,Rt=Rt*dt-Yt*wt,Yt=Gt,L+=(b-1)*(this.B_re[b]*Rt-this.B_im[b]*Yt),r+=(b-1)*(this.B_im[b]*Rt+this.B_re[b]*Yt);Rt=1,Yt=0;var o=this.B_re[1],h=this.B_im[1];for(b=2;b<=6;b++)Gt=Yt*dt+Rt*wt,Rt=Rt*dt-Yt*wt,Yt=Gt,o+=b*(this.B_re[b]*Rt-this.B_im[b]*Yt),h+=b*(this.B_im[b]*Rt+this.B_re[b]*Yt);var f=o*o+h*h;dt=(L*o+r*h)/f,wt=(r*o-L*h)/f}var d=dt,m=wt,x=1,w=0;for(b=1;b<=9;b++)x*=d,w+=this.D[b]*x;var A=this.lat0+w*un*1e5,O=this.long0+m;return g.x=O,g.y=A,g},names:["New_Zealand_Map_Grid","nzmg"]},pu={init:function(){},forward:function(g){var b=g.x,C=g.y,P=Kt(b-this.long0),M=this.x0+this.a*P,G=this.y0+this.a*Math.log(Math.tan(Math.PI/4+C/2.5))*1.25;return g.x=M,g.y=G,g},inverse:function(g){g.x-=this.x0,g.y-=this.y0;var b=Kt(this.long0+g.x/this.a),C=2.5*(Math.atan(Math.exp(.8*g.y/this.a))-Math.PI/4);return g.x=b,g.y=C,g},names:["Miller_Cylindrical","mill"]},yu=20,Xa={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=J(this.es)},forward:function(g){var b,C,P=g.x,M=g.y;if(P=Kt(P-this.long0),this.sphere){if(this.m)for(var G=this.n*Math.sin(M),W=yu;W;--W){var U=(this.m*M+Math.sin(M)-G)/(this.m+Math.cos(M));if(M-=U,Math.abs(U)<Ut)break}else M=this.n!==1?Math.asin(this.n*Math.sin(M)):M;b=this.a*this.C_x*P*(this.m+Math.cos(M)),C=this.a*this.C_y*M}else{var it=Math.sin(M),st=Math.cos(M);C=this.a*ee(M,it,st,this.en),b=this.a*P*st/Math.sqrt(1-this.es*it*it)}return g.x=b,g.y=C,g},inverse:function(g){var b,C,P,M;return g.x-=this.x0,P=g.x/this.a,g.y-=this.y0,b=g.y/this.a,this.sphere?(b/=this.C_y,P/=this.C_x*(this.m+Math.cos(b)),this.m?b=En((this.m*b+Math.sin(b))/this.n):this.n!==1&&(b=En(Math.sin(b)/this.n)),P=Kt(P+this.long0),b=kn(b)):(b=Ri(g.y/this.a,this.es,this.en),(M=Math.abs(b))<Tt?(M=Math.sin(b),C=this.long0+g.x*Math.sqrt(1-this.es*M*M)/(this.a*Math.cos(b)),P=Kt(C)):M-Ut<Tt&&(P=this.long0)),g.x=P,g.y=b,g},names:["Sinusoidal","sinu"]},Si={init:function(){},forward:function(g){for(var b=g.x,C=g.y,P=Kt(b-this.long0),M=C,G=Math.PI*Math.sin(C);;){var W=-(M+Math.sin(M)-G)/(1+Math.cos(M));if(M+=W,Math.abs(W)<Ut)break}M/=2,Math.PI/2-Math.abs(C)<Ut&&(P=0);var U=.900316316158*this.a*P*Math.cos(M)+this.x0,it=1.4142135623731*this.a*Math.sin(M)+this.y0;return g.x=U,g.y=it,g},inverse:function(g){var b,C;g.x-=this.x0,g.y-=this.y0,C=g.y/(1.4142135623731*this.a),Math.abs(C)>.999999999999&&(C=.999999999999),b=Math.asin(C);var P=Kt(this.long0+g.x/(.900316316158*this.a*Math.cos(b)));P<-Math.PI&&(P=-Math.PI),P>Math.PI&&(P=Math.PI),C=(2*b+Math.sin(2*b))/Math.PI,Math.abs(C)>1&&(C=1);var M=Math.asin(C);return g.x=P,g.y=M,g},names:["Mollweide","moll"]},ja={init:function(){Math.abs(this.lat1+this.lat2)<Ut||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ar(this.es),this.e1=Wn(this.es),this.e2=Xn(this.es),this.e3=jn(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=Pn(this.e,this.sinphi,this.cosphi),this.ml1=pi(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<Ut?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=Pn(this.e,this.sinphi,this.cosphi),this.ml2=pi(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=pi(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(g){var b,C=g.x,P=g.y;if(this.sphere)b=this.a*(this.g-P);else{var M=pi(this.e0,this.e1,this.e2,this.e3,P);b=this.a*(this.g-M)}var G=this.ns*Kt(C-this.long0),W=this.x0+b*Math.sin(G),U=this.y0+this.rh-b*Math.cos(G);return g.x=W,g.y=U,g},inverse:function(g){g.x-=this.x0,g.y=this.rh-g.y+this.y0;var b,C,P,M;this.ns>=0?(C=Math.sqrt(g.x*g.x+g.y*g.y),b=1):(C=-Math.sqrt(g.x*g.x+g.y*g.y),b=-1);var G=0;if(C!==0&&(G=Math.atan2(b*g.x,b*g.y)),this.sphere)return M=Kt(this.long0+G/this.ns),P=kn(this.g-C/this.a),g.x=M,g.y=P,g;var W=this.g-C/this.a;return P=ns(W,this.e0,this.e1,this.e2,this.e3),M=Kt(this.long0+G/this.ns),g.x=M,g.y=P,g},names:["Equidistant_Conic","eqdc"]},fi={init:function(){this.R=this.a},forward:function(g){var b,C,P=g.x,M=g.y,G=Kt(P-this.long0);Math.abs(M)<=Ut&&(b=this.x0+this.R*G,C=this.y0);var W=En(2*Math.abs(M/Math.PI));(Math.abs(G)<=Ut||Math.abs(Math.abs(M)-Tt)<=Ut)&&(b=this.x0,C=M>=0?this.y0+Math.PI*this.R*Math.tan(.5*W):this.y0+Math.PI*this.R*-Math.tan(.5*W));var U=.5*Math.abs(Math.PI/G-G/Math.PI),it=U*U,st=Math.sin(W),dt=Math.cos(W),wt=dt/(st+dt-1),Mt=wt*wt,Gt=wt*(2/st-1),Rt=Gt*Gt,Yt=Math.PI*this.R*(U*(wt-Rt)+Math.sqrt(it*(wt-Rt)*(wt-Rt)-(Rt+it)*(Mt-Rt)))/(Rt+it);G<0&&(Yt=-Yt),b=this.x0+Yt;var L=it+wt;return Yt=Math.PI*this.R*(Gt*L-U*Math.sqrt((Rt+it)*(it+1)-L*L))/(Rt+it),C=M>=0?this.y0+Yt:this.y0-Yt,g.x=b,g.y=C,g},inverse:function(g){var b,C,P,M,G,W,U,it,st,dt,wt,Mt,Gt;return g.x-=this.x0,g.y-=this.y0,wt=Math.PI*this.R,P=g.x/wt,M=g.y/wt,G=P*P+M*M,W=-Math.abs(M)*(1+G),U=W-2*M*M+P*P,it=-2*W+1+2*M*M+G*G,Gt=M*M/it+(2*U*U*U/it/it/it-9*W*U/it/it)/27,st=(W-U*U/3/it)/it,dt=2*Math.sqrt(-st/3),wt=3*Gt/st/dt,Math.abs(wt)>1&&(wt=wt>=0?1:-1),Mt=Math.acos(wt)/3,C=g.y>=0?(-dt*Math.cos(Mt+Math.PI/3)-U/3/it)*Math.PI:-(-dt*Math.cos(Mt+Math.PI/3)-U/3/it)*Math.PI,b=Math.abs(P)<Ut?this.long0:Kt(this.long0+Math.PI*(G-1+Math.sqrt(1+2*(P*P-M*M)+G*G))/2/P),g.x=b,g.y=C,g},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},Jr={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(g){var b,C,P,M,G,W,U,it,st,dt,wt,Mt,Gt,Rt,Yt,L,r,o,h,f,d,m,x,w=g.x,A=g.y,O=Math.sin(g.y),B=Math.cos(g.y),Y=Kt(w-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=Ut?(g.x=this.x0+this.a*(Tt-A)*Math.sin(Y),g.y=this.y0-this.a*(Tt-A)*Math.cos(Y),g):Math.abs(this.sin_p12+1)<=Ut?(g.x=this.x0+this.a*(Tt+A)*Math.sin(Y),g.y=this.y0+this.a*(Tt+A)*Math.cos(Y),g):(o=this.sin_p12*O+this.cos_p12*B*Math.cos(Y),L=Math.acos(o),r=L?L/Math.sin(L):1,g.x=this.x0+this.a*r*B*Math.sin(Y),g.y=this.y0+this.a*r*(this.cos_p12*O-this.sin_p12*B*Math.cos(Y)),g):(b=Ar(this.es),C=Wn(this.es),P=Xn(this.es),M=jn(this.es),Math.abs(this.sin_p12-1)<=Ut?(G=this.a*pi(b,C,P,M,Tt),W=this.a*pi(b,C,P,M,A),g.x=this.x0+(G-W)*Math.sin(Y),g.y=this.y0-(G-W)*Math.cos(Y),g):Math.abs(this.sin_p12+1)<=Ut?(G=this.a*pi(b,C,P,M,Tt),W=this.a*pi(b,C,P,M,A),g.x=this.x0+(G+W)*Math.sin(Y),g.y=this.y0+(G+W)*Math.cos(Y),g):(U=O/B,it=ws(this.a,this.e,this.sin_p12),st=ws(this.a,this.e,O),dt=Math.atan((1-this.es)*U+this.es*it*this.sin_p12/(st*B)),wt=Math.atan2(Math.sin(Y),this.cos_p12*Math.tan(dt)-this.sin_p12*Math.cos(Y)),h=wt===0?Math.asin(this.cos_p12*Math.sin(dt)-this.sin_p12*Math.cos(dt)):Math.abs(Math.abs(wt)-Math.PI)<=Ut?-Math.asin(this.cos_p12*Math.sin(dt)-this.sin_p12*Math.cos(dt)):Math.asin(Math.sin(Y)*Math.cos(dt)/Math.sin(wt)),Mt=this.e*this.sin_p12/Math.sqrt(1-this.es),Gt=this.e*this.cos_p12*Math.cos(wt)/Math.sqrt(1-this.es),Rt=Mt*Gt,Yt=Gt*Gt,f=h*h,d=f*h,m=d*h,x=m*h,L=it*h*(1-f*Yt*(1-Yt)/6+d/8*Rt*(1-2*Yt)+m/120*(Yt*(4-7*Yt)-3*Mt*Mt*(1-7*Yt))-x/48*Rt),g.x=this.x0+L*Math.sin(wt),g.y=this.y0+L*Math.cos(wt),g))},inverse:function(g){g.x-=this.x0,g.y-=this.y0;var b,C,P,M,G,W,U,it,st,dt,wt,Mt,Gt,Rt,Yt,L,r,o,h,f,d,m,x,w;return this.sphere?(b=Math.sqrt(g.x*g.x+g.y*g.y))>2*Tt*this.a?void 0:(C=b/this.a,P=Math.sin(C),M=Math.cos(C),G=this.long0,Math.abs(b)<=Ut?W=this.lat0:(W=En(M*this.sin_p12+g.y*P*this.cos_p12/b),U=Math.abs(this.lat0)-Tt,G=Kt(Math.abs(U)<=Ut?this.lat0>=0?this.long0+Math.atan2(g.x,-g.y):this.long0-Math.atan2(-g.x,g.y):this.long0+Math.atan2(g.x*P,b*this.cos_p12*M-g.y*this.sin_p12*P))),g.x=G,g.y=W,g):(it=Ar(this.es),st=Wn(this.es),dt=Xn(this.es),wt=jn(this.es),Math.abs(this.sin_p12-1)<=Ut?(Mt=this.a*pi(it,st,dt,wt,Tt),b=Math.sqrt(g.x*g.x+g.y*g.y),Gt=Mt-b,W=ns(Gt/this.a,it,st,dt,wt),G=Kt(this.long0+Math.atan2(g.x,-1*g.y)),g.x=G,g.y=W,g):Math.abs(this.sin_p12+1)<=Ut?(Mt=this.a*pi(it,st,dt,wt,Tt),b=Math.sqrt(g.x*g.x+g.y*g.y),Gt=b-Mt,W=ns(Gt/this.a,it,st,dt,wt),G=Kt(this.long0+Math.atan2(g.x,g.y)),g.x=G,g.y=W,g):(b=Math.sqrt(g.x*g.x+g.y*g.y),L=Math.atan2(g.x,g.y),Rt=ws(this.a,this.e,this.sin_p12),r=Math.cos(L),o=this.e*this.cos_p12*r,h=-o*o/(1-this.es),f=3*this.es*(1-h)*this.sin_p12*this.cos_p12*r/(1-this.es),d=b/Rt,m=d-h*(1+h)*Math.pow(d,3)/6-f*(1+3*h)*Math.pow(d,4)/24,x=1-h*m*m/2-d*m*m*m/6,Yt=Math.asin(this.sin_p12*Math.cos(m)+this.cos_p12*Math.sin(m)*r),G=Kt(this.long0+Math.asin(Math.sin(L)*Math.sin(m)/Math.cos(Yt))),w=Math.sin(Yt),W=Math.atan2((w-this.es*x*this.sin_p12)*Math.tan(Yt),w*(1-this.es)),g.x=G,g.y=W,g))},names:["Azimuthal_Equidistant","aeqd"]},bs={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(g){var b,C,P,M,G,W,U,it=g.x,st=g.y;return P=Kt(it-this.long0),b=Math.sin(st),C=Math.cos(st),M=Math.cos(P),((G=this.sin_p14*b+this.cos_p14*C*M)>0||Math.abs(G)<=Ut)&&(W=1*this.a*C*Math.sin(P),U=this.y0+1*this.a*(this.cos_p14*b-this.sin_p14*C*M)),g.x=W,g.y=U,g},inverse:function(g){var b,C,P,M,G,W,U;return g.x-=this.x0,g.y-=this.y0,b=Math.sqrt(g.x*g.x+g.y*g.y),C=En(b/this.a),P=Math.sin(C),M=Math.cos(C),W=this.long0,Math.abs(b)<=Ut?(U=this.lat0,g.x=W,g.y=U,g):(U=En(M*this.sin_p14+g.y*P*this.cos_p14/b),G=Math.abs(this.lat0)-Tt,Math.abs(G)<=Ut?(W=Kt(this.lat0>=0?this.long0+Math.atan2(g.x,-g.y):this.long0-Math.atan2(-g.x,g.y)),g.x=W,g.y=U,g):(W=Kt(this.long0+Math.atan2(g.x*P,b*this.cos_p14*M-g.y*this.sin_p14*P)),g.x=W,g.y=U,g))},names:["ortho"]},fe={FRONT:1,RIGHT:2,BACK:3,LEFT:4,TOP:5,BOTTOM:6},Zt={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4},xu={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=Tt-ge/2?this.face=fe.TOP:this.lat0<=-(Tt-ge/2)?this.face=fe.BOTTOM:Math.abs(this.long0)<=ge?this.face=fe.FRONT:Math.abs(this.long0)<=Tt+ge?this.face=this.long0>0?fe.RIGHT:fe.LEFT:this.face=fe.BACK,this.es!==0&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(g){var b,C,P,M,G,W,U={x:0,y:0},it={value:0};if(g.x-=this.long0,b=this.es!==0?Math.atan(this.one_minus_f_squared*Math.tan(g.y)):g.y,C=g.x,this.face===fe.TOP)M=Tt-b,C>=ge&&C<=Tt+ge?(it.value=Zt.AREA_0,P=C-Tt):C>Tt+ge||C<=-(Tt+ge)?(it.value=Zt.AREA_1,P=C>0?C-we:C+we):C>-(Tt+ge)&&C<=-ge?(it.value=Zt.AREA_2,P=C+Tt):(it.value=Zt.AREA_3,P=C);else if(this.face===fe.BOTTOM)M=Tt+b,C>=ge&&C<=Tt+ge?(it.value=Zt.AREA_0,P=-C+Tt):C<ge&&C>=-ge?(it.value=Zt.AREA_1,P=-C):C<-ge&&C>=-(Tt+ge)?(it.value=Zt.AREA_2,P=-C-Tt):(it.value=Zt.AREA_3,P=C>0?-C+we:-C-we);else{var st,dt,wt,Mt,Gt,Rt;this.face===fe.RIGHT?C=le(C,+Tt):this.face===fe.BACK?C=le(C,+we):this.face===fe.LEFT&&(C=le(C,-Tt)),Mt=Math.sin(b),Gt=Math.cos(b),Rt=Math.sin(C),st=Gt*Math.cos(C),dt=Gt*Rt,wt=Mt,this.face===fe.FRONT?P=rn(M=Math.acos(st),wt,dt,it):this.face===fe.RIGHT?P=rn(M=Math.acos(dt),wt,-st,it):this.face===fe.BACK?P=rn(M=Math.acos(-st),wt,-dt,it):this.face===fe.LEFT?P=rn(M=Math.acos(-dt),wt,st,it):(M=P=0,it.value=Zt.AREA_0)}return W=Math.atan(12/we*(P+Math.acos(Math.sin(P)*Math.cos(ge))-Tt)),G=Math.sqrt((1-Math.cos(M))/(Math.cos(W)*Math.cos(W))/(1-Math.cos(Math.atan(1/Math.cos(P))))),it.value===Zt.AREA_1?W+=Tt:it.value===Zt.AREA_2?W+=we:it.value===Zt.AREA_3&&(W+=1.5*we),U.x=G*Math.cos(W),U.y=G*Math.sin(W),U.x=U.x*this.a+this.x0,U.y=U.y*this.a+this.y0,g.x=U.x,g.y=U.y,g},inverse:function(g){var b,C,P,M,G,W,U,it,st,dt={lam:0,phi:0},wt={value:0};if(g.x=(g.x-this.x0)/this.a,g.y=(g.y-this.y0)/this.a,C=Math.atan(Math.sqrt(g.x*g.x+g.y*g.y)),b=Math.atan2(g.y,g.x),g.x>=0&&g.x>=Math.abs(g.y)?wt.value=Zt.AREA_0:g.y>=0&&g.y>=Math.abs(g.x)?(wt.value=Zt.AREA_1,b-=Tt):g.x<0&&-g.x>=Math.abs(g.y)?(wt.value=Zt.AREA_2,b=b<0?b+we:b-we):(wt.value=Zt.AREA_3,b+=Tt),st=we/12*Math.tan(b),G=Math.sin(st)/(Math.cos(st)-1/Math.sqrt(2)),W=Math.atan(G),P=Math.cos(b),M=Math.tan(C),(U=1-P*P*M*M*(1-Math.cos(Math.atan(1/Math.cos(W)))))<-1?U=-1:U>1&&(U=1),this.face===fe.TOP)it=Math.acos(U),dt.phi=Tt-it,wt.value===Zt.AREA_0?dt.lam=W+Tt:wt.value===Zt.AREA_1?dt.lam=W<0?W+we:W-we:wt.value===Zt.AREA_2?dt.lam=W-Tt:dt.lam=W;else if(this.face===fe.BOTTOM)it=Math.acos(U),dt.phi=it-Tt,wt.value===Zt.AREA_0?dt.lam=-W+Tt:wt.value===Zt.AREA_1?dt.lam=-W:wt.value===Zt.AREA_2?dt.lam=-W-Tt:dt.lam=W<0?-W-we:-W+we;else{var Mt,Gt,Rt;st=(Mt=U)*Mt,Gt=(st+=(Rt=st>=1?0:Math.sqrt(1-st)*Math.sin(W))*Rt)>=1?0:Math.sqrt(1-st),wt.value===Zt.AREA_1?(st=Gt,Gt=-Rt,Rt=st):wt.value===Zt.AREA_2?(Gt=-Gt,Rt=-Rt):wt.value===Zt.AREA_3&&(st=Gt,Gt=Rt,Rt=-st),this.face===fe.RIGHT?(st=Mt,Mt=-Gt,Gt=st):this.face===fe.BACK?(Mt=-Mt,Gt=-Gt):this.face===fe.LEFT&&(st=Mt,Mt=Gt,Gt=-st),dt.phi=Math.acos(-Rt)-Tt,dt.lam=Math.atan2(Gt,Mt),this.face===fe.RIGHT?dt.lam=le(dt.lam,-Tt):this.face===fe.BACK?dt.lam=le(dt.lam,-we):this.face===fe.LEFT&&(dt.lam=le(dt.lam,+Tt))}if(this.es!==0){var Yt,L,r;Yt=dt.phi<0?1:0,L=Math.tan(dt.phi),r=this.b/Math.sqrt(L*L+this.one_minus_f_squared),dt.phi=Math.atan(Math.sqrt(this.a*this.a-r*r)/(this.one_minus_f*r)),Yt&&(dt.phi=-dt.phi)}return dt.lam+=this.long0,g.x=dt.lam,g.y=dt.phi,g},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},ii=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-986701e-12],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,18736e-12],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,934959e-12],[.7986,-.00755338,-500009e-10,935324e-12],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],In=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-126793e-14,422642e-15],[.124,.0124,507171e-14,-160604e-14],[.186,.0123999,-190189e-13,600152e-14],[.248,.0124002,710039e-13,-224e-10],[.31,.0123992,-264997e-12,835986e-13],[.372,.0124029,988983e-12,-311994e-12],[.434,.0123893,-369093e-11,-435621e-12],[.4958,.0123198,-102252e-10,-345523e-12],[.5571,.0121916,-154081e-10,-582288e-12],[.6176,.0119938,-241424e-10,-525327e-12],[.6769,.011713,-320223e-10,-516405e-12],[.7346,.0113541,-397684e-10,-609052e-12],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-140374e-14],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Es=.8487,Cl=1.3523,Cn=Ue/5,Ha=1/Cn,Is=18,Ks=function(g,b){return g[0]+b*(g[1]+b*(g[2]+b*g[3]))},Al=function(g,b){return g[1]+b*(2*g[2]+3*b*g[3])},Rl={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(g){var b=Kt(g.x-this.long0),C=Math.abs(g.y),P=Math.floor(C*Cn);P<0?P=0:P>=Is&&(P=Is-1),C=Ue*(C-Ha*P);var M={x:Ks(ii[P],C)*b,y:Ks(In[P],C)};return g.y<0&&(M.y=-M.y),M.x=M.x*this.a*Es+this.x0,M.y=M.y*this.a*Cl+this.y0,M},inverse:function(g){var b={x:(g.x-this.x0)/(this.a*Es),y:Math.abs(g.y-this.y0)/(this.a*Cl)};if(b.y>=1)b.x/=ii[Is][0],b.y=g.y<0?-Tt:Tt;else{var C=Math.floor(b.y*Is);for(C<0?C=0:C>=Is&&(C=Is-1);;)if(In[C][0]>b.y)--C;else{if(!(In[C+1][0]<=b.y))break;++C}var P=In[C],M=5*(b.y-P[0])/(In[C+1][0]-P[0]);M=jt(function(G){return(Ks(P,G)-b.y)/Al(P,G)},M,Ut,100),b.x/=Ks(ii[C],M),b.y=(5*C+M)*Xe,g.y<0&&(b.y=-b.y)}return b.x=Kt(b.x+this.long0),b},names:["Robinson","robin"]},_u={init:function(){this.name="geocent"},forward:function(g){return bt(g,this.es,this.a)},inverse:function(g){return Dt(g,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]},yi={N_POLE:0,S_POLE:1,EQUIT:2,OBLIQ:3},Cs={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}},wu={init:function(){if(Object.keys(Cs).forEach(function(C){if(this[C]===void 0)this[C]=Cs[C].def;else{if(Cs[C].num&&isNaN(this[C]))throw new Error("Invalid parameter value, must be numeric "+C+" = "+this[C]);Cs[C].num&&(this[C]=parseFloat(this[C]))}Cs[C].degrees&&(this[C]=this[C]*Xe)}.bind(this)),Math.abs(Math.abs(this.lat0)-Tt)<Ut?this.mode=this.lat0<0?yi.S_POLE:yi.N_POLE:Math.abs(this.lat0)<Ut?this.mode=yi.EQUIT:(this.mode=yi.OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var g=this.tilt,b=this.azi;this.cg=Math.cos(b),this.sg=Math.sin(b),this.cw=Math.cos(g),this.sw=Math.sin(g)},forward:function(g){g.x-=this.long0;var b,C,P=Math.sin(g.y),M=Math.cos(g.y),G=Math.cos(g.x);switch(this.mode){case yi.OBLIQ:C=this.sinph0*P+this.cosph0*M*G;break;case yi.EQUIT:C=M*G;break;case yi.S_POLE:C=-P;break;case yi.N_POLE:C=P}switch(C=this.pn1/(this.p-C),b=C*M*Math.sin(g.x),this.mode){case yi.OBLIQ:C*=this.cosph0*P-this.sinph0*M*G;break;case yi.EQUIT:C*=P;break;case yi.N_POLE:C*=-M*G;break;case yi.S_POLE:C*=M*G}var W,U;return W=C*this.cg+b*this.sg,U=1/(W*this.sw*this.h1+this.cw),b=(b*this.cg-C*this.sg)*this.cw*U,C=W*U,g.x=b*this.a,g.y=C*this.a,g},inverse:function(g){g.x/=this.a,g.y/=this.a;var b,C,P,M={x:g.x,y:g.y};P=1/(this.pn1-g.y*this.sw),b=this.pn1*g.x*P,C=this.pn1*g.y*this.cw*P,g.x=b*this.cg+C*this.sg,g.y=C*this.cg-b*this.sg;var G=Ki(g.x,g.y);if(Math.abs(G)<Ut)M.x=0,M.y=g.y;else{var W,U;switch(U=1-G*G*this.pfact,U=(this.p-Math.sqrt(U))/(this.pn1/G+G/this.pn1),W=Math.sqrt(1-U*U),this.mode){case yi.OBLIQ:M.y=Math.asin(W*this.sinph0+g.y*U*this.cosph0/G),g.y=(W-this.sinph0*Math.sin(M.y))*G,g.x*=U*this.cosph0;break;case yi.EQUIT:M.y=Math.asin(g.y*U/G),g.y=W*G,g.x*=U;break;case yi.N_POLE:M.y=Math.asin(W),g.y=-g.y;break;case yi.S_POLE:M.y=-Math.asin(W)}M.x=Math.atan2(g.x,g.y)}return g.x=M.x+this.long0,g.y=M.y,g},names:["Tilted_Perspective","tpers"]},Sr={init:function(){if(this.flip_axis=this.sweep==="x"?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,this.es!==0){var g=1-this.es,b=1/g;this.radius_p=Math.sqrt(g),this.radius_p2=g,this.radius_p_inv2=b,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(g){var b,C,P,M,G=g.x,W=g.y;if(G-=this.long0,this.shape==="ellipse"){W=Math.atan(this.radius_p2*Math.tan(W));var U=this.radius_p/Ki(this.radius_p*Math.cos(W),Math.sin(W));if(C=U*Math.cos(G)*Math.cos(W),P=U*Math.sin(G)*Math.cos(W),M=U*Math.sin(W),(this.radius_g-C)*C-P*P-M*M*this.radius_p_inv2<0)return g.x=Number.NaN,g.y=Number.NaN,g;b=this.radius_g-C,this.flip_axis?(g.x=this.radius_g_1*Math.atan(P/Ki(M,b)),g.y=this.radius_g_1*Math.atan(M/b)):(g.x=this.radius_g_1*Math.atan(P/b),g.y=this.radius_g_1*Math.atan(M/Ki(P,b)))}else this.shape==="sphere"&&(b=Math.cos(W),C=Math.cos(G)*b,P=Math.sin(G)*b,M=Math.sin(W),b=this.radius_g-C,this.flip_axis?(g.x=this.radius_g_1*Math.atan(P/Ki(M,b)),g.y=this.radius_g_1*Math.atan(M/b)):(g.x=this.radius_g_1*Math.atan(P/b),g.y=this.radius_g_1*Math.atan(M/Ki(P,b))));return g.x=g.x*this.a,g.y=g.y*this.a,g},inverse:function(g){var b,C,P,M,G=-1,W=0,U=0;if(g.x=g.x/this.a,g.y=g.y/this.a,this.shape==="ellipse"){this.flip_axis?(U=Math.tan(g.y/this.radius_g_1),W=Math.tan(g.x/this.radius_g_1)*Ki(1,U)):(W=Math.tan(g.x/this.radius_g_1),U=Math.tan(g.y/this.radius_g_1)*Ki(1,W));var it=U/this.radius_p;if(b=W*W+it*it+G*G,C=2*this.radius_g*G,(P=C*C-4*b*this.C)<0)return g.x=Number.NaN,g.y=Number.NaN,g;M=(-C-Math.sqrt(P))/(2*b),G=this.radius_g+M*G,W*=M,U*=M,g.x=Math.atan2(W,G),g.y=Math.atan(U*Math.cos(g.x)/G),g.y=Math.atan(this.radius_p_inv2*Math.tan(g.y))}else if(this.shape==="sphere"){if(this.flip_axis?(U=Math.tan(g.y/this.radius_g_1),W=Math.tan(g.x/this.radius_g_1)*Math.sqrt(1+U*U)):(W=Math.tan(g.x/this.radius_g_1),U=Math.tan(g.y/this.radius_g_1)*Math.sqrt(1+W*W)),b=W*W+U*U+G*G,C=2*this.radius_g*G,(P=C*C-4*b*this.C)<0)return g.x=Number.NaN,g.y=Number.NaN,g;M=(-C-Math.sqrt(P))/(2*b),G=this.radius_g+M*G,W*=M,U*=M,g.x=Math.atan2(W,G),g.y=Math.atan(U*Math.cos(g.x)/G)}return g.x=g.x+this.long0,g},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};return Ge.defaultDatum="WGS84",Ge.Proj=rt,Ge.WGS84=new Ge.Proj("WGS84"),Ge.Point=re,Ge.toPoint=Kr,Ge.defs=y,Ge.nadgrid=function(g,b){var C=new DataView(b),P=nt(C),M=ot(C,P),G={header:M,subgrids:tt(C,M,P)};return Ye[g]=G,G},Ge.transform=me,Ge.mgrs=Fi,Ge.version="2.10.0",function(g){g.Proj.projections.add(Wi),g.Proj.projections.add(_s),g.Proj.projections.add(lu),g.Proj.projections.add(ce),g.Proj.projections.add(hu),g.Proj.projections.add(Te),g.Proj.projections.add(uu),g.Proj.projections.add(Wa),g.Proj.projections.add(_l),g.Proj.projections.add(qi),g.Proj.projections.add(El),g.Proj.projections.add(ss),g.Proj.projections.add(gu),g.Proj.projections.add(Me),g.Proj.projections.add(Ni),g.Proj.projections.add(Il),g.Proj.projections.add(mu),g.Proj.projections.add(pu),g.Proj.projections.add(Xa),g.Proj.projections.add(Si),g.Proj.projections.add(ja),g.Proj.projections.add(fi),g.Proj.projections.add(Jr),g.Proj.projections.add(bs),g.Proj.projections.add(xu),g.Proj.projections.add(Rl),g.Proj.projections.add(_u),g.Proj.projections.add(wu),g.Proj.projections.add(Sr)}(Ge),Ge})})(vy);var vI=vy.exports;const Bl=od(vI);function OI(i){const t=Object.keys(i.defs),e=t.length;let n,s;for(n=0;n<e;++n){const a=t[n];if(!li(a)){const l=i.defs(a);let u=l.units;!u&&l.projName==="longlat"&&(u="degrees"),d2(new ff({code:a,axisOrientation:l.axis,metersPerUnit:l.to_meter,units:u}))}}for(n=0;n<e;++n){const a=t[n],l=li(a);for(s=0;s<e;++s){const u=t[s],c=li(u);if(!l2(a,u))if(i.defs[a]===i.defs[u])bc([l,c]);else{const p=i(a,u);p_(l,c,M0(l,c,p.forward),M0(c,l,p.inverse))}}}}var Li;(function(i){i[i.QR_CODE=0]="QR_CODE",i[i.AZTEC=1]="AZTEC",i[i.CODABAR=2]="CODABAR",i[i.CODE_39=3]="CODE_39",i[i.CODE_93=4]="CODE_93",i[i.CODE_128=5]="CODE_128",i[i.DATA_MATRIX=6]="DATA_MATRIX",i[i.MAXICODE=7]="MAXICODE",i[i.ITF=8]="ITF",i[i.EAN_13=9]="EAN_13",i[i.EAN_8=10]="EAN_8",i[i.PDF_417=11]="PDF_417",i[i.RSS_14=12]="RSS_14",i[i.RSS_EXPANDED=13]="RSS_EXPANDED",i[i.UPC_A=14]="UPC_A",i[i.UPC_E=15]="UPC_E",i[i.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Li||(Li={}));Li.QR_CODE,Li.AZTEC,Li.CODABAR,Li.CODE_39,Li.CODE_93,Li.CODE_128,Li.DATA_MATRIX,Li.MAXICODE,Li.ITF,Li.EAN_13,Li.EAN_8,Li.PDF_417,Li.RSS_14,Li.RSS_EXPANDED,Li.UPC_A,Li.UPC_E,Li.UPC_EAN_EXTENSION;var x1;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.URL=1]="URL"})(x1||(x1={}));var ph;(function(i){i[i.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",i[i.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(ph||(ph={}));var PI=function(){function i(){}return i.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",i.SCAN_DEFAULT_FPS=2,i.DEFAULT_DISABLE_FLIP=!1,i.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,i.DEFAULT_SUPPORTED_SCAN_TYPE=[ph.SCAN_TYPE_CAMERA,ph.SCAN_TYPE_FILE],i}(),_1;(function(i){i[i.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",i[i.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",i[i.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(_1||(_1={}));var w1={exports:{}};(function(i,t){(function(e,n){n(t)})(hn,function(e){function n(L){return L==null}var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(L,r){L.__proto__=r}||function(L,r){for(var o in r)r.hasOwnProperty(o)&&(L[o]=r[o])};function a(L,r){s(L,r);function o(){this.constructor=L}L.prototype=r===null?Object.create(r):(o.prototype=r.prototype,new o)}function l(L,r){var o=Object.setPrototypeOf;o?o(L,r):L.__proto__=r}function u(L,r){r===void 0&&(r=L.constructor);var o=Error.captureStackTrace;o&&o(L,r)}var c=function(L){a(r,L);function r(o){var h=this.constructor,f=L.call(this,o)||this;return Object.defineProperty(f,"name",{value:h.name,enumerable:!1}),l(f,h.prototype),u(f),f}return r}(Error);class p extends c{constructor(r=void 0){super(r),this.message=r}getKind(){return this.constructor.kind}}p.kind="Exception";class y extends p{}y.kind="ArgumentException";class _ extends p{}_.kind="IllegalArgumentException";class E{constructor(r){if(this.binarizer=r,r===null)throw new _("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(r,o){return this.binarizer.getBlackRow(r,o)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(r,o,h,f){const d=this.binarizer.getLuminanceSource().crop(r,o,h,f);return new E(this.binarizer.createBinarizer(d))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new E(this.binarizer.createBinarizer(r))}rotateCounterClockwise45(){const r=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new E(this.binarizer.createBinarizer(r))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class I extends p{static getChecksumInstance(){return new I}}I.kind="ChecksumException";class S{constructor(r){this.source=r}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class R{static arraycopy(r,o,h,f,d){for(;d--;)h[f++]=r[o++]}static currentTimeMillis(){return Date.now()}}class D extends p{}D.kind="IndexOutOfBoundsException";class T extends D{constructor(r=void 0,o=void 0){super(o),this.index=r,this.message=o}}T.kind="ArrayIndexOutOfBoundsException";class v{static fill(r,o){for(let h=0,f=r.length;h<f;h++)r[h]=o}static fillWithin(r,o,h,f){v.rangeCheck(r.length,o,h);for(let d=o;d<h;d++)r[d]=f}static rangeCheck(r,o,h){if(o>h)throw new _("fromIndex("+o+") > toIndex("+h+")");if(o<0)throw new T(o);if(h>r)throw new T(h)}static asList(...r){return r}static create(r,o,h){return Array.from({length:r}).map(d=>Array.from({length:o}).fill(h))}static createInt32Array(r,o,h){return Array.from({length:r}).map(d=>Int32Array.from({length:o}).fill(h))}static equals(r,o){if(!r||!o||!r.length||!o.length||r.length!==o.length)return!1;for(let h=0,f=r.length;h<f;h++)if(r[h]!==o[h])return!1;return!0}static hashCode(r){if(r===null)return 0;let o=1;for(const h of r)o=31*o+h;return o}static fillUint8Array(r,o){for(let h=0;h!==r.length;h++)r[h]=o}static copyOf(r,o){return r.slice(0,o)}static copyOfUint8Array(r,o){if(r.length<=o){const h=new Uint8Array(o);return h.set(r),h}return r.slice(0,o)}static copyOfRange(r,o,h){const f=h-o,d=new Int32Array(f);return R.arraycopy(r,o,d,0,f),d}static binarySearch(r,o,h){h===void 0&&(h=v.numberComparator);let f=0,d=r.length-1;for(;f<=d;){const m=d+f>>1,x=h(o,r[m]);if(x>0)f=m+1;else if(x<0)d=m-1;else return m}return-f-1}static numberComparator(r,o){return r-o}}class k{static numberOfTrailingZeros(r){let o;if(r===0)return 32;let h=31;return o=r<<16,o!==0&&(h-=16,r=o),o=r<<8,o!==0&&(h-=8,r=o),o=r<<4,o!==0&&(h-=4,r=o),o=r<<2,o!==0&&(h-=2,r=o),h-(r<<1>>>31)}static numberOfLeadingZeros(r){if(r===0)return 32;let o=1;return r>>>16||(o+=16,r<<=16),r>>>24||(o+=8,r<<=8),r>>>28||(o+=4,r<<=4),r>>>30||(o+=2,r<<=2),o-=r>>>31,o}static toHexString(r){return r.toString(16)}static toBinaryString(r){return String(parseInt(String(r),2))}static bitCount(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),r=r+(r>>>4)&252645135,r=r+(r>>>8),r=r+(r>>>16),r&63}static truncDivision(r,o){return Math.trunc(r/o)}static parseInt(r,o=void 0){return parseInt(r,o)}}k.MIN_VALUE_32_BITS=-2147483648,k.MAX_VALUE=Number.MAX_SAFE_INTEGER;class X{constructor(r,o){r===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=r,o==null?this.bits=X.makeArray(r):this.bits=o)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(r){if(r>this.bits.length*32){const o=X.makeArray(r);R.arraycopy(this.bits,0,o,0,this.bits.length),this.bits=o}}get(r){return(this.bits[Math.floor(r/32)]&1<<(r&31))!==0}set(r){this.bits[Math.floor(r/32)]|=1<<(r&31)}flip(r){this.bits[Math.floor(r/32)]^=1<<(r&31)}getNextSet(r){const o=this.size;if(r>=o)return o;const h=this.bits;let f=Math.floor(r/32),d=h[f];d&=~((1<<(r&31))-1);const m=h.length;for(;d===0;){if(++f===m)return o;d=h[f]}const x=f*32+k.numberOfTrailingZeros(d);return x>o?o:x}getNextUnset(r){const o=this.size;if(r>=o)return o;const h=this.bits;let f=Math.floor(r/32),d=~h[f];d&=~((1<<(r&31))-1);const m=h.length;for(;d===0;){if(++f===m)return o;d=~h[f]}const x=f*32+k.numberOfTrailingZeros(d);return x>o?o:x}setBulk(r,o){this.bits[Math.floor(r/32)]=o}setRange(r,o){if(o<r||r<0||o>this.size)throw new _;if(o===r)return;o--;const h=Math.floor(r/32),f=Math.floor(o/32),d=this.bits;for(let m=h;m<=f;m++){const x=m>h?0:r&31,A=(2<<(m<f?31:o&31))-(1<<x);d[m]|=A}}clear(){const r=this.bits.length,o=this.bits;for(let h=0;h<r;h++)o[h]=0}isRange(r,o,h){if(o<r||r<0||o>this.size)throw new _;if(o===r)return!0;o--;const f=Math.floor(r/32),d=Math.floor(o/32),m=this.bits;for(let x=f;x<=d;x++){const w=x>f?0:r&31,O=(2<<(x<d?31:o&31))-(1<<w)&4294967295;if((m[x]&O)!==(h?O:0))return!1}return!0}appendBit(r){this.ensureCapacity(this.size+1),r&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(r,o){if(o<0||o>32)throw new _("Num bits must be between 0 and 32");this.ensureCapacity(this.size+o);for(let h=o;h>0;h--)this.appendBit((r>>h-1&1)===1)}appendBitArray(r){const o=r.size;this.ensureCapacity(this.size+o);for(let h=0;h<o;h++)this.appendBit(r.get(h))}xor(r){if(this.size!==r.size)throw new _("Sizes don't match");const o=this.bits;for(let h=0,f=o.length;h<f;h++)o[h]^=r.bits[h]}toBytes(r,o,h,f){for(let d=0;d<f;d++){let m=0;for(let x=0;x<8;x++)this.get(r)&&(m|=1<<7-x),r++;o[h+d]=m}}getBitArray(){return this.bits}reverse(){const r=new Int32Array(this.bits.length),o=Math.floor((this.size-1)/32),h=o+1,f=this.bits;for(let d=0;d<h;d++){let m=f[d];m=m>>1&1431655765|(m&1431655765)<<1,m=m>>2&858993459|(m&858993459)<<2,m=m>>4&252645135|(m&252645135)<<4,m=m>>8&16711935|(m&16711935)<<8,m=m>>16&65535|(m&65535)<<16,r[o-d]=m}if(this.size!==h*32){const d=h*32-this.size;let m=r[0]>>>d;for(let x=1;x<h;x++){const w=r[x];m|=w<<32-d,r[x-1]=m,m=w>>>d}r[h-1]=m}this.bits=r}static makeArray(r){return new Int32Array(Math.floor((r+31)/32))}equals(r){if(!(r instanceof X))return!1;const o=r;return this.size===o.size&&v.equals(this.bits,o.bits)}hashCode(){return 31*this.size+v.hashCode(this.bits)}toString(){let r="";for(let o=0,h=this.size;o<h;o++)o&7||(r+=" "),r+=this.get(o)?"X":".";return r}clone(){return new X(this.size,this.bits.slice())}}var H;(function(L){L[L.OTHER=0]="OTHER",L[L.PURE_BARCODE=1]="PURE_BARCODE",L[L.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",L[L.TRY_HARDER=3]="TRY_HARDER",L[L.CHARACTER_SET=4]="CHARACTER_SET",L[L.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",L[L.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",L[L.ASSUME_GS1=7]="ASSUME_GS1",L[L.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",L[L.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",L[L.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(H||(H={}));var K=H;class z extends p{static getFormatInstance(){return new z}}z.kind="FormatException";var q;(function(L){L[L.Cp437=0]="Cp437",L[L.ISO8859_1=1]="ISO8859_1",L[L.ISO8859_2=2]="ISO8859_2",L[L.ISO8859_3=3]="ISO8859_3",L[L.ISO8859_4=4]="ISO8859_4",L[L.ISO8859_5=5]="ISO8859_5",L[L.ISO8859_6=6]="ISO8859_6",L[L.ISO8859_7=7]="ISO8859_7",L[L.ISO8859_8=8]="ISO8859_8",L[L.ISO8859_9=9]="ISO8859_9",L[L.ISO8859_10=10]="ISO8859_10",L[L.ISO8859_11=11]="ISO8859_11",L[L.ISO8859_13=12]="ISO8859_13",L[L.ISO8859_14=13]="ISO8859_14",L[L.ISO8859_15=14]="ISO8859_15",L[L.ISO8859_16=15]="ISO8859_16",L[L.SJIS=16]="SJIS",L[L.Cp1250=17]="Cp1250",L[L.Cp1251=18]="Cp1251",L[L.Cp1252=19]="Cp1252",L[L.Cp1256=20]="Cp1256",L[L.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",L[L.UTF8=22]="UTF8",L[L.ASCII=23]="ASCII",L[L.Big5=24]="Big5",L[L.GB18030=25]="GB18030",L[L.EUC_KR=26]="EUC_KR"})(q||(q={}));class V{constructor(r,o,h,...f){this.valueIdentifier=r,this.name=h,typeof o=="number"?this.values=Int32Array.from([o]):this.values=o,this.otherEncodingNames=f,V.VALUE_IDENTIFIER_TO_ECI.set(r,this),V.NAME_TO_ECI.set(h,this);const d=this.values;for(let m=0,x=d.length;m!==x;m++){const w=d[m];V.VALUES_TO_ECI.set(w,this)}for(const m of f)V.NAME_TO_ECI.set(m,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(r){if(r<0||r>=900)throw new z("incorect value");const o=V.VALUES_TO_ECI.get(r);if(o===void 0)throw new z("incorect value");return o}static getCharacterSetECIByName(r){const o=V.NAME_TO_ECI.get(r);if(o===void 0)throw new z("incorect value");return o}equals(r){if(!(r instanceof V))return!1;const o=r;return this.getName()===o.getName()}}V.VALUE_IDENTIFIER_TO_ECI=new Map,V.VALUES_TO_ECI=new Map,V.NAME_TO_ECI=new Map,V.Cp437=new V(q.Cp437,Int32Array.from([0,2]),"Cp437"),V.ISO8859_1=new V(q.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),V.ISO8859_2=new V(q.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),V.ISO8859_3=new V(q.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),V.ISO8859_4=new V(q.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),V.ISO8859_5=new V(q.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),V.ISO8859_6=new V(q.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),V.ISO8859_7=new V(q.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),V.ISO8859_8=new V(q.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),V.ISO8859_9=new V(q.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),V.ISO8859_10=new V(q.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),V.ISO8859_11=new V(q.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),V.ISO8859_13=new V(q.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),V.ISO8859_14=new V(q.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),V.ISO8859_15=new V(q.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),V.ISO8859_16=new V(q.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),V.SJIS=new V(q.SJIS,20,"SJIS","Shift_JIS"),V.Cp1250=new V(q.Cp1250,21,"Cp1250","windows-1250"),V.Cp1251=new V(q.Cp1251,22,"Cp1251","windows-1251"),V.Cp1252=new V(q.Cp1252,23,"Cp1252","windows-1252"),V.Cp1256=new V(q.Cp1256,24,"Cp1256","windows-1256"),V.UnicodeBigUnmarked=new V(q.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),V.UTF8=new V(q.UTF8,26,"UTF8","UTF-8"),V.ASCII=new V(q.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),V.Big5=new V(q.Big5,28,"Big5"),V.GB18030=new V(q.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),V.EUC_KR=new V(q.EUC_KR,30,"EUC_KR","EUC-KR");class nt extends p{}nt.kind="UnsupportedOperationException";class ot{static decode(r,o){const h=this.encodingName(o);return this.customDecoder?this.customDecoder(r,h):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(h)?this.decodeFallback(r,h):new TextDecoder(h).decode(r)}static shouldDecodeOnFallback(r){return!ot.isBrowser()&&r==="ISO-8859-1"}static encode(r,o){const h=this.encodingName(o);return this.customEncoder?this.customEncoder(r,h):typeof TextEncoder>"u"?this.encodeFallback(r):new TextEncoder().encode(r)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(r){return typeof r=="string"?r:r.getName()}static encodingCharacterSet(r){return r instanceof V?r:V.getCharacterSetECIByName(r)}static decodeFallback(r,o){const h=this.encodingCharacterSet(o);if(ot.isDecodeFallbackSupported(h)){let f="";for(let d=0,m=r.length;d<m;d++){let x=r[d].toString(16);x.length<2&&(x="0"+x),f+="%"+x}return decodeURIComponent(f)}if(h.equals(V.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(r.buffer));throw new nt(`Encoding ${this.encodingName(o)} not supported by fallback.`)}static isDecodeFallbackSupported(r){return r.equals(V.UTF8)||r.equals(V.ISO8859_1)||r.equals(V.ASCII)}static encodeFallback(r){const h=btoa(unescape(encodeURIComponent(r))).split(""),f=[];for(let d=0;d<h.length;d++)f.push(h[d].charCodeAt(0));return new Uint8Array(f)}}class j{static castAsNonUtf8Char(r,o=null){const h=o?o.getName():this.ISO88591;return ot.decode(new Uint8Array([r]),h)}static guessEncoding(r,o){if(o!=null&&o.get(K.CHARACTER_SET)!==void 0)return o.get(K.CHARACTER_SET).toString();const h=r.length;let f=!0,d=!0,m=!0,x=0,w=0,A=0,O=0,B=0,Y=0,Q=0,ht=0,ut=0,yt=0,Ct=0;const zt=r.length>3&&r[0]===239&&r[1]===187&&r[2]===191;for(let Wt=0;Wt<h&&(f||d||m);Wt++){const Bt=r[Wt]&255;m&&(x>0?Bt&128?x--:m=!1:Bt&128&&(Bt&64?(x++,Bt&32?(x++,Bt&16?(x++,Bt&8?m=!1:O++):A++):w++):m=!1)),f&&(Bt>127&&Bt<160?f=!1:Bt>159&&(Bt<192||Bt===215||Bt===247)&&Ct++),d&&(B>0?Bt<64||Bt===127||Bt>252?d=!1:B--:Bt===128||Bt===160||Bt>239?d=!1:Bt>160&&Bt<224?(Y++,ht=0,Q++,Q>ut&&(ut=Q)):Bt>127?(B++,Q=0,ht++,ht>yt&&(yt=ht)):(Q=0,ht=0))}return m&&x>0&&(m=!1),d&&B>0&&(d=!1),m&&(zt||w+A+O>0)?j.UTF8:d&&(j.ASSUME_SHIFT_JIS||ut>=3||yt>=3)?j.SHIFT_JIS:f&&d?ut===2&&Y===2||Ct*10>=h?j.SHIFT_JIS:j.ISO88591:f?j.ISO88591:d?j.SHIFT_JIS:m?j.UTF8:j.PLATFORM_DEFAULT_ENCODING}static format(r,...o){let h=-1;function f(m,x,w,A,O,B){if(m==="%%")return"%";if(o[++h]===void 0)return;m=A?parseInt(A.substr(1)):void 0;let Y=O?parseInt(O.substr(1)):void 0,Q;switch(B){case"s":Q=o[h];break;case"c":Q=o[h][0];break;case"f":Q=parseFloat(o[h]).toFixed(m);break;case"p":Q=parseFloat(o[h]).toPrecision(m);break;case"e":Q=parseFloat(o[h]).toExponential(m);break;case"x":Q=parseInt(o[h]).toString(Y||16);break;case"d":Q=parseFloat(parseInt(o[h],Y||10).toPrecision(m)).toFixed(0);break}Q=typeof Q=="object"?JSON.stringify(Q):(+Q).toString(Y);let ht=parseInt(w),ut=w&&w[0]+""=="0"?"0":" ";for(;Q.length<ht;)Q=x!==void 0?Q+ut:ut+Q;return Q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(d,f)}static getBytes(r,o){return ot.encode(r,o)}static getCharCode(r,o=0){return r.charCodeAt(o)}static getCharAt(r){return String.fromCharCode(r)}}j.SHIFT_JIS=V.SJIS.getName(),j.GB2312="GB2312",j.ISO88591=V.ISO8859_1.getName(),j.EUC_JP="EUC_JP",j.UTF8=V.UTF8.getName(),j.PLATFORM_DEFAULT_ENCODING=j.UTF8,j.ASSUME_SHIFT_JIS=!1;class tt{constructor(r=""){this.value=r}enableDecoding(r){return this.encoding=r,this}append(r){return typeof r=="string"?this.value+=r.toString():this.encoding?this.value+=j.castAsNonUtf8Char(r,this.encoding):this.value+=String.fromCharCode(r),this}appendChars(r,o,h){for(let f=o;o<o+h;f++)this.append(r[f]);return this}length(){return this.value.length}charAt(r){return this.value.charAt(r)}deleteCharAt(r){this.value=this.value.substr(0,r)+this.value.substring(r+1)}setCharAt(r,o){this.value=this.value.substr(0,r)+o+this.value.substr(r+1)}substring(r,o){return this.value.substring(r,o)}setLengthToZero(){this.value=""}toString(){return this.value}insert(r,o){this.value=this.value.substr(0,r)+o+this.value.substr(r+o.length)}}class N{constructor(r,o,h,f){if(this.width=r,this.height=o,this.rowSize=h,this.bits=f,o==null&&(o=r),this.height=o,r<1||o<1)throw new _("Both dimensions must be greater than 0");h==null&&(h=Math.floor((r+31)/32)),this.rowSize=h,f==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(r){const o=r.length,h=r[0].length,f=new N(h,o);for(let d=0;d<o;d++){const m=r[d];for(let x=0;x<h;x++)m[x]&&f.set(x,d)}return f}static parseFromString(r,o,h){if(r===null)throw new _("stringRepresentation cannot be null");const f=new Array(r.length);let d=0,m=0,x=-1,w=0,A=0;for(;A<r.length;)if(r.charAt(A)===`
`||r.charAt(A)==="\r"){if(d>m){if(x===-1)x=d-m;else if(d-m!==x)throw new _("row lengths do not match");m=d,w++}A++}else if(r.substring(A,A+o.length)===o)A+=o.length,f[d]=!0,d++;else if(r.substring(A,A+h.length)===h)A+=h.length,f[d]=!1,d++;else throw new _("illegal character encountered: "+r.substring(A));if(d>m){if(x===-1)x=d-m;else if(d-m!==x)throw new _("row lengths do not match");w++}const O=new N(x,w);for(let B=0;B<d;B++)f[B]&&O.set(Math.floor(B%x),Math.floor(B/x));return O}get(r,o){const h=o*this.rowSize+Math.floor(r/32);return(this.bits[h]>>>(r&31)&1)!==0}set(r,o){const h=o*this.rowSize+Math.floor(r/32);this.bits[h]|=1<<(r&31)&4294967295}unset(r,o){const h=o*this.rowSize+Math.floor(r/32);this.bits[h]&=~(1<<(r&31)&4294967295)}flip(r,o){const h=o*this.rowSize+Math.floor(r/32);this.bits[h]^=1<<(r&31)&4294967295}xor(r){if(this.width!==r.getWidth()||this.height!==r.getHeight()||this.rowSize!==r.getRowSize())throw new _("input matrix dimensions do not match");const o=new X(Math.floor(this.width/32)+1),h=this.rowSize,f=this.bits;for(let d=0,m=this.height;d<m;d++){const x=d*h,w=r.getRow(d,o).getBitArray();for(let A=0;A<h;A++)f[x+A]^=w[A]}}clear(){const r=this.bits,o=r.length;for(let h=0;h<o;h++)r[h]=0}setRegion(r,o,h,f){if(o<0||r<0)throw new _("Left and top must be nonnegative");if(f<1||h<1)throw new _("Height and width must be at least 1");const d=r+h,m=o+f;if(m>this.height||d>this.width)throw new _("The region must fit inside the matrix");const x=this.rowSize,w=this.bits;for(let A=o;A<m;A++){const O=A*x;for(let B=r;B<d;B++)w[O+Math.floor(B/32)]|=1<<(B&31)&4294967295}}getRow(r,o){o==null||o.getSize()<this.width?o=new X(this.width):o.clear();const h=this.rowSize,f=this.bits,d=r*h;for(let m=0;m<h;m++)o.setBulk(m*32,f[d+m]);return o}setRow(r,o){R.arraycopy(o.getBitArray(),0,this.bits,r*this.rowSize,this.rowSize)}rotate180(){const r=this.getWidth(),o=this.getHeight();let h=new X(r),f=new X(r);for(let d=0,m=Math.floor((o+1)/2);d<m;d++)h=this.getRow(d,h),f=this.getRow(o-1-d,f),h.reverse(),f.reverse(),this.setRow(d,f),this.setRow(o-1-d,h)}getEnclosingRectangle(){const r=this.width,o=this.height,h=this.rowSize,f=this.bits;let d=r,m=o,x=-1,w=-1;for(let A=0;A<o;A++)for(let O=0;O<h;O++){const B=f[A*h+O];if(B!==0){if(A<m&&(m=A),A>w&&(w=A),O*32<d){let Y=0;for(;!(B<<31-Y&4294967295);)Y++;O*32+Y<d&&(d=O*32+Y)}if(O*32+31>x){let Y=31;for(;!(B>>>Y);)Y--;O*32+Y>x&&(x=O*32+Y)}}}return x<d||w<m?null:Int32Array.from([d,m,x-d+1,w-m+1])}getTopLeftOnBit(){const r=this.rowSize,o=this.bits;let h=0;for(;h<o.length&&o[h]===0;)h++;if(h===o.length)return null;const f=h/r;let d=h%r*32;const m=o[h];let x=0;for(;!(m<<31-x&4294967295);)x++;return d+=x,Int32Array.from([d,f])}getBottomRightOnBit(){const r=this.rowSize,o=this.bits;let h=o.length-1;for(;h>=0&&o[h]===0;)h--;if(h<0)return null;const f=Math.floor(h/r);let d=Math.floor(h%r)*32;const m=o[h];let x=31;for(;!(m>>>x);)x--;return d+=x,Int32Array.from([d,f])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(r){if(!(r instanceof N))return!1;const o=r;return this.width===o.width&&this.height===o.height&&this.rowSize===o.rowSize&&v.equals(this.bits,o.bits)}hashCode(){let r=this.width;return r=31*r+this.width,r=31*r+this.height,r=31*r+this.rowSize,r=31*r+v.hashCode(this.bits),r}toString(r="X ",o="  ",h=`
`){return this.buildToString(r,o,h)}buildToString(r,o,h){let f=new tt;for(let d=0,m=this.height;d<m;d++){for(let x=0,w=this.width;x<w;x++)f.append(this.get(x,d)?r:o);f.append(h)}return f.toString()}clone(){return new N(this.width,this.height,this.rowSize,this.bits.slice())}}class Z extends p{static getNotFoundInstance(){return new Z}}Z.kind="NotFoundException";class ft extends S{constructor(r){super(r),this.luminances=ft.EMPTY,this.buckets=new Int32Array(ft.LUMINANCE_BUCKETS)}getBlackRow(r,o){const h=this.getLuminanceSource(),f=h.getWidth();o==null||o.getSize()<f?o=new X(f):o.clear(),this.initArrays(f);const d=h.getRow(r,this.luminances),m=this.buckets;for(let w=0;w<f;w++)m[(d[w]&255)>>ft.LUMINANCE_SHIFT]++;const x=ft.estimateBlackPoint(m);if(f<3)for(let w=0;w<f;w++)(d[w]&255)<x&&o.set(w);else{let w=d[0]&255,A=d[1]&255;for(let O=1;O<f-1;O++){const B=d[O+1]&255;(A*4-w-B)/2<x&&o.set(O),w=A,A=B}}return o}getBlackMatrix(){const r=this.getLuminanceSource(),o=r.getWidth(),h=r.getHeight(),f=new N(o,h);this.initArrays(o);const d=this.buckets;for(let w=1;w<5;w++){const A=Math.floor(h*w/5),O=r.getRow(A,this.luminances),B=Math.floor(o*4/5);for(let Y=Math.floor(o/5);Y<B;Y++){const Q=O[Y]&255;d[Q>>ft.LUMINANCE_SHIFT]++}}const m=ft.estimateBlackPoint(d),x=r.getMatrix();for(let w=0;w<h;w++){const A=w*o;for(let O=0;O<o;O++)(x[A+O]&255)<m&&f.set(O,w)}return f}createBinarizer(r){return new ft(r)}initArrays(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));const o=this.buckets;for(let h=0;h<ft.LUMINANCE_BUCKETS;h++)o[h]=0}static estimateBlackPoint(r){const o=r.length;let h=0,f=0,d=0;for(let O=0;O<o;O++)r[O]>d&&(f=O,d=r[O]),r[O]>h&&(h=r[O]);let m=0,x=0;for(let O=0;O<o;O++){const B=O-f,Y=r[O]*B*B;Y>x&&(m=O,x=Y)}if(f>m){const O=f;f=m,m=O}if(m-f<=o/16)throw new Z;let w=m-1,A=-1;for(let O=m-1;O>f;O--){const B=O-f,Y=B*B*(m-O)*(h-r[O]);Y>A&&(w=O,A=Y)}return w<<ft.LUMINANCE_SHIFT}}ft.LUMINANCE_BITS=5,ft.LUMINANCE_SHIFT=8-ft.LUMINANCE_BITS,ft.LUMINANCE_BUCKETS=1<<ft.LUMINANCE_BITS,ft.EMPTY=Uint8ClampedArray.from([0]);class rt extends ft{constructor(r){super(r),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const r=this.getLuminanceSource(),o=r.getWidth(),h=r.getHeight();if(o>=rt.MINIMUM_DIMENSION&&h>=rt.MINIMUM_DIMENSION){const f=r.getMatrix();let d=o>>rt.BLOCK_SIZE_POWER;o&rt.BLOCK_SIZE_MASK&&d++;let m=h>>rt.BLOCK_SIZE_POWER;h&rt.BLOCK_SIZE_MASK&&m++;const x=rt.calculateBlackPoints(f,d,m,o,h),w=new N(o,h);rt.calculateThresholdForBlock(f,d,m,o,h,x,w),this.matrix=w}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(r){return new rt(r)}static calculateThresholdForBlock(r,o,h,f,d,m,x){const w=d-rt.BLOCK_SIZE,A=f-rt.BLOCK_SIZE;for(let O=0;O<h;O++){let B=O<<rt.BLOCK_SIZE_POWER;B>w&&(B=w);const Y=rt.cap(O,2,h-3);for(let Q=0;Q<o;Q++){let ht=Q<<rt.BLOCK_SIZE_POWER;ht>A&&(ht=A);const ut=rt.cap(Q,2,o-3);let yt=0;for(let zt=-2;zt<=2;zt++){const Wt=m[Y+zt];yt+=Wt[ut-2]+Wt[ut-1]+Wt[ut]+Wt[ut+1]+Wt[ut+2]}const Ct=yt/25;rt.thresholdBlock(r,ht,B,Ct,f,x)}}}static cap(r,o,h){return r<o?o:r>h?h:r}static thresholdBlock(r,o,h,f,d,m){for(let x=0,w=h*d+o;x<rt.BLOCK_SIZE;x++,w+=d)for(let A=0;A<rt.BLOCK_SIZE;A++)(r[w+A]&255)<=f&&m.set(o+A,h+x)}static calculateBlackPoints(r,o,h,f,d){const m=d-rt.BLOCK_SIZE,x=f-rt.BLOCK_SIZE,w=new Array(h);for(let A=0;A<h;A++){w[A]=new Int32Array(o);let O=A<<rt.BLOCK_SIZE_POWER;O>m&&(O=m);for(let B=0;B<o;B++){let Y=B<<rt.BLOCK_SIZE_POWER;Y>x&&(Y=x);let Q=0,ht=255,ut=0;for(let Ct=0,zt=O*f+Y;Ct<rt.BLOCK_SIZE;Ct++,zt+=f){for(let Wt=0;Wt<rt.BLOCK_SIZE;Wt++){const Bt=r[zt+Wt]&255;Q+=Bt,Bt<ht&&(ht=Bt),Bt>ut&&(ut=Bt)}if(ut-ht>rt.MIN_DYNAMIC_RANGE)for(Ct++,zt+=f;Ct<rt.BLOCK_SIZE;Ct++,zt+=f)for(let Wt=0;Wt<rt.BLOCK_SIZE;Wt++)Q+=r[zt+Wt]&255}let yt=Q>>rt.BLOCK_SIZE_POWER*2;if(ut-ht<=rt.MIN_DYNAMIC_RANGE&&(yt=ht/2,A>0&&B>0)){const Ct=(w[A-1][B]+2*w[A][B-1]+w[A-1][B-1])/4;ht<Ct&&(yt=Ct)}w[A][B]=yt}}return w}}rt.BLOCK_SIZE_POWER=3,rt.BLOCK_SIZE=1<<rt.BLOCK_SIZE_POWER,rt.BLOCK_SIZE_MASK=rt.BLOCK_SIZE-1,rt.MINIMUM_DIMENSION=rt.BLOCK_SIZE*5,rt.MIN_DYNAMIC_RANGE=24;class At{constructor(r,o){this.width=r,this.height=o}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(r,o,h,f){throw new nt("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new nt("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new nt("This luminance source does not support rotation by 45 degrees.")}toString(){const r=new Uint8ClampedArray(this.width);let o=new tt;for(let h=0;h<this.height;h++){const f=this.getRow(h,r);for(let d=0;d<this.width;d++){const m=f[d]&255;let x;m<64?x="#":m<128?x="+":m<192?x=".":x=" ",o.append(x)}o.append(`
`)}return o.toString()}}class bt extends At{constructor(r){super(r.getWidth(),r.getHeight()),this.delegate=r}getRow(r,o){const h=this.delegate.getRow(r,o),f=this.getWidth();for(let d=0;d<f;d++)h[d]=255-(h[d]&255);return h}getMatrix(){const r=this.delegate.getMatrix(),o=this.getWidth()*this.getHeight(),h=new Uint8ClampedArray(o);for(let f=0;f<o;f++)h[f]=255-(r[f]&255);return h}isCropSupported(){return this.delegate.isCropSupported()}crop(r,o,h,f){return new bt(this.delegate.crop(r,o,h,f))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new bt(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new bt(this.delegate.rotateCounterClockwise45())}}class Dt extends At{constructor(r){super(r.width,r.height),this.canvas=r,this.tempCanvasElement=null,this.buffer=Dt.makeBufferFromCanvasImageData(r)}static makeBufferFromCanvasImageData(r){const o=r.getContext("2d").getImageData(0,0,r.width,r.height);return Dt.toGrayscaleBuffer(o.data,r.width,r.height)}static toGrayscaleBuffer(r,o,h){const f=new Uint8ClampedArray(o*h);for(let d=0,m=0,x=r.length;d<x;d+=4,m++){let w;if(r[d+3]===0)w=255;else{const O=r[d],B=r[d+1],Y=r[d+2];w=306*O+601*B+117*Y+512>>10}f[m]=w}return f}getRow(r,o){if(r<0||r>=this.getHeight())throw new _("Requested row is outside the image: "+r);const h=this.getWidth(),f=r*h;return o===null?o=this.buffer.slice(f,f+h):(o.length<h&&(o=new Uint8ClampedArray(h)),o.set(this.buffer.slice(f,f+h))),o}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(r,o,h,f){return super.crop(r,o,h,f),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement}rotate(r){const o=this.getTempCanvasElement(),h=o.getContext("2d"),f=r*Dt.DEGREE_TO_RADIANS,d=this.canvas.width,m=this.canvas.height,x=Math.ceil(Math.abs(Math.cos(f))*d+Math.abs(Math.sin(f))*m),w=Math.ceil(Math.abs(Math.sin(f))*d+Math.abs(Math.cos(f))*m);return o.width=x,o.height=w,h.translate(x/2,w/2),h.rotate(f),h.drawImage(this.canvas,d/-2,m/-2),this.buffer=Dt.makeBufferFromCanvasImageData(o),this}invert(){return new bt(this)}}Dt.DEGREE_TO_RADIANS=Math.PI/180;class ct{constructor(r,o,h){this.deviceId=r,this.label=o,this.kind="videoinput",this.groupId=h||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var at=(globalThis||hn||self||window||void 0)&&(globalThis||hn||self||window||void 0).__awaiter||function(L,r,o,h){function f(d){return d instanceof o?d:new o(function(m){m(d)})}return new(o||(o=Promise))(function(d,m){function x(O){try{A(h.next(O))}catch(B){m(B)}}function w(O){try{A(h.throw(O))}catch(B){m(B)}}function A(O){O.done?d(O.value):f(O.value).then(x,w)}A((h=h.apply(L,r||[])).next())})};class Pt{constructor(r,o=500,h){this.reader=r,this.timeBetweenScansMillis=o,this._hints=h,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(r){this._timeBetweenDecodingAttempts=r<0?0:r}set hints(r){this._hints=r||null}get hints(){return this._hints}listVideoInputDevices(){return at(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const r=yield navigator.mediaDevices.enumerateDevices(),o=[];for(const h of r){const f=h.kind==="video"?"videoinput":h.kind;if(f!=="videoinput")continue;const d=h.deviceId||h.id,m=h.label||`Video device ${o.length+1}`,x=h.groupId,w={deviceId:d,label:m,kind:f,groupId:x};o.push(w)}return o})}getVideoInputDevices(){return at(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(o=>new ct(o.deviceId,o.label))})}findDeviceById(r){return at(this,void 0,void 0,function*(){const o=yield this.listVideoInputDevices();return o?o.find(h=>h.deviceId===r):null})}decodeFromInputVideoDevice(r,o){return at(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(r,o)})}decodeOnceFromVideoDevice(r,o){return at(this,void 0,void 0,function*(){this.reset();let h;r?h={deviceId:{exact:r}}:h={facingMode:"environment"};const f={video:h};return yield this.decodeOnceFromConstraints(f,o)})}decodeOnceFromConstraints(r,o){return at(this,void 0,void 0,function*(){const h=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeOnceFromStream(h,o)})}decodeOnceFromStream(r,o){return at(this,void 0,void 0,function*(){this.reset();const h=yield this.attachStreamToVideo(r,o);return yield this.decodeOnce(h)})}decodeFromInputVideoDeviceContinuously(r,o,h){return at(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(r,o,h)})}decodeFromVideoDevice(r,o,h){return at(this,void 0,void 0,function*(){let f;r?f={deviceId:{exact:r}}:f={facingMode:"environment"};const d={video:f};return yield this.decodeFromConstraints(d,o,h)})}decodeFromConstraints(r,o,h){return at(this,void 0,void 0,function*(){const f=yield navigator.mediaDevices.getUserMedia(r);return yield this.decodeFromStream(f,o,h)})}decodeFromStream(r,o,h){return at(this,void 0,void 0,function*(){this.reset();const f=yield this.attachStreamToVideo(r,o);return yield this.decodeContinuously(f,h)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(r,o){return at(this,void 0,void 0,function*(){const h=this.prepareVideoElement(o);return this.addVideoSource(h,r),this.videoElement=h,this.stream=r,yield this.playVideoOnLoadAsync(h),h})}playVideoOnLoadAsync(r){return new Promise((o,h)=>this.playVideoOnLoad(r,()=>o()))}playVideoOnLoad(r,o){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(r),r.addEventListener("ended",this.videoEndedListener),r.addEventListener("canplay",this.videoCanPlayListener),r.addEventListener("playing",o),this.tryPlayVideo(r)}isVideoPlaying(r){return r.currentTime>0&&!r.paused&&!r.ended&&r.readyState>2}tryPlayVideo(r){return at(this,void 0,void 0,function*(){if(this.isVideoPlaying(r)){console.warn("Trying to play video that is already playing.");return}try{yield r.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(r,o){const h=document.getElementById(r);if(!h)throw new y(`element with id '${r}' not found`);if(h.nodeName.toLowerCase()!==o.toLowerCase())throw new y(`element with id '${r}' must be an ${o} element`);return h}decodeFromImage(r,o){if(!r&&!o)throw new y("either imageElement with a src set or an url must be provided");return o&&!r?this.decodeFromImageUrl(o):this.decodeFromImageElement(r)}decodeFromVideo(r,o){if(!r&&!o)throw new y("Either an element with a src set or an URL must be provided");return o&&!r?this.decodeFromVideoUrl(o):this.decodeFromVideoElement(r)}decodeFromVideoContinuously(r,o,h){if(r===void 0&&o===void 0)throw new y("Either an element with a src set or an URL must be provided");return o&&!r?this.decodeFromVideoUrlContinuously(o,h):this.decodeFromVideoElementContinuously(r,h)}decodeFromImageElement(r){if(!r)throw new y("An image element must be provided.");this.reset();const o=this.prepareImageElement(r);this.imageElement=o;let h;return this.isImageLoaded(o)?h=this.decodeOnce(o,!1,!0):h=this._decodeOnLoadImage(o),h}decodeFromVideoElement(r){const o=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideo(o)}decodeFromVideoElementContinuously(r,o){const h=this._decodeFromVideoElementSetup(r);return this._decodeOnLoadVideoContinuously(h,o)}_decodeFromVideoElementSetup(r){if(!r)throw new y("A video element must be provided.");this.reset();const o=this.prepareVideoElement(r);return this.videoElement=o,o}decodeFromImageUrl(r){if(!r)throw new y("An URL must be provided.");this.reset();const o=this.prepareImageElement();this.imageElement=o;const h=this._decodeOnLoadImage(o);return o.src=r,h}decodeFromVideoUrl(r){if(!r)throw new y("An URL must be provided.");this.reset();const o=this.prepareVideoElement(),h=this.decodeFromVideoElement(o);return o.src=r,h}decodeFromVideoUrlContinuously(r,o){if(!r)throw new y("An URL must be provided.");this.reset();const h=this.prepareVideoElement(),f=this.decodeFromVideoElementContinuously(h,o);return h.src=r,f}_decodeOnLoadImage(r){return new Promise((o,h)=>{this.imageLoadedListener=()=>this.decodeOnce(r,!1,!0).then(o,h),r.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(r){return at(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(r),yield this.decodeOnce(r)})}_decodeOnLoadVideoContinuously(r,o){return at(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(r),this.decodeContinuously(r,o)})}isImageLoaded(r){return!(!r.complete||r.naturalWidth===0)}prepareImageElement(r){let o;return typeof r>"u"&&(o=document.createElement("img"),o.width=200,o.height=200),typeof r=="string"&&(o=this.getMediaElement(r,"img")),r instanceof HTMLImageElement&&(o=r),o}prepareVideoElement(r){let o;return!r&&typeof document<"u"&&(o=document.createElement("video"),o.width=200,o.height=200),typeof r=="string"&&(o=this.getMediaElement(r,"video")),r instanceof HTMLVideoElement&&(o=r),o.setAttribute("autoplay","true"),o.setAttribute("muted","true"),o.setAttribute("playsinline","true"),o}decodeOnce(r,o=!0,h=!0){this._stopAsyncDecode=!1;const f=(d,m)=>{if(this._stopAsyncDecode){m(new Z("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const x=this.decode(r);d(x)}catch(x){const w=o&&x instanceof Z,O=(x instanceof I||x instanceof z)&&h;if(w||O)return setTimeout(f,this._timeBetweenDecodingAttempts,d,m);m(x)}};return new Promise((d,m)=>f(d,m))}decodeContinuously(r,o){this._stopContinuousDecode=!1;const h=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const f=this.decode(r);o(f,null),setTimeout(h,this.timeBetweenScansMillis)}catch(f){o(null,f);const d=f instanceof I||f instanceof z,m=f instanceof Z;(d||m)&&setTimeout(h,this._timeBetweenDecodingAttempts)}};h()}decode(r){const o=this.createBinaryBitmap(r);return this.decodeBitmap(o)}_isHTMLVideoElement(r){return r.videoWidth!==0}drawFrameOnCanvas(r,o,h){o||(o={sx:0,sy:0,sWidth:r.videoWidth,sHeight:r.videoHeight,dx:0,dy:0,dWidth:r.videoWidth,dHeight:r.videoHeight}),h||(h=this.captureCanvasContext),h.drawImage(r,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}drawImageOnCanvas(r,o,h=this.captureCanvasContext){o||(o={sx:0,sy:0,sWidth:r.naturalWidth,sHeight:r.naturalHeight,dx:0,dy:0,dWidth:r.naturalWidth,dHeight:r.naturalHeight}),h||(h=this.captureCanvasContext),h.drawImage(r,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}createBinaryBitmap(r){this.getCaptureCanvasContext(r),this._isHTMLVideoElement(r)?this.drawFrameOnCanvas(r):this.drawImageOnCanvas(r);const o=this.getCaptureCanvas(r),h=new Dt(o),f=new rt(h);return new E(f)}getCaptureCanvasContext(r){if(!this.captureCanvasContext){const h=this.getCaptureCanvas(r).getContext("2d");this.captureCanvasContext=h}return this.captureCanvasContext}getCaptureCanvas(r){if(!this.captureCanvas){const o=this.createCaptureCanvas(r);this.captureCanvas=o}return this.captureCanvas}decodeBitmap(r){return this.reader.decode(r,this._hints)}createCaptureCanvas(r){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const o=document.createElement("canvas");let h,f;return typeof r<"u"&&(r instanceof HTMLVideoElement?(h=r.videoWidth,f=r.videoHeight):r instanceof HTMLImageElement&&(h=r.naturalWidth||r.width,f=r.naturalHeight||r.height)),o.style.width=h+"px",o.style.height=f+"px",o.width=h,o.height=f,o}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(r=>r.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(r,o){try{r.srcObject=o}catch{r.src=URL.createObjectURL(o)}}cleanVideoSource(r){try{r.srcObject=null}catch{r.src=""}this.videoElement.removeAttribute("src")}}class mt{constructor(r,o,h=o==null?0:8*o.length,f,d,m=R.currentTimeMillis()){this.text=r,this.rawBytes=o,this.numBits=h,this.resultPoints=f,this.format=d,this.timestamp=m,this.text=r,this.rawBytes=o,h==null?this.numBits=o==null?0:8*o.length:this.numBits=h,this.resultPoints=f,this.format=d,this.resultMetadata=null,m==null?this.timestamp=R.currentTimeMillis():this.timestamp=m}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(r,o){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(r,o)}putAllMetadata(r){r!==null&&(this.resultMetadata===null?this.resultMetadata=r:this.resultMetadata=new Map(r))}addResultPoints(r){const o=this.resultPoints;if(o===null)this.resultPoints=r;else if(r!==null&&r.length>0){const h=new Array(o.length+r.length);R.arraycopy(o,0,h,0,o.length),R.arraycopy(r,0,h,o.length,r.length),this.resultPoints=h}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Lt;(function(L){L[L.AZTEC=0]="AZTEC",L[L.CODABAR=1]="CODABAR",L[L.CODE_39=2]="CODE_39",L[L.CODE_93=3]="CODE_93",L[L.CODE_128=4]="CODE_128",L[L.DATA_MATRIX=5]="DATA_MATRIX",L[L.EAN_8=6]="EAN_8",L[L.EAN_13=7]="EAN_13",L[L.ITF=8]="ITF",L[L.MAXICODE=9]="MAXICODE",L[L.PDF_417=10]="PDF_417",L[L.QR_CODE=11]="QR_CODE",L[L.RSS_14=12]="RSS_14",L[L.RSS_EXPANDED=13]="RSS_EXPANDED",L[L.UPC_A=14]="UPC_A",L[L.UPC_E=15]="UPC_E",L[L.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Lt||(Lt={}));var Vt=Lt,Ee;(function(L){L[L.OTHER=0]="OTHER",L[L.ORIENTATION=1]="ORIENTATION",L[L.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",L[L.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",L[L.ISSUE_NUMBER=4]="ISSUE_NUMBER",L[L.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",L[L.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",L[L.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",L[L.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",L[L.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",L[L.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ee||(Ee={}));var te=Ee;class me{constructor(r,o,h,f,d=-1,m=-1){this.rawBytes=r,this.text=o,this.byteSegments=h,this.ecLevel=f,this.structuredAppendSequenceNumber=d,this.structuredAppendParity=m,this.numBits=r==null?0:8*r.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(r){this.numBits=r}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(r){this.errorsCorrected=r}getErasures(){return this.erasures}setErasures(r){this.erasures=r}getOther(){return this.other}setOther(r){this.other=r}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Ie{exp(r){return this.expTable[r]}log(r){if(r===0)throw new _;return this.logTable[r]}static addOrSubtract(r,o){return r^o}}class Ce{constructor(r,o){if(o.length===0)throw new _;this.field=r;const h=o.length;if(h>1&&o[0]===0){let f=1;for(;f<h&&o[f]===0;)f++;f===h?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(h-f),R.arraycopy(o,f,this.coefficients,0,this.coefficients.length))}else this.coefficients=o}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);const o=this.coefficients;let h;if(r===1){h=0;for(let m=0,x=o.length;m!==x;m++){const w=o[m];h=Ie.addOrSubtract(h,w)}return h}h=o[0];const f=o.length,d=this.field;for(let m=1;m<f;m++)h=Ie.addOrSubtract(d.multiply(r,h),o[m]);return h}addOrSubtract(r){if(!this.field.equals(r.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero())return r;if(r.isZero())return this;let o=this.coefficients,h=r.coefficients;if(o.length>h.length){const m=o;o=h,h=m}let f=new Int32Array(h.length);const d=h.length-o.length;R.arraycopy(h,0,f,0,d);for(let m=d;m<h.length;m++)f[m]=Ie.addOrSubtract(o[m-d],h[m]);return new Ce(this.field,f)}multiply(r){if(!this.field.equals(r.field))throw new _("GenericGFPolys do not have same GenericGF field");if(this.isZero()||r.isZero())return this.field.getZero();const o=this.coefficients,h=o.length,f=r.coefficients,d=f.length,m=new Int32Array(h+d-1),x=this.field;for(let w=0;w<h;w++){const A=o[w];for(let O=0;O<d;O++)m[w+O]=Ie.addOrSubtract(m[w+O],x.multiply(A,f[O]))}return new Ce(x,m)}multiplyScalar(r){if(r===0)return this.field.getZero();if(r===1)return this;const o=this.coefficients.length,h=this.field,f=new Int32Array(o),d=this.coefficients;for(let m=0;m<o;m++)f[m]=h.multiply(d[m],r);return new Ce(h,f)}multiplyByMonomial(r,o){if(r<0)throw new _;if(o===0)return this.field.getZero();const h=this.coefficients,f=h.length,d=new Int32Array(f+r),m=this.field;for(let x=0;x<f;x++)d[x]=m.multiply(h[x],o);return new Ce(m,d)}divide(r){if(!this.field.equals(r.field))throw new _("GenericGFPolys do not have same GenericGF field");if(r.isZero())throw new _("Divide by 0");const o=this.field;let h=o.getZero(),f=this;const d=r.getCoefficient(r.getDegree()),m=o.inverse(d);for(;f.getDegree()>=r.getDegree()&&!f.isZero();){const x=f.getDegree()-r.getDegree(),w=o.multiply(f.getCoefficient(f.getDegree()),m),A=r.multiplyByMonomial(x,w),O=o.buildMonomial(x,w);h=h.addOrSubtract(O),f=f.addOrSubtract(A)}return[h,f]}toString(){let r="";for(let o=this.getDegree();o>=0;o--){let h=this.getCoefficient(o);if(h!==0){if(h<0?(r+=" - ",h=-h):r.length>0&&(r+=" + "),o===0||h!==1){const f=this.field.log(h);f===0?r+="1":f===1?r+="a":(r+="a^",r+=f)}o!==0&&(o===1?r+="x":(r+="x^",r+=o))}}return r}}class Ge extends p{}Ge.kind="ArithmeticException";class de extends Ie{constructor(r,o,h){super(),this.primitive=r,this.size=o,this.generatorBase=h;const f=new Int32Array(o);let d=1;for(let x=0;x<o;x++)f[x]=d,d*=2,d>=o&&(d^=r,d&=o-1);this.expTable=f;const m=new Int32Array(o);for(let x=0;x<o-1;x++)m[f[x]]=x;this.logTable=m,this.zero=new Ce(this,Int32Array.from([0])),this.one=new Ce(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,o){if(r<0)throw new _;if(o===0)return this.zero;const h=new Int32Array(r+1);return h[0]=o,new Ce(this,h)}inverse(r){if(r===0)throw new Ge;return this.expTable[this.size-this.logTable[r]-1]}multiply(r,o){return r===0||o===0?0:this.expTable[(this.logTable[r]+this.logTable[o])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+k.toHexString(this.primitive)+","+this.size+")"}equals(r){return r===this}}de.AZTEC_DATA_12=new de(4201,4096,1),de.AZTEC_DATA_10=new de(1033,1024,1),de.AZTEC_DATA_6=new de(67,64,1),de.AZTEC_PARAM=new de(19,16,1),de.QR_CODE_FIELD_256=new de(285,256,0),de.DATA_MATRIX_FIELD_256=new de(301,256,1),de.AZTEC_DATA_8=de.DATA_MATRIX_FIELD_256,de.MAXICODE_FIELD_64=de.AZTEC_DATA_6;class F extends p{}F.kind="ReedSolomonException";class St extends p{}St.kind="IllegalStateException";class Et{constructor(r){this.field=r}decode(r,o){const h=this.field,f=new Ce(h,r),d=new Int32Array(o);let m=!0;for(let Q=0;Q<o;Q++){const ht=f.evaluateAt(h.exp(Q+h.getGeneratorBase()));d[d.length-1-Q]=ht,ht!==0&&(m=!1)}if(m)return;const x=new Ce(h,d),w=this.runEuclideanAlgorithm(h.buildMonomial(o,1),x,o),A=w[0],O=w[1],B=this.findErrorLocations(A),Y=this.findErrorMagnitudes(O,B);for(let Q=0;Q<B.length;Q++){const ht=r.length-1-h.log(B[Q]);if(ht<0)throw new F("Bad error location");r[ht]=de.addOrSubtract(r[ht],Y[Q])}}runEuclideanAlgorithm(r,o,h){if(r.getDegree()<o.getDegree()){const Q=r;r=o,o=Q}const f=this.field;let d=r,m=o,x=f.getZero(),w=f.getOne();for(;m.getDegree()>=(h/2|0);){let Q=d,ht=x;if(d=m,x=w,d.isZero())throw new F("r_{i-1} was zero");m=Q;let ut=f.getZero();const yt=d.getCoefficient(d.getDegree()),Ct=f.inverse(yt);for(;m.getDegree()>=d.getDegree()&&!m.isZero();){const zt=m.getDegree()-d.getDegree(),Wt=f.multiply(m.getCoefficient(m.getDegree()),Ct);ut=ut.addOrSubtract(f.buildMonomial(zt,Wt)),m=m.addOrSubtract(d.multiplyByMonomial(zt,Wt))}if(w=ut.multiply(x).addOrSubtract(ht),m.getDegree()>=d.getDegree())throw new St("Division algorithm failed to reduce polynomial?")}const A=w.getCoefficient(0);if(A===0)throw new F("sigmaTilde(0) was zero");const O=f.inverse(A),B=w.multiplyScalar(O),Y=m.multiplyScalar(O);return[B,Y]}findErrorLocations(r){const o=r.getDegree();if(o===1)return Int32Array.from([r.getCoefficient(1)]);const h=new Int32Array(o);let f=0;const d=this.field;for(let m=1;m<d.getSize()&&f<o;m++)r.evaluateAt(m)===0&&(h[f]=d.inverse(m),f++);if(f!==o)throw new F("Error locator degree does not match number of roots");return h}findErrorMagnitudes(r,o){const h=o.length,f=new Int32Array(h),d=this.field;for(let m=0;m<h;m++){const x=d.inverse(o[m]);let w=1;for(let A=0;A<h;A++)if(m!==A){const O=d.multiply(o[A],x),B=O&1?O&-2:O|1;w=d.multiply(w,B)}f[m]=d.multiply(r.evaluateAt(x),d.inverse(w)),d.getGeneratorBase()!==0&&(f[m]=d.multiply(f[m],x))}return f}}var et;(function(L){L[L.UPPER=0]="UPPER",L[L.LOWER=1]="LOWER",L[L.MIXED=2]="MIXED",L[L.DIGIT=3]="DIGIT",L[L.PUNCT=4]="PUNCT",L[L.BINARY=5]="BINARY"})(et||(et={}));class ${decode(r){this.ddata=r;let o=r.getBits(),h=this.extractBits(o),f=this.correctBits(h),d=$.convertBoolArrayToByteArray(f),m=$.getEncodedData(f),x=new me(d,m,null,null);return x.setNumBits(f.length),x}static highLevelDecode(r){return this.getEncodedData(r)}static getEncodedData(r){let o=r.length,h=et.UPPER,f=et.UPPER,d="",m=0;for(;m<o;)if(f===et.BINARY){if(o-m<5)break;let x=$.readCode(r,m,5);if(m+=5,x===0){if(o-m<11)break;x=$.readCode(r,m,11)+31,m+=11}for(let w=0;w<x;w++){if(o-m<8){m=o;break}const A=$.readCode(r,m,8);d+=j.castAsNonUtf8Char(A),m+=8}f=h}else{let x=f===et.DIGIT?4:5;if(o-m<x)break;let w=$.readCode(r,m,x);m+=x;let A=$.getCharacter(f,w);A.startsWith("CTRL_")?(h=f,f=$.getTable(A.charAt(5)),A.charAt(6)==="L"&&(h=f)):(d+=A,f=h)}return d}static getTable(r){switch(r){case"L":return et.LOWER;case"P":return et.PUNCT;case"M":return et.MIXED;case"D":return et.DIGIT;case"B":return et.BINARY;case"U":default:return et.UPPER}}static getCharacter(r,o){switch(r){case et.UPPER:return $.UPPER_TABLE[o];case et.LOWER:return $.LOWER_TABLE[o];case et.MIXED:return $.MIXED_TABLE[o];case et.PUNCT:return $.PUNCT_TABLE[o];case et.DIGIT:return $.DIGIT_TABLE[o];default:throw new St("Bad table")}}correctBits(r){let o,h;this.ddata.getNbLayers()<=2?(h=6,o=de.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(h=8,o=de.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(h=10,o=de.AZTEC_DATA_10):(h=12,o=de.AZTEC_DATA_12);let f=this.ddata.getNbDatablocks(),d=r.length/h;if(d<f)throw new z;let m=r.length%h,x=new Int32Array(d);for(let Y=0;Y<d;Y++,m+=h)x[Y]=$.readCode(r,m,h);try{new Et(o).decode(x,d-f)}catch(Y){throw new z(Y)}let w=(1<<h)-1,A=0;for(let Y=0;Y<f;Y++){let Q=x[Y];if(Q===0||Q===w)throw new z;(Q===1||Q===w-1)&&A++}let O=new Array(f*h-A),B=0;for(let Y=0;Y<f;Y++){let Q=x[Y];if(Q===1||Q===w-1)O.fill(Q>1,B,B+h-1),B+=h-1;else for(let ht=h-1;ht>=0;--ht)O[B++]=(Q&1<<ht)!==0}return O}extractBits(r){let o=this.ddata.isCompact(),h=this.ddata.getNbLayers(),f=(o?11:14)+h*4,d=new Int32Array(f),m=new Array(this.totalBitsInLayer(h,o));if(o)for(let x=0;x<d.length;x++)d[x]=x;else{let x=f+1+2*k.truncDivision(k.truncDivision(f,2)-1,15),w=f/2,A=k.truncDivision(x,2);for(let O=0;O<w;O++){let B=O+k.truncDivision(O,15);d[w-O-1]=A-B-1,d[w+O]=A+B+1}}for(let x=0,w=0;x<h;x++){let A=(h-x)*4+(o?9:12),O=x*2,B=f-1-O;for(let Y=0;Y<A;Y++){let Q=Y*2;for(let ht=0;ht<2;ht++)m[w+Q+ht]=r.get(d[O+ht],d[O+Y]),m[w+2*A+Q+ht]=r.get(d[O+Y],d[B-ht]),m[w+4*A+Q+ht]=r.get(d[B-ht],d[B-Y]),m[w+6*A+Q+ht]=r.get(d[B-Y],d[O+ht])}w+=A*8}return m}static readCode(r,o,h){let f=0;for(let d=o;d<o+h;d++)f<<=1,r[d]&&(f|=1);return f}static readByte(r,o){let h=r.length-o;return h>=8?$.readCode(r,o,8):$.readCode(r,o,h)<<8-h}static convertBoolArrayToByteArray(r){let o=new Uint8Array((r.length+7)/8);for(let h=0;h<o.length;h++)o[h]=$.readByte(r,8*h);return o}totalBitsInLayer(r,o){return((o?88:112)+16*r)*r}}$.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],$.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],$.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],$.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],$.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class lt{constructor(){}static round(r){return r===NaN?0:r<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:r>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:r+(r<0?-.5:.5)|0}static distance(r,o,h,f){const d=r-h,m=o-f;return Math.sqrt(d*d+m*m)}static sum(r){let o=0;for(let h=0,f=r.length;h!==f;h++){const d=r[h];o+=d}return o}}class vt{static floatToIntBits(r){return r}}vt.MAX_VALUE=Number.MAX_SAFE_INTEGER;class gt{constructor(r,o){this.x=r,this.y=o}getX(){return this.x}getY(){return this.y}equals(r){if(r instanceof gt){const o=r;return this.x===o.x&&this.y===o.y}return!1}hashCode(){return 31*vt.floatToIntBits(this.x)+vt.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(r){const o=this.distance(r[0],r[1]),h=this.distance(r[1],r[2]),f=this.distance(r[0],r[2]);let d,m,x;if(h>=o&&h>=f?(m=r[0],d=r[1],x=r[2]):f>=h&&f>=o?(m=r[1],d=r[0],x=r[2]):(m=r[2],d=r[0],x=r[1]),this.crossProductZ(d,m,x)<0){const w=d;d=x,x=w}r[0]=d,r[1]=m,r[2]=x}static distance(r,o){return lt.distance(r.x,r.y,o.x,o.y)}static crossProductZ(r,o,h){const f=o.x,d=o.y;return(h.x-f)*(r.y-d)-(h.y-d)*(r.x-f)}}class pt{constructor(r,o){this.bits=r,this.points=o}getBits(){return this.bits}getPoints(){return this.points}}class kt extends pt{constructor(r,o,h,f,d){super(r,o),this.compact=h,this.nbDatablocks=f,this.nbLayers=d}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Ht{constructor(r,o,h,f){this.image=r,this.height=r.getHeight(),this.width=r.getWidth(),o==null&&(o=Ht.INIT_SIZE),h==null&&(h=r.getWidth()/2|0),f==null&&(f=r.getHeight()/2|0);const d=o/2|0;if(this.leftInit=h-d,this.rightInit=h+d,this.upInit=f-d,this.downInit=f+d,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Z}detect(){let r=this.leftInit,o=this.rightInit,h=this.upInit,f=this.downInit,d=!1,m=!0,x=!1,w=!1,A=!1,O=!1,B=!1;const Y=this.width,Q=this.height;for(;m;){m=!1;let ht=!0;for(;(ht||!w)&&o<Y;)ht=this.containsBlackPoint(h,f,o,!1),ht?(o++,m=!0,w=!0):w||o++;if(o>=Y){d=!0;break}let ut=!0;for(;(ut||!A)&&f<Q;)ut=this.containsBlackPoint(r,o,f,!0),ut?(f++,m=!0,A=!0):A||f++;if(f>=Q){d=!0;break}let yt=!0;for(;(yt||!O)&&r>=0;)yt=this.containsBlackPoint(h,f,r,!1),yt?(r--,m=!0,O=!0):O||r--;if(r<0){d=!0;break}let Ct=!0;for(;(Ct||!B)&&h>=0;)Ct=this.containsBlackPoint(r,o,h,!0),Ct?(h--,m=!0,B=!0):B||h--;if(h<0){d=!0;break}m&&(x=!0)}if(!d&&x){const ht=o-r;let ut=null;for(let Wt=1;ut===null&&Wt<ht;Wt++)ut=this.getBlackPointOnSegment(r,f-Wt,r+Wt,f);if(ut==null)throw new Z;let yt=null;for(let Wt=1;yt===null&&Wt<ht;Wt++)yt=this.getBlackPointOnSegment(r,h+Wt,r+Wt,h);if(yt==null)throw new Z;let Ct=null;for(let Wt=1;Ct===null&&Wt<ht;Wt++)Ct=this.getBlackPointOnSegment(o,h+Wt,o-Wt,h);if(Ct==null)throw new Z;let zt=null;for(let Wt=1;zt===null&&Wt<ht;Wt++)zt=this.getBlackPointOnSegment(o,f-Wt,o-Wt,f);if(zt==null)throw new Z;return this.centerEdges(zt,ut,Ct,yt)}else throw new Z}getBlackPointOnSegment(r,o,h,f){const d=lt.round(lt.distance(r,o,h,f)),m=(h-r)/d,x=(f-o)/d,w=this.image;for(let A=0;A<d;A++){const O=lt.round(r+A*m),B=lt.round(o+A*x);if(w.get(O,B))return new gt(O,B)}return null}centerEdges(r,o,h,f){const d=r.getX(),m=r.getY(),x=o.getX(),w=o.getY(),A=h.getX(),O=h.getY(),B=f.getX(),Y=f.getY(),Q=Ht.CORR;return d<this.width/2?[new gt(B-Q,Y+Q),new gt(x+Q,w+Q),new gt(A-Q,O-Q),new gt(d+Q,m-Q)]:[new gt(B+Q,Y+Q),new gt(x+Q,w-Q),new gt(A-Q,O+Q),new gt(d-Q,m-Q)]}containsBlackPoint(r,o,h,f){const d=this.image;if(f){for(let m=r;m<=o;m++)if(d.get(m,h))return!0}else for(let m=r;m<=o;m++)if(d.get(h,m))return!0;return!1}}Ht.INIT_SIZE=10,Ht.CORR=1;class Ft{static checkAndNudgePoints(r,o){const h=r.getWidth(),f=r.getHeight();let d=!0;for(let m=0;m<o.length&&d;m+=2){const x=Math.floor(o[m]),w=Math.floor(o[m+1]);if(x<-1||x>h||w<-1||w>f)throw new Z;d=!1,x===-1?(o[m]=0,d=!0):x===h&&(o[m]=h-1,d=!0),w===-1?(o[m+1]=0,d=!0):w===f&&(o[m+1]=f-1,d=!0)}d=!0;for(let m=o.length-2;m>=0&&d;m-=2){const x=Math.floor(o[m]),w=Math.floor(o[m+1]);if(x<-1||x>h||w<-1||w>f)throw new Z;d=!1,x===-1?(o[m]=0,d=!0):x===h&&(o[m]=h-1,d=!0),w===-1?(o[m+1]=0,d=!0):w===f&&(o[m+1]=f-1,d=!0)}}}class qt{constructor(r,o,h,f,d,m,x,w,A){this.a11=r,this.a21=o,this.a31=h,this.a12=f,this.a22=d,this.a32=m,this.a13=x,this.a23=w,this.a33=A}static quadrilateralToQuadrilateral(r,o,h,f,d,m,x,w,A,O,B,Y,Q,ht,ut,yt){const Ct=qt.quadrilateralToSquare(r,o,h,f,d,m,x,w);return qt.squareToQuadrilateral(A,O,B,Y,Q,ht,ut,yt).times(Ct)}transformPoints(r){const o=r.length,h=this.a11,f=this.a12,d=this.a13,m=this.a21,x=this.a22,w=this.a23,A=this.a31,O=this.a32,B=this.a33;for(let Y=0;Y<o;Y+=2){const Q=r[Y],ht=r[Y+1],ut=d*Q+w*ht+B;r[Y]=(h*Q+m*ht+A)/ut,r[Y+1]=(f*Q+x*ht+O)/ut}}transformPointsWithValues(r,o){const h=this.a11,f=this.a12,d=this.a13,m=this.a21,x=this.a22,w=this.a23,A=this.a31,O=this.a32,B=this.a33,Y=r.length;for(let Q=0;Q<Y;Q++){const ht=r[Q],ut=o[Q],yt=d*ht+w*ut+B;r[Q]=(h*ht+m*ut+A)/yt,o[Q]=(f*ht+x*ut+O)/yt}}static squareToQuadrilateral(r,o,h,f,d,m,x,w){const A=r-h+d-x,O=o-f+m-w;if(A===0&&O===0)return new qt(h-r,d-h,r,f-o,m-f,o,0,0,1);{const B=h-d,Y=x-d,Q=f-m,ht=w-m,ut=B*ht-Y*Q,yt=(A*ht-Y*O)/ut,Ct=(B*O-A*Q)/ut;return new qt(h-r+yt*h,x-r+Ct*x,r,f-o+yt*f,w-o+Ct*w,o,yt,Ct,1)}}static quadrilateralToSquare(r,o,h,f,d,m,x,w){return qt.squareToQuadrilateral(r,o,h,f,d,m,x,w).buildAdjoint()}buildAdjoint(){return new qt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(r){return new qt(this.a11*r.a11+this.a21*r.a12+this.a31*r.a13,this.a11*r.a21+this.a21*r.a22+this.a31*r.a23,this.a11*r.a31+this.a21*r.a32+this.a31*r.a33,this.a12*r.a11+this.a22*r.a12+this.a32*r.a13,this.a12*r.a21+this.a22*r.a22+this.a32*r.a23,this.a12*r.a31+this.a22*r.a32+this.a32*r.a33,this.a13*r.a11+this.a23*r.a12+this.a33*r.a13,this.a13*r.a21+this.a23*r.a22+this.a33*r.a23,this.a13*r.a31+this.a23*r.a32+this.a33*r.a33)}}class ve extends Ft{sampleGrid(r,o,h,f,d,m,x,w,A,O,B,Y,Q,ht,ut,yt,Ct,zt,Wt){const Bt=qt.quadrilateralToQuadrilateral(f,d,m,x,w,A,O,B,Y,Q,ht,ut,yt,Ct,zt,Wt);return this.sampleGridWithTransform(r,o,h,Bt)}sampleGridWithTransform(r,o,h,f){if(o<=0||h<=0)throw new Z;const d=new N(o,h),m=new Float32Array(2*o);for(let x=0;x<h;x++){const w=m.length,A=x+.5;for(let O=0;O<w;O+=2)m[O]=O/2+.5,m[O+1]=A;f.transformPoints(m),Ft.checkAndNudgePoints(r,m);try{for(let O=0;O<w;O+=2)r.get(Math.floor(m[O]),Math.floor(m[O+1]))&&d.set(O/2,x)}catch{throw new Z}}return d}}class re{static setGridSampler(r){re.gridSampler=r}static getInstance(){return re.gridSampler}}re.gridSampler=new ve;class pe{constructor(r,o){this.x=r,this.y=o}toResultPoint(){return new gt(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Mn{constructor(r){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=r}detect(){return this.detectMirror(!1)}detectMirror(r){let o=this.getMatrixCenter(),h=this.getBullsEyeCorners(o);if(r){let m=h[0];h[0]=h[2],h[2]=m}this.extractParameters(h);let f=this.sampleGrid(this.image,h[this.shift%4],h[(this.shift+1)%4],h[(this.shift+2)%4],h[(this.shift+3)%4]),d=this.getMatrixCornerPoints(h);return new kt(f,d,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(r){if(!this.isValidPoint(r[0])||!this.isValidPoint(r[1])||!this.isValidPoint(r[2])||!this.isValidPoint(r[3]))throw new Z;let o=2*this.nbCenterLayers,h=new Int32Array([this.sampleLine(r[0],r[1],o),this.sampleLine(r[1],r[2],o),this.sampleLine(r[2],r[3],o),this.sampleLine(r[3],r[0],o)]);this.shift=this.getRotation(h,o);let f=0;for(let m=0;m<4;m++){let x=h[(this.shift+m)%4];this.compact?(f<<=7,f+=x>>1&127):(f<<=10,f+=(x>>2&992)+(x>>1&31))}let d=this.getCorrectedParameterData(f,this.compact);this.compact?(this.nbLayers=(d>>6)+1,this.nbDataBlocks=(d&63)+1):(this.nbLayers=(d>>11)+1,this.nbDataBlocks=(d&2047)+1)}getRotation(r,o){let h=0;r.forEach((f,d,m)=>{let x=(f>>o-2<<1)+(f&1);h=(h<<3)+x}),h=((h&1)<<11)+(h>>1);for(let f=0;f<4;f++)if(k.bitCount(h^this.EXPECTED_CORNER_BITS[f])<=2)return f;throw new Z}getCorrectedParameterData(r,o){let h,f;o?(h=7,f=2):(h=10,f=4);let d=h-f,m=new Int32Array(h);for(let w=h-1;w>=0;--w)m[w]=r&15,r>>=4;try{new Et(de.AZTEC_PARAM).decode(m,d)}catch{throw new Z}let x=0;for(let w=0;w<f;w++)x=(x<<4)+m[w];return x}getBullsEyeCorners(r){let o=r,h=r,f=r,d=r,m=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let B=this.getFirstDifferent(o,m,1,-1),Y=this.getFirstDifferent(h,m,1,1),Q=this.getFirstDifferent(f,m,-1,1),ht=this.getFirstDifferent(d,m,-1,-1);if(this.nbCenterLayers>2){let ut=this.distancePoint(ht,B)*this.nbCenterLayers/(this.distancePoint(d,o)*(this.nbCenterLayers+2));if(ut<.75||ut>1.25||!this.isWhiteOrBlackRectangle(B,Y,Q,ht))break}o=B,h=Y,f=Q,d=ht,m=!m}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new Z;this.compact=this.nbCenterLayers===5;let x=new gt(o.getX()+.5,o.getY()-.5),w=new gt(h.getX()+.5,h.getY()+.5),A=new gt(f.getX()-.5,f.getY()+.5),O=new gt(d.getX()-.5,d.getY()-.5);return this.expandSquare([x,w,A,O],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let r,o,h,f;try{let x=new Ht(this.image).detect();r=x[0],o=x[1],h=x[2],f=x[3]}catch{let w=this.image.getWidth()/2,A=this.image.getHeight()/2;r=this.getFirstDifferent(new pe(w+7,A-7),!1,1,-1).toResultPoint(),o=this.getFirstDifferent(new pe(w+7,A+7),!1,1,1).toResultPoint(),h=this.getFirstDifferent(new pe(w-7,A+7),!1,-1,1).toResultPoint(),f=this.getFirstDifferent(new pe(w-7,A-7),!1,-1,-1).toResultPoint()}let d=lt.round((r.getX()+f.getX()+o.getX()+h.getX())/4),m=lt.round((r.getY()+f.getY()+o.getY()+h.getY())/4);try{let x=new Ht(this.image,15,d,m).detect();r=x[0],o=x[1],h=x[2],f=x[3]}catch{r=this.getFirstDifferent(new pe(d+7,m-7),!1,1,-1).toResultPoint(),o=this.getFirstDifferent(new pe(d+7,m+7),!1,1,1).toResultPoint(),h=this.getFirstDifferent(new pe(d-7,m+7),!1,-1,1).toResultPoint(),f=this.getFirstDifferent(new pe(d-7,m-7),!1,-1,-1).toResultPoint()}return d=lt.round((r.getX()+f.getX()+o.getX()+h.getX())/4),m=lt.round((r.getY()+f.getY()+o.getY()+h.getY())/4),new pe(d,m)}getMatrixCornerPoints(r){return this.expandSquare(r,2*this.nbCenterLayers,this.getDimension())}sampleGrid(r,o,h,f,d){let m=re.getInstance(),x=this.getDimension(),w=x/2-this.nbCenterLayers,A=x/2+this.nbCenterLayers;return m.sampleGrid(r,x,x,w,w,A,w,A,A,w,A,o.getX(),o.getY(),h.getX(),h.getY(),f.getX(),f.getY(),d.getX(),d.getY())}sampleLine(r,o,h){let f=0,d=this.distanceResultPoint(r,o),m=d/h,x=r.getX(),w=r.getY(),A=m*(o.getX()-r.getX())/d,O=m*(o.getY()-r.getY())/d;for(let B=0;B<h;B++)this.image.get(lt.round(x+B*A),lt.round(w+B*O))&&(f|=1<<h-B-1);return f}isWhiteOrBlackRectangle(r,o,h,f){let d=3;r=new pe(r.getX()-d,r.getY()+d),o=new pe(o.getX()-d,o.getY()-d),h=new pe(h.getX()+d,h.getY()-d),f=new pe(f.getX()+d,f.getY()+d);let m=this.getColor(f,r);if(m===0)return!1;let x=this.getColor(r,o);return x!==m||(x=this.getColor(o,h),x!==m)?!1:(x=this.getColor(h,f),x===m)}getColor(r,o){let h=this.distancePoint(r,o),f=(o.getX()-r.getX())/h,d=(o.getY()-r.getY())/h,m=0,x=r.getX(),w=r.getY(),A=this.image.get(r.getX(),r.getY()),O=Math.ceil(h);for(let Y=0;Y<O;Y++)x+=f,w+=d,this.image.get(lt.round(x),lt.round(w))!==A&&m++;let B=m/h;return B>.1&&B<.9?0:B<=.1===A?1:-1}getFirstDifferent(r,o,h,f){let d=r.getX()+h,m=r.getY()+f;for(;this.isValid(d,m)&&this.image.get(d,m)===o;)d+=h,m+=f;for(d-=h,m-=f;this.isValid(d,m)&&this.image.get(d,m)===o;)d+=h;for(d-=h;this.isValid(d,m)&&this.image.get(d,m)===o;)m+=f;return m-=f,new pe(d,m)}expandSquare(r,o,h){let f=h/(2*o),d=r[0].getX()-r[2].getX(),m=r[0].getY()-r[2].getY(),x=(r[0].getX()+r[2].getX())/2,w=(r[0].getY()+r[2].getY())/2,A=new gt(x+f*d,w+f*m),O=new gt(x-f*d,w-f*m);d=r[1].getX()-r[3].getX(),m=r[1].getY()-r[3].getY(),x=(r[1].getX()+r[3].getX())/2,w=(r[1].getY()+r[3].getY())/2;let B=new gt(x+f*d,w+f*m),Y=new gt(x-f*d,w-f*m);return[A,B,O,Y]}isValid(r,o){return r>=0&&r<this.image.getWidth()&&o>0&&o<this.image.getHeight()}isValidPoint(r){let o=lt.round(r.getX()),h=lt.round(r.getY());return this.isValid(o,h)}distancePoint(r,o){return lt.distance(r.getX(),r.getY(),o.getX(),o.getY())}distanceResultPoint(r,o){return lt.distance(r.getX(),r.getY(),o.getX(),o.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(k.truncDivision(this.nbLayers-4,8)+1)+15}}class Mi{decode(r,o=null){let h=null,f=new Mn(r.getBlackMatrix()),d=null,m=null;try{let O=f.detectMirror(!1);d=O.getPoints(),this.reportFoundResultPoints(o,d),m=new $().decode(O)}catch(O){h=O}if(m==null)try{let O=f.detectMirror(!0);d=O.getPoints(),this.reportFoundResultPoints(o,d),m=new $().decode(O)}catch(O){throw h??O}let x=new mt(m.getText(),m.getRawBytes(),m.getNumBits(),d,Vt.AZTEC,R.currentTimeMillis()),w=m.getByteSegments();w!=null&&x.putMetadata(te.BYTE_SEGMENTS,w);let A=m.getECLevel();return A!=null&&x.putMetadata(te.ERROR_CORRECTION_LEVEL,A),x}reportFoundResultPoints(r,o){if(r!=null){let h=r.get(K.NEED_RESULT_POINT_CALLBACK);h!=null&&o.forEach((f,d,m)=>{h.foundPossibleResultPoint(f)})}}reset(){}}class rn extends Pt{constructor(r=500){super(new Mi,r)}}class le{decode(r,o){try{return this.doDecode(r,o)}catch{if(o&&o.get(K.TRY_HARDER)===!0&&r.isRotateSupported()){const d=r.rotateCounterClockwise(),m=this.doDecode(d,o),x=m.getResultMetadata();let w=270;x!==null&&x.get(te.ORIENTATION)===!0&&(w=w+x.get(te.ORIENTATION)%360),m.putMetadata(te.ORIENTATION,w);const A=m.getResultPoints();if(A!==null){const O=d.getHeight();for(let B=0;B<A.length;B++)A[B]=new gt(O-A[B].getY()-1,A[B].getX())}return m}else throw new Z}}reset(){}doDecode(r,o){const h=r.getWidth(),f=r.getHeight();let d=new X(h);const m=o&&o.get(K.TRY_HARDER)===!0,x=Math.max(1,f>>(m?8:5));let w;m?w=f:w=15;const A=Math.trunc(f/2);for(let O=0;O<w;O++){const B=Math.trunc((O+1)/2),Y=(O&1)===0,Q=A+x*(Y?B:-B);if(Q<0||Q>=f)break;try{d=r.getBlackRow(Q,d)}catch{continue}for(let ht=0;ht<2;ht++){if(ht===1&&(d.reverse(),o&&o.get(K.NEED_RESULT_POINT_CALLBACK)===!0)){const ut=new Map;o.forEach((yt,Ct)=>ut.set(Ct,yt)),ut.delete(K.NEED_RESULT_POINT_CALLBACK),o=ut}try{const ut=this.decodeRow(Q,d,o);if(ht===1){ut.putMetadata(te.ORIENTATION,180);const yt=ut.getResultPoints();yt!==null&&(yt[0]=new gt(h-yt[0].getX()-1,yt[0].getY()),yt[1]=new gt(h-yt[1].getX()-1,yt[1].getY()))}return ut}catch{}}}throw new Z}static recordPattern(r,o,h){const f=h.length;for(let A=0;A<f;A++)h[A]=0;const d=r.getSize();if(o>=d)throw new Z;let m=!r.get(o),x=0,w=o;for(;w<d;){if(r.get(w)!==m)h[x]++;else{if(++x===f)break;h[x]=1,m=!m}w++}if(!(x===f||x===f-1&&w===d))throw new Z}static recordPatternInReverse(r,o,h){let f=h.length,d=r.get(o);for(;o>0&&f>=0;)r.get(--o)!==d&&(f--,d=!d);if(f>=0)throw new Z;le.recordPattern(r,o+1,h)}static patternMatchVariance(r,o,h){const f=r.length;let d=0,m=0;for(let A=0;A<f;A++)d+=r[A],m+=o[A];if(d<m)return Number.POSITIVE_INFINITY;const x=d/m;h*=x;let w=0;for(let A=0;A<f;A++){const O=r[A],B=o[A]*x,Y=O>B?O-B:B-O;if(Y>h)return Number.POSITIVE_INFINITY;w+=Y}return w/d}}class jt extends le{static findStartPattern(r){const o=r.getSize(),h=r.getNextSet(0);let f=0,d=Int32Array.from([0,0,0,0,0,0]),m=h,x=!1;const w=6;for(let A=h;A<o;A++)if(r.get(A)!==x)d[f]++;else{if(f===w-1){let O=jt.MAX_AVG_VARIANCE,B=-1;for(let Y=jt.CODE_START_A;Y<=jt.CODE_START_C;Y++){const Q=le.patternMatchVariance(d,jt.CODE_PATTERNS[Y],jt.MAX_INDIVIDUAL_VARIANCE);Q<O&&(O=Q,B=Y)}if(B>=0&&r.isRange(Math.max(0,m-(A-m)/2),m,!1))return Int32Array.from([m,A,B]);m+=d[0]+d[1],d=d.slice(2,d.length-1),d[f-1]=0,d[f]=0,f--}else f++;d[f]=1,x=!x}throw new Z}static decodeCode(r,o,h){le.recordPattern(r,h,o);let f=jt.MAX_AVG_VARIANCE,d=-1;for(let m=0;m<jt.CODE_PATTERNS.length;m++){const x=jt.CODE_PATTERNS[m],w=this.patternMatchVariance(o,x,jt.MAX_INDIVIDUAL_VARIANCE);w<f&&(f=w,d=m)}if(d>=0)return d;throw new Z}decodeRow(r,o,h){const f=h&&h.get(K.ASSUME_GS1)===!0,d=jt.findStartPattern(o),m=d[2];let x=0;const w=new Uint8Array(20);w[x++]=m;let A;switch(m){case jt.CODE_START_A:A=jt.CODE_CODE_A;break;case jt.CODE_START_B:A=jt.CODE_CODE_B;break;case jt.CODE_START_C:A=jt.CODE_CODE_C;break;default:throw new z}let O=!1,B=!1,Y="",Q=d[0],ht=d[1];const ut=Int32Array.from([0,0,0,0,0,0]);let yt=0,Ct=0,zt=m,Wt=0,Bt=!0,Be=!1,De=!1;for(;!O;){const ta=B;switch(B=!1,yt=Ct,Ct=jt.decodeCode(o,ut,ht),w[x++]=Ct,Ct!==jt.CODE_STOP&&(Bt=!0),Ct!==jt.CODE_STOP&&(Wt++,zt+=Wt*Ct),Q=ht,ht+=ut.reduce((Bx,Vx)=>Bx+Vx,0),Ct){case jt.CODE_START_A:case jt.CODE_START_B:case jt.CODE_START_C:throw new z}switch(A){case jt.CODE_CODE_A:if(Ct<64)De===Be?Y+=String.fromCharCode(32+Ct):Y+=String.fromCharCode(32+Ct+128),De=!1;else if(Ct<96)De===Be?Y+=String.fromCharCode(Ct-64):Y+=String.fromCharCode(Ct+64),De=!1;else switch(Ct!==jt.CODE_STOP&&(Bt=!1),Ct){case jt.CODE_FNC_1:f&&(Y.length===0?Y+="]C1":Y+="");break;case jt.CODE_FNC_2:case jt.CODE_FNC_3:break;case jt.CODE_FNC_4_A:!Be&&De?(Be=!0,De=!1):Be&&De?(Be=!1,De=!1):De=!0;break;case jt.CODE_SHIFT:B=!0,A=jt.CODE_CODE_B;break;case jt.CODE_CODE_B:A=jt.CODE_CODE_B;break;case jt.CODE_CODE_C:A=jt.CODE_CODE_C;break;case jt.CODE_STOP:O=!0;break}break;case jt.CODE_CODE_B:if(Ct<96)De===Be?Y+=String.fromCharCode(32+Ct):Y+=String.fromCharCode(32+Ct+128),De=!1;else switch(Ct!==jt.CODE_STOP&&(Bt=!1),Ct){case jt.CODE_FNC_1:f&&(Y.length===0?Y+="]C1":Y+="");break;case jt.CODE_FNC_2:case jt.CODE_FNC_3:break;case jt.CODE_FNC_4_B:!Be&&De?(Be=!0,De=!1):Be&&De?(Be=!1,De=!1):De=!0;break;case jt.CODE_SHIFT:B=!0,A=jt.CODE_CODE_A;break;case jt.CODE_CODE_A:A=jt.CODE_CODE_A;break;case jt.CODE_CODE_C:A=jt.CODE_CODE_C;break;case jt.CODE_STOP:O=!0;break}break;case jt.CODE_CODE_C:if(Ct<100)Ct<10&&(Y+="0"),Y+=Ct;else switch(Ct!==jt.CODE_STOP&&(Bt=!1),Ct){case jt.CODE_FNC_1:f&&(Y.length===0?Y+="]C1":Y+="");break;case jt.CODE_CODE_A:A=jt.CODE_CODE_A;break;case jt.CODE_CODE_B:A=jt.CODE_CODE_B;break;case jt.CODE_STOP:O=!0;break}break}ta&&(A=A===jt.CODE_CODE_A?jt.CODE_CODE_B:jt.CODE_CODE_A)}const dn=ht-Q;if(ht=o.getNextUnset(ht),!o.isRange(ht,Math.min(o.getSize(),ht+(ht-Q)/2),!1))throw new Z;if(zt-=Wt*yt,zt%103!==yt)throw new I;const Yn=Y.length;if(Yn===0)throw new Z;Yn>0&&Bt&&(A===jt.CODE_CODE_C?Y=Y.substring(0,Yn-2):Y=Y.substring(0,Yn-1));const gn=(d[1]+d[0])/2,ai=Q+dn/2,Xi=w.length,An=new Uint8Array(Xi);for(let ta=0;ta<Xi;ta++)An[ta]=w[ta];const Qr=[new gt(gn,r),new gt(ai,r)];return new mt(Y,An,0,Qr,Vt.CODE_128,new Date().getTime())}}jt.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],jt.MAX_AVG_VARIANCE=.25,jt.MAX_INDIVIDUAL_VARIANCE=.7,jt.CODE_SHIFT=98,jt.CODE_CODE_C=99,jt.CODE_CODE_B=100,jt.CODE_CODE_A=101,jt.CODE_FNC_1=102,jt.CODE_FNC_2=97,jt.CODE_FNC_3=96,jt.CODE_FNC_4_A=101,jt.CODE_FNC_4_B=100,jt.CODE_START_A=103,jt.CODE_START_B=104,jt.CODE_START_C=105,jt.CODE_STOP=106;class He extends le{constructor(r=!1,o=!1){super(),this.usingCheckDigit=r,this.extendedMode=o,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(r,o,h){let f=this.counters;f.fill(0),this.decodeRowResult="";let d=He.findAsteriskPattern(o,f),m=o.getNextSet(d[1]),x=o.getSize(),w,A;do{He.recordPattern(o,m,f);let ut=He.toNarrowWidePattern(f);if(ut<0)throw new Z;w=He.patternToChar(ut),this.decodeRowResult+=w,A=m;for(let yt of f)m+=yt;m=o.getNextSet(m)}while(w!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let O=0;for(let ut of f)O+=ut;let B=m-A-O;if(m!==x&&B*2<O)throw new Z;if(this.usingCheckDigit){let ut=this.decodeRowResult.length-1,yt=0;for(let Ct=0;Ct<ut;Ct++)yt+=He.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Ct));if(this.decodeRowResult.charAt(ut)!==He.ALPHABET_STRING.charAt(yt%43))throw new I;this.decodeRowResult=this.decodeRowResult.substring(0,ut)}if(this.decodeRowResult.length===0)throw new Z;let Y;this.extendedMode?Y=He.decodeExtended(this.decodeRowResult):Y=this.decodeRowResult;let Q=(d[1]+d[0])/2,ht=A+O/2;return new mt(Y,null,0,[new gt(Q,r),new gt(ht,r)],Vt.CODE_39,new Date().getTime())}static findAsteriskPattern(r,o){let h=r.getSize(),f=r.getNextSet(0),d=0,m=f,x=!1,w=o.length;for(let A=f;A<h;A++)if(r.get(A)!==x)o[d]++;else{if(d===w-1){if(this.toNarrowWidePattern(o)===He.ASTERISK_ENCODING&&r.isRange(Math.max(0,m-Math.floor((A-m)/2)),m,!1))return[m,A];m+=o[0]+o[1],o.copyWithin(0,2,2+d-1),o[d-1]=0,o[d]=0,d--}else d++;o[d]=1,x=!x}throw new Z}static toNarrowWidePattern(r){let o=r.length,h=0,f;do{let d=2147483647;for(let w of r)w<d&&w>h&&(d=w);h=d,f=0;let m=0,x=0;for(let w=0;w<o;w++){let A=r[w];A>h&&(x|=1<<o-1-w,f++,m+=A)}if(f===3){for(let w=0;w<o&&f>0;w++){let A=r[w];if(A>h&&(f--,A*2>=m))return-1}return x}}while(f>3);return-1}static patternToChar(r){for(let o=0;o<He.CHARACTER_ENCODINGS.length;o++)if(He.CHARACTER_ENCODINGS[o]===r)return He.ALPHABET_STRING.charAt(o);if(r===He.ASTERISK_ENCODING)return"*";throw new Z}static decodeExtended(r){let o=r.length,h="";for(let f=0;f<o;f++){let d=r.charAt(f);if(d==="+"||d==="$"||d==="%"||d==="/"){let m=r.charAt(f+1),x="\0";switch(d){case"+":if(m>="A"&&m<="Z")x=String.fromCharCode(m.charCodeAt(0)+32);else throw new z;break;case"$":if(m>="A"&&m<="Z")x=String.fromCharCode(m.charCodeAt(0)-64);else throw new z;break;case"%":if(m>="A"&&m<="E")x=String.fromCharCode(m.charCodeAt(0)-38);else if(m>="F"&&m<="J")x=String.fromCharCode(m.charCodeAt(0)-11);else if(m>="K"&&m<="O")x=String.fromCharCode(m.charCodeAt(0)+16);else if(m>="P"&&m<="T")x=String.fromCharCode(m.charCodeAt(0)+43);else if(m==="U")x="\0";else if(m==="V")x="@";else if(m==="W")x="`";else if(m==="X"||m==="Y"||m==="Z")x="";else throw new z;break;case"/":if(m>="A"&&m<="O")x=String.fromCharCode(m.charCodeAt(0)-32);else if(m==="Z")x=":";else throw new z;break}h+=x,f++}else h+=d}return h}}He.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",He.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],He.ASTERISK_ENCODING=148;class ye extends le{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(r,o,h){let f=this.decodeStart(o),d=this.decodeEnd(o),m=new tt;ye.decodeMiddle(o,f[1],d[0],m);let x=m.toString(),w=null;h!=null&&(w=h.get(K.ALLOWED_LENGTHS)),w==null&&(w=ye.DEFAULT_ALLOWED_LENGTHS);let A=x.length,O=!1,B=0;for(let ht of w){if(A===ht){O=!0;break}ht>B&&(B=ht)}if(!O&&A>B&&(O=!0),!O)throw new z;const Y=[new gt(f[1],r),new gt(d[0],r)];return new mt(x,null,0,Y,Vt.ITF,new Date().getTime())}static decodeMiddle(r,o,h,f){let d=new Int32Array(10),m=new Int32Array(5),x=new Int32Array(5);for(d.fill(0),m.fill(0),x.fill(0);o<h;){le.recordPattern(r,o,d);for(let A=0;A<5;A++){let O=2*A;m[A]=d[O],x[A]=d[O+1]}let w=ye.decodeDigit(m);f.append(w.toString()),w=this.decodeDigit(x),f.append(w.toString()),d.forEach(function(A){o+=A})}}decodeStart(r){let o=ye.skipWhiteSpace(r),h=ye.findGuardPattern(r,o,ye.START_PATTERN);return this.narrowLineWidth=(h[1]-h[0])/4,this.validateQuietZone(r,h[0]),h}validateQuietZone(r,o){let h=this.narrowLineWidth*10;h=h<o?h:o;for(let f=o-1;h>0&&f>=0&&!r.get(f);f--)h--;if(h!==0)throw new Z}static skipWhiteSpace(r){const o=r.getSize(),h=r.getNextSet(0);if(h===o)throw new Z;return h}decodeEnd(r){r.reverse();try{let o=ye.skipWhiteSpace(r),h;try{h=ye.findGuardPattern(r,o,ye.END_PATTERN_REVERSED[0])}catch(d){d instanceof Z&&(h=ye.findGuardPattern(r,o,ye.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,h[0]);let f=h[0];return h[0]=r.getSize()-h[1],h[1]=r.getSize()-f,h}finally{r.reverse()}}static findGuardPattern(r,o,h){let f=h.length,d=new Int32Array(f),m=r.getSize(),x=!1,w=0,A=o;d.fill(0);for(let O=o;O<m;O++)if(r.get(O)!==x)d[w]++;else{if(w===f-1){if(le.patternMatchVariance(d,h,ye.MAX_INDIVIDUAL_VARIANCE)<ye.MAX_AVG_VARIANCE)return[A,O];A+=d[0]+d[1],R.arraycopy(d,2,d,0,w-1),d[w-1]=0,d[w]=0,w--}else w++;d[w]=1,x=!x}throw new Z}static decodeDigit(r){let o=ye.MAX_AVG_VARIANCE,h=-1,f=ye.PATTERNS.length;for(let d=0;d<f;d++){let m=ye.PATTERNS[d],x=le.patternMatchVariance(r,m,ye.MAX_INDIVIDUAL_VARIANCE);x<o?(o=x,h=d):x===o&&(h=-1)}if(h>=0)return h%10;throw new Z}}ye.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],ye.MAX_AVG_VARIANCE=.38,ye.MAX_INDIVIDUAL_VARIANCE=.5,ye.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],ye.START_PATTERN=Int32Array.from([1,1,1,1]),ye.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class ze extends le{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(r){let o=!1,h,f=0,d=Int32Array.from([0,0,0]);for(;!o;){d=Int32Array.from([0,0,0]),h=ze.findGuardPattern(r,f,!1,this.START_END_PATTERN,d);let m=h[0];f=h[1];let x=m-(f-m);x>=0&&(o=r.isRange(x,m,!1))}return h}static checkChecksum(r){return ze.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let o=r.length;if(o===0)return!1;let h=parseInt(r.charAt(o-1),10);return ze.getStandardUPCEANChecksum(r.substring(0,o-1))===h}static getStandardUPCEANChecksum(r){let o=r.length,h=0;for(let f=o-1;f>=0;f-=2){let d=r.charAt(f).charCodeAt(0)-48;if(d<0||d>9)throw new z;h+=d}h*=3;for(let f=o-2;f>=0;f-=2){let d=r.charAt(f).charCodeAt(0)-48;if(d<0||d>9)throw new z;h+=d}return(1e3-h)%10}static decodeEnd(r,o){return ze.findGuardPattern(r,o,!1,ze.START_END_PATTERN,new Int32Array(ze.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(r,o,h,f){return this.findGuardPattern(r,o,h,f,new Int32Array(f.length))}static findGuardPattern(r,o,h,f,d){let m=r.getSize();o=h?r.getNextUnset(o):r.getNextSet(o);let x=0,w=o,A=f.length,O=h;for(let B=o;B<m;B++)if(r.get(B)!==O)d[x]++;else{if(x===A-1){if(le.patternMatchVariance(d,f,ze.MAX_INDIVIDUAL_VARIANCE)<ze.MAX_AVG_VARIANCE)return Int32Array.from([w,B]);w+=d[0]+d[1];let Y=d.slice(2,d.length-1);for(let Q=0;Q<x-1;Q++)d[Q]=Y[Q];d[x-1]=0,d[x]=0,x--}else x++;d[x]=1,O=!O}throw new Z}static decodeDigit(r,o,h,f){this.recordPattern(r,h,o);let d=this.MAX_AVG_VARIANCE,m=-1,x=f.length;for(let w=0;w<x;w++){let A=f[w],O=le.patternMatchVariance(o,A,ze.MAX_INDIVIDUAL_VARIANCE);O<d&&(d=O,m=w)}if(m>=0)return m;throw new Z}}ze.MAX_AVG_VARIANCE=.48,ze.MAX_INDIVIDUAL_VARIANCE=.7,ze.START_END_PATTERN=Int32Array.from([1,1,1]),ze.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),ze.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ze.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class bn{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,o,h){let f=this.decodeRowStringBuffer,d=this.decodeMiddle(o,h,f),m=f.toString(),x=bn.parseExtensionString(m),w=[new gt((h[0]+h[1])/2,r),new gt(d,r)],A=new mt(m,null,0,w,Vt.UPC_EAN_EXTENSION,new Date().getTime());return x!=null&&A.putAllMetadata(x),A}decodeMiddle(r,o,h){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=r.getSize(),m=o[1],x=0;for(let A=0;A<5&&m<d;A++){let O=ze.decodeDigit(r,f,m,ze.L_AND_G_PATTERNS);h+=String.fromCharCode(48+O%10);for(let B of f)m+=B;O>=10&&(x|=1<<4-A),A!==4&&(m=r.getNextSet(m),m=r.getNextUnset(m))}if(h.length!==5)throw new Z;let w=this.determineCheckDigit(x);if(bn.extensionChecksum(h.toString())!==w)throw new Z;return m}static extensionChecksum(r){let o=r.length,h=0;for(let f=o-2;f>=0;f-=2)h+=r.charAt(f).charCodeAt(0)-48;h*=3;for(let f=o-1;f>=0;f-=2)h+=r.charAt(f).charCodeAt(0)-48;return h*=3,h%10}determineCheckDigit(r){for(let o=0;o<10;o++)if(r===this.CHECK_DIGIT_ENCODINGS[o])return o;throw new Z}static parseExtensionString(r){if(r.length!==5)return null;let o=bn.parseExtension5String(r);return o==null?null:new Map([[te.SUGGESTED_PRICE,o]])}static parseExtension5String(r){let o;switch(r.charAt(0)){case"0":o="£";break;case"5":o="$";break;case"9":switch(r){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}o="";break;default:o="";break}let h=parseInt(r.substring(1)),f=(h/100).toString(),d=h%100,m=d<10?"0"+d:d.toString();return o+f+"."+m}}class vn{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(r,o,h){let f=this.decodeRowStringBuffer,d=this.decodeMiddle(o,h,f),m=f.toString(),x=vn.parseExtensionString(m),w=[new gt((h[0]+h[1])/2,r),new gt(d,r)],A=new mt(m,null,0,w,Vt.UPC_EAN_EXTENSION,new Date().getTime());return x!=null&&A.putAllMetadata(x),A}decodeMiddle(r,o,h){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=r.getSize(),m=o[1],x=0;for(let w=0;w<2&&m<d;w++){let A=ze.decodeDigit(r,f,m,ze.L_AND_G_PATTERNS);h+=String.fromCharCode(48+A%10);for(let O of f)m+=O;A>=10&&(x|=1<<1-w),w!==1&&(m=r.getNextSet(m),m=r.getNextUnset(m))}if(h.length!==2)throw new Z;if(parseInt(h.toString())%4!==x)throw new Z;return m}static parseExtensionString(r){return r.length!==2?null:new Map([[te.ISSUE_NUMBER,parseInt(r)]])}}class un{static decodeRow(r,o,h){let f=ze.findGuardPattern(o,h,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new bn().decodeRow(r,o,f)}catch{return new vn().decodeRow(r,o,f)}}}un.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Tt extends ze{constructor(){super(),this.decodeRowStringBuffer="",Tt.L_AND_G_PATTERNS=Tt.L_PATTERNS.map(r=>Int32Array.from(r));for(let r=10;r<20;r++){let o=Tt.L_PATTERNS[r-10],h=new Int32Array(o.length);for(let f=0;f<o.length;f++)h[f]=o[o.length-f-1];Tt.L_AND_G_PATTERNS[r]=h}}decodeRow(r,o,h){let f=Tt.findStartGuardPattern(o),d=h==null?null:h.get(K.NEED_RESULT_POINT_CALLBACK);if(d!=null){const Bt=new gt((f[0]+f[1])/2,r);d.foundPossibleResultPoint(Bt)}let m=this.decodeMiddle(o,f,this.decodeRowStringBuffer),x=m.rowOffset,w=m.resultString;if(d!=null){const Bt=new gt(x,r);d.foundPossibleResultPoint(Bt)}let A=this.decodeEnd(o,x);if(d!=null){const Bt=new gt((A[0]+A[1])/2,r);d.foundPossibleResultPoint(Bt)}let O=A[1],B=O+(O-A[0]);if(B>=o.getSize()||!o.isRange(O,B,!1))throw new Z;let Y=w.toString();if(Y.length<8)throw new z;if(!Tt.checkChecksum(Y))throw new I;let Q=(f[1]+f[0])/2,ht=(A[1]+A[0])/2,ut=this.getBarcodeFormat(),yt=[new gt(Q,r),new gt(ht,r)],Ct=new mt(Y,null,0,yt,ut,new Date().getTime()),zt=0;try{let Bt=un.decodeRow(r,o,A[1]);Ct.putMetadata(te.UPC_EAN_EXTENSION,Bt.getText()),Ct.putAllMetadata(Bt.getResultMetadata()),Ct.addResultPoints(Bt.getResultPoints()),zt=Bt.getText().length}catch{}let Wt=h==null?null:h.get(K.ALLOWED_EAN_EXTENSIONS);if(Wt!=null){let Bt=!1;for(let Be in Wt)if(zt.toString()===Be){Bt=!0;break}if(!Bt)throw new Z}return Ct}decodeEnd(r,o){return Tt.findGuardPattern(r,o,!1,Tt.START_END_PATTERN,new Int32Array(Tt.START_END_PATTERN.length).fill(0))}static checkChecksum(r){return Tt.checkStandardUPCEANChecksum(r)}static checkStandardUPCEANChecksum(r){let o=r.length;if(o===0)return!1;let h=parseInt(r.charAt(o-1),10);return Tt.getStandardUPCEANChecksum(r.substring(0,o-1))===h}static getStandardUPCEANChecksum(r){let o=r.length,h=0;for(let f=o-1;f>=0;f-=2){let d=r.charAt(f).charCodeAt(0)-48;if(d<0||d>9)throw new z;h+=d}h*=3;for(let f=o-2;f>=0;f-=2){let d=r.charAt(f).charCodeAt(0)-48;if(d<0||d>9)throw new z;h+=d}return(1e3-h)%10}}class Ii extends Tt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,o,h){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=r.getSize(),m=o[1],x=0;for(let A=0;A<6&&m<d;A++){let O=Tt.decodeDigit(r,f,m,Tt.L_AND_G_PATTERNS);h+=String.fromCharCode(48+O%10);for(let B of f)m+=B;O>=10&&(x|=1<<5-A)}h=Ii.determineFirstDigit(h,x),m=Tt.findGuardPattern(r,m,!0,Tt.MIDDLE_PATTERN,new Int32Array(Tt.MIDDLE_PATTERN.length).fill(0))[1];for(let A=0;A<6&&m<d;A++){let O=Tt.decodeDigit(r,f,m,Tt.L_PATTERNS);h+=String.fromCharCode(48+O);for(let B of f)m+=B}return{rowOffset:m,resultString:h}}getBarcodeFormat(){return Vt.EAN_13}static determineFirstDigit(r,o){for(let h=0;h<10;h++)if(o===this.FIRST_DIGIT_ENCODINGS[h])return r=String.fromCharCode(48+h)+r,r;throw new Z}}Ii.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class an extends Tt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(r,o,h){const f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=r.getSize(),m=o[1];for(let w=0;w<4&&m<d;w++){let A=Tt.decodeDigit(r,f,m,Tt.L_PATTERNS);h+=String.fromCharCode(48+A);for(let O of f)m+=O}m=Tt.findGuardPattern(r,m,!0,Tt.MIDDLE_PATTERN,new Int32Array(Tt.MIDDLE_PATTERN.length).fill(0))[1];for(let w=0;w<4&&m<d;w++){let A=Tt.decodeDigit(r,f,m,Tt.L_PATTERNS);h+=String.fromCharCode(48+A);for(let O of f)m+=O}return{rowOffset:m,resultString:h}}getBarcodeFormat(){return Vt.EAN_8}}class Er extends Tt{constructor(){super(...arguments),this.ean13Reader=new Ii}getBarcodeFormat(){return Vt.UPC_A}decode(r,o){return this.maybeReturnResult(this.ean13Reader.decode(r))}decodeRow(r,o,h){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,o,h))}decodeMiddle(r,o,h){return this.ean13Reader.decodeMiddle(r,o,h)}maybeReturnResult(r){let o=r.getText();if(o.charAt(0)==="0"){let h=new mt(o.substring(1),null,null,r.getResultPoints(),Vt.UPC_A);return r.getResultMetadata()!=null&&h.putAllMetadata(r.getResultMetadata()),h}else throw new Z}reset(){this.ean13Reader.reset()}}class Ut extends Tt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(r,o,h){const f=this.decodeMiddleCounters.map(A=>A);f[0]=0,f[1]=0,f[2]=0,f[3]=0;const d=r.getSize();let m=o[1],x=0;for(let A=0;A<6&&m<d;A++){const O=Ut.decodeDigit(r,f,m,Ut.L_AND_G_PATTERNS);h+=String.fromCharCode(48+O%10);for(let B of f)m+=B;O>=10&&(x|=1<<5-A)}let w=Ut.determineNumSysAndCheckDigit(h,x);return{rowOffset:m,resultString:w}}decodeEnd(r,o){return Ut.findGuardPatternWithoutCounters(r,o,!0,Ut.MIDDLE_END_PATTERN)}checkChecksum(r){return Tt.checkChecksum(Ut.convertUPCEtoUPCA(r))}static determineNumSysAndCheckDigit(r,o){for(let h=0;h<=1;h++)for(let f=0;f<10;f++)if(o===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[h][f]){let d=String.fromCharCode(48+h),m=String.fromCharCode(48+f);return d+r+m}throw Z.getNotFoundInstance()}getBarcodeFormat(){return Vt.UPC_E}static convertUPCEtoUPCA(r){const o=r.slice(1,7).split("").map(d=>d.charCodeAt(0)),h=new tt;h.append(r.charAt(0));let f=o[5];switch(f){case 0:case 1:case 2:h.appendChars(o,0,2),h.append(f),h.append("0000"),h.appendChars(o,2,3);break;case 3:h.appendChars(o,0,3),h.append("00000"),h.appendChars(o,3,2);break;case 4:h.appendChars(o,0,4),h.append("00000"),h.append(o[4]);break;default:h.appendChars(o,0,5),h.append("0000"),h.append(f);break}return r.length>=8&&h.append(r.charAt(7)),h.toString()}}Ut.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ut.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Xe extends le{constructor(r){super();let o=r==null?null:r.get(K.POSSIBLE_FORMATS),h=[];n(o)?(h.push(new Ii),h.push(new Er),h.push(new an),h.push(new Ut)):(o.indexOf(Vt.EAN_13)>-1&&h.push(new Ii),o.indexOf(Vt.UPC_A)>-1&&h.push(new Er),o.indexOf(Vt.EAN_8)>-1&&h.push(new an),o.indexOf(Vt.UPC_E)>-1&&h.push(new Ut)),this.readers=h}decodeRow(r,o,h){for(let f of this.readers)try{const d=f.decodeRow(r,o,h),m=d.getBarcodeFormat()===Vt.EAN_13&&d.getText().charAt(0)==="0",x=h==null?null:h.get(K.POSSIBLE_FORMATS),w=x==null||x.includes(Vt.UPC_A);if(m&&w){const A=d.getRawBytes(),O=new mt(d.getText().substring(1),A,A?A.length:null,d.getResultPoints(),Vt.UPC_A);return O.putAllMetadata(d.getResultMetadata()),O}return d}catch{}throw new Z}reset(){for(let r of this.readers)r.reset()}}class Ue extends le{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(r,o){for(let h=0;h<o.length;h++)if(le.patternMatchVariance(r,o[h],Ue.MAX_INDIVIDUAL_VARIANCE)<Ue.MAX_AVG_VARIANCE)return h;throw new Z}static count(r){return lt.sum(new Int32Array(r))}static increment(r,o){let h=0,f=o[0];for(let d=1;d<r.length;d++)o[d]>f&&(f=o[d],h=d);r[h]++}static decrement(r,o){let h=0,f=o[0];for(let d=1;d<r.length;d++)o[d]<f&&(f=o[d],h=d);r[h]--}static isFinderPattern(r){let o=r[0]+r[1],h=o+r[2]+r[3],f=o/h;if(f>=Ue.MIN_FINDER_PATTERN_RATIO&&f<=Ue.MAX_FINDER_PATTERN_RATIO){let d=Number.MAX_SAFE_INTEGER,m=Number.MIN_SAFE_INTEGER;for(let x of r)x>m&&(m=x),x<d&&(d=x);return m<10*d}return!1}}Ue.MAX_AVG_VARIANCE=.2,Ue.MAX_INDIVIDUAL_VARIANCE=.45,Ue.MIN_FINDER_PATTERN_RATIO=9.5/12,Ue.MAX_FINDER_PATTERN_RATIO=12.5/14;class ge{constructor(r,o){this.value=r,this.checksumPortion=o}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(r){if(!(r instanceof ge))return!1;const o=r;return this.value===o.value&&this.checksumPortion===o.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Ci{constructor(r,o,h,f,d){this.value=r,this.startEnd=o,this.value=r,this.startEnd=o,this.resultPoints=new Array,this.resultPoints.push(new gt(h,d)),this.resultPoints.push(new gt(f,d))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(r){if(!(r instanceof Ci))return!1;const o=r;return this.value===o.value}hashCode(){return this.value}}class we{constructor(){}static getRSSvalue(r,o,h){let f=0;for(let w of r)f+=w;let d=0,m=0,x=r.length;for(let w=0;w<x-1;w++){let A;for(A=1,m|=1<<w;A<r[w];A++,m&=~(1<<w)){let O=we.combins(f-A-1,x-w-2);if(h&&m===0&&f-A-(x-w-1)>=x-w-1&&(O-=we.combins(f-A-(x-w),x-w-2)),x-w-1>1){let B=0;for(let Y=f-A-(x-w-2);Y>o;Y--)B+=we.combins(f-A-Y-1,x-w-3);O-=B*(x-1-w)}else f-A>o&&O--;d+=O}f-=A}return d}static combins(r,o){let h,f;r-o>o?(f=o,h=r-o):(f=r-o,h=o);let d=1,m=1;for(let x=r;x>h;x--)d*=x,m<=f&&(d/=m,m++);for(;m<=f;)d/=m,m++;return d}}class hi{static buildBitArray(r){let o=r.length*2-1;r[r.length-1].getRightChar()==null&&(o-=1);let h=12*o,f=new X(h),d=0,x=r[0].getRightChar().getValue();for(let w=11;w>=0;--w)x&1<<w&&f.set(d),d++;for(let w=1;w<r.length;++w){let A=r[w],O=A.getLeftChar().getValue();for(let B=11;B>=0;--B)O&1<<B&&f.set(d),d++;if(A.getRightChar()!=null){let B=A.getRightChar().getValue();for(let Y=11;Y>=0;--Y)B&1<<Y&&f.set(d),d++}}return f}}class Pi{constructor(r,o){o?this.decodedInformation=null:(this.finished=r,this.decodedInformation=o)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class ei{constructor(r){this.newPosition=r}getNewPosition(){return this.newPosition}}class je extends ei{constructor(r,o){super(r),this.value=o}getValue(){return this.value}isFNC1(){return this.value===je.FNC1}}je.FNC1="$";class gi extends ei{constructor(r,o,h){super(r),h?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=o}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Yi extends ei{constructor(r,o,h){if(super(r),o<0||o>10||h<0||h>10)throw new z;this.firstDigit=o,this.secondDigit=h}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Yi.FNC1}isSecondDigitFNC1(){return this.secondDigit===Yi.FNC1}isAnyFNC1(){return this.firstDigit===Yi.FNC1||this.secondDigit===Yi.FNC1}}Yi.FNC1=10;class Jt{constructor(){}static parseFieldsInGeneralPurpose(r){if(!r)return null;if(r.length<2)throw new Z;let o=r.substring(0,2);for(let d of Jt.TWO_DIGIT_DATA_LENGTH)if(d[0]===o)return d[1]===Jt.VARIABLE_LENGTH?Jt.processVariableAI(2,d[2],r):Jt.processFixedAI(2,d[1],r);if(r.length<3)throw new Z;let h=r.substring(0,3);for(let d of Jt.THREE_DIGIT_DATA_LENGTH)if(d[0]===h)return d[1]===Jt.VARIABLE_LENGTH?Jt.processVariableAI(3,d[2],r):Jt.processFixedAI(3,d[1],r);for(let d of Jt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(d[0]===h)return d[1]===Jt.VARIABLE_LENGTH?Jt.processVariableAI(4,d[2],r):Jt.processFixedAI(4,d[1],r);if(r.length<4)throw new Z;let f=r.substring(0,4);for(let d of Jt.FOUR_DIGIT_DATA_LENGTH)if(d[0]===f)return d[1]===Jt.VARIABLE_LENGTH?Jt.processVariableAI(4,d[2],r):Jt.processFixedAI(4,d[1],r);throw new Z}static processFixedAI(r,o,h){if(h.length<r)throw new Z;let f=h.substring(0,r);if(h.length<r+o)throw new Z;let d=h.substring(r,r+o),m=h.substring(r+o),x="("+f+")"+d,w=Jt.parseFieldsInGeneralPurpose(m);return w==null?x:x+w}static processVariableAI(r,o,h){let f=h.substring(0,r),d;h.length<r+o?d=h.length:d=r+o;let m=h.substring(r,d),x=h.substring(d),w="("+f+")"+m,A=Jt.parseFieldsInGeneralPurpose(x);return A==null?w:w+A}}Jt.VARIABLE_LENGTH=[],Jt.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Jt.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Jt.VARIABLE_LENGTH,20],["22",Jt.VARIABLE_LENGTH,29],["30",Jt.VARIABLE_LENGTH,8],["37",Jt.VARIABLE_LENGTH,8],["90",Jt.VARIABLE_LENGTH,30],["91",Jt.VARIABLE_LENGTH,30],["92",Jt.VARIABLE_LENGTH,30],["93",Jt.VARIABLE_LENGTH,30],["94",Jt.VARIABLE_LENGTH,30],["95",Jt.VARIABLE_LENGTH,30],["96",Jt.VARIABLE_LENGTH,30],["97",Jt.VARIABLE_LENGTH,3],["98",Jt.VARIABLE_LENGTH,30],["99",Jt.VARIABLE_LENGTH,30]],Jt.THREE_DIGIT_DATA_LENGTH=[["240",Jt.VARIABLE_LENGTH,30],["241",Jt.VARIABLE_LENGTH,30],["242",Jt.VARIABLE_LENGTH,6],["250",Jt.VARIABLE_LENGTH,30],["251",Jt.VARIABLE_LENGTH,30],["253",Jt.VARIABLE_LENGTH,17],["254",Jt.VARIABLE_LENGTH,20],["400",Jt.VARIABLE_LENGTH,30],["401",Jt.VARIABLE_LENGTH,30],["402",17],["403",Jt.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Jt.VARIABLE_LENGTH,20],["421",Jt.VARIABLE_LENGTH,15],["422",3],["423",Jt.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Jt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Jt.VARIABLE_LENGTH,15],["391",Jt.VARIABLE_LENGTH,18],["392",Jt.VARIABLE_LENGTH,15],["393",Jt.VARIABLE_LENGTH,18],["703",Jt.VARIABLE_LENGTH,30]],Jt.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Jt.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Jt.VARIABLE_LENGTH,20],["8003",Jt.VARIABLE_LENGTH,30],["8004",Jt.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Jt.VARIABLE_LENGTH,30],["8008",Jt.VARIABLE_LENGTH,12],["8018",18],["8020",Jt.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Jt.VARIABLE_LENGTH,70],["8200",Jt.VARIABLE_LENGTH,70]];class Ws{constructor(r){this.buffer=new tt,this.information=r}decodeAllCodes(r,o){let h=o,f=null;do{let d=this.decodeGeneralPurposeField(h,f),m=Jt.parseFieldsInGeneralPurpose(d.getNewString());if(m!=null&&r.append(m),d.isRemaining()?f=""+d.getRemainingValue():f=null,h===d.getNewPosition())break;h=d.getNewPosition()}while(!0);return r.toString()}isStillNumeric(r){if(r+7>this.information.getSize())return r+4<=this.information.getSize();for(let o=r;o<r+3;++o)if(this.information.get(o))return!0;return this.information.get(r+3)}decodeNumeric(r){if(r+7>this.information.getSize()){let d=this.extractNumericValueFromBitArray(r,4);return d===0?new Yi(this.information.getSize(),Yi.FNC1,Yi.FNC1):new Yi(this.information.getSize(),d-1,Yi.FNC1)}let o=this.extractNumericValueFromBitArray(r,7),h=(o-8)/11,f=(o-8)%11;return new Yi(r+7,h,f)}extractNumericValueFromBitArray(r,o){return Ws.extractNumericValueFromBitArray(this.information,r,o)}static extractNumericValueFromBitArray(r,o,h){let f=0;for(let d=0;d<h;++d)r.get(o+d)&&(f|=1<<h-d-1);return f}decodeGeneralPurposeField(r,o){this.buffer.setLengthToZero(),o!=null&&this.buffer.append(o),this.current.setPosition(r);let h=this.parseBlocks();return h!=null&&h.isRemaining()?new gi(this.current.getPosition(),this.buffer.toString(),h.getRemainingValue()):new gi(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let r,o;do{let h=this.current.getPosition();if(this.current.isAlpha()?(o=this.parseAlphaBlock(),r=o.isFinished()):this.current.isIsoIec646()?(o=this.parseIsoIec646Block(),r=o.isFinished()):(o=this.parseNumericBlock(),r=o.isFinished()),!(h!==this.current.getPosition())&&!r)break}while(!r);return o.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let r=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFirstDigitFNC1()){let o;return r.isSecondDigitFNC1()?o=new gi(this.current.getPosition(),this.buffer.toString()):o=new gi(this.current.getPosition(),this.buffer.toString(),r.getSecondDigit()),new Pi(!0,o)}if(this.buffer.append(r.getFirstDigit()),r.isSecondDigitFNC1()){let o=new gi(this.current.getPosition(),this.buffer.toString());return new Pi(!0,o)}this.buffer.append(r.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Pi(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let r=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let o=new gi(this.current.getPosition(),this.buffer.toString());return new Pi(!0,o)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Pi(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let r=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(r.getNewPosition()),r.isFNC1()){let o=new gi(this.current.getPosition(),this.buffer.toString());return new Pi(!0,o)}this.buffer.append(r.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Pi(!1)}isStillIsoIec646(r){if(r+5>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(r,5);if(o>=5&&o<16)return!0;if(r+7>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(r,7);if(h>=64&&h<116)return!0;if(r+8>this.information.getSize())return!1;let f=this.extractNumericValueFromBitArray(r,8);return f>=232&&f<253}decodeIsoIec646(r){let o=this.extractNumericValueFromBitArray(r,5);if(o===15)return new je(r+5,je.FNC1);if(o>=5&&o<15)return new je(r+5,"0"+(o-5));let h=this.extractNumericValueFromBitArray(r,7);if(h>=64&&h<90)return new je(r+7,""+(h+1));if(h>=90&&h<116)return new je(r+7,""+(h+7));let f=this.extractNumericValueFromBitArray(r,8),d;switch(f){case 232:d="!";break;case 233:d='"';break;case 234:d="%";break;case 235:d="&";break;case 236:d="'";break;case 237:d="(";break;case 238:d=")";break;case 239:d="*";break;case 240:d="+";break;case 241:d=",";break;case 242:d="-";break;case 243:d=".";break;case 244:d="/";break;case 245:d=":";break;case 246:d=";";break;case 247:d="<";break;case 248:d="=";break;case 249:d=">";break;case 250:d="?";break;case 251:d="_";break;case 252:d=" ";break;default:throw new z}return new je(r+8,d)}isStillAlpha(r){if(r+5>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(r,5);if(o>=5&&o<16)return!0;if(r+6>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(r,6);return h>=16&&h<63}decodeAlphanumeric(r){let o=this.extractNumericValueFromBitArray(r,5);if(o===15)return new je(r+5,je.FNC1);if(o>=5&&o<15)return new je(r+5,"0"+(o-5));let h=this.extractNumericValueFromBitArray(r,6);if(h>=32&&h<58)return new je(r+6,""+(h+33));let f;switch(h){case 58:f="*";break;case 59:f=",";break;case 60:f="-";break;case 61:f=".";break;case 62:f="/";break;default:throw new St("Decoding invalid alphanumeric value: "+h)}return new je(r+6,f)}isAlphaTo646ToAlphaLatch(r){if(r+1>this.information.getSize())return!1;for(let o=0;o<5&&o+r<this.information.getSize();++o)if(o===2){if(!this.information.get(r+2))return!1}else if(this.information.get(r+o))return!1;return!0}isAlphaOr646ToNumericLatch(r){if(r+3>this.information.getSize())return!1;for(let o=r;o<r+3;++o)if(this.information.get(o))return!1;return!0}isNumericToAlphaNumericLatch(r){if(r+1>this.information.getSize())return!1;for(let o=0;o<4&&o+r<this.information.getSize();++o)if(this.information.get(r+o))return!1;return!0}}class Xs{constructor(r){this.information=r,this.generalDecoder=new Ws(r)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Ui extends Xs{constructor(r){super(r)}encodeCompressedGtin(r,o){r.append("(01)");let h=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,o,h)}encodeCompressedGtinWithoutAI(r,o,h){for(let f=0;f<4;++f){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(o+10*f,10);d/100===0&&r.append("0"),d/10===0&&r.append("0"),r.append(d)}Ui.appendCheckDigit(r,h)}static appendCheckDigit(r,o){let h=0;for(let f=0;f<13;f++){let d=r.charAt(f+o).charCodeAt(0)-48;h+=f&1?d:3*d}h=10-h%10,h===10&&(h=0),r.append(h)}}Ui.GTIN_SIZE=40;class js extends Ui{constructor(r){super(r)}parseInformation(){let r=new tt;r.append("(01)");let o=r.length(),h=this.getGeneralDecoder().extractNumericValueFromBitArray(js.HEADER_SIZE,4);return r.append(h),this.encodeCompressedGtinWithoutAI(r,js.HEADER_SIZE+4,o),this.getGeneralDecoder().decodeAllCodes(r,js.HEADER_SIZE+44)}}js.HEADER_SIZE=4;class Ir extends Xs{constructor(r){super(r)}parseInformation(){let r=new tt;return this.getGeneralDecoder().decodeAllCodes(r,Ir.HEADER_SIZE)}}Ir.HEADER_SIZE=5;class Zr extends Ui{constructor(r){super(r)}encodeCompressedWeight(r,o,h){let f=this.getGeneralDecoder().extractNumericValueFromBitArray(o,h);this.addWeightCode(r,f);let d=this.checkWeight(f),m=1e5;for(let x=0;x<5;++x)d/m===0&&r.append("0"),m/=10;r.append(d)}}class On extends Zr{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()!=On.HEADER_SIZE+Zr.GTIN_SIZE+On.WEIGHT_SIZE)throw new Z;let r=new tt;return this.encodeCompressedGtin(r,On.HEADER_SIZE),this.encodeCompressedWeight(r,On.HEADER_SIZE+Zr.GTIN_SIZE,On.WEIGHT_SIZE),r.toString()}}On.HEADER_SIZE=5,On.WEIGHT_SIZE=15;class ml extends On{constructor(r){super(r)}addWeightCode(r,o){r.append("(3103)")}checkWeight(r){return r}}class Pn extends On{constructor(r){super(r)}addWeightCode(r,o){o<1e4?r.append("(3202)"):r.append("(3203)")}checkWeight(r){return r<1e4?r:r-1e4}}class Zi extends Ui{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Zi.HEADER_SIZE+Ui.GTIN_SIZE)throw new Z;let r=new tt;this.encodeCompressedGtin(r,Zi.HEADER_SIZE);let o=this.getGeneralDecoder().extractNumericValueFromBitArray(Zi.HEADER_SIZE+Ui.GTIN_SIZE,Zi.LAST_DIGIT_SIZE);r.append("(392"),r.append(o),r.append(")");let h=this.getGeneralDecoder().decodeGeneralPurposeField(Zi.HEADER_SIZE+Ui.GTIN_SIZE+Zi.LAST_DIGIT_SIZE,null);return r.append(h.getNewString()),r.toString()}}Zi.HEADER_SIZE=8,Zi.LAST_DIGIT_SIZE=2;class Kt extends Ui{constructor(r){super(r)}parseInformation(){if(this.getInformation().getSize()<Kt.HEADER_SIZE+Ui.GTIN_SIZE)throw new Z;let r=new tt;this.encodeCompressedGtin(r,Kt.HEADER_SIZE);let o=this.getGeneralDecoder().extractNumericValueFromBitArray(Kt.HEADER_SIZE+Ui.GTIN_SIZE,Kt.LAST_DIGIT_SIZE);r.append("(393"),r.append(o),r.append(")");let h=this.getGeneralDecoder().extractNumericValueFromBitArray(Kt.HEADER_SIZE+Ui.GTIN_SIZE+Kt.LAST_DIGIT_SIZE,Kt.FIRST_THREE_DIGITS_SIZE);h/100==0&&r.append("0"),h/10==0&&r.append("0"),r.append(h);let f=this.getGeneralDecoder().decodeGeneralPurposeField(Kt.HEADER_SIZE+Ui.GTIN_SIZE+Kt.LAST_DIGIT_SIZE+Kt.FIRST_THREE_DIGITS_SIZE,null);return r.append(f.getNewString()),r.toString()}}Kt.HEADER_SIZE=8,Kt.LAST_DIGIT_SIZE=2,Kt.FIRST_THREE_DIGITS_SIZE=10;class Fe extends Zr{constructor(r,o,h){super(r),this.dateCode=h,this.firstAIdigits=o}parseInformation(){if(this.getInformation().getSize()!=Fe.HEADER_SIZE+Fe.GTIN_SIZE+Fe.WEIGHT_SIZE+Fe.DATE_SIZE)throw new Z;let r=new tt;return this.encodeCompressedGtin(r,Fe.HEADER_SIZE),this.encodeCompressedWeight(r,Fe.HEADER_SIZE+Fe.GTIN_SIZE,Fe.WEIGHT_SIZE),this.encodeCompressedDate(r,Fe.HEADER_SIZE+Fe.GTIN_SIZE+Fe.WEIGHT_SIZE),r.toString()}encodeCompressedDate(r,o){let h=this.getGeneralDecoder().extractNumericValueFromBitArray(o,Fe.DATE_SIZE);if(h==38400)return;r.append("("),r.append(this.dateCode),r.append(")");let f=h%32;h/=32;let d=h%12+1;h/=12;let m=h;m/10==0&&r.append("0"),r.append(m),d/10==0&&r.append("0"),r.append(d),f/10==0&&r.append("0"),r.append(f)}addWeightCode(r,o){r.append("("),r.append(this.firstAIdigits),r.append(o/1e5),r.append(")")}checkWeight(r){return r%1e5}}Fe.HEADER_SIZE=8,Fe.WEIGHT_SIZE=20,Fe.DATE_SIZE=16;function Hs(L){try{if(L.get(1))return new js(L);if(!L.get(2))return new Ir(L);switch(Ws.extractNumericValueFromBitArray(L,1,4)){case 4:return new ml(L);case 5:return new Pn(L)}switch(Ws.extractNumericValueFromBitArray(L,1,5)){case 12:return new Zi(L);case 13:return new Kt(L)}switch(Ws.extractNumericValueFromBitArray(L,1,7)){case 56:return new Fe(L,"310","11");case 57:return new Fe(L,"320","11");case 58:return new Fe(L,"310","13");case 59:return new Fe(L,"320","13");case 60:return new Fe(L,"310","15");case 61:return new Fe(L,"320","15");case 62:return new Fe(L,"310","17");case 63:return new Fe(L,"320","17")}}catch(r){throw console.log(r),new St("unknown decoder: "+L)}}class is{constructor(r,o,h,f){this.leftchar=r,this.rightchar=o,this.finderpattern=h,this.maybeLast=f}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(r,o){return r instanceof is?is.equalsOrNull(r.leftchar,o.leftchar)&&is.equalsOrNull(r.rightchar,o.rightchar)&&is.equalsOrNull(r.finderpattern,o.finderpattern):!1}static equalsOrNull(r,o){return r===null?o===null:is.equals(r,o)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Ys{constructor(r,o,h){this.pairs=r,this.rowNumber=o,this.wasReversed=h}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(r){return this.checkEqualitity(this,r)}toString(){return"{ "+this.pairs+" }"}equals(r,o){return r instanceof Ys?this.checkEqualitity(r,o)&&r.wasReversed===o.wasReversed:!1}checkEqualitity(r,o){if(!r||!o)return;let h;return r.forEach((f,d)=>{o.forEach(m=>{f.getLeftChar().getValue()===m.getLeftChar().getValue()&&f.getRightChar().getValue()===m.getRightChar().getValue()&&f.getFinderPatter().getValue()===m.getFinderPatter().getValue()&&(h=!0)})}),h}}class Nt extends Ue{constructor(r){super(...arguments),this.pairs=new Array(Nt.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=r===!0}decodeRow(r,o,h){this.pairs.length=0,this.startFromEven=!1;try{return Nt.constructResult(this.decodeRow2pairs(r,o))}catch(f){this.verbose&&console.log(f)}return this.pairs.length=0,this.startFromEven=!0,Nt.constructResult(this.decodeRow2pairs(r,o))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(r,o){let h=!1;for(;!h;)try{this.pairs.push(this.retrieveNextPair(o,this.pairs,r))}catch(d){if(d instanceof Z){if(!this.pairs.length)throw new Z;h=!0}}if(this.checkChecksum())return this.pairs;let f;if(this.rows.length?f=!0:f=!1,this.storeRow(r,!1),f){let d=this.checkRowsBoolean(!1);if(d!=null||(d=this.checkRowsBoolean(!0),d!=null))return d}throw new Z}checkRowsBoolean(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());let o=null;try{o=this.checkRows(new Array,0)}catch(h){this.verbose&&console.log(h)}return r&&(this.rows=this.rows.reverse()),o}checkRows(r,o){for(let h=o;h<this.rows.length;h++){let f=this.rows[h];this.pairs.length=0;for(let m of r)this.pairs.push(m.getPairs());if(this.pairs.push(f.getPairs()),!Nt.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let d=new Array(r);d.push(f);try{return this.checkRows(d,h+1)}catch(m){this.verbose&&console.log(m)}}throw new Z}static isValidSequence(r){for(let o of Nt.FINDER_PATTERN_SEQUENCES){if(r.length>o.length)continue;let h=!0;for(let f=0;f<r.length;f++)if(r[f].getFinderPattern().getValue()!=o[f]){h=!1;break}if(h)return!0}return!1}storeRow(r,o){let h=0,f=!1,d=!1;for(;h<this.rows.length;){let m=this.rows[h];if(m.getRowNumber()>r){d=m.isEquivalent(this.pairs);break}f=m.isEquivalent(this.pairs),h++}d||f||Nt.isPartialRow(this.pairs,this.rows)||(this.rows.push(h,new Ys(this.pairs,r,o)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(r,o){for(let h of o)if(h.getPairs().length!==r.length){for(let f of h.getPairs())for(let d of r)if(is.equals(f,d))break}}static isPartialRow(r,o){for(let h of o){let f=!0;for(let d of r){let m=!1;for(let x of h.getPairs())if(d.equals(x)){m=!0;break}if(!m){f=!1;break}}if(f)return!0}return!1}getRows(){return this.rows}static constructResult(r){let o=hi.buildBitArray(r),f=Hs(o).parseInformation(),d=r[0].getFinderPattern().getResultPoints(),m=r[r.length-1].getFinderPattern().getResultPoints(),x=[d[0],d[1],m[0],m[1]];return new mt(f,null,null,x,Vt.RSS_EXPANDED,null)}checkChecksum(){let r=this.pairs.get(0),o=r.getLeftChar(),h=r.getRightChar();if(h==null)return!1;let f=h.getChecksumPortion(),d=2;for(let x=1;x<this.pairs.size();++x){let w=this.pairs.get(x);f+=w.getLeftChar().getChecksumPortion(),d++;let A=w.getRightChar();A!=null&&(f+=A.getChecksumPortion(),d++)}return f%=211,211*(d-4)+f==o.getValue()}static getNextSecondBar(r,o){let h;return r.get(o)?(h=r.getNextUnset(o),h=r.getNextSet(h)):(h=r.getNextSet(o),h=r.getNextUnset(h)),h}retrieveNextPair(r,o,h){let f=o.length%2==0;this.startFromEven&&(f=!f);let d,m=!0,x=-1;do this.findNextPair(r,o,x),d=this.parseFoundFinderPattern(r,h,f),d==null?x=Nt.getNextSecondBar(r,this.startEnd[0]):m=!1;while(m);let w=this.decodeDataCharacter(r,d,f,!0);if(!this.isEmptyPair(o)&&o[o.length-1].mustBeLast())throw new Z;let A;try{A=this.decodeDataCharacter(r,d,f,!1)}catch(O){A=null,this.verbose&&console.log(O)}return new is(w,A,d,!0)}isEmptyPair(r){return r.length===0}findNextPair(r,o,h){let f=this.getDecodeFinderCounters();f[0]=0,f[1]=0,f[2]=0,f[3]=0;let d=r.getSize(),m;h>=0?m=h:this.isEmptyPair(o)?m=0:m=o[o.length-1].getFinderPattern().getStartEnd()[1];let x=o.length%2!=0;this.startFromEven&&(x=!x);let w=!1;for(;m<d&&(w=!r.get(m),!!w);)m++;let A=0,O=m;for(let B=m;B<d;B++)if(r.get(B)!=w)f[A]++;else{if(A==3){if(x&&Nt.reverseCounters(f),Nt.isFinderPattern(f)){this.startEnd[0]=O,this.startEnd[1]=B;return}x&&Nt.reverseCounters(f),O+=f[0]+f[1],f[0]=f[2],f[1]=f[3],f[2]=0,f[3]=0,A--}else A++;f[A]=1,w=!w}throw new Z}static reverseCounters(r){let o=r.length;for(let h=0;h<o/2;++h){let f=r[h];r[h]=r[o-h-1],r[o-h-1]=f}}parseFoundFinderPattern(r,o,h){let f,d,m;if(h){let A=this.startEnd[0]-1;for(;A>=0&&!r.get(A);)A--;A++,f=this.startEnd[0]-A,d=A,m=this.startEnd[1]}else d=this.startEnd[0],m=r.getNextUnset(this.startEnd[1]+1),f=m-this.startEnd[1];let x=this.getDecodeFinderCounters();R.arraycopy(x,0,x,1,x.length-1),x[0]=f;let w;try{w=this.parseFinderValue(x,Nt.FINDER_PATTERNS)}catch{return null}return new Ci(w,[d,m],d,m,o)}decodeDataCharacter(r,o,h,f){let d=this.getDataCharacterCounters();for(let ai=0;ai<d.length;ai++)d[ai]=0;if(f)Nt.recordPatternInReverse(r,o.getStartEnd()[0],d);else{Nt.recordPattern(r,o.getStartEnd()[1],d);for(let ai=0,Xi=d.length-1;ai<Xi;ai++,Xi--){let An=d[ai];d[ai]=d[Xi],d[Xi]=An}}let m=17,x=lt.sum(new Int32Array(d))/m,w=(o.getStartEnd()[1]-o.getStartEnd()[0])/15;if(Math.abs(x-w)/w>.3)throw new Z;let A=this.getOddCounts(),O=this.getEvenCounts(),B=this.getOddRoundingErrors(),Y=this.getEvenRoundingErrors();for(let ai=0;ai<d.length;ai++){let Xi=1*d[ai]/x,An=Xi+.5;if(An<1){if(Xi<.3)throw new Z;An=1}else if(An>8){if(Xi>8.7)throw new Z;An=8}let Qr=ai/2;ai&1?(O[Qr]=An,Y[Qr]=Xi-An):(A[Qr]=An,B[Qr]=Xi-An)}this.adjustOddEvenCounts(m);let Q=4*o.getValue()+(h?0:2)+(f?0:1)-1,ht=0,ut=0;for(let ai=A.length-1;ai>=0;ai--){if(Nt.isNotA1left(o,h,f)){let Xi=Nt.WEIGHTS[Q][2*ai];ut+=A[ai]*Xi}ht+=A[ai]}let yt=0;for(let ai=O.length-1;ai>=0;ai--)if(Nt.isNotA1left(o,h,f)){let Xi=Nt.WEIGHTS[Q][2*ai+1];yt+=O[ai]*Xi}let Ct=ut+yt;if(ht&1||ht>13||ht<4)throw new Z;let zt=(13-ht)/2,Wt=Nt.SYMBOL_WIDEST[zt],Bt=9-Wt,Be=we.getRSSvalue(A,Wt,!0),De=we.getRSSvalue(O,Bt,!1),dn=Nt.EVEN_TOTAL_SUBSET[zt],Yn=Nt.GSUM[zt],gn=Be*dn+De+Yn;return new ge(gn,Ct)}static isNotA1left(r,o,h){return!(r.getValue()==0&&o&&h)}adjustOddEvenCounts(r){let o=lt.sum(new Int32Array(this.getOddCounts())),h=lt.sum(new Int32Array(this.getEvenCounts())),f=!1,d=!1;o>13?d=!0:o<4&&(f=!0);let m=!1,x=!1;h>13?x=!0:h<4&&(m=!0);let w=o+h-r,A=(o&1)==1,O=(h&1)==0;if(w==1)if(A){if(O)throw new Z;d=!0}else{if(!O)throw new Z;x=!0}else if(w==-1)if(A){if(O)throw new Z;f=!0}else{if(!O)throw new Z;m=!0}else if(w==0){if(A){if(!O)throw new Z;o<h?(f=!0,x=!0):(d=!0,m=!0)}else if(O)throw new Z}else throw new Z;if(f){if(d)throw new Z;Nt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&Nt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),m){if(x)throw new Z;Nt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}x&&Nt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Nt.SYMBOL_WIDEST=[7,5,4,3,1],Nt.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Nt.GSUM=[0,348,1388,2948,3988],Nt.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Nt.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Nt.FINDER_PAT_A=0,Nt.FINDER_PAT_B=1,Nt.FINDER_PAT_C=2,Nt.FINDER_PAT_D=3,Nt.FINDER_PAT_E=4,Nt.FINDER_PAT_F=5,Nt.FINDER_PATTERN_SEQUENCES=[[Nt.FINDER_PAT_A,Nt.FINDER_PAT_A],[Nt.FINDER_PAT_A,Nt.FINDER_PAT_B,Nt.FINDER_PAT_B],[Nt.FINDER_PAT_A,Nt.FINDER_PAT_C,Nt.FINDER_PAT_B,Nt.FINDER_PAT_D],[Nt.FINDER_PAT_A,Nt.FINDER_PAT_E,Nt.FINDER_PAT_B,Nt.FINDER_PAT_D,Nt.FINDER_PAT_C],[Nt.FINDER_PAT_A,Nt.FINDER_PAT_E,Nt.FINDER_PAT_B,Nt.FINDER_PAT_D,Nt.FINDER_PAT_D,Nt.FINDER_PAT_F],[Nt.FINDER_PAT_A,Nt.FINDER_PAT_E,Nt.FINDER_PAT_B,Nt.FINDER_PAT_D,Nt.FINDER_PAT_E,Nt.FINDER_PAT_F,Nt.FINDER_PAT_F],[Nt.FINDER_PAT_A,Nt.FINDER_PAT_A,Nt.FINDER_PAT_B,Nt.FINDER_PAT_B,Nt.FINDER_PAT_C,Nt.FINDER_PAT_C,Nt.FINDER_PAT_D,Nt.FINDER_PAT_D],[Nt.FINDER_PAT_A,Nt.FINDER_PAT_A,Nt.FINDER_PAT_B,Nt.FINDER_PAT_B,Nt.FINDER_PAT_C,Nt.FINDER_PAT_C,Nt.FINDER_PAT_D,Nt.FINDER_PAT_E,Nt.FINDER_PAT_E],[Nt.FINDER_PAT_A,Nt.FINDER_PAT_A,Nt.FINDER_PAT_B,Nt.FINDER_PAT_B,Nt.FINDER_PAT_C,Nt.FINDER_PAT_C,Nt.FINDER_PAT_D,Nt.FINDER_PAT_E,Nt.FINDER_PAT_F,Nt.FINDER_PAT_F],[Nt.FINDER_PAT_A,Nt.FINDER_PAT_A,Nt.FINDER_PAT_B,Nt.FINDER_PAT_B,Nt.FINDER_PAT_C,Nt.FINDER_PAT_D,Nt.FINDER_PAT_D,Nt.FINDER_PAT_E,Nt.FINDER_PAT_E,Nt.FINDER_PAT_F,Nt.FINDER_PAT_F]],Nt.MAX_PAIRS=11;class au extends ge{constructor(r,o,h){super(r,o),this.count=0,this.finderPattern=h}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Qt extends Ue{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(r,o,h){const f=this.decodePair(o,!1,r,h);Qt.addOrTally(this.possibleLeftPairs,f),o.reverse();let d=this.decodePair(o,!0,r,h);Qt.addOrTally(this.possibleRightPairs,d),o.reverse();for(let m of this.possibleLeftPairs)if(m.getCount()>1){for(let x of this.possibleRightPairs)if(x.getCount()>1&&Qt.checkChecksum(m,x))return Qt.constructResult(m,x)}throw new Z}static addOrTally(r,o){if(o==null)return;let h=!1;for(let f of r)if(f.getValue()===o.getValue()){f.incrementCount(),h=!0;break}h||r.push(o)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(r,o){let h=4537077*r.getValue()+o.getValue(),f=new String(h).toString(),d=new tt;for(let A=13-f.length;A>0;A--)d.append("0");d.append(f);let m=0;for(let A=0;A<13;A++){let O=d.charAt(A).charCodeAt(0)-48;m+=A&1?O:3*O}m=10-m%10,m===10&&(m=0),d.append(m.toString());let x=r.getFinderPattern().getResultPoints(),w=o.getFinderPattern().getResultPoints();return new mt(d.toString(),null,0,[x[0],x[1],w[0],w[1]],Vt.RSS_14,new Date().getTime())}static checkChecksum(r,o){let h=(r.getChecksumPortion()+16*o.getChecksumPortion())%79,f=9*r.getFinderPattern().getValue()+o.getFinderPattern().getValue();return f>72&&f--,f>8&&f--,h===f}decodePair(r,o,h,f){try{let d=this.findFinderPattern(r,o),m=this.parseFoundFinderPattern(r,h,o,d),x=f==null?null:f.get(K.NEED_RESULT_POINT_CALLBACK);if(x!=null){let O=(d[0]+d[1])/2;o&&(O=r.getSize()-1-O),x.foundPossibleResultPoint(new gt(O,h))}let w=this.decodeDataCharacter(r,m,!0),A=this.decodeDataCharacter(r,m,!1);return new au(1597*w.getValue()+A.getValue(),w.getChecksumPortion()+4*A.getChecksumPortion(),m)}catch{return null}}decodeDataCharacter(r,o,h){let f=this.getDataCharacterCounters();for(let yt=0;yt<f.length;yt++)f[yt]=0;if(h)le.recordPatternInReverse(r,o.getStartEnd()[0],f);else{le.recordPattern(r,o.getStartEnd()[1]+1,f);for(let yt=0,Ct=f.length-1;yt<Ct;yt++,Ct--){let zt=f[yt];f[yt]=f[Ct],f[Ct]=zt}}let d=h?16:15,m=lt.sum(new Int32Array(f))/d,x=this.getOddCounts(),w=this.getEvenCounts(),A=this.getOddRoundingErrors(),O=this.getEvenRoundingErrors();for(let yt=0;yt<f.length;yt++){let Ct=f[yt]/m,zt=Math.floor(Ct+.5);zt<1?zt=1:zt>8&&(zt=8);let Wt=Math.floor(yt/2);yt&1?(w[Wt]=zt,O[Wt]=Ct-zt):(x[Wt]=zt,A[Wt]=Ct-zt)}this.adjustOddEvenCounts(h,d);let B=0,Y=0;for(let yt=x.length-1;yt>=0;yt--)Y*=9,Y+=x[yt],B+=x[yt];let Q=0,ht=0;for(let yt=w.length-1;yt>=0;yt--)Q*=9,Q+=w[yt],ht+=w[yt];let ut=Y+3*Q;if(h){if(B&1||B>12||B<4)throw new Z;let yt=(12-B)/2,Ct=Qt.OUTSIDE_ODD_WIDEST[yt],zt=9-Ct,Wt=we.getRSSvalue(x,Ct,!1),Bt=we.getRSSvalue(w,zt,!0),Be=Qt.OUTSIDE_EVEN_TOTAL_SUBSET[yt],De=Qt.OUTSIDE_GSUM[yt];return new ge(Wt*Be+Bt+De,ut)}else{if(ht&1||ht>10||ht<4)throw new Z;let yt=(10-ht)/2,Ct=Qt.INSIDE_ODD_WIDEST[yt],zt=9-Ct,Wt=we.getRSSvalue(x,Ct,!0),Bt=we.getRSSvalue(w,zt,!1),Be=Qt.INSIDE_ODD_TOTAL_SUBSET[yt],De=Qt.INSIDE_GSUM[yt];return new ge(Bt*Be+Wt+De,ut)}}findFinderPattern(r,o){let h=this.getDecodeFinderCounters();h[0]=0,h[1]=0,h[2]=0,h[3]=0;let f=r.getSize(),d=!1,m=0;for(;m<f&&(d=!r.get(m),o!==d);)m++;let x=0,w=m;for(let A=m;A<f;A++)if(r.get(A)!==d)h[x]++;else{if(x===3){if(Ue.isFinderPattern(h))return[w,A];w+=h[0]+h[1],h[0]=h[2],h[1]=h[3],h[2]=0,h[3]=0,x--}else x++;h[x]=1,d=!d}throw new Z}parseFoundFinderPattern(r,o,h,f){let d=r.get(f[0]),m=f[0]-1;for(;m>=0&&d!==r.get(m);)m--;m++;const x=f[0]-m,w=this.getDecodeFinderCounters(),A=new Int32Array(w.length);R.arraycopy(w,0,A,1,w.length-1),A[0]=x;const O=this.parseFinderValue(A,Qt.FINDER_PATTERNS);let B=m,Y=f[1];return h&&(B=r.getSize()-1-B,Y=r.getSize()-1-Y),new Ci(O,[m,f[1]],B,Y,o)}adjustOddEvenCounts(r,o){let h=lt.sum(new Int32Array(this.getOddCounts())),f=lt.sum(new Int32Array(this.getEvenCounts())),d=!1,m=!1,x=!1,w=!1;r?(h>12?m=!0:h<4&&(d=!0),f>12?w=!0:f<4&&(x=!0)):(h>11?m=!0:h<5&&(d=!0),f>10?w=!0:f<4&&(x=!0));let A=h+f-o,O=(h&1)===(r?1:0),B=(f&1)===1;if(A===1)if(O){if(B)throw new Z;m=!0}else{if(!B)throw new Z;w=!0}else if(A===-1)if(O){if(B)throw new Z;d=!0}else{if(!B)throw new Z;x=!0}else if(A===0){if(O){if(!B)throw new Z;h<f?(d=!0,w=!0):(m=!0,x=!0)}else if(B)throw new Z}else throw new Z;if(d){if(m)throw new Z;Ue.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(m&&Ue.decrement(this.getOddCounts(),this.getOddRoundingErrors()),x){if(w)throw new Z;Ue.increment(this.getEvenCounts(),this.getOddRoundingErrors())}w&&Ue.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Qt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Qt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Qt.OUTSIDE_GSUM=[0,161,961,2015,2715],Qt.INSIDE_GSUM=[0,336,1036,1516],Qt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Qt.INSIDE_ODD_WIDEST=[2,4,6,8],Qt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Zs extends le{constructor(r,o){super(),this.readers=[],this.verbose=o===!0;const h=r?r.get(K.POSSIBLE_FORMATS):null,f=r&&r.get(K.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;h?((h.includes(Vt.EAN_13)||h.includes(Vt.UPC_A)||h.includes(Vt.EAN_8)||h.includes(Vt.UPC_E))&&this.readers.push(new Xe(r)),h.includes(Vt.CODE_39)&&this.readers.push(new He(f)),h.includes(Vt.CODE_128)&&this.readers.push(new jt),h.includes(Vt.ITF)&&this.readers.push(new ye),h.includes(Vt.RSS_14)&&this.readers.push(new Qt),h.includes(Vt.RSS_EXPANDED)&&this.readers.push(new Nt(this.verbose))):(this.readers.push(new Xe(r)),this.readers.push(new He),this.readers.push(new Xe(r)),this.readers.push(new jt),this.readers.push(new ye),this.readers.push(new Qt),this.readers.push(new Nt(this.verbose)))}decodeRow(r,o,h){for(let f=0;f<this.readers.length;f++)try{return this.readers[f].decodeRow(r,o,h)}catch{}throw new Z}reset(){this.readers.forEach(r=>r.reset())}}class Ai extends Pt{constructor(r=500,o){super(new Zs(o),r,o)}}class Ye{constructor(r,o,h){this.ecCodewords=r,this.ecBlocks=[o],h&&this.ecBlocks.push(h)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Ze{constructor(r,o){this.count=r,this.dataCodewords=o}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ne{constructor(r,o,h,f,d,m){this.versionNumber=r,this.symbolSizeRows=o,this.symbolSizeColumns=h,this.dataRegionSizeRows=f,this.dataRegionSizeColumns=d,this.ecBlocks=m;let x=0;const w=m.getECCodewords(),A=m.getECBlocks();for(let O of A)x+=O.getCount()*(O.getDataCodewords()+w);this.totalCodewords=x}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(r,o){if(r&1||o&1)throw new z;for(let h of Ne.VERSIONS)if(h.symbolSizeRows===r&&h.symbolSizeColumns===o)return h;throw new z}toString(){return""+this.versionNumber}static buildVersions(){return[new Ne(1,10,10,8,8,new Ye(5,new Ze(1,3))),new Ne(2,12,12,10,10,new Ye(7,new Ze(1,5))),new Ne(3,14,14,12,12,new Ye(10,new Ze(1,8))),new Ne(4,16,16,14,14,new Ye(12,new Ze(1,12))),new Ne(5,18,18,16,16,new Ye(14,new Ze(1,18))),new Ne(6,20,20,18,18,new Ye(18,new Ze(1,22))),new Ne(7,22,22,20,20,new Ye(20,new Ze(1,30))),new Ne(8,24,24,22,22,new Ye(24,new Ze(1,36))),new Ne(9,26,26,24,24,new Ye(28,new Ze(1,44))),new Ne(10,32,32,14,14,new Ye(36,new Ze(1,62))),new Ne(11,36,36,16,16,new Ye(42,new Ze(1,86))),new Ne(12,40,40,18,18,new Ye(48,new Ze(1,114))),new Ne(13,44,44,20,20,new Ye(56,new Ze(1,144))),new Ne(14,48,48,22,22,new Ye(68,new Ze(1,174))),new Ne(15,52,52,24,24,new Ye(42,new Ze(2,102))),new Ne(16,64,64,14,14,new Ye(56,new Ze(2,140))),new Ne(17,72,72,16,16,new Ye(36,new Ze(4,92))),new Ne(18,80,80,18,18,new Ye(48,new Ze(4,114))),new Ne(19,88,88,20,20,new Ye(56,new Ze(4,144))),new Ne(20,96,96,22,22,new Ye(68,new Ze(4,174))),new Ne(21,104,104,24,24,new Ye(56,new Ze(6,136))),new Ne(22,120,120,18,18,new Ye(68,new Ze(6,175))),new Ne(23,132,132,20,20,new Ye(62,new Ze(8,163))),new Ne(24,144,144,22,22,new Ye(62,new Ze(8,156),new Ze(2,155))),new Ne(25,8,18,6,16,new Ye(7,new Ze(1,5))),new Ne(26,8,32,6,14,new Ye(11,new Ze(1,10))),new Ne(27,12,26,10,24,new Ye(14,new Ze(1,16))),new Ne(28,12,36,10,16,new Ye(18,new Ze(1,22))),new Ne(29,16,36,14,16,new Ye(24,new Ze(1,32))),new Ne(30,16,48,14,22,new Ye(28,new Ze(1,49)))]}}Ne.VERSIONS=Ne.buildVersions();class Kr{constructor(r){const o=r.getHeight();if(o<8||o>144||o&1)throw new z;this.version=Kr.readVersion(r),this.mappingBitMatrix=this.extractDataRegion(r),this.readMappingMatrix=new N(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(r){const o=r.getHeight(),h=r.getWidth();return Ne.getVersionForDimensions(o,h)}readCodewords(){const r=new Int8Array(this.version.getTotalCodewords());let o=0,h=4,f=0;const d=this.mappingBitMatrix.getHeight(),m=this.mappingBitMatrix.getWidth();let x=!1,w=!1,A=!1,O=!1;do if(h===d&&f===0&&!x)r[o++]=this.readCorner1(d,m)&255,h-=2,f+=2,x=!0;else if(h===d-2&&f===0&&m&3&&!w)r[o++]=this.readCorner2(d,m)&255,h-=2,f+=2,w=!0;else if(h===d+4&&f===2&&!(m&7)&&!A)r[o++]=this.readCorner3(d,m)&255,h-=2,f+=2,A=!0;else if(h===d-2&&f===0&&(m&7)===4&&!O)r[o++]=this.readCorner4(d,m)&255,h-=2,f+=2,O=!0;else{do h<d&&f>=0&&!this.readMappingMatrix.get(f,h)&&(r[o++]=this.readUtah(h,f,d,m)&255),h-=2,f+=2;while(h>=0&&f<m);h+=1,f+=3;do h>=0&&f<m&&!this.readMappingMatrix.get(f,h)&&(r[o++]=this.readUtah(h,f,d,m)&255),h+=2,f-=2;while(h<d&&f>=0);h+=3,f+=1}while(h<d||f<m);if(o!==this.version.getTotalCodewords())throw new z;return r}readModule(r,o,h,f){return r<0&&(r+=h,o+=4-(h+4&7)),o<0&&(o+=f,r+=4-(f+4&7)),this.readMappingMatrix.set(o,r),this.mappingBitMatrix.get(o,r)}readUtah(r,o,h,f){let d=0;return this.readModule(r-2,o-2,h,f)&&(d|=1),d<<=1,this.readModule(r-2,o-1,h,f)&&(d|=1),d<<=1,this.readModule(r-1,o-2,h,f)&&(d|=1),d<<=1,this.readModule(r-1,o-1,h,f)&&(d|=1),d<<=1,this.readModule(r-1,o,h,f)&&(d|=1),d<<=1,this.readModule(r,o-2,h,f)&&(d|=1),d<<=1,this.readModule(r,o-1,h,f)&&(d|=1),d<<=1,this.readModule(r,o,h,f)&&(d|=1),d}readCorner1(r,o){let h=0;return this.readModule(r-1,0,r,o)&&(h|=1),h<<=1,this.readModule(r-1,1,r,o)&&(h|=1),h<<=1,this.readModule(r-1,2,r,o)&&(h|=1),h<<=1,this.readModule(0,o-2,r,o)&&(h|=1),h<<=1,this.readModule(0,o-1,r,o)&&(h|=1),h<<=1,this.readModule(1,o-1,r,o)&&(h|=1),h<<=1,this.readModule(2,o-1,r,o)&&(h|=1),h<<=1,this.readModule(3,o-1,r,o)&&(h|=1),h}readCorner2(r,o){let h=0;return this.readModule(r-3,0,r,o)&&(h|=1),h<<=1,this.readModule(r-2,0,r,o)&&(h|=1),h<<=1,this.readModule(r-1,0,r,o)&&(h|=1),h<<=1,this.readModule(0,o-4,r,o)&&(h|=1),h<<=1,this.readModule(0,o-3,r,o)&&(h|=1),h<<=1,this.readModule(0,o-2,r,o)&&(h|=1),h<<=1,this.readModule(0,o-1,r,o)&&(h|=1),h<<=1,this.readModule(1,o-1,r,o)&&(h|=1),h}readCorner3(r,o){let h=0;return this.readModule(r-1,0,r,o)&&(h|=1),h<<=1,this.readModule(r-1,o-1,r,o)&&(h|=1),h<<=1,this.readModule(0,o-3,r,o)&&(h|=1),h<<=1,this.readModule(0,o-2,r,o)&&(h|=1),h<<=1,this.readModule(0,o-1,r,o)&&(h|=1),h<<=1,this.readModule(1,o-3,r,o)&&(h|=1),h<<=1,this.readModule(1,o-2,r,o)&&(h|=1),h<<=1,this.readModule(1,o-1,r,o)&&(h|=1),h}readCorner4(r,o){let h=0;return this.readModule(r-3,0,r,o)&&(h|=1),h<<=1,this.readModule(r-2,0,r,o)&&(h|=1),h<<=1,this.readModule(r-1,0,r,o)&&(h|=1),h<<=1,this.readModule(0,o-2,r,o)&&(h|=1),h<<=1,this.readModule(0,o-1,r,o)&&(h|=1),h<<=1,this.readModule(1,o-1,r,o)&&(h|=1),h<<=1,this.readModule(2,o-1,r,o)&&(h|=1),h<<=1,this.readModule(3,o-1,r,o)&&(h|=1),h}extractDataRegion(r){const o=this.version.getSymbolSizeRows(),h=this.version.getSymbolSizeColumns();if(r.getHeight()!==o)throw new _("Dimension of bitMatrix must match the version size");const f=this.version.getDataRegionSizeRows(),d=this.version.getDataRegionSizeColumns(),m=o/f|0,x=h/d|0,w=m*f,A=x*d,O=new N(A,w);for(let B=0;B<m;++B){const Y=B*f;for(let Q=0;Q<x;++Q){const ht=Q*d;for(let ut=0;ut<f;++ut){const yt=B*(f+2)+1+ut,Ct=Y+ut;for(let zt=0;zt<d;++zt){const Wt=Q*(d+2)+1+zt;if(r.get(Wt,yt)){const Bt=ht+zt;O.set(Bt,Ct)}}}}}return O}}class za{constructor(r,o){this.numDataCodewords=r,this.codewords=o}static getDataBlocks(r,o){const h=o.getECBlocks();let f=0;const d=h.getECBlocks();for(let ut of d)f+=ut.getCount();const m=new Array(f);let x=0;for(let ut of d)for(let yt=0;yt<ut.getCount();yt++){const Ct=ut.getDataCodewords(),zt=h.getECCodewords()+Ct;m[x++]=new za(Ct,new Uint8Array(zt))}const A=m[0].codewords.length-h.getECCodewords(),O=A-1;let B=0;for(let ut=0;ut<O;ut++)for(let yt=0;yt<x;yt++)m[yt].codewords[ut]=r[B++];const Y=o.getVersionNumber()===24,Q=Y?8:x;for(let ut=0;ut<Q;ut++)m[ut].codewords[A-1]=r[B++];const ht=m[0].codewords.length;for(let ut=A;ut<ht;ut++)for(let yt=0;yt<x;yt++){const Ct=Y?(yt+8)%x:yt,zt=Y&&Ct>7?ut-1:ut;m[Ct].codewords[zt]=r[B++]}if(B!==r.length)throw new _;return m}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class qr{constructor(r){this.bytes=r,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(r){if(r<1||r>32||r>this.available())throw new _(""+r);let o=0,h=this.bitOffset,f=this.byteOffset;const d=this.bytes;if(h>0){const m=8-h,x=r<m?r:m,w=m-x,A=255>>8-x<<w;o=(d[f]&A)>>w,r-=x,h+=x,h===8&&(h=0,f++)}if(r>0){for(;r>=8;)o=o<<8|d[f]&255,f++,r-=8;if(r>0){const m=8-r,x=255>>m<<m;o=o<<r|(d[f]&x)>>m,h+=r}}return this.bitOffset=h,this.byteOffset=f,o}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var xi;(function(L){L[L.PAD_ENCODE=0]="PAD_ENCODE",L[L.ASCII_ENCODE=1]="ASCII_ENCODE",L[L.C40_ENCODE=2]="C40_ENCODE",L[L.TEXT_ENCODE=3]="TEXT_ENCODE",L[L.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",L[L.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",L[L.BASE256_ENCODE=6]="BASE256_ENCODE"})(xi||(xi={}));class Un{static decode(r){const o=new qr(r),h=new tt,f=new tt,d=new Array;let m=xi.ASCII_ENCODE;do if(m===xi.ASCII_ENCODE)m=this.decodeAsciiSegment(o,h,f);else{switch(m){case xi.C40_ENCODE:this.decodeC40Segment(o,h);break;case xi.TEXT_ENCODE:this.decodeTextSegment(o,h);break;case xi.ANSIX12_ENCODE:this.decodeAnsiX12Segment(o,h);break;case xi.EDIFACT_ENCODE:this.decodeEdifactSegment(o,h);break;case xi.BASE256_ENCODE:this.decodeBase256Segment(o,h,d);break;default:throw new z}m=xi.ASCII_ENCODE}while(m!==xi.PAD_ENCODE&&o.available()>0);return f.length()>0&&h.append(f.toString()),new me(r,h.toString(),d.length===0?null:d,null)}static decodeAsciiSegment(r,o,h){let f=!1;do{let d=r.readBits(8);if(d===0)throw new z;if(d<=128)return f&&(d+=128),o.append(String.fromCharCode(d-1)),xi.ASCII_ENCODE;if(d===129)return xi.PAD_ENCODE;if(d<=229){const m=d-130;m<10&&o.append("0"),o.append(""+m)}else switch(d){case 230:return xi.C40_ENCODE;case 231:return xi.BASE256_ENCODE;case 232:o.append("");break;case 233:case 234:break;case 235:f=!0;break;case 236:o.append("[)>05"),h.insert(0,"");break;case 237:o.append("[)>06"),h.insert(0,"");break;case 238:return xi.ANSIX12_ENCODE;case 239:return xi.TEXT_ENCODE;case 240:return xi.EDIFACT_ENCODE;case 241:break;default:if(d!==254||r.available()!==0)throw new z;break}}while(r.available()>0);return xi.ASCII_ENCODE}static decodeC40Segment(r,o){let h=!1;const f=[];let d=0;do{if(r.available()===8)return;const m=r.readBits(8);if(m===254)return;this.parseTwoBytes(m,r.readBits(8),f);for(let x=0;x<3;x++){const w=f[x];switch(d){case 0:if(w<3)d=w+1;else if(w<this.C40_BASIC_SET_CHARS.length){const A=this.C40_BASIC_SET_CHARS[w];h?(o.append(String.fromCharCode(A.charCodeAt(0)+128)),h=!1):o.append(A)}else throw new z;break;case 1:h?(o.append(String.fromCharCode(w+128)),h=!1):o.append(String.fromCharCode(w)),d=0;break;case 2:if(w<this.C40_SHIFT2_SET_CHARS.length){const A=this.C40_SHIFT2_SET_CHARS[w];h?(o.append(String.fromCharCode(A.charCodeAt(0)+128)),h=!1):o.append(A)}else switch(w){case 27:o.append("");break;case 30:h=!0;break;default:throw new z}d=0;break;case 3:h?(o.append(String.fromCharCode(w+224)),h=!1):o.append(String.fromCharCode(w+96)),d=0;break;default:throw new z}}}while(r.available()>0)}static decodeTextSegment(r,o){let h=!1,f=[],d=0;do{if(r.available()===8)return;const m=r.readBits(8);if(m===254)return;this.parseTwoBytes(m,r.readBits(8),f);for(let x=0;x<3;x++){const w=f[x];switch(d){case 0:if(w<3)d=w+1;else if(w<this.TEXT_BASIC_SET_CHARS.length){const A=this.TEXT_BASIC_SET_CHARS[w];h?(o.append(String.fromCharCode(A.charCodeAt(0)+128)),h=!1):o.append(A)}else throw new z;break;case 1:h?(o.append(String.fromCharCode(w+128)),h=!1):o.append(String.fromCharCode(w)),d=0;break;case 2:if(w<this.TEXT_SHIFT2_SET_CHARS.length){const A=this.TEXT_SHIFT2_SET_CHARS[w];h?(o.append(String.fromCharCode(A.charCodeAt(0)+128)),h=!1):o.append(A)}else switch(w){case 27:o.append("");break;case 30:h=!0;break;default:throw new z}d=0;break;case 3:if(w<this.TEXT_SHIFT3_SET_CHARS.length){const A=this.TEXT_SHIFT3_SET_CHARS[w];h?(o.append(String.fromCharCode(A.charCodeAt(0)+128)),h=!1):o.append(A),d=0}else throw new z;break;default:throw new z}}}while(r.available()>0)}static decodeAnsiX12Segment(r,o){const h=[];do{if(r.available()===8)return;const f=r.readBits(8);if(f===254)return;this.parseTwoBytes(f,r.readBits(8),h);for(let d=0;d<3;d++){const m=h[d];switch(m){case 0:o.append("\r");break;case 1:o.append("*");break;case 2:o.append(">");break;case 3:o.append(" ");break;default:if(m<14)o.append(String.fromCharCode(m+44));else if(m<40)o.append(String.fromCharCode(m+51));else throw new z;break}}}while(r.available()>0)}static parseTwoBytes(r,o,h){let f=(r<<8)+o-1,d=Math.floor(f/1600);h[0]=d,f-=d*1600,d=Math.floor(f/40),h[1]=d,h[2]=f-d*40}static decodeEdifactSegment(r,o){do{if(r.available()<=16)return;for(let h=0;h<4;h++){let f=r.readBits(6);if(f===31){const d=8-r.getBitOffset();d!==8&&r.readBits(d);return}f&32||(f|=64),o.append(String.fromCharCode(f))}}while(r.available()>0)}static decodeBase256Segment(r,o,h){let f=1+r.getByteOffset();const d=this.unrandomize255State(r.readBits(8),f++);let m;if(d===0?m=r.available()/8|0:d<250?m=d:m=250*(d-249)+this.unrandomize255State(r.readBits(8),f++),m<0)throw new z;const x=new Uint8Array(m);for(let w=0;w<m;w++){if(r.available()<8)throw new z;x[w]=this.unrandomize255State(r.readBits(8),f++)}h.push(x);try{o.append(ot.decode(x,j.ISO88591))}catch(w){throw new St("Platform does not support required encoding: "+w.message)}}static unrandomize255State(r,o){const h=149*o%255+1,f=r-h;return f>=0?f:f+256}}Un.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Un.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Un.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Un.TEXT_SHIFT2_SET_CHARS=Un.C40_SHIFT2_SET_CHARS,Un.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class pl{constructor(){this.rsDecoder=new Et(de.DATA_MATRIX_FIELD_256)}decode(r){const o=new Kr(r),h=o.getVersion(),f=o.readCodewords(),d=za.getDataBlocks(f,h);let m=0;for(let A of d)m+=A.getNumDataCodewords();const x=new Uint8Array(m),w=d.length;for(let A=0;A<w;A++){const O=d[A],B=O.getCodewords(),Y=O.getNumDataCodewords();this.correctErrors(B,Y);for(let Q=0;Q<Y;Q++)x[Q*w+A]=B[Q]}return Un.decode(x)}correctErrors(r,o){const h=new Int32Array(r);try{this.rsDecoder.decode(h,r.length-o)}catch{throw new I}for(let f=0;f<o;f++)r[f]=h[f]}}class si{constructor(r){this.image=r,this.rectangleDetector=new Ht(this.image)}detect(){const r=this.rectangleDetector.detect();let o=this.detectSolid1(r);if(o=this.detectSolid2(o),o[3]=this.correctTopRight(o),!o[3])throw new Z;o=this.shiftToModuleCenter(o);const h=o[0],f=o[1],d=o[2],m=o[3];let x=this.transitionsBetween(h,m)+1,w=this.transitionsBetween(d,m)+1;(x&1)===1&&(x+=1),(w&1)===1&&(w+=1),4*x<7*w&&4*w<7*x&&(x=w=Math.max(x,w));let A=si.sampleGrid(this.image,h,f,d,m,x,w);return new pt(A,[h,f,d,m])}static shiftPoint(r,o,h){let f=(o.getX()-r.getX())/(h+1),d=(o.getY()-r.getY())/(h+1);return new gt(r.getX()+f,r.getY()+d)}static moveAway(r,o,h){let f=r.getX(),d=r.getY();return f<o?f-=1:f+=1,d<h?d-=1:d+=1,new gt(f,d)}detectSolid1(r){let o=r[0],h=r[1],f=r[3],d=r[2],m=this.transitionsBetween(o,h),x=this.transitionsBetween(h,f),w=this.transitionsBetween(f,d),A=this.transitionsBetween(d,o),O=m,B=[d,o,h,f];return O>x&&(O=x,B[0]=o,B[1]=h,B[2]=f,B[3]=d),O>w&&(O=w,B[0]=h,B[1]=f,B[2]=d,B[3]=o),O>A&&(B[0]=f,B[1]=d,B[2]=o,B[3]=h),B}detectSolid2(r){let o=r[0],h=r[1],f=r[2],d=r[3],m=this.transitionsBetween(o,d),x=si.shiftPoint(h,f,(m+1)*4),w=si.shiftPoint(f,h,(m+1)*4),A=this.transitionsBetween(x,o),O=this.transitionsBetween(w,d);return A<O?(r[0]=o,r[1]=h,r[2]=f,r[3]=d):(r[0]=h,r[1]=f,r[2]=d,r[3]=o),r}correctTopRight(r){let o=r[0],h=r[1],f=r[2],d=r[3],m=this.transitionsBetween(o,d),x=this.transitionsBetween(h,d),w=si.shiftPoint(o,h,(x+1)*4),A=si.shiftPoint(f,h,(m+1)*4);m=this.transitionsBetween(w,d),x=this.transitionsBetween(A,d);let O=new gt(d.getX()+(f.getX()-h.getX())/(m+1),d.getY()+(f.getY()-h.getY())/(m+1)),B=new gt(d.getX()+(o.getX()-h.getX())/(x+1),d.getY()+(o.getY()-h.getY())/(x+1));if(!this.isValid(O))return this.isValid(B)?B:null;if(!this.isValid(B))return O;let Y=this.transitionsBetween(w,O)+this.transitionsBetween(A,O),Q=this.transitionsBetween(w,B)+this.transitionsBetween(A,B);return Y>Q?O:B}shiftToModuleCenter(r){let o=r[0],h=r[1],f=r[2],d=r[3],m=this.transitionsBetween(o,d)+1,x=this.transitionsBetween(f,d)+1,w=si.shiftPoint(o,h,x*4),A=si.shiftPoint(f,h,m*4);m=this.transitionsBetween(w,d)+1,x=this.transitionsBetween(A,d)+1,(m&1)===1&&(m+=1),(x&1)===1&&(x+=1);let O=(o.getX()+h.getX()+f.getX()+d.getX())/4,B=(o.getY()+h.getY()+f.getY()+d.getY())/4;o=si.moveAway(o,O,B),h=si.moveAway(h,O,B),f=si.moveAway(f,O,B),d=si.moveAway(d,O,B);let Y,Q;return w=si.shiftPoint(o,h,x*4),w=si.shiftPoint(w,d,m*4),Y=si.shiftPoint(h,o,x*4),Y=si.shiftPoint(Y,f,m*4),A=si.shiftPoint(f,d,x*4),A=si.shiftPoint(A,h,m*4),Q=si.shiftPoint(d,f,x*4),Q=si.shiftPoint(Q,o,m*4),[w,Y,A,Q]}isValid(r){return r.getX()>=0&&r.getX()<this.image.getWidth()&&r.getY()>0&&r.getY()<this.image.getHeight()}static sampleGrid(r,o,h,f,d,m,x){return re.getInstance().sampleGrid(r,m,x,.5,.5,m-.5,.5,m-.5,x-.5,.5,x-.5,o.getX(),o.getY(),d.getX(),d.getY(),f.getX(),f.getY(),h.getX(),h.getY())}transitionsBetween(r,o){let h=Math.trunc(r.getX()),f=Math.trunc(r.getY()),d=Math.trunc(o.getX()),m=Math.trunc(o.getY()),x=Math.abs(m-f)>Math.abs(d-h);if(x){let ut=h;h=f,f=ut,ut=d,d=m,m=ut}let w=Math.abs(d-h),A=Math.abs(m-f),O=-w/2,B=f<m?1:-1,Y=h<d?1:-1,Q=0,ht=this.image.get(x?f:h,x?h:f);for(let ut=h,yt=f;ut!==d;ut+=Y){let Ct=this.image.get(x?yt:ut,x?ut:yt);if(Ct!==ht&&(Q++,ht=Ct),O+=A,O>0){if(yt===m)break;yt+=B,O-=w}}return Q}}class mi{constructor(){this.decoder=new pl}decode(r,o=null){let h,f;if(o!=null&&o.has(K.PURE_BARCODE)){const A=mi.extractPureBits(r.getBlackMatrix());h=this.decoder.decode(A),f=mi.NO_POINTS}else{const A=new si(r.getBlackMatrix()).detect();h=this.decoder.decode(A.getBits()),f=A.getPoints()}const d=h.getRawBytes(),m=new mt(h.getText(),d,8*d.length,f,Vt.DATA_MATRIX,R.currentTimeMillis()),x=h.getByteSegments();x!=null&&m.putMetadata(te.BYTE_SEGMENTS,x);const w=h.getECLevel();return w!=null&&m.putMetadata(te.ERROR_CORRECTION_LEVEL,w),m}reset(){}static extractPureBits(r){const o=r.getTopLeftOnBit(),h=r.getBottomRightOnBit();if(o==null||h==null)throw new Z;const f=this.moduleSize(o,r);let d=o[1];const m=h[1];let x=o[0];const A=(h[0]-x+1)/f,O=(m-d+1)/f;if(A<=0||O<=0)throw new Z;const B=f/2;d+=B,x+=B;const Y=new N(A,O);for(let Q=0;Q<O;Q++){const ht=d+Q*f;for(let ut=0;ut<A;ut++)r.get(x+ut*f,ht)&&Y.set(ut,Q)}return Y}static moduleSize(r,o){const h=o.getWidth();let f=r[0];const d=r[1];for(;f<h&&o.get(f,d);)f++;if(f===h)throw new Z;const m=f-r[0];if(m===0)throw new Z;return m}}mi.NO_POINTS=[];class cn extends Pt{constructor(r=500){super(new mi,r)}}var Nn;(function(L){L[L.L=0]="L",L[L.M=1]="M",L[L.Q=2]="Q",L[L.H=3]="H"})(Nn||(Nn={}));class $e{constructor(r,o,h){this.value=r,this.stringValue=o,this.bits=h,$e.FOR_BITS.set(h,this),$e.FOR_VALUE.set(r,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(r){switch(r){case"L":return $e.L;case"M":return $e.M;case"Q":return $e.Q;case"H":return $e.H;default:throw new y(r+"not available")}}toString(){return this.stringValue}equals(r){if(!(r instanceof $e))return!1;const o=r;return this.value===o.value}static forBits(r){if(r<0||r>=$e.FOR_BITS.size)throw new _;return $e.FOR_BITS.get(r)}}$e.FOR_BITS=new Map,$e.FOR_VALUE=new Map,$e.L=new $e(Nn.L,"L",1),$e.M=new $e(Nn.M,"M",0),$e.Q=new $e(Nn.Q,"Q",3),$e.H=new $e(Nn.H,"H",2);class Fi{constructor(r){this.errorCorrectionLevel=$e.forBits(r>>3&3),this.dataMask=r&7}static numBitsDiffering(r,o){return k.bitCount(r^o)}static decodeFormatInformation(r,o){const h=Fi.doDecodeFormatInformation(r,o);return h!==null?h:Fi.doDecodeFormatInformation(r^Fi.FORMAT_INFO_MASK_QR,o^Fi.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(r,o){let h=Number.MAX_SAFE_INTEGER,f=0;for(const d of Fi.FORMAT_INFO_DECODE_LOOKUP){const m=d[0];if(m===r||m===o)return new Fi(d[1]);let x=Fi.numBitsDiffering(r,m);x<h&&(f=d[1],h=x),r!==o&&(x=Fi.numBitsDiffering(o,m),x<h&&(f=d[1],h=x))}return h<=3?new Fi(f):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(r){if(!(r instanceof Fi))return!1;const o=r;return this.errorCorrectionLevel===o.errorCorrectionLevel&&this.dataMask===o.dataMask}}Fi.FORMAT_INFO_MASK_QR=21522,Fi.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class xt{constructor(r,...o){this.ecCodewordsPerBlock=r,this.ecBlocks=o}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let r=0;const o=this.ecBlocks;for(const h of o)r+=h.getCount();return r}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class J{constructor(r,o){this.count=r,this.dataCodewords=o}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ee{constructor(r,o,...h){this.versionNumber=r,this.alignmentPatternCenters=o,this.ecBlocks=h;let f=0;const d=h[0].getECCodewordsPerBlock(),m=h[0].getECBlocks();for(const x of m)f+=x.getCount()*(x.getDataCodewords()+d);this.totalCodewords=f}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(r){return this.ecBlocks[r.getValue()]}static getProvisionalVersionForDimension(r){if(r%4!==1)throw new z;try{return this.getVersionForNumber((r-17)/4)}catch{throw new z}}static getVersionForNumber(r){if(r<1||r>40)throw new _;return ee.VERSIONS[r-1]}static decodeVersionInformation(r){let o=Number.MAX_SAFE_INTEGER,h=0;for(let f=0;f<ee.VERSION_DECODE_INFO.length;f++){const d=ee.VERSION_DECODE_INFO[f];if(d===r)return ee.getVersionForNumber(f+7);const m=Fi.numBitsDiffering(r,d);m<o&&(h=f+7,o=m)}return o<=3?ee.getVersionForNumber(h):null}buildFunctionPattern(){const r=this.getDimensionForVersion(),o=new N(r);o.setRegion(0,0,9,9),o.setRegion(r-8,0,8,9),o.setRegion(0,r-8,9,8);const h=this.alignmentPatternCenters.length;for(let f=0;f<h;f++){const d=this.alignmentPatternCenters[f]-2;for(let m=0;m<h;m++)f===0&&(m===0||m===h-1)||f===h-1&&m===0||o.setRegion(this.alignmentPatternCenters[m]-2,d,5,5)}return o.setRegion(6,9,1,r-17),o.setRegion(9,6,r-17,1),this.versionNumber>6&&(o.setRegion(r-11,0,3,6),o.setRegion(0,r-11,6,3)),o}toString(){return""+this.versionNumber}}ee.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ee.VERSIONS=[new ee(1,new Int32Array(0),new xt(7,new J(1,19)),new xt(10,new J(1,16)),new xt(13,new J(1,13)),new xt(17,new J(1,9))),new ee(2,Int32Array.from([6,18]),new xt(10,new J(1,34)),new xt(16,new J(1,28)),new xt(22,new J(1,22)),new xt(28,new J(1,16))),new ee(3,Int32Array.from([6,22]),new xt(15,new J(1,55)),new xt(26,new J(1,44)),new xt(18,new J(2,17)),new xt(22,new J(2,13))),new ee(4,Int32Array.from([6,26]),new xt(20,new J(1,80)),new xt(18,new J(2,32)),new xt(26,new J(2,24)),new xt(16,new J(4,9))),new ee(5,Int32Array.from([6,30]),new xt(26,new J(1,108)),new xt(24,new J(2,43)),new xt(18,new J(2,15),new J(2,16)),new xt(22,new J(2,11),new J(2,12))),new ee(6,Int32Array.from([6,34]),new xt(18,new J(2,68)),new xt(16,new J(4,27)),new xt(24,new J(4,19)),new xt(28,new J(4,15))),new ee(7,Int32Array.from([6,22,38]),new xt(20,new J(2,78)),new xt(18,new J(4,31)),new xt(18,new J(2,14),new J(4,15)),new xt(26,new J(4,13),new J(1,14))),new ee(8,Int32Array.from([6,24,42]),new xt(24,new J(2,97)),new xt(22,new J(2,38),new J(2,39)),new xt(22,new J(4,18),new J(2,19)),new xt(26,new J(4,14),new J(2,15))),new ee(9,Int32Array.from([6,26,46]),new xt(30,new J(2,116)),new xt(22,new J(3,36),new J(2,37)),new xt(20,new J(4,16),new J(4,17)),new xt(24,new J(4,12),new J(4,13))),new ee(10,Int32Array.from([6,28,50]),new xt(18,new J(2,68),new J(2,69)),new xt(26,new J(4,43),new J(1,44)),new xt(24,new J(6,19),new J(2,20)),new xt(28,new J(6,15),new J(2,16))),new ee(11,Int32Array.from([6,30,54]),new xt(20,new J(4,81)),new xt(30,new J(1,50),new J(4,51)),new xt(28,new J(4,22),new J(4,23)),new xt(24,new J(3,12),new J(8,13))),new ee(12,Int32Array.from([6,32,58]),new xt(24,new J(2,92),new J(2,93)),new xt(22,new J(6,36),new J(2,37)),new xt(26,new J(4,20),new J(6,21)),new xt(28,new J(7,14),new J(4,15))),new ee(13,Int32Array.from([6,34,62]),new xt(26,new J(4,107)),new xt(22,new J(8,37),new J(1,38)),new xt(24,new J(8,20),new J(4,21)),new xt(22,new J(12,11),new J(4,12))),new ee(14,Int32Array.from([6,26,46,66]),new xt(30,new J(3,115),new J(1,116)),new xt(24,new J(4,40),new J(5,41)),new xt(20,new J(11,16),new J(5,17)),new xt(24,new J(11,12),new J(5,13))),new ee(15,Int32Array.from([6,26,48,70]),new xt(22,new J(5,87),new J(1,88)),new xt(24,new J(5,41),new J(5,42)),new xt(30,new J(5,24),new J(7,25)),new xt(24,new J(11,12),new J(7,13))),new ee(16,Int32Array.from([6,26,50,74]),new xt(24,new J(5,98),new J(1,99)),new xt(28,new J(7,45),new J(3,46)),new xt(24,new J(15,19),new J(2,20)),new xt(30,new J(3,15),new J(13,16))),new ee(17,Int32Array.from([6,30,54,78]),new xt(28,new J(1,107),new J(5,108)),new xt(28,new J(10,46),new J(1,47)),new xt(28,new J(1,22),new J(15,23)),new xt(28,new J(2,14),new J(17,15))),new ee(18,Int32Array.from([6,30,56,82]),new xt(30,new J(5,120),new J(1,121)),new xt(26,new J(9,43),new J(4,44)),new xt(28,new J(17,22),new J(1,23)),new xt(28,new J(2,14),new J(19,15))),new ee(19,Int32Array.from([6,30,58,86]),new xt(28,new J(3,113),new J(4,114)),new xt(26,new J(3,44),new J(11,45)),new xt(26,new J(17,21),new J(4,22)),new xt(26,new J(9,13),new J(16,14))),new ee(20,Int32Array.from([6,34,62,90]),new xt(28,new J(3,107),new J(5,108)),new xt(26,new J(3,41),new J(13,42)),new xt(30,new J(15,24),new J(5,25)),new xt(28,new J(15,15),new J(10,16))),new ee(21,Int32Array.from([6,28,50,72,94]),new xt(28,new J(4,116),new J(4,117)),new xt(26,new J(17,42)),new xt(28,new J(17,22),new J(6,23)),new xt(30,new J(19,16),new J(6,17))),new ee(22,Int32Array.from([6,26,50,74,98]),new xt(28,new J(2,111),new J(7,112)),new xt(28,new J(17,46)),new xt(30,new J(7,24),new J(16,25)),new xt(24,new J(34,13))),new ee(23,Int32Array.from([6,30,54,78,102]),new xt(30,new J(4,121),new J(5,122)),new xt(28,new J(4,47),new J(14,48)),new xt(30,new J(11,24),new J(14,25)),new xt(30,new J(16,15),new J(14,16))),new ee(24,Int32Array.from([6,28,54,80,106]),new xt(30,new J(6,117),new J(4,118)),new xt(28,new J(6,45),new J(14,46)),new xt(30,new J(11,24),new J(16,25)),new xt(30,new J(30,16),new J(2,17))),new ee(25,Int32Array.from([6,32,58,84,110]),new xt(26,new J(8,106),new J(4,107)),new xt(28,new J(8,47),new J(13,48)),new xt(30,new J(7,24),new J(22,25)),new xt(30,new J(22,15),new J(13,16))),new ee(26,Int32Array.from([6,30,58,86,114]),new xt(28,new J(10,114),new J(2,115)),new xt(28,new J(19,46),new J(4,47)),new xt(28,new J(28,22),new J(6,23)),new xt(30,new J(33,16),new J(4,17))),new ee(27,Int32Array.from([6,34,62,90,118]),new xt(30,new J(8,122),new J(4,123)),new xt(28,new J(22,45),new J(3,46)),new xt(30,new J(8,23),new J(26,24)),new xt(30,new J(12,15),new J(28,16))),new ee(28,Int32Array.from([6,26,50,74,98,122]),new xt(30,new J(3,117),new J(10,118)),new xt(28,new J(3,45),new J(23,46)),new xt(30,new J(4,24),new J(31,25)),new xt(30,new J(11,15),new J(31,16))),new ee(29,Int32Array.from([6,30,54,78,102,126]),new xt(30,new J(7,116),new J(7,117)),new xt(28,new J(21,45),new J(7,46)),new xt(30,new J(1,23),new J(37,24)),new xt(30,new J(19,15),new J(26,16))),new ee(30,Int32Array.from([6,26,52,78,104,130]),new xt(30,new J(5,115),new J(10,116)),new xt(28,new J(19,47),new J(10,48)),new xt(30,new J(15,24),new J(25,25)),new xt(30,new J(23,15),new J(25,16))),new ee(31,Int32Array.from([6,30,56,82,108,134]),new xt(30,new J(13,115),new J(3,116)),new xt(28,new J(2,46),new J(29,47)),new xt(30,new J(42,24),new J(1,25)),new xt(30,new J(23,15),new J(28,16))),new ee(32,Int32Array.from([6,34,60,86,112,138]),new xt(30,new J(17,115)),new xt(28,new J(10,46),new J(23,47)),new xt(30,new J(10,24),new J(35,25)),new xt(30,new J(19,15),new J(35,16))),new ee(33,Int32Array.from([6,30,58,86,114,142]),new xt(30,new J(17,115),new J(1,116)),new xt(28,new J(14,46),new J(21,47)),new xt(30,new J(29,24),new J(19,25)),new xt(30,new J(11,15),new J(46,16))),new ee(34,Int32Array.from([6,34,62,90,118,146]),new xt(30,new J(13,115),new J(6,116)),new xt(28,new J(14,46),new J(23,47)),new xt(30,new J(44,24),new J(7,25)),new xt(30,new J(59,16),new J(1,17))),new ee(35,Int32Array.from([6,30,54,78,102,126,150]),new xt(30,new J(12,121),new J(7,122)),new xt(28,new J(12,47),new J(26,48)),new xt(30,new J(39,24),new J(14,25)),new xt(30,new J(22,15),new J(41,16))),new ee(36,Int32Array.from([6,24,50,76,102,128,154]),new xt(30,new J(6,121),new J(14,122)),new xt(28,new J(6,47),new J(34,48)),new xt(30,new J(46,24),new J(10,25)),new xt(30,new J(2,15),new J(64,16))),new ee(37,Int32Array.from([6,28,54,80,106,132,158]),new xt(30,new J(17,122),new J(4,123)),new xt(28,new J(29,46),new J(14,47)),new xt(30,new J(49,24),new J(10,25)),new xt(30,new J(24,15),new J(46,16))),new ee(38,Int32Array.from([6,32,58,84,110,136,162]),new xt(30,new J(4,122),new J(18,123)),new xt(28,new J(13,46),new J(32,47)),new xt(30,new J(48,24),new J(14,25)),new xt(30,new J(42,15),new J(32,16))),new ee(39,Int32Array.from([6,26,54,82,110,138,166]),new xt(30,new J(20,117),new J(4,118)),new xt(28,new J(40,47),new J(7,48)),new xt(30,new J(43,24),new J(22,25)),new xt(30,new J(10,15),new J(67,16))),new ee(40,Int32Array.from([6,30,58,86,114,142,170]),new xt(30,new J(19,118),new J(6,119)),new xt(28,new J(18,47),new J(31,48)),new xt(30,new J(34,24),new J(34,25)),new xt(30,new J(20,15),new J(61,16)))];var Ri;(function(L){L[L.DATA_MASK_000=0]="DATA_MASK_000",L[L.DATA_MASK_001=1]="DATA_MASK_001",L[L.DATA_MASK_010=2]="DATA_MASK_010",L[L.DATA_MASK_011=3]="DATA_MASK_011",L[L.DATA_MASK_100=4]="DATA_MASK_100",L[L.DATA_MASK_101=5]="DATA_MASK_101",L[L.DATA_MASK_110=6]="DATA_MASK_110",L[L.DATA_MASK_111=7]="DATA_MASK_111"})(Ri||(Ri={}));class Wi{constructor(r,o){this.value=r,this.isMasked=o}unmaskBitMatrix(r,o){for(let h=0;h<o;h++)for(let f=0;f<o;f++)this.isMasked(h,f)&&r.flip(f,h)}}Wi.values=new Map([[Ri.DATA_MASK_000,new Wi(Ri.DATA_MASK_000,(L,r)=>(L+r&1)===0)],[Ri.DATA_MASK_001,new Wi(Ri.DATA_MASK_001,(L,r)=>(L&1)===0)],[Ri.DATA_MASK_010,new Wi(Ri.DATA_MASK_010,(L,r)=>r%3===0)],[Ri.DATA_MASK_011,new Wi(Ri.DATA_MASK_011,(L,r)=>(L+r)%3===0)],[Ri.DATA_MASK_100,new Wi(Ri.DATA_MASK_100,(L,r)=>(Math.floor(L/2)+Math.floor(r/3)&1)===0)],[Ri.DATA_MASK_101,new Wi(Ri.DATA_MASK_101,(L,r)=>L*r%6===0)],[Ri.DATA_MASK_110,new Wi(Ri.DATA_MASK_110,(L,r)=>L*r%6<3)],[Ri.DATA_MASK_111,new Wi(Ri.DATA_MASK_111,(L,r)=>(L+r+L*r%3&1)===0)]]);class yl{constructor(r){const o=r.getHeight();if(o<21||(o&3)!==1)throw new z;this.bitMatrix=r}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let r=0;for(let d=0;d<6;d++)r=this.copyBit(d,8,r);r=this.copyBit(7,8,r),r=this.copyBit(8,8,r),r=this.copyBit(8,7,r);for(let d=5;d>=0;d--)r=this.copyBit(8,d,r);const o=this.bitMatrix.getHeight();let h=0;const f=o-7;for(let d=o-1;d>=f;d--)h=this.copyBit(8,d,h);for(let d=o-8;d<o;d++)h=this.copyBit(d,8,h);if(this.parsedFormatInfo=Fi.decodeFormatInformation(r,h),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new z}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const r=this.bitMatrix.getHeight(),o=Math.floor((r-17)/4);if(o<=6)return ee.getVersionForNumber(o);let h=0;const f=r-11;for(let m=5;m>=0;m--)for(let x=r-9;x>=f;x--)h=this.copyBit(x,m,h);let d=ee.decodeVersionInformation(h);if(d!==null&&d.getDimensionForVersion()===r)return this.parsedVersion=d,d;h=0;for(let m=5;m>=0;m--)for(let x=r-9;x>=f;x--)h=this.copyBit(m,x,h);if(d=ee.decodeVersionInformation(h),d!==null&&d.getDimensionForVersion()===r)return this.parsedVersion=d,d;throw new z}copyBit(r,o,h){return(this.isMirror?this.bitMatrix.get(o,r):this.bitMatrix.get(r,o))?h<<1|1:h<<1}readCodewords(){const r=this.readFormatInformation(),o=this.readVersion(),h=Wi.values.get(r.getDataMask()),f=this.bitMatrix.getHeight();h.unmaskBitMatrix(this.bitMatrix,f);const d=o.buildFunctionPattern();let m=!0;const x=new Uint8Array(o.getTotalCodewords());let w=0,A=0,O=0;for(let B=f-1;B>0;B-=2){B===6&&B--;for(let Y=0;Y<f;Y++){const Q=m?f-1-Y:Y;for(let ht=0;ht<2;ht++)d.get(B-ht,Q)||(O++,A<<=1,this.bitMatrix.get(B-ht,Q)&&(A|=1),O===8&&(x[w++]=A,O=0,A=0))}m=!m}if(w!==o.getTotalCodewords())throw new z;return x}remask(){if(this.parsedFormatInfo===null)return;const r=Wi.values[this.parsedFormatInfo.getDataMask()],o=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,o)}setMirror(r){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=r}mirror(){const r=this.bitMatrix;for(let o=0,h=r.getWidth();o<h;o++)for(let f=o+1,d=r.getHeight();f<d;f++)r.get(o,f)!==r.get(f,o)&&(r.flip(f,o),r.flip(o,f))}}class Ki{constructor(r,o){this.numDataCodewords=r,this.codewords=o}static getDataBlocks(r,o,h){if(r.length!==o.getTotalCodewords())throw new _;const f=o.getECBlocksForLevel(h);let d=0;const m=f.getECBlocks();for(const ht of m)d+=ht.getCount();const x=new Array(d);let w=0;for(const ht of m)for(let ut=0;ut<ht.getCount();ut++){const yt=ht.getDataCodewords(),Ct=f.getECCodewordsPerBlock()+yt;x[w++]=new Ki(yt,new Uint8Array(Ct))}const A=x[0].codewords.length;let O=x.length-1;for(;O>=0&&x[O].codewords.length!==A;)O--;O++;const B=A-f.getECCodewordsPerBlock();let Y=0;for(let ht=0;ht<B;ht++)for(let ut=0;ut<w;ut++)x[ut].codewords[ht]=r[Y++];for(let ht=O;ht<w;ht++)x[ht].codewords[B]=r[Y++];const Q=x[0].codewords.length;for(let ht=B;ht<Q;ht++)for(let ut=0;ut<w;ut++){const yt=ut<O?ht:ht+1;x[ut].codewords[yt]=r[Y++]}return x}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var fn;(function(L){L[L.TERMINATOR=0]="TERMINATOR",L[L.NUMERIC=1]="NUMERIC",L[L.ALPHANUMERIC=2]="ALPHANUMERIC",L[L.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",L[L.BYTE=4]="BYTE",L[L.ECI=5]="ECI",L[L.KANJI=6]="KANJI",L[L.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",L[L.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",L[L.HANZI=9]="HANZI"})(fn||(fn={}));class oe{constructor(r,o,h,f){this.value=r,this.stringValue=o,this.characterCountBitsForVersions=h,this.bits=f,oe.FOR_BITS.set(f,this),oe.FOR_VALUE.set(r,this)}static forBits(r){const o=oe.FOR_BITS.get(r);if(o===void 0)throw new _;return o}getCharacterCountBits(r){const o=r.getVersionNumber();let h;return o<=9?h=0:o<=26?h=1:h=2,this.characterCountBitsForVersions[h]}getValue(){return this.value}getBits(){return this.bits}equals(r){if(!(r instanceof oe))return!1;const o=r;return this.value===o.value}toString(){return this.stringValue}}oe.FOR_BITS=new Map,oe.FOR_VALUE=new Map,oe.TERMINATOR=new oe(fn.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),oe.NUMERIC=new oe(fn.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),oe.ALPHANUMERIC=new oe(fn.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),oe.STRUCTURED_APPEND=new oe(fn.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),oe.BYTE=new oe(fn.BYTE,"BYTE",Int32Array.from([8,16,16]),4),oe.ECI=new oe(fn.ECI,"ECI",Int32Array.from([0,0,0]),7),oe.KANJI=new oe(fn.KANJI,"KANJI",Int32Array.from([8,10,12]),8),oe.FNC1_FIRST_POSITION=new oe(fn.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),oe.FNC1_SECOND_POSITION=new oe(fn.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),oe.HANZI=new oe(fn.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class ri{static decode(r,o,h,f){const d=new qr(r);let m=new tt;const x=new Array;let w=-1,A=-1;try{let O=null,B=!1,Y;do{if(d.available()<4)Y=oe.TERMINATOR;else{const Q=d.readBits(4);Y=oe.forBits(Q)}switch(Y){case oe.TERMINATOR:break;case oe.FNC1_FIRST_POSITION:case oe.FNC1_SECOND_POSITION:B=!0;break;case oe.STRUCTURED_APPEND:if(d.available()<16)throw new z;w=d.readBits(8),A=d.readBits(8);break;case oe.ECI:const Q=ri.parseECIValue(d);if(O=V.getCharacterSetECIByValue(Q),O===null)throw new z;break;case oe.HANZI:const ht=d.readBits(4),ut=d.readBits(Y.getCharacterCountBits(o));ht===ri.GB2312_SUBSET&&ri.decodeHanziSegment(d,m,ut);break;default:const yt=d.readBits(Y.getCharacterCountBits(o));switch(Y){case oe.NUMERIC:ri.decodeNumericSegment(d,m,yt);break;case oe.ALPHANUMERIC:ri.decodeAlphanumericSegment(d,m,yt,B);break;case oe.BYTE:ri.decodeByteSegment(d,m,yt,O,x,f);break;case oe.KANJI:ri.decodeKanjiSegment(d,m,yt);break;default:throw new z}break}}while(Y!==oe.TERMINATOR)}catch{throw new z}return new me(r,m.toString(),x.length===0?null:x,h===null?null:h.toString(),w,A)}static decodeHanziSegment(r,o,h){if(h*13>r.available())throw new z;const f=new Uint8Array(2*h);let d=0;for(;h>0;){const m=r.readBits(13);let x=m/96<<8&4294967295|m%96;x<959?x+=41377:x+=42657,f[d]=x>>8&255,f[d+1]=x&255,d+=2,h--}try{o.append(ot.decode(f,j.GB2312))}catch(m){throw new z(m)}}static decodeKanjiSegment(r,o,h){if(h*13>r.available())throw new z;const f=new Uint8Array(2*h);let d=0;for(;h>0;){const m=r.readBits(13);let x=m/192<<8&4294967295|m%192;x<7936?x+=33088:x+=49472,f[d]=x>>8,f[d+1]=x,d+=2,h--}try{o.append(ot.decode(f,j.SHIFT_JIS))}catch(m){throw new z(m)}}static decodeByteSegment(r,o,h,f,d,m){if(8*h>r.available())throw new z;const x=new Uint8Array(h);for(let A=0;A<h;A++)x[A]=r.readBits(8);let w;f===null?w=j.guessEncoding(x,m):w=f.getName();try{o.append(ot.decode(x,w))}catch(A){throw new z(A)}d.push(x)}static toAlphaNumericChar(r){if(r>=ri.ALPHANUMERIC_CHARS.length)throw new z;return ri.ALPHANUMERIC_CHARS[r]}static decodeAlphanumericSegment(r,o,h,f){const d=o.length();for(;h>1;){if(r.available()<11)throw new z;const m=r.readBits(11);o.append(ri.toAlphaNumericChar(Math.floor(m/45))),o.append(ri.toAlphaNumericChar(m%45)),h-=2}if(h===1){if(r.available()<6)throw new z;o.append(ri.toAlphaNumericChar(r.readBits(6)))}if(f)for(let m=d;m<o.length();m++)o.charAt(m)==="%"&&(m<o.length()-1&&o.charAt(m+1)==="%"?o.deleteCharAt(m+1):o.setCharAt(m,""))}static decodeNumericSegment(r,o,h){for(;h>=3;){if(r.available()<10)throw new z;const f=r.readBits(10);if(f>=1e3)throw new z;o.append(ri.toAlphaNumericChar(Math.floor(f/100))),o.append(ri.toAlphaNumericChar(Math.floor(f/10)%10)),o.append(ri.toAlphaNumericChar(f%10)),h-=3}if(h===2){if(r.available()<7)throw new z;const f=r.readBits(7);if(f>=100)throw new z;o.append(ri.toAlphaNumericChar(Math.floor(f/10))),o.append(ri.toAlphaNumericChar(f%10))}else if(h===1){if(r.available()<4)throw new z;const f=r.readBits(4);if(f>=10)throw new z;o.append(ri.toAlphaNumericChar(f))}}static parseECIValue(r){const o=r.readBits(8);if(!(o&128))return o&127;if((o&192)===128){const h=r.readBits(8);return(o&63)<<8&4294967295|h}if((o&224)===192){const h=r.readBits(16);return(o&31)<<16&4294967295|h}throw new z}}ri.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",ri.GB2312_SUBSET=1;class xl{constructor(r){this.mirrored=r}isMirrored(){return this.mirrored}applyMirroredCorrection(r){if(!this.mirrored||r===null||r.length<3)return;const o=r[0];r[0]=r[2],r[2]=o}}class ou{constructor(){this.rsDecoder=new Et(de.QR_CODE_FIELD_256)}decodeBooleanArray(r,o){return this.decodeBitMatrix(N.parseFromBooleanArray(r),o)}decodeBitMatrix(r,o){const h=new yl(r);let f=null;try{return this.decodeBitMatrixParser(h,o)}catch(d){f=d}try{h.remask(),h.setMirror(!0),h.readVersion(),h.readFormatInformation(),h.mirror();const d=this.decodeBitMatrixParser(h,o);return d.setOther(new xl(!0)),d}catch(d){throw f!==null?f:d}}decodeBitMatrixParser(r,o){const h=r.readVersion(),f=r.readFormatInformation().getErrorCorrectionLevel(),d=r.readCodewords(),m=Ki.getDataBlocks(d,h,f);let x=0;for(const O of m)x+=O.getNumDataCodewords();const w=new Uint8Array(x);let A=0;for(const O of m){const B=O.getCodewords(),Y=O.getNumDataCodewords();this.correctErrors(B,Y);for(let Q=0;Q<Y;Q++)w[A++]=B[Q]}return ri.decode(w,h,f,o)}correctErrors(r,o){const h=new Int32Array(r);try{this.rsDecoder.decode(h,r.length-o)}catch{throw new I}for(let f=0;f<o;f++)r[f]=h[f]}}class $r extends gt{constructor(r,o,h){super(r,o),this.estimatedModuleSize=h}aboutEquals(r,o,h){if(Math.abs(o-this.getY())<=r&&Math.abs(h-this.getX())<=r){const f=Math.abs(r-this.estimatedModuleSize);return f<=1||f<=this.estimatedModuleSize}return!1}combineEstimate(r,o,h){const f=(this.getX()+o)/2,d=(this.getY()+r)/2,m=(this.estimatedModuleSize+h)/2;return new $r(f,d,m)}}class _s{constructor(r,o,h,f,d,m,x){this.image=r,this.startX=o,this.startY=h,this.width=f,this.height=d,this.moduleSize=m,this.resultPointCallback=x,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const r=this.startX,o=this.height,h=this.width,f=r+h,d=this.startY+o/2,m=new Int32Array(3),x=this.image;for(let w=0;w<o;w++){const A=d+(w&1?-Math.floor((w+1)/2):Math.floor((w+1)/2));m[0]=0,m[1]=0,m[2]=0;let O=r;for(;O<f&&!x.get(O,A);)O++;let B=0;for(;O<f;){if(x.get(O,A))if(B===1)m[1]++;else if(B===2){if(this.foundPatternCross(m)){const Y=this.handlePossibleCenter(m,A,O);if(Y!==null)return Y}m[0]=m[2],m[1]=1,m[2]=0,B=1}else m[++B]++;else B===1&&B++,m[B]++;O++}if(this.foundPatternCross(m)){const Y=this.handlePossibleCenter(m,A,f);if(Y!==null)return Y}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new Z}static centerFromEnd(r,o){return o-r[2]-r[1]/2}foundPatternCross(r){const o=this.moduleSize,h=o/2;for(let f=0;f<3;f++)if(Math.abs(o-r[f])>=h)return!1;return!0}crossCheckVertical(r,o,h,f){const d=this.image,m=d.getHeight(),x=this.crossCheckStateCount;x[0]=0,x[1]=0,x[2]=0;let w=r;for(;w>=0&&d.get(o,w)&&x[1]<=h;)x[1]++,w--;if(w<0||x[1]>h)return NaN;for(;w>=0&&!d.get(o,w)&&x[0]<=h;)x[0]++,w--;if(x[0]>h)return NaN;for(w=r+1;w<m&&d.get(o,w)&&x[1]<=h;)x[1]++,w++;if(w===m||x[1]>h)return NaN;for(;w<m&&!d.get(o,w)&&x[2]<=h;)x[2]++,w++;if(x[2]>h)return NaN;const A=x[0]+x[1]+x[2];return 5*Math.abs(A-f)>=2*f?NaN:this.foundPatternCross(x)?_s.centerFromEnd(x,w):NaN}handlePossibleCenter(r,o,h){const f=r[0]+r[1]+r[2],d=_s.centerFromEnd(r,h),m=this.crossCheckVertical(o,d,2*r[1],f);if(!isNaN(m)){const x=(r[0]+r[1]+r[2])/3;for(const A of this.possibleCenters)if(A.aboutEquals(x,m,d))return A.combineEstimate(m,d,x);const w=new $r(d,m,x);this.possibleCenters.push(w),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(w)}return null}}class Ua extends gt{constructor(r,o,h,f){super(r,o),this.estimatedModuleSize=h,this.count=f,f===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(r,o,h){if(Math.abs(o-this.getY())<=r&&Math.abs(h-this.getX())<=r){const f=Math.abs(r-this.estimatedModuleSize);return f<=1||f<=this.estimatedModuleSize}return!1}combineEstimate(r,o,h){const f=this.count+1,d=(this.count*this.getX()+o)/f,m=(this.count*this.getY()+r)/f,x=(this.count*this.estimatedModuleSize+h)/f;return new Ua(d,m,x,f)}}class lu{constructor(r){this.bottomLeft=r[0],this.topLeft=r[1],this.topRight=r[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class _i{constructor(r,o){this.image=r,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=o}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(r){const o=r!=null&&r.get(K.TRY_HARDER)!==void 0,h=r!=null&&r.get(K.PURE_BARCODE)!==void 0,f=this.image,d=f.getHeight(),m=f.getWidth();let x=Math.floor(3*d/(4*_i.MAX_MODULES));(x<_i.MIN_SKIP||o)&&(x=_i.MIN_SKIP);let w=!1;const A=new Int32Array(5);for(let B=x-1;B<d&&!w;B+=x){A[0]=0,A[1]=0,A[2]=0,A[3]=0,A[4]=0;let Y=0;for(let Q=0;Q<m;Q++)if(f.get(Q,B))(Y&1)===1&&Y++,A[Y]++;else if(Y&1)A[Y]++;else if(Y===4)if(_i.foundPatternCross(A)){if(this.handlePossibleCenter(A,B,Q,h)===!0)if(x=2,this.hasSkipped===!0)w=this.haveMultiplyConfirmedCenters();else{const ut=this.findRowSkip();ut>A[2]&&(B+=ut-A[2]-x,Q=m-1)}else{A[0]=A[2],A[1]=A[3],A[2]=A[4],A[3]=1,A[4]=0,Y=3;continue}Y=0,A[0]=0,A[1]=0,A[2]=0,A[3]=0,A[4]=0}else A[0]=A[2],A[1]=A[3],A[2]=A[4],A[3]=1,A[4]=0,Y=3;else A[++Y]++;_i.foundPatternCross(A)&&this.handlePossibleCenter(A,B,m,h)===!0&&(x=A[0],this.hasSkipped&&(w=this.haveMultiplyConfirmedCenters()))}const O=this.selectBestPatterns();return gt.orderBestPatterns(O),new lu(O)}static centerFromEnd(r,o){return o-r[4]-r[3]-r[2]/2}static foundPatternCross(r){let o=0;for(let d=0;d<5;d++){const m=r[d];if(m===0)return!1;o+=m}if(o<7)return!1;const h=o/7,f=h/2;return Math.abs(h-r[0])<f&&Math.abs(h-r[1])<f&&Math.abs(3*h-r[2])<3*f&&Math.abs(h-r[3])<f&&Math.abs(h-r[4])<f}getCrossCheckStateCount(){const r=this.crossCheckStateCount;return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r}crossCheckDiagonal(r,o,h,f){const d=this.getCrossCheckStateCount();let m=0;const x=this.image;for(;r>=m&&o>=m&&x.get(o-m,r-m);)d[2]++,m++;if(r<m||o<m)return!1;for(;r>=m&&o>=m&&!x.get(o-m,r-m)&&d[1]<=h;)d[1]++,m++;if(r<m||o<m||d[1]>h)return!1;for(;r>=m&&o>=m&&x.get(o-m,r-m)&&d[0]<=h;)d[0]++,m++;if(d[0]>h)return!1;const w=x.getHeight(),A=x.getWidth();for(m=1;r+m<w&&o+m<A&&x.get(o+m,r+m);)d[2]++,m++;if(r+m>=w||o+m>=A)return!1;for(;r+m<w&&o+m<A&&!x.get(o+m,r+m)&&d[3]<h;)d[3]++,m++;if(r+m>=w||o+m>=A||d[3]>=h)return!1;for(;r+m<w&&o+m<A&&x.get(o+m,r+m)&&d[4]<h;)d[4]++,m++;if(d[4]>=h)return!1;const O=d[0]+d[1]+d[2]+d[3]+d[4];return Math.abs(O-f)<2*f&&_i.foundPatternCross(d)}crossCheckVertical(r,o,h,f){const d=this.image,m=d.getHeight(),x=this.getCrossCheckStateCount();let w=r;for(;w>=0&&d.get(o,w);)x[2]++,w--;if(w<0)return NaN;for(;w>=0&&!d.get(o,w)&&x[1]<=h;)x[1]++,w--;if(w<0||x[1]>h)return NaN;for(;w>=0&&d.get(o,w)&&x[0]<=h;)x[0]++,w--;if(x[0]>h)return NaN;for(w=r+1;w<m&&d.get(o,w);)x[2]++,w++;if(w===m)return NaN;for(;w<m&&!d.get(o,w)&&x[3]<h;)x[3]++,w++;if(w===m||x[3]>=h)return NaN;for(;w<m&&d.get(o,w)&&x[4]<h;)x[4]++,w++;if(x[4]>=h)return NaN;const A=x[0]+x[1]+x[2]+x[3]+x[4];return 5*Math.abs(A-f)>=2*f?NaN:_i.foundPatternCross(x)?_i.centerFromEnd(x,w):NaN}crossCheckHorizontal(r,o,h,f){const d=this.image,m=d.getWidth(),x=this.getCrossCheckStateCount();let w=r;for(;w>=0&&d.get(w,o);)x[2]++,w--;if(w<0)return NaN;for(;w>=0&&!d.get(w,o)&&x[1]<=h;)x[1]++,w--;if(w<0||x[1]>h)return NaN;for(;w>=0&&d.get(w,o)&&x[0]<=h;)x[0]++,w--;if(x[0]>h)return NaN;for(w=r+1;w<m&&d.get(w,o);)x[2]++,w++;if(w===m)return NaN;for(;w<m&&!d.get(w,o)&&x[3]<h;)x[3]++,w++;if(w===m||x[3]>=h)return NaN;for(;w<m&&d.get(w,o)&&x[4]<h;)x[4]++,w++;if(x[4]>=h)return NaN;const A=x[0]+x[1]+x[2]+x[3]+x[4];return 5*Math.abs(A-f)>=f?NaN:_i.foundPatternCross(x)?_i.centerFromEnd(x,w):NaN}handlePossibleCenter(r,o,h,f){const d=r[0]+r[1]+r[2]+r[3]+r[4];let m=_i.centerFromEnd(r,h),x=this.crossCheckVertical(o,Math.floor(m),r[2],d);if(!isNaN(x)&&(m=this.crossCheckHorizontal(Math.floor(m),Math.floor(x),r[2],d),!isNaN(m)&&(!f||this.crossCheckDiagonal(Math.floor(x),Math.floor(m),r[2],d)))){const w=d/7;let A=!1;const O=this.possibleCenters;for(let B=0,Y=O.length;B<Y;B++){const Q=O[B];if(Q.aboutEquals(w,x,m)){O[B]=Q.combineEstimate(x,m,w),A=!0;break}}if(!A){const B=new Ua(m,x,w);O.push(B),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(B)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let o=null;for(const h of this.possibleCenters)if(h.getCount()>=_i.CENTER_QUORUM)if(o==null)o=h;else return this.hasSkipped=!0,Math.floor((Math.abs(o.getX()-h.getX())-Math.abs(o.getY()-h.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let r=0,o=0;const h=this.possibleCenters.length;for(const m of this.possibleCenters)m.getCount()>=_i.CENTER_QUORUM&&(r++,o+=m.getEstimatedModuleSize());if(r<3)return!1;const f=o/h;let d=0;for(const m of this.possibleCenters)d+=Math.abs(m.getEstimatedModuleSize()-f);return d<=.05*o}selectBestPatterns(){const r=this.possibleCenters.length;if(r<3)throw new Z;const o=this.possibleCenters;let h;if(r>3){let f=0,d=0;for(const w of this.possibleCenters){const A=w.getEstimatedModuleSize();f+=A,d+=A*A}h=f/r;let m=Math.sqrt(d/r-h*h);o.sort((w,A)=>{const O=Math.abs(A.getEstimatedModuleSize()-h),B=Math.abs(w.getEstimatedModuleSize()-h);return O<B?-1:O>B?1:0});const x=Math.max(.2*h,m);for(let w=0;w<o.length&&o.length>3;w++){const A=o[w];Math.abs(A.getEstimatedModuleSize()-h)>x&&(o.splice(w,1),w--)}}if(o.length>3){let f=0;for(const d of o)f+=d.getEstimatedModuleSize();h=f/o.length,o.sort((d,m)=>{if(m.getCount()===d.getCount()){const x=Math.abs(m.getEstimatedModuleSize()-h),w=Math.abs(d.getEstimatedModuleSize()-h);return x<w?1:x>w?-1:0}else return m.getCount()-d.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]}}_i.CENTER_QUORUM=2,_i.MIN_SKIP=3,_i.MAX_MODULES=57;class Cr{constructor(r){this.image=r}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(r){this.resultPointCallback=r==null?null:r.get(K.NEED_RESULT_POINT_CALLBACK);const h=new _i(this.image,this.resultPointCallback).find(r);return this.processFinderPatternInfo(h)}processFinderPatternInfo(r){const o=r.getTopLeft(),h=r.getTopRight(),f=r.getBottomLeft(),d=this.calculateModuleSize(o,h,f);if(d<1)throw new Z("No pattern found in proccess finder.");const m=Cr.computeDimension(o,h,f,d),x=ee.getProvisionalVersionForDimension(m),w=x.getDimensionForVersion()-7;let A=null;if(x.getAlignmentPatternCenters().length>0){const Q=h.getX()-o.getX()+f.getX(),ht=h.getY()-o.getY()+f.getY(),ut=1-3/w,yt=Math.floor(o.getX()+ut*(Q-o.getX())),Ct=Math.floor(o.getY()+ut*(ht-o.getY()));for(let zt=4;zt<=16;zt<<=1)try{A=this.findAlignmentInRegion(d,yt,Ct,zt);break}catch(Wt){if(!(Wt instanceof Z))throw Wt}}const O=Cr.createTransform(o,h,f,A,m),B=Cr.sampleGrid(this.image,O,m);let Y;return A===null?Y=[f,o,h]:Y=[f,o,h,A],new pt(B,Y)}static createTransform(r,o,h,f,d){const m=d-3.5;let x,w,A,O;return f!==null?(x=f.getX(),w=f.getY(),A=m-3,O=A):(x=o.getX()-r.getX()+h.getX(),w=o.getY()-r.getY()+h.getY(),A=m,O=m),qt.quadrilateralToQuadrilateral(3.5,3.5,m,3.5,A,O,3.5,m,r.getX(),r.getY(),o.getX(),o.getY(),x,w,h.getX(),h.getY())}static sampleGrid(r,o,h){return re.getInstance().sampleGridWithTransform(r,h,h,o)}static computeDimension(r,o,h,f){const d=lt.round(gt.distance(r,o)/f),m=lt.round(gt.distance(r,h)/f);let x=Math.floor((d+m)/2)+7;switch(x&3){case 0:x++;break;case 2:x--;break;case 3:throw new Z("Dimensions could be not found.")}return x}calculateModuleSize(r,o,h){return(this.calculateModuleSizeOneWay(r,o)+this.calculateModuleSizeOneWay(r,h))/2}calculateModuleSizeOneWay(r,o){const h=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(o.getX()),Math.floor(o.getY())),f=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(o.getX()),Math.floor(o.getY()),Math.floor(r.getX()),Math.floor(r.getY()));return isNaN(h)?f/7:isNaN(f)?h/7:(h+f)/14}sizeOfBlackWhiteBlackRunBothWays(r,o,h,f){let d=this.sizeOfBlackWhiteBlackRun(r,o,h,f),m=1,x=r-(h-r);x<0?(m=r/(r-x),x=0):x>=this.image.getWidth()&&(m=(this.image.getWidth()-1-r)/(x-r),x=this.image.getWidth()-1);let w=Math.floor(o-(f-o)*m);return m=1,w<0?(m=o/(o-w),w=0):w>=this.image.getHeight()&&(m=(this.image.getHeight()-1-o)/(w-o),w=this.image.getHeight()-1),x=Math.floor(r+(x-r)*m),d+=this.sizeOfBlackWhiteBlackRun(r,o,x,w),d-1}sizeOfBlackWhiteBlackRun(r,o,h,f){const d=Math.abs(f-o)>Math.abs(h-r);if(d){let Q=r;r=o,o=Q,Q=h,h=f,f=Q}const m=Math.abs(h-r),x=Math.abs(f-o);let w=-m/2;const A=r<h?1:-1,O=o<f?1:-1;let B=0;const Y=h+A;for(let Q=r,ht=o;Q!==Y;Q+=A){const ut=d?ht:Q,yt=d?Q:ht;if(B===1===this.image.get(ut,yt)){if(B===2)return lt.distance(Q,ht,r,o);B++}if(w+=x,w>0){if(ht===f)break;ht+=O,w-=m}}return B===2?lt.distance(h+A,f,r,o):NaN}findAlignmentInRegion(r,o,h,f){const d=Math.floor(f*r),m=Math.max(0,o-d),x=Math.min(this.image.getWidth()-1,o+d);if(x-m<r*3)throw new Z("Alignment top exceeds estimated module size.");const w=Math.max(0,h-d),A=Math.min(this.image.getHeight()-1,h+d);if(A-w<r*3)throw new Z("Alignment bottom exceeds estimated module size.");return new _s(this.image,m,w,x-m,A-w,r,this.resultPointCallback).find()}}class Ln{constructor(){this.decoder=new ou}getDecoder(){return this.decoder}decode(r,o){let h,f;if(o!=null&&o.get(K.PURE_BARCODE)!==void 0){const w=Ln.extractPureBits(r.getBlackMatrix());h=this.decoder.decodeBitMatrix(w,o),f=Ln.NO_POINTS}else{const w=new Cr(r.getBlackMatrix()).detect(o);h=this.decoder.decodeBitMatrix(w.getBits(),o),f=w.getPoints()}h.getOther()instanceof xl&&h.getOther().applyMirroredCorrection(f);const d=new mt(h.getText(),h.getRawBytes(),void 0,f,Vt.QR_CODE,void 0),m=h.getByteSegments();m!==null&&d.putMetadata(te.BYTE_SEGMENTS,m);const x=h.getECLevel();return x!==null&&d.putMetadata(te.ERROR_CORRECTION_LEVEL,x),h.hasStructuredAppend()&&(d.putMetadata(te.STRUCTURED_APPEND_SEQUENCE,h.getStructuredAppendSequenceNumber()),d.putMetadata(te.STRUCTURED_APPEND_PARITY,h.getStructuredAppendParity())),d}reset(){}static extractPureBits(r){const o=r.getTopLeftOnBit(),h=r.getBottomRightOnBit();if(o===null||h===null)throw new Z;const f=this.moduleSize(o,r);let d=o[1],m=h[1],x=o[0],w=h[0];if(x>=w||d>=m)throw new Z;if(m-d!==w-x&&(w=x+(m-d),w>=r.getWidth()))throw new Z;const A=Math.round((w-x+1)/f),O=Math.round((m-d+1)/f);if(A<=0||O<=0)throw new Z;if(O!==A)throw new Z;const B=Math.floor(f/2);d+=B,x+=B;const Y=x+Math.floor((A-1)*f)-w;if(Y>0){if(Y>B)throw new Z;x-=Y}const Q=d+Math.floor((O-1)*f)-m;if(Q>0){if(Q>B)throw new Z;d-=Q}const ht=new N(A,O);for(let ut=0;ut<O;ut++){const yt=d+Math.floor(ut*f);for(let Ct=0;Ct<A;Ct++)r.get(x+Math.floor(Ct*f),yt)&&ht.set(Ct,ut)}return ht}static moduleSize(r,o){const h=o.getHeight(),f=o.getWidth();let d=r[0],m=r[1],x=!0,w=0;for(;d<f&&m<h;){if(x!==o.get(d,m)){if(++w===5)break;x=!x}d++,m++}if(d===f||m===h)throw new Z;return(d-r[0])/7}}Ln.NO_POINTS=new Array;class ce{PDF417Common(){}static getBitCountSum(r){return lt.sum(r)}static toIntArray(r){if(r==null||!r.length)return ce.EMPTY_INT_ARRAY;const o=new Int32Array(r.length);let h=0;for(const f of r)o[h++]=f;return o}static getCodeword(r){const o=v.binarySearch(ce.SYMBOL_TABLE,r&262143);return o<0?-1:(ce.CODEWORD_TABLE[o]-1)%ce.NUMBER_OF_CODEWORDS}}ce.NUMBER_OF_CODEWORDS=929,ce.MAX_CODEWORDS_IN_BARCODE=ce.NUMBER_OF_CODEWORDS-1,ce.MIN_ROWS_IN_BARCODE=3,ce.MAX_ROWS_IN_BARCODE=90,ce.MODULES_IN_CODEWORD=17,ce.MODULES_IN_STOP_PATTERN=18,ce.BARS_IN_MODULE=8,ce.EMPTY_INT_ARRAY=new Int32Array([]),ce.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),ce.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class hu{constructor(r,o){this.bits=r,this.points=o}getBits(){return this.bits}getPoints(){return this.points}}class Te{static detectMultiple(r,o,h){let f=r.getBlackMatrix(),d=Te.detect(h,f);return d.length||(f=f.clone(),f.rotate180(),d=Te.detect(h,f)),new hu(f,d)}static detect(r,o){const h=new Array;let f=0,d=0,m=!1;for(;f<o.getHeight();){const x=Te.findVertices(o,f,d);if(x[0]==null&&x[3]==null){if(!m)break;m=!1,d=0;for(const w of h)w[1]!=null&&(f=Math.trunc(Math.max(f,w[1].getY()))),w[3]!=null&&(f=Math.max(f,Math.trunc(w[3].getY())));f+=Te.ROW_STEP;continue}if(m=!0,h.push(x),!r)break;x[2]!=null?(d=Math.trunc(x[2].getX()),f=Math.trunc(x[2].getY())):(d=Math.trunc(x[4].getX()),f=Math.trunc(x[4].getY()))}return h}static findVertices(r,o,h){const f=r.getHeight(),d=r.getWidth(),m=new Array(8);return Te.copyToResult(m,Te.findRowsWithPattern(r,f,d,o,h,Te.START_PATTERN),Te.INDEXES_START_PATTERN),m[4]!=null&&(h=Math.trunc(m[4].getX()),o=Math.trunc(m[4].getY())),Te.copyToResult(m,Te.findRowsWithPattern(r,f,d,o,h,Te.STOP_PATTERN),Te.INDEXES_STOP_PATTERN),m}static copyToResult(r,o,h){for(let f=0;f<h.length;f++)r[h[f]]=o[f]}static findRowsWithPattern(r,o,h,f,d,m){const x=new Array(4);let w=!1;const A=new Int32Array(m.length);for(;f<o;f+=Te.ROW_STEP){let B=Te.findGuardPattern(r,d,f,h,!1,m,A);if(B!=null){for(;f>0;){const Y=Te.findGuardPattern(r,d,--f,h,!1,m,A);if(Y!=null)B=Y;else{f++;break}}x[0]=new gt(B[0],f),x[1]=new gt(B[1],f),w=!0;break}}let O=f+1;if(w){let B=0,Y=Int32Array.from([Math.trunc(x[0].getX()),Math.trunc(x[1].getX())]);for(;O<o;O++){const Q=Te.findGuardPattern(r,Y[0],O,h,!1,m,A);if(Q!=null&&Math.abs(Y[0]-Q[0])<Te.MAX_PATTERN_DRIFT&&Math.abs(Y[1]-Q[1])<Te.MAX_PATTERN_DRIFT)Y=Q,B=0;else{if(B>Te.SKIPPED_ROW_COUNT_MAX)break;B++}}O-=B+1,x[2]=new gt(Y[0],O),x[3]=new gt(Y[1],O)}return O-f<Te.BARCODE_MIN_HEIGHT&&v.fill(x,null),x}static findGuardPattern(r,o,h,f,d,m,x){v.fillWithin(x,0,x.length,0);let w=o,A=0;for(;r.get(w,h)&&w>0&&A++<Te.MAX_PIXEL_DRIFT;)w--;let O=w,B=0,Y=m.length;for(let Q=d;O<f;O++)if(r.get(O,h)!==Q)x[B]++;else{if(B===Y-1){if(Te.patternMatchVariance(x,m,Te.MAX_INDIVIDUAL_VARIANCE)<Te.MAX_AVG_VARIANCE)return new Int32Array([w,O]);w+=x[0]+x[1],R.arraycopy(x,2,x,0,B-1),x[B-1]=0,x[B]=0,B--}else B++;x[B]=1,Q=!Q}return B===Y-1&&Te.patternMatchVariance(x,m,Te.MAX_INDIVIDUAL_VARIANCE)<Te.MAX_AVG_VARIANCE?new Int32Array([w,O-1]):null}static patternMatchVariance(r,o,h){let f=r.length,d=0,m=0;for(let A=0;A<f;A++)d+=r[A],m+=o[A];if(d<m)return 1/0;let x=d/m;h*=x;let w=0;for(let A=0;A<f;A++){let O=r[A],B=o[A]*x,Y=O>B?O-B:B-O;if(Y>h)return 1/0;w+=Y}return w/d}}Te.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Te.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Te.MAX_AVG_VARIANCE=.42,Te.MAX_INDIVIDUAL_VARIANCE=.8,Te.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Te.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Te.MAX_PIXEL_DRIFT=3,Te.MAX_PATTERN_DRIFT=5,Te.SKIPPED_ROW_COUNT_MAX=25,Te.ROW_STEP=5,Te.BARCODE_MIN_HEIGHT=10;class ci{constructor(r,o){if(o.length===0)throw new _;this.field=r;let h=o.length;if(h>1&&o[0]===0){let f=1;for(;f<h&&o[f]===0;)f++;f===h?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(h-f),R.arraycopy(o,f,this.coefficients,0,this.coefficients.length))}else this.coefficients=o}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(r){return this.coefficients[this.coefficients.length-1-r]}evaluateAt(r){if(r===0)return this.getCoefficient(0);if(r===1){let f=0;for(let d of this.coefficients)f=this.field.add(f,d);return f}let o=this.coefficients[0],h=this.coefficients.length;for(let f=1;f<h;f++)o=this.field.add(this.field.multiply(r,o),this.coefficients[f]);return o}add(r){if(!this.field.equals(r.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero())return r;if(r.isZero())return this;let o=this.coefficients,h=r.coefficients;if(o.length>h.length){let m=o;o=h,h=m}let f=new Int32Array(h.length),d=h.length-o.length;R.arraycopy(h,0,f,0,d);for(let m=d;m<h.length;m++)f[m]=this.field.add(o[m-d],h[m]);return new ci(this.field,f)}subtract(r){if(!this.field.equals(r.field))throw new _("ModulusPolys do not have same ModulusGF field");return r.isZero()?this:this.add(r.negative())}multiply(r){return r instanceof ci?this.multiplyOther(r):this.multiplyScalar(r)}multiplyOther(r){if(!this.field.equals(r.field))throw new _("ModulusPolys do not have same ModulusGF field");if(this.isZero()||r.isZero())return new ci(this.field,new Int32Array([0]));let o=this.coefficients,h=o.length,f=r.coefficients,d=f.length,m=new Int32Array(h+d-1);for(let x=0;x<h;x++){let w=o[x];for(let A=0;A<d;A++)m[x+A]=this.field.add(m[x+A],this.field.multiply(w,f[A]))}return new ci(this.field,m)}negative(){let r=this.coefficients.length,o=new Int32Array(r);for(let h=0;h<r;h++)o[h]=this.field.subtract(0,this.coefficients[h]);return new ci(this.field,o)}multiplyScalar(r){if(r===0)return new ci(this.field,new Int32Array([0]));if(r===1)return this;let o=this.coefficients.length,h=new Int32Array(o);for(let f=0;f<o;f++)h[f]=this.field.multiply(this.coefficients[f],r);return new ci(this.field,h)}multiplyByMonomial(r,o){if(r<0)throw new _;if(o===0)return new ci(this.field,new Int32Array([0]));let h=this.coefficients.length,f=new Int32Array(h+r);for(let d=0;d<h;d++)f[d]=this.field.multiply(this.coefficients[d],o);return new ci(this.field,f)}toString(){let r=new tt;for(let o=this.getDegree();o>=0;o--){let h=this.getCoefficient(o);h!==0&&(h<0?(r.append(" - "),h=-h):r.length()>0&&r.append(" + "),(o===0||h!==1)&&r.append(h),o!==0&&(o===1?r.append("x"):(r.append("x^"),r.append(o))))}return r.toString()}}class uu{add(r,o){return(r+o)%this.modulus}subtract(r,o){return(this.modulus+r-o)%this.modulus}exp(r){return this.expTable[r]}log(r){if(r===0)throw new _;return this.logTable[r]}inverse(r){if(r===0)throw new Ge;return this.expTable[this.modulus-this.logTable[r]-1]}multiply(r,o){return r===0||o===0?0:this.expTable[(this.logTable[r]+this.logTable[o])%(this.modulus-1)]}getSize(){return this.modulus}equals(r){return r===this}}class Wa extends uu{constructor(r,o){super(),this.modulus=r,this.expTable=new Int32Array(r),this.logTable=new Int32Array(r);let h=1;for(let f=0;f<r;f++)this.expTable[f]=h,h=h*o%r;for(let f=0;f<r-1;f++)this.logTable[this.expTable[f]]=f;this.zero=new ci(this,new Int32Array([0])),this.one=new ci(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(r,o){if(r<0)throw new _;if(o===0)return this.zero;let h=new Int32Array(r+1);return h[0]=o,new ci(this,h)}}Wa.PDF417_GF=new Wa(ce.NUMBER_OF_CODEWORDS,3);class _l{constructor(){this.field=Wa.PDF417_GF}decode(r,o,h){let f=new ci(this.field,r),d=new Int32Array(o),m=!1;for(let ht=o;ht>0;ht--){let ut=f.evaluateAt(this.field.exp(ht));d[o-ht]=ut,ut!==0&&(m=!0)}if(!m)return 0;let x=this.field.getOne();if(h!=null)for(const ht of h){let ut=this.field.exp(r.length-1-ht),yt=new ci(this.field,new Int32Array([this.field.subtract(0,ut),1]));x=x.multiply(yt)}let w=new ci(this.field,d),A=this.runEuclideanAlgorithm(this.field.buildMonomial(o,1),w,o),O=A[0],B=A[1],Y=this.findErrorLocations(O),Q=this.findErrorMagnitudes(B,O,Y);for(let ht=0;ht<Y.length;ht++){let ut=r.length-1-this.field.log(Y[ht]);if(ut<0)throw I.getChecksumInstance();r[ut]=this.field.subtract(r[ut],Q[ht])}return Y.length}runEuclideanAlgorithm(r,o,h){if(r.getDegree()<o.getDegree()){let Y=r;r=o,o=Y}let f=r,d=o,m=this.field.getZero(),x=this.field.getOne();for(;d.getDegree()>=Math.round(h/2);){let Y=f,Q=m;if(f=d,m=x,f.isZero())throw I.getChecksumInstance();d=Y;let ht=this.field.getZero(),ut=f.getCoefficient(f.getDegree()),yt=this.field.inverse(ut);for(;d.getDegree()>=f.getDegree()&&!d.isZero();){let Ct=d.getDegree()-f.getDegree(),zt=this.field.multiply(d.getCoefficient(d.getDegree()),yt);ht=ht.add(this.field.buildMonomial(Ct,zt)),d=d.subtract(f.multiplyByMonomial(Ct,zt))}x=ht.multiply(m).subtract(Q).negative()}let w=x.getCoefficient(0);if(w===0)throw I.getChecksumInstance();let A=this.field.inverse(w),O=x.multiply(A),B=d.multiply(A);return[O,B]}findErrorLocations(r){let o=r.getDegree(),h=new Int32Array(o),f=0;for(let d=1;d<this.field.getSize()&&f<o;d++)r.evaluateAt(d)===0&&(h[f]=this.field.inverse(d),f++);if(f!==o)throw I.getChecksumInstance();return h}findErrorMagnitudes(r,o,h){let f=o.getDegree(),d=new Int32Array(f);for(let A=1;A<=f;A++)d[f-A]=this.field.multiply(A,o.getCoefficient(A));let m=new ci(this.field,d),x=h.length,w=new Int32Array(x);for(let A=0;A<x;A++){let O=this.field.inverse(h[A]),B=this.field.subtract(0,r.evaluateAt(O)),Y=this.field.inverse(m.evaluateAt(O));w[A]=this.field.multiply(B,Y)}return w}}class pi{constructor(r,o,h,f,d){r instanceof pi?this.constructor_2(r):this.constructor_1(r,o,h,f,d)}constructor_1(r,o,h,f,d){const m=o==null||h==null,x=f==null||d==null;if(m&&x)throw new Z;m?(o=new gt(0,f.getY()),h=new gt(0,d.getY())):x&&(f=new gt(r.getWidth()-1,o.getY()),d=new gt(r.getWidth()-1,h.getY())),this.image=r,this.topLeft=o,this.bottomLeft=h,this.topRight=f,this.bottomRight=d,this.minX=Math.trunc(Math.min(o.getX(),h.getX())),this.maxX=Math.trunc(Math.max(f.getX(),d.getX())),this.minY=Math.trunc(Math.min(o.getY(),f.getY())),this.maxY=Math.trunc(Math.max(h.getY(),d.getY()))}constructor_2(r){this.image=r.image,this.topLeft=r.getTopLeft(),this.bottomLeft=r.getBottomLeft(),this.topRight=r.getTopRight(),this.bottomRight=r.getBottomRight(),this.minX=r.getMinX(),this.maxX=r.getMaxX(),this.minY=r.getMinY(),this.maxY=r.getMaxY()}static merge(r,o){return r==null?o:o==null?r:new pi(r.image,r.topLeft,r.bottomLeft,o.topRight,o.bottomRight)}addMissingRows(r,o,h){let f=this.topLeft,d=this.bottomLeft,m=this.topRight,x=this.bottomRight;if(r>0){let w=h?this.topLeft:this.topRight,A=Math.trunc(w.getY()-r);A<0&&(A=0);let O=new gt(w.getX(),A);h?f=O:m=O}if(o>0){let w=h?this.bottomLeft:this.bottomRight,A=Math.trunc(w.getY()+o);A>=this.image.getHeight()&&(A=this.image.getHeight()-1);let O=new gt(w.getX(),A);h?d=O:x=O}return new pi(this.image,f,d,m,x)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Ar{constructor(r,o,h,f){this.columnCount=r,this.errorCorrectionLevel=f,this.rowCountUpperPart=o,this.rowCountLowerPart=h,this.rowCount=o+h}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Wn{constructor(){this.buffer=""}static form(r,o){let h=-1;function f(m,x,w,A,O,B){if(m==="%%")return"%";if(o[++h]===void 0)return;m=A?parseInt(A.substr(1)):void 0;let Y=O?parseInt(O.substr(1)):void 0,Q;switch(B){case"s":Q=o[h];break;case"c":Q=o[h][0];break;case"f":Q=parseFloat(o[h]).toFixed(m);break;case"p":Q=parseFloat(o[h]).toPrecision(m);break;case"e":Q=parseFloat(o[h]).toExponential(m);break;case"x":Q=parseInt(o[h]).toString(Y||16);break;case"d":Q=parseFloat(parseInt(o[h],Y||10).toPrecision(m)).toFixed(0);break}Q=typeof Q=="object"?JSON.stringify(Q):(+Q).toString(Y);let ht=parseInt(w),ut=w&&w[0]+""=="0"?"0":" ";for(;Q.length<ht;)Q=x!==void 0?Q+ut:ut+Q;return Q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return r.replace(d,f)}format(r,...o){this.buffer+=Wn.form(r,o)}toString(){return this.buffer}}class Xn{constructor(r){this.boundingBox=new pi(r),this.codewords=new Array(r.getMaxY()-r.getMinY()+1)}getCodewordNearby(r){let o=this.getCodeword(r);if(o!=null)return o;for(let h=1;h<Xn.MAX_NEARBY_DISTANCE;h++){let f=this.imageRowToCodewordIndex(r)-h;if(f>=0&&(o=this.codewords[f],o!=null)||(f=this.imageRowToCodewordIndex(r)+h,f<this.codewords.length&&(o=this.codewords[f],o!=null)))return o}return null}imageRowToCodewordIndex(r){return r-this.boundingBox.getMinY()}setCodeword(r,o){this.codewords[this.imageRowToCodewordIndex(r)]=o}getCodeword(r){return this.codewords[this.imageRowToCodewordIndex(r)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const r=new Wn;let o=0;for(const h of this.codewords){if(h==null){r.format("%3d:    |   %n",o++);continue}r.format("%3d: %3d|%3d%n",o++,h.getRowNumber(),h.getValue())}return r.toString()}}Xn.MAX_NEARBY_DISTANCE=5;class jn{constructor(){this.values=new Map}setValue(r){r=Math.trunc(r);let o=this.values.get(r);o==null&&(o=0),o++,this.values.set(r,o)}getValue(){let r=-1,o=new Array;for(const[h,f]of this.values.entries()){const d={getKey:()=>h,getValue:()=>f};d.getValue()>r?(r=d.getValue(),o=[],o.push(d.getKey())):d.getValue()===r&&o.push(d.getKey())}return ce.toIntArray(o)}getConfidence(r){return this.values.get(r)}}class ws extends Xn{constructor(r,o){super(r),this._isLeft=o}setRowNumbers(){for(let r of this.getCodewords())r?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(r){let o=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(o,r);let h=this.getBoundingBox(),f=this._isLeft?h.getTopLeft():h.getTopRight(),d=this._isLeft?h.getBottomLeft():h.getBottomRight(),m=this.imageRowToCodewordIndex(Math.trunc(f.getY())),x=this.imageRowToCodewordIndex(Math.trunc(d.getY())),w=-1,A=1,O=0;for(let B=m;B<x;B++){if(o[B]==null)continue;let Y=o[B],Q=Y.getRowNumber()-w;if(Q===0)O++;else if(Q===1)A=Math.max(A,O),O=1,w=Y.getRowNumber();else if(Q<0||Y.getRowNumber()>=r.getRowCount()||Q>B)o[B]=null;else{let ht;A>2?ht=(A-2)*Q:ht=Q;let ut=ht>=B;for(let yt=1;yt<=ht&&!ut;yt++)ut=o[B-yt]!=null;ut?o[B]=null:(w=Y.getRowNumber(),O=1)}}}getRowHeights(){let r=this.getBarcodeMetadata();if(r==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(r);let o=new Int32Array(r.getRowCount());for(let h of this.getCodewords())if(h!=null){let f=h.getRowNumber();if(f>=o.length)continue;o[f]++}return o}adjustIncompleteIndicatorColumnRowNumbers(r){let o=this.getBoundingBox(),h=this._isLeft?o.getTopLeft():o.getTopRight(),f=this._isLeft?o.getBottomLeft():o.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(h.getY())),m=this.imageRowToCodewordIndex(Math.trunc(f.getY())),x=this.getCodewords(),w=-1;for(let A=d;A<m;A++){if(x[A]==null)continue;let O=x[A];O.setRowNumberAsRowIndicatorColumn();let B=O.getRowNumber()-w;B===0||(B===1?w=O.getRowNumber():O.getRowNumber()>=r.getRowCount()?x[A]=null:w=O.getRowNumber())}}getBarcodeMetadata(){let r=this.getCodewords(),o=new jn,h=new jn,f=new jn,d=new jn;for(let x of r){if(x==null)continue;x.setRowNumberAsRowIndicatorColumn();let w=x.getValue()%30,A=x.getRowNumber();switch(this._isLeft||(A+=2),A%3){case 0:h.setValue(w*3+1);break;case 1:d.setValue(w/3),f.setValue(w%3);break;case 2:o.setValue(w+1);break}}if(o.getValue().length===0||h.getValue().length===0||f.getValue().length===0||d.getValue().length===0||o.getValue()[0]<1||h.getValue()[0]+f.getValue()[0]<ce.MIN_ROWS_IN_BARCODE||h.getValue()[0]+f.getValue()[0]>ce.MAX_ROWS_IN_BARCODE)return null;let m=new Ar(o.getValue()[0],h.getValue()[0],f.getValue()[0],d.getValue()[0]);return this.removeIncorrectCodewords(r,m),m}removeIncorrectCodewords(r,o){for(let h=0;h<r.length;h++){let f=r[h];if(r[h]==null)continue;let d=f.getValue()%30,m=f.getRowNumber();if(m>o.getRowCount()){r[h]=null;continue}switch(this._isLeft||(m+=2),m%3){case 0:d*3+1!==o.getRowCountUpperPart()&&(r[h]=null);break;case 1:(Math.trunc(d/3)!==o.getErrorCorrectionLevel()||d%3!==o.getRowCountLowerPart())&&(r[h]=null);break;case 2:d+1!==o.getColumnCount()&&(r[h]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class kn{constructor(r,o){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=r,this.barcodeColumnCount=r.getColumnCount(),this.boundingBox=o,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let r=ce.MAX_CODEWORDS_IN_BARCODE,o;do o=r,r=this.adjustRowNumbersAndGetCount();while(r>0&&r<o);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(r){r?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let r=this.adjustRowNumbersByRow();if(r===0)return 0;for(let o=1;o<this.barcodeColumnCount+1;o++){let h=this.detectionResultColumns[o].getCodewords();for(let f=0;f<h.length;f++)h[f]!=null&&(h[f].hasValidRowNumber()||this.adjustRowNumbers(o,f,h))}return r}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let r=this.detectionResultColumns[0].getCodewords(),o=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let h=0;h<r.length;h++)if(r[h]!=null&&o[h]!=null&&r[h].getRowNumber()===o[h].getRowNumber())for(let f=1;f<=this.barcodeColumnCount;f++){let d=this.detectionResultColumns[f].getCodewords()[h];d!=null&&(d.setRowNumber(r[h].getRowNumber()),d.hasValidRowNumber()||(this.detectionResultColumns[f].getCodewords()[h]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let r=0,o=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let h=0;h<o.length;h++){if(o[h]==null)continue;let f=o[h].getRowNumber(),d=0;for(let m=this.barcodeColumnCount+1;m>0&&d<this.ADJUST_ROW_NUMBER_SKIP;m--){let x=this.detectionResultColumns[m].getCodewords()[h];x!=null&&(d=kn.adjustRowNumberIfValid(f,d,x),x.hasValidRowNumber()||r++)}}return r}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let r=0,o=this.detectionResultColumns[0].getCodewords();for(let h=0;h<o.length;h++){if(o[h]==null)continue;let f=o[h].getRowNumber(),d=0;for(let m=1;m<this.barcodeColumnCount+1&&d<this.ADJUST_ROW_NUMBER_SKIP;m++){let x=this.detectionResultColumns[m].getCodewords()[h];x!=null&&(d=kn.adjustRowNumberIfValid(f,d,x),x.hasValidRowNumber()||r++)}}return r}static adjustRowNumberIfValid(r,o,h){return h==null||h.hasValidRowNumber()||(h.isValidRowNumber(r)?(h.setRowNumber(r),o=0):++o),o}adjustRowNumbers(r,o,h){if(!this.detectionResultColumns[r-1])return;let f=h[o],d=this.detectionResultColumns[r-1].getCodewords(),m=d;this.detectionResultColumns[r+1]!=null&&(m=this.detectionResultColumns[r+1].getCodewords());let x=new Array(14);x[2]=d[o],x[3]=m[o],o>0&&(x[0]=h[o-1],x[4]=d[o-1],x[5]=m[o-1]),o>1&&(x[8]=h[o-2],x[10]=d[o-2],x[11]=m[o-2]),o<h.length-1&&(x[1]=h[o+1],x[6]=d[o+1],x[7]=m[o+1]),o<h.length-2&&(x[9]=h[o+2],x[12]=d[o+2],x[13]=m[o+2]);for(let w of x)if(kn.adjustRowNumber(f,w))return}static adjustRowNumber(r,o){return o==null?!1:o.hasValidRowNumber()&&o.getBucket()===r.getBucket()?(r.setRowNumber(o.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(r){this.boundingBox=r}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(r,o){this.detectionResultColumns[r]=o}getDetectionResultColumn(r){return this.detectionResultColumns[r]}toString(){let r=this.detectionResultColumns[0];r==null&&(r=this.detectionResultColumns[this.barcodeColumnCount+1]);let o=new Wn;for(let h=0;h<r.getCodewords().length;h++){o.format("CW %3d:",h);for(let f=0;f<this.barcodeColumnCount+2;f++){if(this.detectionResultColumns[f]==null){o.format("    |   ");continue}let d=this.detectionResultColumns[f].getCodewords()[h];if(d==null){o.format("    |   ");continue}o.format(" %3d|%3d",d.getRowNumber(),d.getValue())}o.format("%n")}return o.toString()}}class ns{constructor(r,o,h,f){this.rowNumber=ns.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(r),this.endX=Math.trunc(o),this.bucket=Math.trunc(h),this.value=Math.trunc(f)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(r){return r!==ns.BARCODE_ROW_UNKNOWN&&this.bucket===r%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(r){this.rowNumber=r}toString(){return this.rowNumber+"|"+this.value}}ns.BARCODE_ROW_UNKNOWN=-1;class qi{static initialize(){for(let r=0;r<ce.SYMBOL_TABLE.length;r++){let o=ce.SYMBOL_TABLE[r],h=o&1;for(let f=0;f<ce.BARS_IN_MODULE;f++){let d=0;for(;(o&1)===h;)d+=1,o>>=1;h=o&1,qi.RATIOS_TABLE[r]||(qi.RATIOS_TABLE[r]=new Array(ce.BARS_IN_MODULE)),qi.RATIOS_TABLE[r][ce.BARS_IN_MODULE-f-1]=Math.fround(d/ce.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(r){let o=qi.getDecodedCodewordValue(qi.sampleBitCounts(r));return o!==-1?o:qi.getClosestDecodedValue(r)}static sampleBitCounts(r){let o=lt.sum(r),h=new Int32Array(ce.BARS_IN_MODULE),f=0,d=0;for(let m=0;m<ce.MODULES_IN_CODEWORD;m++){let x=o/(2*ce.MODULES_IN_CODEWORD)+m*o/ce.MODULES_IN_CODEWORD;d+r[f]<=x&&(d+=r[f],f++),h[f]++}return h}static getDecodedCodewordValue(r){let o=qi.getBitValue(r);return ce.getCodeword(o)===-1?-1:o}static getBitValue(r){let o=0;for(let h=0;h<r.length;h++)for(let f=0;f<r[h];f++)o=o<<1|(h%2===0?1:0);return Math.trunc(o)}static getClosestDecodedValue(r){let o=lt.sum(r),h=new Array(ce.BARS_IN_MODULE);if(o>1)for(let m=0;m<h.length;m++)h[m]=Math.fround(r[m]/o);let f=vt.MAX_VALUE,d=-1;this.bSymbolTableReady||qi.initialize();for(let m=0;m<qi.RATIOS_TABLE.length;m++){let x=0,w=qi.RATIOS_TABLE[m];for(let A=0;A<ce.BARS_IN_MODULE;A++){let O=Math.fround(w[A]-h[A]);if(x+=Math.fround(O*O),x>=f)break}x<f&&(f=x,d=ce.SYMBOL_TABLE[m])}return d}}qi.bSymbolTableReady=!1,qi.RATIOS_TABLE=new Array(ce.SYMBOL_TABLE.length).map(L=>new Array(ce.BARS_IN_MODULE));class Hn{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(r){this.segmentIndex=r}getFileId(){return this.fileId}setFileId(r){this.fileId=r}getOptionalData(){return this.optionalData}setOptionalData(r){this.optionalData=r}isLastSegment(){return this.lastSegment}setLastSegment(r){this.lastSegment=r}getSegmentCount(){return this.segmentCount}setSegmentCount(r){this.segmentCount=r}getSender(){return this.sender||null}setSender(r){this.sender=r}getAddressee(){return this.addressee||null}setAddressee(r){this.addressee=r}getFileName(){return this.fileName}setFileName(r){this.fileName=r}getFileSize(){return this.fileSize}setFileSize(r){this.fileSize=r}getChecksum(){return this.checksum}setChecksum(r){this.checksum=r}getTimestamp(){return this.timestamp}setTimestamp(r){this.timestamp=r}}class wl{static parseLong(r,o=void 0){return parseInt(r,o)}}class bl extends p{}bl.kind="NullPointerException";class cu{writeBytes(r){this.writeBytesOffset(r,0,r.length)}writeBytesOffset(r,o,h){if(r==null)throw new bl;if(o<0||o>r.length||h<0||o+h>r.length||o+h<0)throw new D;if(h===0)return;for(let f=0;f<h;f++)this.write(r[o+f])}flush(){}close(){}}class fu extends p{}class du extends cu{constructor(r=32){if(super(),this.count=0,r<0)throw new _("Negative initial size: "+r);this.buf=new Uint8Array(r)}ensureCapacity(r){r-this.buf.length>0&&this.grow(r)}grow(r){let h=this.buf.length<<1;if(h-r<0&&(h=r),h<0){if(r<0)throw new fu;h=k.MAX_VALUE}this.buf=v.copyOfUint8Array(this.buf,h)}write(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1}writeBytesOffset(r,o,h){if(o<0||o>r.length||h<0||o+h-r.length>0)throw new D;this.ensureCapacity(this.count+h),R.arraycopy(r,o,this.buf,this.count,h),this.count+=h}writeTo(r){r.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return v.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(r){return new String(this.buf).toString()}toString_number(r){return new String(this.buf).toString()}close(){}}var Je;(function(L){L[L.ALPHA=0]="ALPHA",L[L.LOWER=1]="LOWER",L[L.MIXED=2]="MIXED",L[L.PUNCT=3]="PUNCT",L[L.ALPHA_SHIFT=4]="ALPHA_SHIFT",L[L.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Je||(Je={}));function El(){if(typeof window<"u")return window.BigInt||null;if(typeof hn<"u")return hn.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let En;function ss(L){if(typeof En>"u"&&(En=El()),En===null)throw new Error("BigInt is not supported!");return En(L)}function gu(){let L=[];L[0]=ss(1);let r=ss(900);L[1]=r;for(let o=2;o<16;o++)L[o]=L[o-1]*r;return L}class It{static decode(r,o){let h=new tt(""),f=V.ISO8859_1;h.enableDecoding(f);let d=1,m=r[d++],x=new Hn;for(;d<r[0];){switch(m){case It.TEXT_COMPACTION_MODE_LATCH:d=It.textCompaction(r,d,h);break;case It.BYTE_COMPACTION_MODE_LATCH:case It.BYTE_COMPACTION_MODE_LATCH_6:d=It.byteCompaction(m,r,f,d,h);break;case It.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:h.append(r[d++]);break;case It.NUMERIC_COMPACTION_MODE_LATCH:d=It.numericCompaction(r,d,h);break;case It.ECI_CHARSET:V.getCharacterSetECIByValue(r[d++]);break;case It.ECI_GENERAL_PURPOSE:d+=2;break;case It.ECI_USER_DEFINED:d++;break;case It.BEGIN_MACRO_PDF417_CONTROL_BLOCK:d=It.decodeMacroBlock(r,d,x);break;case It.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case It.MACRO_PDF417_TERMINATOR:throw new z;default:d--,d=It.textCompaction(r,d,h);break}if(d<r.length)m=r[d++];else throw z.getFormatInstance()}if(h.length()===0)throw z.getFormatInstance();let w=new me(null,h.toString(),null,o);return w.setOther(x),w}static decodeMacroBlock(r,o,h){if(o+It.NUMBER_OF_SEQUENCE_CODEWORDS>r[0])throw z.getFormatInstance();let f=new Int32Array(It.NUMBER_OF_SEQUENCE_CODEWORDS);for(let x=0;x<It.NUMBER_OF_SEQUENCE_CODEWORDS;x++,o++)f[x]=r[o];h.setSegmentIndex(k.parseInt(It.decodeBase900toBase10(f,It.NUMBER_OF_SEQUENCE_CODEWORDS)));let d=new tt;o=It.textCompaction(r,o,d),h.setFileId(d.toString());let m=-1;for(r[o]===It.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(m=o+1);o<r[0];)switch(r[o]){case It.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(o++,r[o]){case It.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let x=new tt;o=It.textCompaction(r,o+1,x),h.setFileName(x.toString());break;case It.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let w=new tt;o=It.textCompaction(r,o+1,w),h.setSender(w.toString());break;case It.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let A=new tt;o=It.textCompaction(r,o+1,A),h.setAddressee(A.toString());break;case It.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let O=new tt;o=It.numericCompaction(r,o+1,O),h.setSegmentCount(k.parseInt(O.toString()));break;case It.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let B=new tt;o=It.numericCompaction(r,o+1,B),h.setTimestamp(wl.parseLong(B.toString()));break;case It.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let Y=new tt;o=It.numericCompaction(r,o+1,Y),h.setChecksum(k.parseInt(Y.toString()));break;case It.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let Q=new tt;o=It.numericCompaction(r,o+1,Q),h.setFileSize(wl.parseLong(Q.toString()));break;default:throw z.getFormatInstance()}break;case It.MACRO_PDF417_TERMINATOR:o++,h.setLastSegment(!0);break;default:throw z.getFormatInstance()}if(m!==-1){let x=o-m;h.isLastSegment()&&x--,h.setOptionalData(v.copyOfRange(r,m,m+x))}return o}static textCompaction(r,o,h){let f=new Int32Array((r[0]-o)*2),d=new Int32Array((r[0]-o)*2),m=0,x=!1;for(;o<r[0]&&!x;){let w=r[o++];if(w<It.TEXT_COMPACTION_MODE_LATCH)f[m]=w/30,f[m+1]=w%30,m+=2;else switch(w){case It.TEXT_COMPACTION_MODE_LATCH:f[m++]=It.TEXT_COMPACTION_MODE_LATCH;break;case It.BYTE_COMPACTION_MODE_LATCH:case It.BYTE_COMPACTION_MODE_LATCH_6:case It.NUMERIC_COMPACTION_MODE_LATCH:case It.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case It.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case It.MACRO_PDF417_TERMINATOR:o--,x=!0;break;case It.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f[m]=It.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,w=r[o++],d[m]=w,m++;break}}return It.decodeTextCompaction(f,d,m,h),o}static decodeTextCompaction(r,o,h,f){let d=Je.ALPHA,m=Je.ALPHA,x=0;for(;x<h;){let w=r[x],A="";switch(d){case Je.ALPHA:if(w<26)A=String.fromCharCode(65+w);else switch(w){case 26:A=" ";break;case It.LL:d=Je.LOWER;break;case It.ML:d=Je.MIXED;break;case It.PS:m=d,d=Je.PUNCT_SHIFT;break;case It.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[x]);break;case It.TEXT_COMPACTION_MODE_LATCH:d=Je.ALPHA;break}break;case Je.LOWER:if(w<26)A=String.fromCharCode(97+w);else switch(w){case 26:A=" ";break;case It.AS:m=d,d=Je.ALPHA_SHIFT;break;case It.ML:d=Je.MIXED;break;case It.PS:m=d,d=Je.PUNCT_SHIFT;break;case It.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[x]);break;case It.TEXT_COMPACTION_MODE_LATCH:d=Je.ALPHA;break}break;case Je.MIXED:if(w<It.PL)A=It.MIXED_CHARS[w];else switch(w){case It.PL:d=Je.PUNCT;break;case 26:A=" ";break;case It.LL:d=Je.LOWER;break;case It.AL:d=Je.ALPHA;break;case It.PS:m=d,d=Je.PUNCT_SHIFT;break;case It.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[x]);break;case It.TEXT_COMPACTION_MODE_LATCH:d=Je.ALPHA;break}break;case Je.PUNCT:if(w<It.PAL)A=It.PUNCT_CHARS[w];else switch(w){case It.PAL:d=Je.ALPHA;break;case It.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[x]);break;case It.TEXT_COMPACTION_MODE_LATCH:d=Je.ALPHA;break}break;case Je.ALPHA_SHIFT:if(d=m,w<26)A=String.fromCharCode(65+w);else switch(w){case 26:A=" ";break;case It.TEXT_COMPACTION_MODE_LATCH:d=Je.ALPHA;break}break;case Je.PUNCT_SHIFT:if(d=m,w<It.PAL)A=It.PUNCT_CHARS[w];else switch(w){case It.PAL:d=Je.ALPHA;break;case It.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[x]);break;case It.TEXT_COMPACTION_MODE_LATCH:d=Je.ALPHA;break}break}A!==""&&f.append(A),x++}}static byteCompaction(r,o,h,f,d){let m=new du,x=0,w=0,A=!1;switch(r){case It.BYTE_COMPACTION_MODE_LATCH:let O=new Int32Array(6),B=o[f++];for(;f<o[0]&&!A;)switch(O[x++]=B,w=900*w+B,B=o[f++],B){case It.TEXT_COMPACTION_MODE_LATCH:case It.BYTE_COMPACTION_MODE_LATCH:case It.NUMERIC_COMPACTION_MODE_LATCH:case It.BYTE_COMPACTION_MODE_LATCH_6:case It.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case It.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case It.MACRO_PDF417_TERMINATOR:f--,A=!0;break;default:if(x%5===0&&x>0){for(let Y=0;Y<6;++Y)m.write(Number(ss(w)>>ss(8*(5-Y))));w=0,x=0}break}f===o[0]&&B<It.TEXT_COMPACTION_MODE_LATCH&&(O[x++]=B);for(let Y=0;Y<x;Y++)m.write(O[Y]);break;case It.BYTE_COMPACTION_MODE_LATCH_6:for(;f<o[0]&&!A;){let Y=o[f++];if(Y<It.TEXT_COMPACTION_MODE_LATCH)x++,w=900*w+Y;else switch(Y){case It.TEXT_COMPACTION_MODE_LATCH:case It.BYTE_COMPACTION_MODE_LATCH:case It.NUMERIC_COMPACTION_MODE_LATCH:case It.BYTE_COMPACTION_MODE_LATCH_6:case It.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case It.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case It.MACRO_PDF417_TERMINATOR:f--,A=!0;break}if(x%5===0&&x>0){for(let Q=0;Q<6;++Q)m.write(Number(ss(w)>>ss(8*(5-Q))));w=0,x=0}}break}return d.append(ot.decode(m.toByteArray(),h)),f}static numericCompaction(r,o,h){let f=0,d=!1,m=new Int32Array(It.MAX_NUMERIC_CODEWORDS);for(;o<r[0]&&!d;){let x=r[o++];if(o===r[0]&&(d=!0),x<It.TEXT_COMPACTION_MODE_LATCH)m[f]=x,f++;else switch(x){case It.TEXT_COMPACTION_MODE_LATCH:case It.BYTE_COMPACTION_MODE_LATCH:case It.BYTE_COMPACTION_MODE_LATCH_6:case It.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case It.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case It.MACRO_PDF417_TERMINATOR:o--,d=!0;break}(f%It.MAX_NUMERIC_CODEWORDS===0||x===It.NUMERIC_COMPACTION_MODE_LATCH||d)&&f>0&&(h.append(It.decodeBase900toBase10(m,f)),f=0)}return o}static decodeBase900toBase10(r,o){let h=ss(0);for(let d=0;d<o;d++)h+=It.EXP900[o-d-1]*ss(r[d]);let f=h.toString();if(f.charAt(0)!=="1")throw new z;return f.substring(1)}}It.TEXT_COMPACTION_MODE_LATCH=900,It.BYTE_COMPACTION_MODE_LATCH=901,It.NUMERIC_COMPACTION_MODE_LATCH=902,It.BYTE_COMPACTION_MODE_LATCH_6=924,It.ECI_USER_DEFINED=925,It.ECI_GENERAL_PURPOSE=926,It.ECI_CHARSET=927,It.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,It.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,It.MACRO_PDF417_TERMINATOR=922,It.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,It.MAX_NUMERIC_CODEWORDS=15,It.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,It.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,It.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,It.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,It.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,It.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,It.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,It.PL=25,It.LL=27,It.AS=27,It.ML=28,It.AL=28,It.PS=29,It.PAL=29,It.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,It.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",It.EXP900=El()?gu():[],It.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Me{constructor(){}static decode(r,o,h,f,d,m,x){let w=new pi(r,o,h,f,d),A=null,O=null,B;for(let ht=!0;;ht=!1){if(o!=null&&(A=Me.getRowIndicatorColumn(r,w,o,!0,m,x)),f!=null&&(O=Me.getRowIndicatorColumn(r,w,f,!1,m,x)),B=Me.merge(A,O),B==null)throw Z.getNotFoundInstance();let ut=B.getBoundingBox();if(ht&&ut!=null&&(ut.getMinY()<w.getMinY()||ut.getMaxY()>w.getMaxY()))w=ut;else break}B.setBoundingBox(w);let Y=B.getBarcodeColumnCount()+1;B.setDetectionResultColumn(0,A),B.setDetectionResultColumn(Y,O);let Q=A!=null;for(let ht=1;ht<=Y;ht++){let ut=Q?ht:Y-ht;if(B.getDetectionResultColumn(ut)!==void 0)continue;let yt;ut===0||ut===Y?yt=new ws(w,ut===0):yt=new Xn(w),B.setDetectionResultColumn(ut,yt);let Ct=-1,zt=Ct;for(let Wt=w.getMinY();Wt<=w.getMaxY();Wt++){if(Ct=Me.getStartColumn(B,ut,Wt,Q),Ct<0||Ct>w.getMaxX()){if(zt===-1)continue;Ct=zt}let Bt=Me.detectCodeword(r,w.getMinX(),w.getMaxX(),Q,Ct,Wt,m,x);Bt!=null&&(yt.setCodeword(Wt,Bt),zt=Ct,m=Math.min(m,Bt.getWidth()),x=Math.max(x,Bt.getWidth()))}}return Me.createDecoderResult(B)}static merge(r,o){if(r==null&&o==null)return null;let h=Me.getBarcodeMetadata(r,o);if(h==null)return null;let f=pi.merge(Me.adjustBoundingBox(r),Me.adjustBoundingBox(o));return new kn(h,f)}static adjustBoundingBox(r){if(r==null)return null;let o=r.getRowHeights();if(o==null)return null;let h=Me.getMax(o),f=0;for(let x of o)if(f+=h-x,x>0)break;let d=r.getCodewords();for(let x=0;f>0&&d[x]==null;x++)f--;let m=0;for(let x=o.length-1;x>=0&&(m+=h-o[x],!(o[x]>0));x--);for(let x=d.length-1;m>0&&d[x]==null;x--)m--;return r.getBoundingBox().addMissingRows(f,m,r.isLeft())}static getMax(r){let o=-1;for(let h of r)o=Math.max(o,h);return o}static getBarcodeMetadata(r,o){let h;if(r==null||(h=r.getBarcodeMetadata())==null)return o==null?null:o.getBarcodeMetadata();let f;return o==null||(f=o.getBarcodeMetadata())==null?h:h.getColumnCount()!==f.getColumnCount()&&h.getErrorCorrectionLevel()!==f.getErrorCorrectionLevel()&&h.getRowCount()!==f.getRowCount()?null:h}static getRowIndicatorColumn(r,o,h,f,d,m){let x=new ws(o,f);for(let w=0;w<2;w++){let A=w===0?1:-1,O=Math.trunc(Math.trunc(h.getX()));for(let B=Math.trunc(Math.trunc(h.getY()));B<=o.getMaxY()&&B>=o.getMinY();B+=A){let Y=Me.detectCodeword(r,0,r.getWidth(),f,O,B,d,m);Y!=null&&(x.setCodeword(B,Y),f?O=Y.getStartX():O=Y.getEndX())}}return x}static adjustCodewordCount(r,o){let h=o[0][1],f=h.getValue(),d=r.getBarcodeColumnCount()*r.getBarcodeRowCount()-Me.getNumberOfECCodeWords(r.getBarcodeECLevel());if(f.length===0){if(d<1||d>ce.MAX_CODEWORDS_IN_BARCODE)throw Z.getNotFoundInstance();h.setValue(d)}else f[0]!==d&&h.setValue(d)}static createDecoderResult(r){let o=Me.createBarcodeMatrix(r);Me.adjustCodewordCount(r,o);let h=new Array,f=new Int32Array(r.getBarcodeRowCount()*r.getBarcodeColumnCount()),d=[],m=new Array;for(let w=0;w<r.getBarcodeRowCount();w++)for(let A=0;A<r.getBarcodeColumnCount();A++){let O=o[w][A+1].getValue(),B=w*r.getBarcodeColumnCount()+A;O.length===0?h.push(B):O.length===1?f[B]=O[0]:(m.push(B),d.push(O))}let x=new Array(d.length);for(let w=0;w<x.length;w++)x[w]=d[w];return Me.createDecoderResultFromAmbiguousValues(r.getBarcodeECLevel(),f,ce.toIntArray(h),ce.toIntArray(m),x)}static createDecoderResultFromAmbiguousValues(r,o,h,f,d){let m=new Int32Array(f.length),x=100;for(;x-- >0;){for(let w=0;w<m.length;w++)o[f[w]]=d[w][m[w]];try{return Me.decodeCodewords(o,r,h)}catch(w){if(!(w instanceof I))throw w}if(m.length===0)throw I.getChecksumInstance();for(let w=0;w<m.length;w++)if(m[w]<d[w].length-1){m[w]++;break}else if(m[w]=0,w===m.length-1)throw I.getChecksumInstance()}throw I.getChecksumInstance()}static createBarcodeMatrix(r){let o=Array.from({length:r.getBarcodeRowCount()},()=>new Array(r.getBarcodeColumnCount()+2));for(let f=0;f<o.length;f++)for(let d=0;d<o[f].length;d++)o[f][d]=new jn;let h=0;for(let f of r.getDetectionResultColumns()){if(f!=null){for(let d of f.getCodewords())if(d!=null){let m=d.getRowNumber();if(m>=0){if(m>=o.length)continue;o[m][h].setValue(d.getValue())}}}h++}return o}static isValidBarcodeColumn(r,o){return o>=0&&o<=r.getBarcodeColumnCount()+1}static getStartColumn(r,o,h,f){let d=f?1:-1,m=null;if(Me.isValidBarcodeColumn(r,o-d)&&(m=r.getDetectionResultColumn(o-d).getCodeword(h)),m!=null)return f?m.getEndX():m.getStartX();if(m=r.getDetectionResultColumn(o).getCodewordNearby(h),m!=null)return f?m.getStartX():m.getEndX();if(Me.isValidBarcodeColumn(r,o-d)&&(m=r.getDetectionResultColumn(o-d).getCodewordNearby(h)),m!=null)return f?m.getEndX():m.getStartX();let x=0;for(;Me.isValidBarcodeColumn(r,o-d);){o-=d;for(let w of r.getDetectionResultColumn(o).getCodewords())if(w!=null)return(f?w.getEndX():w.getStartX())+d*x*(w.getEndX()-w.getStartX());x++}return f?r.getBoundingBox().getMinX():r.getBoundingBox().getMaxX()}static detectCodeword(r,o,h,f,d,m,x,w){d=Me.adjustCodewordStartColumn(r,o,h,f,d,m);let A=Me.getModuleBitCount(r,o,h,f,d,m);if(A==null)return null;let O,B=lt.sum(A);if(f)O=d+B;else{for(let ht=0;ht<A.length/2;ht++){let ut=A[ht];A[ht]=A[A.length-1-ht],A[A.length-1-ht]=ut}O=d,d=O-B}if(!Me.checkCodewordSkew(B,x,w))return null;let Y=qi.getDecodedValue(A),Q=ce.getCodeword(Y);return Q===-1?null:new ns(d,O,Me.getCodewordBucketNumber(Y),Q)}static getModuleBitCount(r,o,h,f,d,m){let x=d,w=new Int32Array(8),A=0,O=f?1:-1,B=f;for(;(f?x<h:x>=o)&&A<w.length;)r.get(x,m)===B?(w[A]++,x+=O):(A++,B=!B);return A===w.length||x===(f?h:o)&&A===w.length-1?w:null}static getNumberOfECCodeWords(r){return 2<<r}static adjustCodewordStartColumn(r,o,h,f,d,m){let x=d,w=f?-1:1;for(let A=0;A<2;A++){for(;(f?x>=o:x<h)&&f===r.get(x,m);){if(Math.abs(d-x)>Me.CODEWORD_SKEW_SIZE)return d;x+=w}w=-w,f=!f}return x}static checkCodewordSkew(r,o,h){return o-Me.CODEWORD_SKEW_SIZE<=r&&r<=h+Me.CODEWORD_SKEW_SIZE}static decodeCodewords(r,o,h){if(r.length===0)throw z.getFormatInstance();let f=1<<o+1,d=Me.correctErrors(r,h,f);Me.verifyCodewordCount(r,f);let m=It.decode(r,""+o);return m.setErrorsCorrected(d),m.setErasures(h.length),m}static correctErrors(r,o,h){if(o!=null&&o.length>h/2+Me.MAX_ERRORS||h<0||h>Me.MAX_EC_CODEWORDS)throw I.getChecksumInstance();return Me.errorCorrection.decode(r,h,o)}static verifyCodewordCount(r,o){if(r.length<4)throw z.getFormatInstance();let h=r[0];if(h>r.length)throw z.getFormatInstance();if(h===0)if(o<r.length)r[0]=r.length-o;else throw z.getFormatInstance()}static getBitCountForCodeword(r){let o=new Int32Array(8),h=0,f=o.length-1;for(;!((r&1)!==h&&(h=r&1,f--,f<0));)o[f]++,r>>=1;return o}static getCodewordBucketNumber(r){return r instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(r):this.getCodewordBucketNumber_number(r)}static getCodewordBucketNumber_number(r){return Me.getCodewordBucketNumber(Me.getBitCountForCodeword(r))}static getCodewordBucketNumber_Int32Array(r){return(r[0]-r[2]+r[4]-r[6]+9)%9}static toString(r){let o=new Wn;for(let h=0;h<r.length;h++){o.format("Row %2d: ",h);for(let f=0;f<r[h].length;f++){let d=r[h][f];d.getValue().length===0?o.format("        ",null):o.format("%4d(%2d)",d.getValue()[0],d.getConfidence(d.getValue()[0]))}o.format("%n")}return o.toString()}}Me.CODEWORD_SKEW_SIZE=2,Me.MAX_ERRORS=3,Me.MAX_EC_CODEWORDS=512,Me.errorCorrection=new _l;class Ni{decode(r,o=null){let h=Ni.decode(r,o,!1);if(h==null||h.length===0||h[0]==null)throw Z.getNotFoundInstance();return h[0]}decodeMultiple(r,o=null){try{return Ni.decode(r,o,!0)}catch(h){throw h instanceof z||h instanceof I?Z.getNotFoundInstance():h}}static decode(r,o,h){const f=new Array,d=Te.detectMultiple(r,o,h);for(const m of d.getPoints()){const x=Me.decode(d.getBits(),m[4],m[5],m[6],m[7],Ni.getMinCodewordWidth(m),Ni.getMaxCodewordWidth(m)),w=new mt(x.getText(),x.getRawBytes(),void 0,m,Vt.PDF_417);w.putMetadata(te.ERROR_CORRECTION_LEVEL,x.getECLevel());const A=x.getOther();A!=null&&w.putMetadata(te.PDF417_EXTRA_METADATA,A),f.push(w)}return f.map(m=>m)}static getMaxWidth(r,o){return r==null||o==null?0:Math.trunc(Math.abs(r.getX()-o.getX()))}static getMinWidth(r,o){return r==null||o==null?k.MAX_VALUE:Math.trunc(Math.abs(r.getX()-o.getX()))}static getMaxCodewordWidth(r){return Math.floor(Math.max(Math.max(Ni.getMaxWidth(r[0],r[4]),Ni.getMaxWidth(r[6],r[2])*ce.MODULES_IN_CODEWORD/ce.MODULES_IN_STOP_PATTERN),Math.max(Ni.getMaxWidth(r[1],r[5]),Ni.getMaxWidth(r[7],r[3])*ce.MODULES_IN_CODEWORD/ce.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(r){return Math.floor(Math.min(Math.min(Ni.getMinWidth(r[0],r[4]),Ni.getMinWidth(r[6],r[2])*ce.MODULES_IN_CODEWORD/ce.MODULES_IN_STOP_PATTERN),Math.min(Ni.getMinWidth(r[1],r[5]),Ni.getMinWidth(r[7],r[3])*ce.MODULES_IN_CODEWORD/ce.MODULES_IN_STOP_PATTERN)))}reset(){}}class Rr extends p{}Rr.kind="ReaderException";class Il{constructor(r,o){this.verbose=r===!0,o&&this.setHints(o)}decode(r,o){return o&&this.setHints(o),this.decodeInternal(r)}decodeWithState(r){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(r)}setHints(r){this.hints=r;const o=!n(r)&&r.get(K.TRY_HARDER)===!0,h=n(r)?null:r.get(K.POSSIBLE_FORMATS),f=new Array;if(!n(h)){const d=h.some(m=>m===Vt.UPC_A||m===Vt.UPC_E||m===Vt.EAN_13||m===Vt.EAN_8||m===Vt.CODABAR||m===Vt.CODE_39||m===Vt.CODE_93||m===Vt.CODE_128||m===Vt.ITF||m===Vt.RSS_14||m===Vt.RSS_EXPANDED);d&&!o&&f.push(new Zs(r,this.verbose)),h.includes(Vt.QR_CODE)&&f.push(new Ln),h.includes(Vt.DATA_MATRIX)&&f.push(new mi),h.includes(Vt.AZTEC)&&f.push(new Mi),h.includes(Vt.PDF_417)&&f.push(new Ni),d&&o&&f.push(new Zs(r,this.verbose))}f.length===0&&(o||f.push(new Zs(r,this.verbose)),f.push(new Ln),f.push(new mi),f.push(new Mi),f.push(new Ni),o&&f.push(new Zs(r,this.verbose))),this.readers=f}reset(){if(this.readers!==null)for(const r of this.readers)r.reset()}decodeInternal(r){if(this.readers===null)throw new Rr("No readers where selected, nothing can be read.");for(const o of this.readers)try{return o.decode(r,this.hints)}catch(h){if(h instanceof Rr)continue}throw new Z("No MultiFormat Readers were able to detect the code.")}}class mu extends Pt{constructor(r=null,o=500){const h=new Il;h.setHints(r),super(h,o)}decodeBitmap(r){return this.reader.decodeWithState(r)}}class pu extends Pt{constructor(r=500){super(new Ni,r)}}class yu extends Pt{constructor(r=500){super(new Ln,r)}}var Xa;(function(L){L[L.ERROR_CORRECTION=0]="ERROR_CORRECTION",L[L.CHARACTER_SET=1]="CHARACTER_SET",L[L.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",L[L.MIN_SIZE=3]="MIN_SIZE",L[L.MAX_SIZE=4]="MAX_SIZE",L[L.MARGIN=5]="MARGIN",L[L.PDF417_COMPACT=6]="PDF417_COMPACT",L[L.PDF417_COMPACTION=7]="PDF417_COMPACTION",L[L.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",L[L.AZTEC_LAYERS=9]="AZTEC_LAYERS",L[L.QR_VERSION=10]="QR_VERSION"})(Xa||(Xa={}));var Si=Xa;class ja{constructor(r){this.field=r,this.cachedGenerators=[],this.cachedGenerators.push(new Ce(r,Int32Array.from([1])))}buildGenerator(r){const o=this.cachedGenerators;if(r>=o.length){let h=o[o.length-1];const f=this.field;for(let d=o.length;d<=r;d++){const m=h.multiply(new Ce(f,Int32Array.from([1,f.exp(d-1+f.getGeneratorBase())])));o.push(m),h=m}}return o[r]}encode(r,o){if(o===0)throw new _("No error correction bytes");const h=r.length-o;if(h<=0)throw new _("No data bytes provided");const f=this.buildGenerator(o),d=new Int32Array(h);R.arraycopy(r,0,d,0,h);let m=new Ce(this.field,d);m=m.multiplyByMonomial(o,1);const w=m.divide(f)[1].getCoefficients(),A=o-w.length;for(let O=0;O<A;O++)r[h+O]=0;R.arraycopy(w,0,r,h+A,w.length)}}class fi{constructor(){}static applyMaskPenaltyRule1(r){return fi.applyMaskPenaltyRule1Internal(r,!0)+fi.applyMaskPenaltyRule1Internal(r,!1)}static applyMaskPenaltyRule2(r){let o=0;const h=r.getArray(),f=r.getWidth(),d=r.getHeight();for(let m=0;m<d-1;m++){const x=h[m];for(let w=0;w<f-1;w++){const A=x[w];A===x[w+1]&&A===h[m+1][w]&&A===h[m+1][w+1]&&o++}}return fi.N2*o}static applyMaskPenaltyRule3(r){let o=0;const h=r.getArray(),f=r.getWidth(),d=r.getHeight();for(let m=0;m<d;m++)for(let x=0;x<f;x++){const w=h[m];x+6<f&&w[x]===1&&w[x+1]===0&&w[x+2]===1&&w[x+3]===1&&w[x+4]===1&&w[x+5]===0&&w[x+6]===1&&(fi.isWhiteHorizontal(w,x-4,x)||fi.isWhiteHorizontal(w,x+7,x+11))&&o++,m+6<d&&h[m][x]===1&&h[m+1][x]===0&&h[m+2][x]===1&&h[m+3][x]===1&&h[m+4][x]===1&&h[m+5][x]===0&&h[m+6][x]===1&&(fi.isWhiteVertical(h,x,m-4,m)||fi.isWhiteVertical(h,x,m+7,m+11))&&o++}return o*fi.N3}static isWhiteHorizontal(r,o,h){o=Math.max(o,0),h=Math.min(h,r.length);for(let f=o;f<h;f++)if(r[f]===1)return!1;return!0}static isWhiteVertical(r,o,h,f){h=Math.max(h,0),f=Math.min(f,r.length);for(let d=h;d<f;d++)if(r[d][o]===1)return!1;return!0}static applyMaskPenaltyRule4(r){let o=0;const h=r.getArray(),f=r.getWidth(),d=r.getHeight();for(let w=0;w<d;w++){const A=h[w];for(let O=0;O<f;O++)A[O]===1&&o++}const m=r.getHeight()*r.getWidth();return Math.floor(Math.abs(o*2-m)*10/m)*fi.N4}static getDataMaskBit(r,o,h){let f,d;switch(r){case 0:f=h+o&1;break;case 1:f=h&1;break;case 2:f=o%3;break;case 3:f=(h+o)%3;break;case 4:f=Math.floor(h/2)+Math.floor(o/3)&1;break;case 5:d=h*o,f=(d&1)+d%3;break;case 6:d=h*o,f=(d&1)+d%3&1;break;case 7:d=h*o,f=d%3+(h+o&1)&1;break;default:throw new _("Invalid mask pattern: "+r)}return f===0}static applyMaskPenaltyRule1Internal(r,o){let h=0;const f=o?r.getHeight():r.getWidth(),d=o?r.getWidth():r.getHeight(),m=r.getArray();for(let x=0;x<f;x++){let w=0,A=-1;for(let O=0;O<d;O++){const B=o?m[x][O]:m[O][x];B===A?w++:(w>=5&&(h+=fi.N1+(w-5)),w=1,A=B)}w>=5&&(h+=fi.N1+(w-5))}return h}}fi.N1=3,fi.N2=3,fi.N3=40,fi.N4=10;class Jr{constructor(r,o){this.width=r,this.height=o;const h=new Array(o);for(let f=0;f!==o;f++)h[f]=new Uint8Array(r);this.bytes=h}getHeight(){return this.height}getWidth(){return this.width}get(r,o){return this.bytes[o][r]}getArray(){return this.bytes}setNumber(r,o,h){this.bytes[o][r]=h}setBoolean(r,o,h){this.bytes[o][r]=h?1:0}clear(r){for(const o of this.bytes)v.fill(o,r)}equals(r){if(!(r instanceof Jr))return!1;const o=r;if(this.width!==o.width||this.height!==o.height)return!1;for(let h=0,f=this.height;h<f;++h){const d=this.bytes[h],m=o.bytes[h];for(let x=0,w=this.width;x<w;++x)if(d[x]!==m[x])return!1}return!0}toString(){const r=new tt;for(let o=0,h=this.height;o<h;++o){const f=this.bytes[o];for(let d=0,m=this.width;d<m;++d)switch(f[d]){case 0:r.append(" 0");break;case 1:r.append(" 1");break;default:r.append("  ");break}r.append(`
`)}return r.toString()}}class bs{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const r=new tt;return r.append(`<<
`),r.append(" mode: "),r.append(this.mode?this.mode.toString():"null"),r.append(`
 ecLevel: `),r.append(this.ecLevel?this.ecLevel.toString():"null"),r.append(`
 version: `),r.append(this.version?this.version.toString():"null"),r.append(`
 maskPattern: `),r.append(this.maskPattern.toString()),this.matrix?(r.append(`
 matrix:
`),r.append(this.matrix.toString())):r.append(`
 matrix: null
`),r.append(`>>
`),r.toString()}setMode(r){this.mode=r}setECLevel(r){this.ecLevel=r}setVersion(r){this.version=r}setMaskPattern(r){this.maskPattern=r}setMatrix(r){this.matrix=r}static isValidMaskPattern(r){return r>=0&&r<bs.NUM_MASK_PATTERNS}}bs.NUM_MASK_PATTERNS=8;class fe extends p{}fe.kind="WriterException";class Zt{constructor(){}static clearMatrix(r){r.clear(255)}static buildMatrix(r,o,h,f,d){Zt.clearMatrix(d),Zt.embedBasicPatterns(h,d),Zt.embedTypeInfo(o,f,d),Zt.maybeEmbedVersionInfo(h,d),Zt.embedDataBits(r,f,d)}static embedBasicPatterns(r,o){Zt.embedPositionDetectionPatternsAndSeparators(o),Zt.embedDarkDotAtLeftBottomCorner(o),Zt.maybeEmbedPositionAdjustmentPatterns(r,o),Zt.embedTimingPatterns(o)}static embedTypeInfo(r,o,h){const f=new X;Zt.makeTypeInfoBits(r,o,f);for(let d=0,m=f.getSize();d<m;++d){const x=f.get(f.getSize()-1-d),w=Zt.TYPE_INFO_COORDINATES[d],A=w[0],O=w[1];if(h.setBoolean(A,O,x),d<8){const B=h.getWidth()-d-1;h.setBoolean(B,8,x)}else{const Y=h.getHeight()-7+(d-8);h.setBoolean(8,Y,x)}}}static maybeEmbedVersionInfo(r,o){if(r.getVersionNumber()<7)return;const h=new X;Zt.makeVersionInfoBits(r,h);let f=6*3-1;for(let d=0;d<6;++d)for(let m=0;m<3;++m){const x=h.get(f);f--,o.setBoolean(d,o.getHeight()-11+m,x),o.setBoolean(o.getHeight()-11+m,d,x)}}static embedDataBits(r,o,h){let f=0,d=-1,m=h.getWidth()-1,x=h.getHeight()-1;for(;m>0;){for(m===6&&(m-=1);x>=0&&x<h.getHeight();){for(let w=0;w<2;++w){const A=m-w;if(!Zt.isEmpty(h.get(A,x)))continue;let O;f<r.getSize()?(O=r.get(f),++f):O=!1,o!==255&&fi.getDataMaskBit(o,A,x)&&(O=!O),h.setBoolean(A,x,O)}x+=d}d=-d,x+=d,m-=2}if(f!==r.getSize())throw new fe("Not all bits consumed: "+f+"/"+r.getSize())}static findMSBSet(r){return 32-k.numberOfLeadingZeros(r)}static calculateBCHCode(r,o){if(o===0)throw new _("0 polynomial");const h=Zt.findMSBSet(o);for(r<<=h-1;Zt.findMSBSet(r)>=h;)r^=o<<Zt.findMSBSet(r)-h;return r}static makeTypeInfoBits(r,o,h){if(!bs.isValidMaskPattern(o))throw new fe("Invalid mask pattern");const f=r.getBits()<<3|o;h.appendBits(f,5);const d=Zt.calculateBCHCode(f,Zt.TYPE_INFO_POLY);h.appendBits(d,10);const m=new X;if(m.appendBits(Zt.TYPE_INFO_MASK_PATTERN,15),h.xor(m),h.getSize()!==15)throw new fe("should not happen but we got: "+h.getSize())}static makeVersionInfoBits(r,o){o.appendBits(r.getVersionNumber(),6);const h=Zt.calculateBCHCode(r.getVersionNumber(),Zt.VERSION_INFO_POLY);if(o.appendBits(h,12),o.getSize()!==18)throw new fe("should not happen but we got: "+o.getSize())}static isEmpty(r){return r===255}static embedTimingPatterns(r){for(let o=8;o<r.getWidth()-8;++o){const h=(o+1)%2;Zt.isEmpty(r.get(o,6))&&r.setNumber(o,6,h),Zt.isEmpty(r.get(6,o))&&r.setNumber(6,o,h)}}static embedDarkDotAtLeftBottomCorner(r){if(r.get(8,r.getHeight()-8)===0)throw new fe;r.setNumber(8,r.getHeight()-8,1)}static embedHorizontalSeparationPattern(r,o,h){for(let f=0;f<8;++f){if(!Zt.isEmpty(h.get(r+f,o)))throw new fe;h.setNumber(r+f,o,0)}}static embedVerticalSeparationPattern(r,o,h){for(let f=0;f<7;++f){if(!Zt.isEmpty(h.get(r,o+f)))throw new fe;h.setNumber(r,o+f,0)}}static embedPositionAdjustmentPattern(r,o,h){for(let f=0;f<5;++f){const d=Zt.POSITION_ADJUSTMENT_PATTERN[f];for(let m=0;m<5;++m)h.setNumber(r+m,o+f,d[m])}}static embedPositionDetectionPattern(r,o,h){for(let f=0;f<7;++f){const d=Zt.POSITION_DETECTION_PATTERN[f];for(let m=0;m<7;++m)h.setNumber(r+m,o+f,d[m])}}static embedPositionDetectionPatternsAndSeparators(r){const o=Zt.POSITION_DETECTION_PATTERN[0].length;Zt.embedPositionDetectionPattern(0,0,r),Zt.embedPositionDetectionPattern(r.getWidth()-o,0,r),Zt.embedPositionDetectionPattern(0,r.getWidth()-o,r);const h=8;Zt.embedHorizontalSeparationPattern(0,h-1,r),Zt.embedHorizontalSeparationPattern(r.getWidth()-h,h-1,r),Zt.embedHorizontalSeparationPattern(0,r.getWidth()-h,r);const f=7;Zt.embedVerticalSeparationPattern(f,0,r),Zt.embedVerticalSeparationPattern(r.getHeight()-f-1,0,r),Zt.embedVerticalSeparationPattern(f,r.getHeight()-f,r)}static maybeEmbedPositionAdjustmentPatterns(r,o){if(r.getVersionNumber()<2)return;const h=r.getVersionNumber()-1,f=Zt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[h];for(let d=0,m=f.length;d!==m;d++){const x=f[d];if(x>=0)for(let w=0;w!==m;w++){const A=f[w];A>=0&&Zt.isEmpty(o.get(A,x))&&Zt.embedPositionAdjustmentPattern(A-2,x-2,o)}}}}Zt.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Zt.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Zt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Zt.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Zt.VERSION_INFO_POLY=7973,Zt.TYPE_INFO_POLY=1335,Zt.TYPE_INFO_MASK_PATTERN=21522;class xu{constructor(r,o){this.dataBytes=r,this.errorCorrectionBytes=o}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class ii{constructor(){}static calculateMaskPenalty(r){return fi.applyMaskPenaltyRule1(r)+fi.applyMaskPenaltyRule2(r)+fi.applyMaskPenaltyRule3(r)+fi.applyMaskPenaltyRule4(r)}static encode(r,o,h=null){let f=ii.DEFAULT_BYTE_MODE_ENCODING;const d=h!==null&&h.get(Si.CHARACTER_SET)!==void 0;d&&(f=h.get(Si.CHARACTER_SET).toString());const m=this.chooseMode(r,f),x=new X;if(m===oe.BYTE&&(d||ii.DEFAULT_BYTE_MODE_ENCODING!==f)){const Wt=V.getCharacterSetECIByName(f);Wt!==void 0&&this.appendECI(Wt,x)}this.appendModeInfo(m,x);const w=new X;this.appendBytes(r,m,w,f);let A;if(h!==null&&h.get(Si.QR_VERSION)!==void 0){const Wt=Number.parseInt(h.get(Si.QR_VERSION).toString(),10);A=ee.getVersionForNumber(Wt);const Bt=this.calculateBitsNeeded(m,x,w,A);if(!this.willFit(Bt,A,o))throw new fe("Data too big for requested version")}else A=this.recommendVersion(o,m,x,w);const O=new X;O.appendBitArray(x);const B=m===oe.BYTE?w.getSizeInBytes():r.length;this.appendLengthInfo(B,A,m,O),O.appendBitArray(w);const Y=A.getECBlocksForLevel(o),Q=A.getTotalCodewords()-Y.getTotalECCodewords();this.terminateBits(Q,O);const ht=this.interleaveWithECBytes(O,A.getTotalCodewords(),Q,Y.getNumBlocks()),ut=new bs;ut.setECLevel(o),ut.setMode(m),ut.setVersion(A);const yt=A.getDimensionForVersion(),Ct=new Jr(yt,yt),zt=this.chooseMaskPattern(ht,o,A,Ct);return ut.setMaskPattern(zt),Zt.buildMatrix(ht,o,A,zt,Ct),ut.setMatrix(Ct),ut}static recommendVersion(r,o,h,f){const d=this.calculateBitsNeeded(o,h,f,ee.getVersionForNumber(1)),m=this.chooseVersion(d,r),x=this.calculateBitsNeeded(o,h,f,m);return this.chooseVersion(x,r)}static calculateBitsNeeded(r,o,h,f){return o.getSize()+r.getCharacterCountBits(f)+h.getSize()}static getAlphanumericCode(r){return r<ii.ALPHANUMERIC_TABLE.length?ii.ALPHANUMERIC_TABLE[r]:-1}static chooseMode(r,o=null){if(V.SJIS.getName()===o&&this.isOnlyDoubleByteKanji(r))return oe.KANJI;let h=!1,f=!1;for(let d=0,m=r.length;d<m;++d){const x=r.charAt(d);if(ii.isDigit(x))h=!0;else if(this.getAlphanumericCode(x.charCodeAt(0))!==-1)f=!0;else return oe.BYTE}return f?oe.ALPHANUMERIC:h?oe.NUMERIC:oe.BYTE}static isOnlyDoubleByteKanji(r){let o;try{o=ot.encode(r,V.SJIS)}catch{return!1}const h=o.length;if(h%2!==0)return!1;for(let f=0;f<h;f+=2){const d=o[f]&255;if((d<129||d>159)&&(d<224||d>235))return!1}return!0}static chooseMaskPattern(r,o,h,f){let d=Number.MAX_SAFE_INTEGER,m=-1;for(let x=0;x<bs.NUM_MASK_PATTERNS;x++){Zt.buildMatrix(r,o,h,x,f);let w=this.calculateMaskPenalty(f);w<d&&(d=w,m=x)}return m}static chooseVersion(r,o){for(let h=1;h<=40;h++){const f=ee.getVersionForNumber(h);if(ii.willFit(r,f,o))return f}throw new fe("Data too big")}static willFit(r,o,h){const f=o.getTotalCodewords(),m=o.getECBlocksForLevel(h).getTotalECCodewords(),x=f-m,w=(r+7)/8;return x>=w}static terminateBits(r,o){const h=r*8;if(o.getSize()>h)throw new fe("data bits cannot fit in the QR Code"+o.getSize()+" > "+h);for(let m=0;m<4&&o.getSize()<h;++m)o.appendBit(!1);const f=o.getSize()&7;if(f>0)for(let m=f;m<8;m++)o.appendBit(!1);const d=r-o.getSizeInBytes();for(let m=0;m<d;++m)o.appendBits(m&1?17:236,8);if(o.getSize()!==h)throw new fe("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(r,o,h,f,d,m){if(f>=h)throw new fe("Block ID too large");const x=r%h,w=h-x,A=Math.floor(r/h),O=A+1,B=Math.floor(o/h),Y=B+1,Q=A-B,ht=O-Y;if(Q!==ht)throw new fe("EC bytes mismatch");if(h!==w+x)throw new fe("RS blocks mismatch");if(r!==(B+Q)*w+(Y+ht)*x)throw new fe("Total bytes mismatch");f<w?(d[0]=B,m[0]=Q):(d[0]=Y,m[0]=ht)}static interleaveWithECBytes(r,o,h,f){if(r.getSizeInBytes()!==h)throw new fe("Number of bits and data bytes does not match");let d=0,m=0,x=0;const w=new Array;for(let O=0;O<f;++O){const B=new Int32Array(1),Y=new Int32Array(1);ii.getNumDataBytesAndNumECBytesForBlockID(o,h,f,O,B,Y);const Q=B[0],ht=new Uint8Array(Q);r.toBytes(8*d,ht,0,Q);const ut=ii.generateECBytes(ht,Y[0]);w.push(new xu(ht,ut)),m=Math.max(m,Q),x=Math.max(x,ut.length),d+=B[0]}if(h!==d)throw new fe("Data bytes does not match offset");const A=new X;for(let O=0;O<m;++O)for(const B of w){const Y=B.getDataBytes();O<Y.length&&A.appendBits(Y[O],8)}for(let O=0;O<x;++O)for(const B of w){const Y=B.getErrorCorrectionBytes();O<Y.length&&A.appendBits(Y[O],8)}if(o!==A.getSizeInBytes())throw new fe("Interleaving error: "+o+" and "+A.getSizeInBytes()+" differ.");return A}static generateECBytes(r,o){const h=r.length,f=new Int32Array(h+o);for(let m=0;m<h;m++)f[m]=r[m]&255;new ja(de.QR_CODE_FIELD_256).encode(f,o);const d=new Uint8Array(o);for(let m=0;m<o;m++)d[m]=f[h+m];return d}static appendModeInfo(r,o){o.appendBits(r.getBits(),4)}static appendLengthInfo(r,o,h,f){const d=h.getCharacterCountBits(o);if(r>=1<<d)throw new fe(r+" is bigger than "+((1<<d)-1));f.appendBits(r,d)}static appendBytes(r,o,h,f){switch(o){case oe.NUMERIC:ii.appendNumericBytes(r,h);break;case oe.ALPHANUMERIC:ii.appendAlphanumericBytes(r,h);break;case oe.BYTE:ii.append8BitBytes(r,h,f);break;case oe.KANJI:ii.appendKanjiBytes(r,h);break;default:throw new fe("Invalid mode: "+o)}}static getDigit(r){return r.charCodeAt(0)-48}static isDigit(r){const o=ii.getDigit(r);return o>=0&&o<=9}static appendNumericBytes(r,o){const h=r.length;let f=0;for(;f<h;){const d=ii.getDigit(r.charAt(f));if(f+2<h){const m=ii.getDigit(r.charAt(f+1)),x=ii.getDigit(r.charAt(f+2));o.appendBits(d*100+m*10+x,10),f+=3}else if(f+1<h){const m=ii.getDigit(r.charAt(f+1));o.appendBits(d*10+m,7),f+=2}else o.appendBits(d,4),f++}}static appendAlphanumericBytes(r,o){const h=r.length;let f=0;for(;f<h;){const d=ii.getAlphanumericCode(r.charCodeAt(f));if(d===-1)throw new fe;if(f+1<h){const m=ii.getAlphanumericCode(r.charCodeAt(f+1));if(m===-1)throw new fe;o.appendBits(d*45+m,11),f+=2}else o.appendBits(d,6),f++}}static append8BitBytes(r,o,h){let f;try{f=ot.encode(r,h)}catch(d){throw new fe(d)}for(let d=0,m=f.length;d!==m;d++){const x=f[d];o.appendBits(x,8)}}static appendKanjiBytes(r,o){let h;try{h=ot.encode(r,V.SJIS)}catch(d){throw new fe(d)}const f=h.length;for(let d=0;d<f;d+=2){const m=h[d]&255,x=h[d+1]&255,w=m<<8&4294967295|x;let A=-1;if(w>=33088&&w<=40956?A=w-33088:w>=57408&&w<=60351&&(A=w-49472),A===-1)throw new fe("Invalid byte sequence");const O=(A>>8)*192+(A&255);o.appendBits(O,13)}}static appendECI(r,o){o.appendBits(oe.ECI.getBits(),4),o.appendBits(r.getValue(),8)}}ii.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),ii.DEFAULT_BYTE_MODE_ENCODING=V.UTF8.getName();class In{write(r,o,h,f=null){if(r.length===0)throw new _("Found empty contents");if(o<0||h<0)throw new _("Requested dimensions are too small: "+o+"x"+h);let d=$e.L,m=In.QUIET_ZONE_SIZE;f!==null&&(f.get(Si.ERROR_CORRECTION)!==void 0&&(d=$e.fromString(f.get(Si.ERROR_CORRECTION).toString())),f.get(Si.MARGIN)!==void 0&&(m=Number.parseInt(f.get(Si.MARGIN).toString(),10)));const x=ii.encode(r,d,f);return this.renderResult(x,o,h,m)}writeToDom(r,o,h,f,d=null){typeof r=="string"&&(r=document.querySelector(r));const m=this.write(o,h,f,d);r&&r.appendChild(m)}renderResult(r,o,h,f){const d=r.getMatrix();if(d===null)throw new St;const m=d.getWidth(),x=d.getHeight(),w=m+f*2,A=x+f*2,O=Math.max(o,w),B=Math.max(h,A),Y=Math.min(Math.floor(O/w),Math.floor(B/A)),Q=Math.floor((O-m*Y)/2),ht=Math.floor((B-x*Y)/2),ut=this.createSVGElement(O,B);for(let yt=0,Ct=ht;yt<x;yt++,Ct+=Y)for(let zt=0,Wt=Q;zt<m;zt++,Wt+=Y)if(d.get(zt,yt)===1){const Bt=this.createSvgRectElement(Wt,Ct,Y,Y);ut.appendChild(Bt)}return ut}createSVGElement(r,o){const h=document.createElementNS(In.SVG_NS,"svg");return h.setAttributeNS(null,"height",r.toString()),h.setAttributeNS(null,"width",o.toString()),h}createSvgRectElement(r,o,h,f){const d=document.createElementNS(In.SVG_NS,"rect");return d.setAttributeNS(null,"x",r.toString()),d.setAttributeNS(null,"y",o.toString()),d.setAttributeNS(null,"height",h.toString()),d.setAttributeNS(null,"width",f.toString()),d.setAttributeNS(null,"fill","#000000"),d}}In.QUIET_ZONE_SIZE=4,In.SVG_NS="http://www.w3.org/2000/svg";class Es{encode(r,o,h,f,d){if(r.length===0)throw new _("Found empty contents");if(o!==Vt.QR_CODE)throw new _("Can only encode QR_CODE, but got "+o);if(h<0||f<0)throw new _(`Requested dimensions are too small: ${h}x${f}`);let m=$e.L,x=Es.QUIET_ZONE_SIZE;d!==null&&(d.get(Si.ERROR_CORRECTION)!==void 0&&(m=$e.fromString(d.get(Si.ERROR_CORRECTION).toString())),d.get(Si.MARGIN)!==void 0&&(x=Number.parseInt(d.get(Si.MARGIN).toString(),10)));const w=ii.encode(r,m,d);return Es.renderResult(w,h,f,x)}static renderResult(r,o,h,f){const d=r.getMatrix();if(d===null)throw new St;const m=d.getWidth(),x=d.getHeight(),w=m+f*2,A=x+f*2,O=Math.max(o,w),B=Math.max(h,A),Y=Math.min(Math.floor(O/w),Math.floor(B/A)),Q=Math.floor((O-m*Y)/2),ht=Math.floor((B-x*Y)/2),ut=new N(O,B);for(let yt=0,Ct=ht;yt<x;yt++,Ct+=Y)for(let zt=0,Wt=Q;zt<m;zt++,Wt+=Y)d.get(zt,yt)===1&&ut.setRegion(Wt,Ct,Y,Y);return ut}}Es.QUIET_ZONE_SIZE=4;class Cl{encode(r,o,h,f,d){let m;switch(o){case Vt.QR_CODE:m=new Es;break;default:throw new _("No encoder available for format "+o)}return m.encode(r,o,h,f,d)}}class Cn extends At{constructor(r,o,h,f,d,m,x,w){if(super(m,x),this.yuvData=r,this.dataWidth=o,this.dataHeight=h,this.left=f,this.top=d,f+m>o||d+x>h)throw new _("Crop rectangle does not fit within image data.");w&&this.reverseHorizontal(m,x)}getRow(r,o){if(r<0||r>=this.getHeight())throw new _("Requested row is outside the image: "+r);const h=this.getWidth();(o==null||o.length<h)&&(o=new Uint8ClampedArray(h));const f=(r+this.top)*this.dataWidth+this.left;return R.arraycopy(this.yuvData,f,o,0,h),o}getMatrix(){const r=this.getWidth(),o=this.getHeight();if(r===this.dataWidth&&o===this.dataHeight)return this.yuvData;const h=r*o,f=new Uint8ClampedArray(h);let d=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return R.arraycopy(this.yuvData,d,f,0,h),f;for(let m=0;m<o;m++){const x=m*r;R.arraycopy(this.yuvData,d,f,x,r),d+=this.dataWidth}return f}isCropSupported(){return!0}crop(r,o,h,f){return new Cn(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+o,h,f,!1)}renderThumbnail(){const r=this.getWidth()/Cn.THUMBNAIL_SCALE_FACTOR,o=this.getHeight()/Cn.THUMBNAIL_SCALE_FACTOR,h=new Int32Array(r*o),f=this.yuvData;let d=this.top*this.dataWidth+this.left;for(let m=0;m<o;m++){const x=m*r;for(let w=0;w<r;w++){const A=f[d+w*Cn.THUMBNAIL_SCALE_FACTOR]&255;h[x+w]=4278190080|A*65793}d+=this.dataWidth*Cn.THUMBNAIL_SCALE_FACTOR}return h}getThumbnailWidth(){return this.getWidth()/Cn.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Cn.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(r,o){const h=this.yuvData;for(let f=0,d=this.top*this.dataWidth+this.left;f<o;f++,d+=this.dataWidth){const m=d+r/2;for(let x=d,w=d+r-1;x<m;x++,w--){const A=h[x];h[x]=h[w],h[w]=A}}}invert(){return new bt(this)}}Cn.THUMBNAIL_SCALE_FACTOR=2;class Ha extends At{constructor(r,o,h,f,d,m,x){if(super(o,h),this.dataWidth=f,this.dataHeight=d,this.left=m,this.top=x,r.BYTES_PER_ELEMENT===4){const w=o*h,A=new Uint8ClampedArray(w);for(let O=0;O<w;O++){const B=r[O],Y=B>>16&255,Q=B>>7&510,ht=B&255;A[O]=(Y+Q+ht)/4&255}this.luminances=A}else this.luminances=r;if(f===void 0&&(this.dataWidth=o),d===void 0&&(this.dataHeight=h),m===void 0&&(this.left=0),x===void 0&&(this.top=0),this.left+o>this.dataWidth||this.top+h>this.dataHeight)throw new _("Crop rectangle does not fit within image data.")}getRow(r,o){if(r<0||r>=this.getHeight())throw new _("Requested row is outside the image: "+r);const h=this.getWidth();(o==null||o.length<h)&&(o=new Uint8ClampedArray(h));const f=(r+this.top)*this.dataWidth+this.left;return R.arraycopy(this.luminances,f,o,0,h),o}getMatrix(){const r=this.getWidth(),o=this.getHeight();if(r===this.dataWidth&&o===this.dataHeight)return this.luminances;const h=r*o,f=new Uint8ClampedArray(h);let d=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return R.arraycopy(this.luminances,d,f,0,h),f;for(let m=0;m<o;m++){const x=m*r;R.arraycopy(this.luminances,d,f,x,r),d+=this.dataWidth}return f}isCropSupported(){return!0}crop(r,o,h,f){return new Ha(this.luminances,h,f,this.dataWidth,this.dataHeight,this.left+r,this.top+o)}invert(){return new bt(this)}}class Is extends V{static forName(r){return this.getCharacterSetECIByName(r)}}class Ks{}Ks.ISO_8859_1=V.ISO8859_1;class Al{isCompact(){return this.compact}setCompact(r){this.compact=r}getSize(){return this.size}setSize(r){this.size=r}getLayers(){return this.layers}setLayers(r){this.layers=r}getCodeWords(){return this.codeWords}setCodeWords(r){this.codeWords=r}getMatrix(){return this.matrix}setMatrix(r){this.matrix=r}}class Rl{static singletonList(r){return[r]}static min(r,o){return r.sort(o)[0]}}class _u{constructor(r){this.previous=r}getPrevious(){return this.previous}}class yi extends _u{constructor(r,o,h){super(r),this.value=o,this.bitCount=h}appendTo(r,o){r.appendBits(this.value,this.bitCount)}add(r,o){return new yi(this,r,o)}addBinaryShift(r,o){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new yi(this,r,o)}toString(){let r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+k.toBinaryString(r|1<<this.bitCount).substring(1)+">"}}class Cs extends yi{constructor(r,o,h){super(r,0,0),this.binaryShiftStart=o,this.binaryShiftByteCount=h}appendTo(r,o){for(let h=0;h<this.binaryShiftByteCount;h++)(h===0||h===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):h===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(o[this.binaryShiftStart+h],8)}addBinaryShift(r,o){return new Cs(this,r,o)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function wu(L,r,o){return new Cs(L,r,o)}function Sr(L,r,o){return new yi(L,r,o)}const g=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],b=0,C=1,P=2,M=3,G=4,W=new yi(null,0,0),U=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function it(L){for(let r of L)v.fill(r,-1);return L[b][G]=0,L[C][G]=0,L[C][b]=28,L[M][G]=0,L[P][G]=0,L[P][b]=15,L}const st=it(v.createInt32Array(6,6));class dt{constructor(r,o,h,f){this.token=r,this.mode=o,this.binaryShiftByteCount=h,this.bitCount=f}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(r,o){let h=this.bitCount,f=this.token;if(r!==this.mode){let m=U[this.mode][r];f=Sr(f,m&65535,m>>16),h+=m>>16}let d=r===P?4:5;return f=Sr(f,o,d),new dt(f,r,0,h+d)}shiftAndAppend(r,o){let h=this.token,f=this.mode===P?4:5;return h=Sr(h,st[this.mode][r],f),h=Sr(h,o,5),new dt(h,this.mode,0,this.bitCount+f+5)}addBinaryShiftChar(r){let o=this.token,h=this.mode,f=this.bitCount;if(this.mode===G||this.mode===P){let x=U[h][b];o=Sr(o,x&65535,x>>16),f+=x>>16,h=b}let d=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,m=new dt(o,h,this.binaryShiftByteCount+1,f+d);return m.binaryShiftByteCount===2078&&(m=m.endBinaryShift(r+1)),m}endBinaryShift(r){if(this.binaryShiftByteCount===0)return this;let o=this.token;return o=wu(o,r-this.binaryShiftByteCount,this.binaryShiftByteCount),new dt(o,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(r){let o=this.bitCount+(U[this.mode][r.mode]>>16);return this.binaryShiftByteCount<r.binaryShiftByteCount?o+=dt.calculateBinaryShiftCost(r)-dt.calculateBinaryShiftCost(this):this.binaryShiftByteCount>r.binaryShiftByteCount&&r.binaryShiftByteCount>0&&(o+=10),o<=r.bitCount}toBitArray(r){let o=[];for(let f=this.endBinaryShift(r.length).token;f!==null;f=f.getPrevious())o.unshift(f);let h=new X;for(const f of o)f.appendTo(h,r);return h}toString(){return j.format("%s bits=%d bytes=%d",g[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(r){return r.binaryShiftByteCount>62?21:r.binaryShiftByteCount>31?20:r.binaryShiftByteCount>0?10:0}}dt.INITIAL_STATE=new dt(W,b,0,0);function wt(L){const r=j.getCharCode(" "),o=j.getCharCode("."),h=j.getCharCode(",");L[b][r]=1;const f=j.getCharCode("Z"),d=j.getCharCode("A");for(let Y=d;Y<=f;Y++)L[b][Y]=Y-d+2;L[C][r]=1;const m=j.getCharCode("z"),x=j.getCharCode("a");for(let Y=x;Y<=m;Y++)L[C][Y]=Y-x+2;L[P][r]=1;const w=j.getCharCode("9"),A=j.getCharCode("0");for(let Y=A;Y<=w;Y++)L[P][Y]=Y-A+2;L[P][h]=12,L[P][o]=13;const O=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let Y=0;Y<O.length;Y++)L[M][j.getCharCode(O[Y])]=Y;const B=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let Y=0;Y<B.length;Y++)j.getCharCode(B[Y])>0&&(L[G][j.getCharCode(B[Y])]=Y);return L}const Mt=wt(v.createInt32Array(5,256));class Gt{constructor(r){this.text=r}encode(){const r=j.getCharCode(" "),o=j.getCharCode(`
`);let h=Rl.singletonList(dt.INITIAL_STATE);for(let d=0;d<this.text.length;d++){let m,x=d+1<this.text.length?this.text[d+1]:0;switch(this.text[d]){case j.getCharCode("\r"):m=x===o?2:0;break;case j.getCharCode("."):m=x===r?3:0;break;case j.getCharCode(","):m=x===r?4:0;break;case j.getCharCode(":"):m=x===r?5:0;break;default:m=0}m>0?(h=Gt.updateStateListForPair(h,d,m),d++):h=this.updateStateListForChar(h,d)}return Rl.min(h,(d,m)=>d.getBitCount()-m.getBitCount()).toBitArray(this.text)}updateStateListForChar(r,o){const h=[];for(let f of r)this.updateStateForChar(f,o,h);return Gt.simplifyStates(h)}updateStateForChar(r,o,h){let f=this.text[o]&255,d=Mt[r.getMode()][f]>0,m=null;for(let x=0;x<=G;x++){let w=Mt[x][f];if(w>0){if(m==null&&(m=r.endBinaryShift(o)),!d||x===r.getMode()||x===P){const A=m.latchAndAppend(x,w);h.push(A)}if(!d&&st[r.getMode()][x]>=0){const A=m.shiftAndAppend(x,w);h.push(A)}}}if(r.getBinaryShiftByteCount()>0||Mt[r.getMode()][f]===0){let x=r.addBinaryShiftChar(o);h.push(x)}}static updateStateListForPair(r,o,h){const f=[];for(let d of r)this.updateStateForPair(d,o,h,f);return this.simplifyStates(f)}static updateStateForPair(r,o,h,f){let d=r.endBinaryShift(o);if(f.push(d.latchAndAppend(G,h)),r.getMode()!==G&&f.push(d.shiftAndAppend(G,h)),h===3||h===4){let m=d.latchAndAppend(P,16-h).latchAndAppend(P,1);f.push(m)}if(r.getBinaryShiftByteCount()>0){let m=r.addBinaryShiftChar(o).addBinaryShiftChar(o+1);f.push(m)}}static simplifyStates(r){let o=[];for(const h of r){let f=!0;for(const d of o){if(d.isBetterThanOrEqualTo(h)){f=!1;break}h.isBetterThanOrEqualTo(d)&&(o=o.filter(m=>m!==d))}f&&o.push(h)}return o}}class Rt{constructor(){}static encodeBytes(r){return Rt.encode(r,Rt.DEFAULT_EC_PERCENT,Rt.DEFAULT_AZTEC_LAYERS)}static encode(r,o,h){let f=new Gt(r).encode(),d=k.truncDivision(f.getSize()*o,100)+11,m=f.getSize()+d,x,w,A,O,B;if(h!==Rt.DEFAULT_AZTEC_LAYERS){if(x=h<0,w=Math.abs(h),w>(x?Rt.MAX_NB_BITS_COMPACT:Rt.MAX_NB_BITS))throw new _(j.format("Illegal value %s for layers",h));A=Rt.totalBitsInLayer(w,x),O=Rt.WORD_SIZE[w];let Bt=A-A%O;if(B=Rt.stuffBits(f,O),B.getSize()+d>Bt)throw new _("Data to large for user specified layer");if(x&&B.getSize()>O*64)throw new _("Data to large for user specified layer")}else{O=0,B=null;for(let Bt=0;;Bt++){if(Bt>Rt.MAX_NB_BITS)throw new _("Data too large for an Aztec code");if(x=Bt<=3,w=x?Bt+1:Bt,A=Rt.totalBitsInLayer(w,x),m>A)continue;(B==null||O!==Rt.WORD_SIZE[w])&&(O=Rt.WORD_SIZE[w],B=Rt.stuffBits(f,O));let Be=A-A%O;if(!(x&&B.getSize()>O*64)&&B.getSize()+d<=Be)break}}let Y=Rt.generateCheckWords(B,A,O),Q=B.getSize()/O,ht=Rt.generateModeMessage(x,w,Q),ut=(x?11:14)+w*4,yt=new Int32Array(ut),Ct;if(x){Ct=ut;for(let Bt=0;Bt<yt.length;Bt++)yt[Bt]=Bt}else{Ct=ut+1+2*k.truncDivision(k.truncDivision(ut,2)-1,15);let Bt=k.truncDivision(ut,2),Be=k.truncDivision(Ct,2);for(let De=0;De<Bt;De++){let dn=De+k.truncDivision(De,15);yt[Bt-De-1]=Be-dn-1,yt[Bt+De]=Be+dn+1}}let zt=new N(Ct);for(let Bt=0,Be=0;Bt<w;Bt++){let De=(w-Bt)*4+(x?9:12);for(let dn=0;dn<De;dn++){let Yn=dn*2;for(let gn=0;gn<2;gn++)Y.get(Be+Yn+gn)&&zt.set(yt[Bt*2+gn],yt[Bt*2+dn]),Y.get(Be+De*2+Yn+gn)&&zt.set(yt[Bt*2+dn],yt[ut-1-Bt*2-gn]),Y.get(Be+De*4+Yn+gn)&&zt.set(yt[ut-1-Bt*2-gn],yt[ut-1-Bt*2-dn]),Y.get(Be+De*6+Yn+gn)&&zt.set(yt[ut-1-Bt*2-dn],yt[Bt*2+gn])}Be+=De*8}if(Rt.drawModeMessage(zt,x,Ct,ht),x)Rt.drawBullsEye(zt,k.truncDivision(Ct,2),5);else{Rt.drawBullsEye(zt,k.truncDivision(Ct,2),7);for(let Bt=0,Be=0;Bt<k.truncDivision(ut,2)-1;Bt+=15,Be+=16)for(let De=k.truncDivision(Ct,2)&1;De<Ct;De+=2)zt.set(k.truncDivision(Ct,2)-Be,De),zt.set(k.truncDivision(Ct,2)+Be,De),zt.set(De,k.truncDivision(Ct,2)-Be),zt.set(De,k.truncDivision(Ct,2)+Be)}let Wt=new Al;return Wt.setCompact(x),Wt.setSize(Ct),Wt.setLayers(w),Wt.setCodeWords(Q),Wt.setMatrix(zt),Wt}static drawBullsEye(r,o,h){for(let f=0;f<h;f+=2)for(let d=o-f;d<=o+f;d++)r.set(d,o-f),r.set(d,o+f),r.set(o-f,d),r.set(o+f,d);r.set(o-h,o-h),r.set(o-h+1,o-h),r.set(o-h,o-h+1),r.set(o+h,o-h),r.set(o+h,o-h+1),r.set(o+h,o+h-1)}static generateModeMessage(r,o,h){let f=new X;return r?(f.appendBits(o-1,2),f.appendBits(h-1,6),f=Rt.generateCheckWords(f,28,4)):(f.appendBits(o-1,5),f.appendBits(h-1,11),f=Rt.generateCheckWords(f,40,4)),f}static drawModeMessage(r,o,h,f){let d=k.truncDivision(h,2);if(o)for(let m=0;m<7;m++){let x=d-3+m;f.get(m)&&r.set(x,d-5),f.get(m+7)&&r.set(d+5,x),f.get(20-m)&&r.set(x,d+5),f.get(27-m)&&r.set(d-5,x)}else for(let m=0;m<10;m++){let x=d-5+m+k.truncDivision(m,5);f.get(m)&&r.set(x,d-7),f.get(m+10)&&r.set(d+7,x),f.get(29-m)&&r.set(x,d+7),f.get(39-m)&&r.set(d-7,x)}}static generateCheckWords(r,o,h){let f=r.getSize()/h,d=new ja(Rt.getGF(h)),m=k.truncDivision(o,h),x=Rt.bitsToWords(r,h,m);d.encode(x,m-f);let w=o%h,A=new X;A.appendBits(0,w);for(const O of Array.from(x))A.appendBits(O,h);return A}static bitsToWords(r,o,h){let f=new Int32Array(h),d,m;for(d=0,m=r.getSize()/o;d<m;d++){let x=0;for(let w=0;w<o;w++)x|=r.get(d*o+w)?1<<o-w-1:0;f[d]=x}return f}static getGF(r){switch(r){case 4:return de.AZTEC_PARAM;case 6:return de.AZTEC_DATA_6;case 8:return de.AZTEC_DATA_8;case 10:return de.AZTEC_DATA_10;case 12:return de.AZTEC_DATA_12;default:throw new _("Unsupported word size "+r)}}static stuffBits(r,o){let h=new X,f=r.getSize(),d=(1<<o)-2;for(let m=0;m<f;m+=o){let x=0;for(let w=0;w<o;w++)(m+w>=f||r.get(m+w))&&(x|=1<<o-1-w);(x&d)===d?(h.appendBits(x&d,o),m--):x&d?h.appendBits(x,o):(h.appendBits(x|1,o),m--)}return h}static totalBitsInLayer(r,o){return((o?88:112)+16*r)*r}}Rt.DEFAULT_EC_PERCENT=33,Rt.DEFAULT_AZTEC_LAYERS=0,Rt.MAX_NB_BITS=32,Rt.MAX_NB_BITS_COMPACT=4,Rt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Yt{encode(r,o,h,f){return this.encodeWithHints(r,o,h,f,null)}encodeWithHints(r,o,h,f,d){let m=Ks.ISO_8859_1,x=Rt.DEFAULT_EC_PERCENT,w=Rt.DEFAULT_AZTEC_LAYERS;return d!=null&&(d.has(Si.CHARACTER_SET)&&(m=Is.forName(d.get(Si.CHARACTER_SET).toString())),d.has(Si.ERROR_CORRECTION)&&(x=k.parseInt(d.get(Si.ERROR_CORRECTION).toString())),d.has(Si.AZTEC_LAYERS)&&(w=k.parseInt(d.get(Si.AZTEC_LAYERS).toString()))),Yt.encodeLayers(r,o,h,f,m,x,w)}static encodeLayers(r,o,h,f,d,m,x){if(o!==Vt.AZTEC)throw new _("Can only encode AZTEC, but got "+o);let w=Rt.encode(j.getBytes(r,d),m,x);return Yt.renderResult(w,h,f)}static renderResult(r,o,h){let f=r.getMatrix();if(f==null)throw new St;let d=f.getWidth(),m=f.getHeight(),x=Math.max(o,d),w=Math.max(h,m),A=Math.min(x/d,w/m),O=(x-d*A)/2,B=(w-m*A)/2,Y=new N(x,w);for(let Q=0,ht=B;Q<m;Q++,ht+=A)for(let ut=0,yt=O;ut<d;ut++,yt+=A)f.get(ut,Q)&&Y.setRegion(yt,ht,A,A);return Y}}e.AbstractExpandedDecoder=Xs,e.ArgumentException=y,e.ArithmeticException=Ge,e.AztecCode=Al,e.AztecCodeReader=Mi,e.AztecCodeWriter=Yt,e.AztecDecoder=$,e.AztecDetector=Mn,e.AztecDetectorResult=kt,e.AztecEncoder=Rt,e.AztecHighLevelEncoder=Gt,e.AztecPoint=pe,e.BarcodeFormat=Vt,e.Binarizer=S,e.BinaryBitmap=E,e.BitArray=X,e.BitMatrix=N,e.BitSource=qr,e.BrowserAztecCodeReader=rn,e.BrowserBarcodeReader=Ai,e.BrowserCodeReader=Pt,e.BrowserDatamatrixCodeReader=cn,e.BrowserMultiFormatReader=mu,e.BrowserPDF417Reader=pu,e.BrowserQRCodeReader=yu,e.BrowserQRCodeSvgWriter=In,e.CharacterSetECI=V,e.ChecksumException=I,e.Code128Reader=jt,e.Code39Reader=He,e.DataMatrixDecodedBitStreamParser=Un,e.DataMatrixReader=mi,e.DecodeHintType=K,e.DecoderResult=me,e.DefaultGridSampler=ve,e.DetectorResult=pt,e.EAN13Reader=Ii,e.EncodeHintType=Si,e.Exception=p,e.FormatException=z,e.GenericGF=de,e.GenericGFPoly=Ce,e.GlobalHistogramBinarizer=ft,e.GridSampler=Ft,e.GridSamplerInstance=re,e.HTMLCanvasElementLuminanceSource=Dt,e.HybridBinarizer=rt,e.ITFReader=ye,e.IllegalArgumentException=_,e.IllegalStateException=St,e.InvertedLuminanceSource=bt,e.LuminanceSource=At,e.MathUtils=lt,e.MultiFormatOneDReader=Zs,e.MultiFormatReader=Il,e.MultiFormatWriter=Cl,e.NotFoundException=Z,e.OneDReader=le,e.PDF417DecodedBitStreamParser=It,e.PDF417DecoderErrorCorrection=_l,e.PDF417Reader=Ni,e.PDF417ResultMetadata=Hn,e.PerspectiveTransform=qt,e.PlanarYUVLuminanceSource=Cn,e.QRCodeByteMatrix=Jr,e.QRCodeDataMask=Wi,e.QRCodeDecodedBitStreamParser=ri,e.QRCodeDecoderErrorCorrectionLevel=$e,e.QRCodeDecoderFormatInformation=Fi,e.QRCodeEncoder=ii,e.QRCodeEncoderQRCode=bs,e.QRCodeMaskUtil=fi,e.QRCodeMatrixUtil=Zt,e.QRCodeMode=oe,e.QRCodeReader=Ln,e.QRCodeVersion=ee,e.QRCodeWriter=Es,e.RGBLuminanceSource=Ha,e.RSS14Reader=Qt,e.RSSExpandedReader=Nt,e.ReaderException=Rr,e.ReedSolomonDecoder=Et,e.ReedSolomonEncoder=ja,e.ReedSolomonException=F,e.Result=mt,e.ResultMetadataType=te,e.ResultPoint=gt,e.StringUtils=j,e.UnsupportedOperationException=nt,e.VideoInputDevice=ct,e.WhiteRectangleDetector=Ht,e.WriterException=fe,e.ZXingArrays=v,e.ZXingCharset=Is,e.ZXingInteger=k,e.ZXingStandardCharsets=Ks,e.ZXingStringBuilder=tt,e.ZXingStringEncoding=ot,e.ZXingSystem=R,e.createAbstractExpandedDecoder=Hs,Object.defineProperty(e,"__esModule",{value:!0})})})(w1,w1.exports);var ld=function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(n[a]=s[a])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Oy=function(){function i(t,e){this.name=t,this.track=e}return i.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},i.prototype.apply=function(t){var e={};e[this.name]=t;var n={advanced:[e]};return this.track.applyConstraints(n)},i.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var e=t[this.name];return e}return null},i}(),NI=function(i){ld(t,i);function t(e,n){return i.call(this,e,n)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(e){var n={};n[this.name]=e;var s={advanced:[n]};return this.track.applyConstraints(s)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var e=this.track.getCapabilities(),n=e[this.name];return{min:n.min,max:n.max,step:n.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(Oy);(function(i){ld(t,i);function t(e){return i.call(this,"zoom",e)||this}return t})(NI);(function(i){ld(t,i);function t(e){return i.call(this,"torch",e)||this}return t})(Oy);var b1;(function(i){i[i.UNKNOWN=0]="UNKNOWN",i[i.NOT_STARTED=1]="NOT_STARTED",i[i.SCANNING=2]="SCANNING",i[i.PAUSED=3]="PAUSED"})(b1||(b1={}));var LI=function(){var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(n[a]=s[a])},i(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");i(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();(function(i){LI(t,i);function t(){return i!==null&&i.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t})(PI);var E1;(function(i){i[i.STATUS_DEFAULT=0]="STATUS_DEFAULT",i[i.STATUS_SUCCESS=1]="STATUS_SUCCESS",i[i.STATUS_WARNING=2]="STATUS_WARNING",i[i.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(E1||(E1={}));const Fc=(i,t)=>t.some(e=>i instanceof e);let I1,C1;function kI(){return I1||(I1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function FI(){return C1||(C1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Bc=new WeakMap,Wu=new WeakMap,Kh=new WeakMap;function BI(i){const t=new Promise((e,n)=>{const s=()=>{i.removeEventListener("success",a),i.removeEventListener("error",l)},a=()=>{e(Br(i.result)),s()},l=()=>{n(i.error),s()};i.addEventListener("success",a),i.addEventListener("error",l)});return Kh.set(t,i),t}function VI(i){if(Bc.has(i))return;const t=new Promise((e,n)=>{const s=()=>{i.removeEventListener("complete",a),i.removeEventListener("error",l),i.removeEventListener("abort",l)},a=()=>{e(),s()},l=()=>{n(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",a),i.addEventListener("error",l),i.addEventListener("abort",l)});Bc.set(i,t)}let Vc={get(i,t,e){if(i instanceof IDBTransaction){if(t==="done")return Bc.get(i);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Br(i[t])},set(i,t,e){return i[t]=e,!0},has(i,t){return i instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in i}};function Py(i){Vc=i(Vc)}function GI(i){return FI().includes(i)?function(...t){return i.apply(Gc(this),t),Br(this.request)}:function(...t){return Br(i.apply(Gc(this),t))}}function zI(i){return typeof i=="function"?GI(i):(i instanceof IDBTransaction&&VI(i),Fc(i,kI())?new Proxy(i,Vc):i)}function Br(i){if(i instanceof IDBRequest)return BI(i);if(Wu.has(i))return Wu.get(i);const t=zI(i);return t!==i&&(Wu.set(i,t),Kh.set(t,i)),t}const Gc=i=>Kh.get(i);function UI(i,t,{blocked:e,upgrade:n,blocking:s,terminated:a}={}){const l=indexedDB.open(i,t),u=Br(l);return n&&l.addEventListener("upgradeneeded",c=>{n(Br(l.result),c.oldVersion,c.newVersion,Br(l.transaction),c)}),e&&l.addEventListener("blocked",c=>e(c.oldVersion,c.newVersion,c)),u.then(c=>{a&&c.addEventListener("close",()=>a()),s&&c.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),u}const WI=["get","getKey","getAll","getAllKeys","count"],XI=["put","add","delete","clear"],Xu=new Map;function A1(i,t){if(!(i instanceof IDBDatabase&&!(t in i)&&typeof t=="string"))return;if(Xu.get(t))return Xu.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,s=XI.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(s||WI.includes(e)))return;const a=async function(l,...u){const c=this.transaction(l,s?"readwrite":"readonly");let p=c.store;return n&&(p=p.index(u.shift())),(await Promise.all([p[e](...u),s&&c.done]))[0]};return Xu.set(t,a),a}Py(i=>({...i,get:(t,e,n)=>A1(t,e)||i.get(t,e,n),has:(t,e)=>!!A1(t,e)||i.has(t,e)}));const jI=["continue","continuePrimaryKey","advance"],R1={},zc=new WeakMap,Ny=new WeakMap,HI={get(i,t){if(!jI.includes(t))return i[t];let e=R1[t];return e||(e=R1[t]=function(...n){zc.set(this,Ny.get(this)[t](...n))}),e}};async function*YI(...i){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...i)),!t)return;t=t;const e=new Proxy(t,HI);for(Ny.set(e,t),Kh.set(e,Gc(t));t;)yield e,t=await(zc.get(e)||t.continue()),zc.delete(e)}function S1(i,t){return t===Symbol.asyncIterator&&Fc(i,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&Fc(i,[IDBIndex,IDBObjectStore])}Py(i=>({...i,get(t,e,n){return S1(t,e)?YI:i.get(t,e,n)},has(t,e){return S1(t,e)||i.has(t,e)}}));var Ly={exports:{}};(function(i,t){(function(e,n){n()})(hn,function(){function e(p,y){return typeof y>"u"?y={autoBom:!1}:typeof y!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),y={autoBom:!y}),y.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(p.type)?new Blob(["\uFEFF",p],{type:p.type}):p}function n(p,y,_){var E=new XMLHttpRequest;E.open("GET",p),E.responseType="blob",E.onload=function(){c(E.response,y,_)},E.onerror=function(){console.error("could not download file")},E.send()}function s(p){var y=new XMLHttpRequest;y.open("HEAD",p,!1);try{y.send()}catch{}return 200<=y.status&&299>=y.status}function a(p){try{p.dispatchEvent(new MouseEvent("click"))}catch{var y=document.createEvent("MouseEvents");y.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),p.dispatchEvent(y)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof hn=="object"&&hn.global===hn?hn:void 0,u=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(p,y,_){var E=l.URL||l.webkitURL,I=document.createElement("a");y=y||p.name||"download",I.download=y,I.rel="noopener",typeof p=="string"?(I.href=p,I.origin===location.origin?a(I):s(I.href)?n(p,y,_):a(I,I.target="_blank")):(I.href=E.createObjectURL(p),setTimeout(function(){E.revokeObjectURL(I.href)},4e4),setTimeout(function(){a(I)},0))}:"msSaveOrOpenBlob"in navigator?function(p,y,_){if(y=y||p.name||"download",typeof p!="string")navigator.msSaveOrOpenBlob(e(p,_),y);else if(s(p))n(p,y,_);else{var E=document.createElement("a");E.href=p,E.target="_blank",setTimeout(function(){a(E)})}}:function(p,y,_,E){if(E=E||open("","_blank"),E&&(E.document.title=E.document.body.innerText="downloading..."),typeof p=="string")return n(p,y,_);var I=p.type==="application/octet-stream",S=/constructor/i.test(l.HTMLElement)||l.safari,R=/CriOS\/[\d]+/.test(navigator.userAgent);if((R||I&&S||u)&&typeof FileReader<"u"){var D=new FileReader;D.onloadend=function(){var k=D.result;k=R?k:k.replace(/^data:[^;]*;/,"data:attachment/file;"),E?E.location.href=k:location=k,E=null},D.readAsDataURL(p)}else{var T=l.URL||l.webkitURL,v=T.createObjectURL(p);E?E.location=v:location.href=v,E=null,setTimeout(function(){T.revokeObjectURL(v)},4e4)}});l.saveAs=c.saveAs=c,i.exports=c})})(Ly);var ZI=Ly.exports;const KI=od(ZI);function qI(i,t,e){for(var n=512,s=atob(i),a=[],l=0;l<s.length;l+=n){for(var u=s.slice(l,l+n),c=new Array(u.length),p=0;p<u.length;p++)c[p]=u.charCodeAt(p);var y=new Uint8Array(c);a.push(y)}var _=new File(a,t,{type:e});return _}function $I(i){return new Promise((t,e)=>{let n=new FileReader;n.onload=function(){return t({data:n.result,name:i.name,size:i.size,type:i.type})},n.readAsDataURL(i)})}function ul(i,t,e,n={}){return n.headers=n.headers??{},n.headers.Authorization=`Basic ${window.btoa(i+":"+t)}`,fetch(e,n)}async function T1(i,t,e,n,s){let a=i+"/geoserver/wfs/?service=WFS&version=2.0.0&request=GetFeature&typeNames="+t+"&propertyname=fid,objectid,filename,filesize,mimetype,userids&outputformat=json";return s&&(a+=`&cql_filter=objectid='${s}'`),(await(await ul(e,n,a)).json()).features.map(u=>u.properties)}async function JI(i,t,e,n,s){const a=await(await ul(e,n,i+`/geoserver/wfs/?service=WFS&version=2.0.0&request=GetFeature&typeNames=${t}&cql_filter=filename='${s}'&outputformat=json`)).text(),c=JSON.parse(a).features[0].properties.fdata;return qI(c)}async function D1(i,t,e,n,s,a,l,u,c,p,y){const _=await $I(y),E=_.data.substring(_.data.indexOf(",")+1),I=`<wfs:Transaction service="WFS" version="1.1.0"
    xmlns:wfs="http://www.opengis.net/wfs"
    xmlns:gml="http://www.opengis.net/gml"
    xmlns:${i}="${i}"> 
  
      <wfs:Insert>
          <${e}>
              <${i}:objectid>${a}</${i}:objectid>
              <${i}:filename>${l}</${i}:filename>
              <${i}:filesize>${u}</${i}:filesize>
              <${i}:mimetype>${c}</${i}:mimetype>
              <${i}:userids>${p}</${i}:userids>
              <${i}:fdata>${E}</${i}:fdata>
          </${e}>
      </wfs:Insert>
    </wfs:Transaction>`;await ul(n,s,t+"/geoserver/wfs",{method:"POST",body:I})}async function QI(i,t,e,n,s){const a=`<wfs:Transaction service="WFS" version="1.1.0"
    xmlns:wfs="http://www.opengis.net/wfs"
    xmlns:gml="http://www.opengis.net/gml"
    xmlns:wfstest="wfstest"> 

    <wfs:Delete typeName="${t}">
      <Filter>
        <PropertyIsEqualTo>
          <PropertyName>filename</PropertyName>
          <Literal>${s}</Literal>
        </PropertyIsEqualTo>
      </Filter>
    </wfs:Delete>
    </wfs:Transaction>`;return(await ul(e,n,i+"/geoserver/wfs",{method:"POST",body:a})).text()}var cl={},tC=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},ky={},Dn={};let hd;const eC=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Dn.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};Dn.getSymbolTotalCodewords=function(t){return eC[t]};Dn.getBCHDigit=function(i){let t=0;for(;i!==0;)t++,i>>>=1;return t};Dn.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');hd=t};Dn.isKanjiModeEnabled=function(){return typeof hd<"u"};Dn.toSJIS=function(t){return hd(t)};var qh={};(function(i){i.L={bit:1},i.M={bit:0},i.Q={bit:3},i.H={bit:2};function t(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return i.L;case"m":case"medium":return i.M;case"q":case"quartile":return i.Q;case"h":case"high":return i.H;default:throw new Error("Unknown EC Level: "+e)}}i.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},i.from=function(n,s){if(i.isValid(n))return n;try{return t(n)}catch{return s}}})(qh);function Fy(){this.buffer=[],this.length=0}Fy.prototype={get:function(i){const t=Math.floor(i/8);return(this.buffer[t]>>>7-i%8&1)===1},put:function(i,t){for(let e=0;e<t;e++)this.putBit((i>>>t-e-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(i){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),i&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var iC=Fy;function fl(i){if(!i||i<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=i,this.data=new Uint8Array(i*i),this.reservedBit=new Uint8Array(i*i)}fl.prototype.set=function(i,t,e,n){const s=i*this.size+t;this.data[s]=e,n&&(this.reservedBit[s]=!0)};fl.prototype.get=function(i,t){return this.data[i*this.size+t]};fl.prototype.xor=function(i,t,e){this.data[i*this.size+t]^=e};fl.prototype.isReserved=function(i,t){return this.reservedBit[i*this.size+t]};var nC=fl,By={};(function(i){const t=Dn.getSymbolSize;i.getRowColCoords=function(n){if(n===1)return[];const s=Math.floor(n/7)+2,a=t(n),l=a===145?26:Math.ceil((a-13)/(2*s-2))*2,u=[a-7];for(let c=1;c<s-1;c++)u[c]=u[c-1]-l;return u.push(6),u.reverse()},i.getPositions=function(n){const s=[],a=i.getRowColCoords(n),l=a.length;for(let u=0;u<l;u++)for(let c=0;c<l;c++)u===0&&c===0||u===0&&c===l-1||u===l-1&&c===0||s.push([a[u],a[c]]);return s}})(By);var Vy={};const sC=Dn.getSymbolSize,M1=7;Vy.getPositions=function(t){const e=sC(t);return[[0,0],[e-M1,0],[0,e-M1]]};var Gy={};(function(i){i.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};i.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},i.from=function(s){return i.isValid(s)?parseInt(s,10):void 0},i.getPenaltyN1=function(s){const a=s.size;let l=0,u=0,c=0,p=null,y=null;for(let _=0;_<a;_++){u=c=0,p=y=null;for(let E=0;E<a;E++){let I=s.get(_,E);I===p?u++:(u>=5&&(l+=t.N1+(u-5)),p=I,u=1),I=s.get(E,_),I===y?c++:(c>=5&&(l+=t.N1+(c-5)),y=I,c=1)}u>=5&&(l+=t.N1+(u-5)),c>=5&&(l+=t.N1+(c-5))}return l},i.getPenaltyN2=function(s){const a=s.size;let l=0;for(let u=0;u<a-1;u++)for(let c=0;c<a-1;c++){const p=s.get(u,c)+s.get(u,c+1)+s.get(u+1,c)+s.get(u+1,c+1);(p===4||p===0)&&l++}return l*t.N2},i.getPenaltyN3=function(s){const a=s.size;let l=0,u=0,c=0;for(let p=0;p<a;p++){u=c=0;for(let y=0;y<a;y++)u=u<<1&2047|s.get(p,y),y>=10&&(u===1488||u===93)&&l++,c=c<<1&2047|s.get(y,p),y>=10&&(c===1488||c===93)&&l++}return l*t.N3},i.getPenaltyN4=function(s){let a=0;const l=s.data.length;for(let c=0;c<l;c++)a+=s.data[c];return Math.abs(Math.ceil(a*100/l/5)-10)*t.N4};function e(n,s,a){switch(n){case i.Patterns.PATTERN000:return(s+a)%2===0;case i.Patterns.PATTERN001:return s%2===0;case i.Patterns.PATTERN010:return a%3===0;case i.Patterns.PATTERN011:return(s+a)%3===0;case i.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(a/3))%2===0;case i.Patterns.PATTERN101:return s*a%2+s*a%3===0;case i.Patterns.PATTERN110:return(s*a%2+s*a%3)%2===0;case i.Patterns.PATTERN111:return(s*a%3+(s+a)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}i.applyMask=function(s,a){const l=a.size;for(let u=0;u<l;u++)for(let c=0;c<l;c++)a.isReserved(c,u)||a.xor(c,u,e(s,c,u))},i.getBestMask=function(s,a){const l=Object.keys(i.Patterns).length;let u=0,c=1/0;for(let p=0;p<l;p++){a(p),i.applyMask(p,s);const y=i.getPenaltyN1(s)+i.getPenaltyN2(s)+i.getPenaltyN3(s)+i.getPenaltyN4(s);i.applyMask(p,s),y<c&&(c=y,u=p)}return u}})(Gy);var $h={};const ur=qh,Vl=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Gl=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];$h.getBlocksCount=function(t,e){switch(e){case ur.L:return Vl[(t-1)*4+0];case ur.M:return Vl[(t-1)*4+1];case ur.Q:return Vl[(t-1)*4+2];case ur.H:return Vl[(t-1)*4+3];default:return}};$h.getTotalCodewordsCount=function(t,e){switch(e){case ur.L:return Gl[(t-1)*4+0];case ur.M:return Gl[(t-1)*4+1];case ur.Q:return Gl[(t-1)*4+2];case ur.H:return Gl[(t-1)*4+3];default:return}};var zy={},Jh={};const uo=new Uint8Array(512),yh=new Uint8Array(256);(function(){let t=1;for(let e=0;e<255;e++)uo[e]=t,yh[t]=e,t<<=1,t&256&&(t^=285);for(let e=255;e<512;e++)uo[e]=uo[e-255]})();Jh.log=function(t){if(t<1)throw new Error("log("+t+")");return yh[t]};Jh.exp=function(t){return uo[t]};Jh.mul=function(t,e){return t===0||e===0?0:uo[yh[t]+yh[e]]};(function(i){const t=Jh;i.mul=function(n,s){const a=new Uint8Array(n.length+s.length-1);for(let l=0;l<n.length;l++)for(let u=0;u<s.length;u++)a[l+u]^=t.mul(n[l],s[u]);return a},i.mod=function(n,s){let a=new Uint8Array(n);for(;a.length-s.length>=0;){const l=a[0];for(let c=0;c<s.length;c++)a[c]^=t.mul(s[c],l);let u=0;for(;u<a.length&&a[u]===0;)u++;a=a.slice(u)}return a},i.generateECPolynomial=function(n){let s=new Uint8Array([1]);for(let a=0;a<n;a++)s=i.mul(s,new Uint8Array([1,t.exp(a)]));return s}})(zy);const Uy=zy;function ud(i){this.genPoly=void 0,this.degree=i,this.degree&&this.initialize(this.degree)}ud.prototype.initialize=function(t){this.degree=t,this.genPoly=Uy.generateECPolynomial(this.degree)};ud.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(t.length+this.degree);e.set(t);const n=Uy.mod(e,this.genPoly),s=this.degree-n.length;if(s>0){const a=new Uint8Array(this.degree);return a.set(n,s),a}return n};var rC=ud,Wy={},xr={},cd={};cd.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var xs={};const Xy="[0-9]+",aC="[A-Z $%*+\\-./:]+";let Mo="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Mo=Mo.replace(/u/g,"\\u");const oC="(?:(?![A-Z0-9 $%*+\\-./:]|"+Mo+`)(?:.|[\r
]))+`;xs.KANJI=new RegExp(Mo,"g");xs.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");xs.BYTE=new RegExp(oC,"g");xs.NUMERIC=new RegExp(Xy,"g");xs.ALPHANUMERIC=new RegExp(aC,"g");const lC=new RegExp("^"+Mo+"$"),hC=new RegExp("^"+Xy+"$"),uC=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");xs.testKanji=function(t){return lC.test(t)};xs.testNumeric=function(t){return hC.test(t)};xs.testAlphanumeric=function(t){return uC.test(t)};(function(i){const t=cd,e=xs;i.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},i.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},i.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},i.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},i.MIXED={bit:-1},i.getCharCountIndicator=function(a,l){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!t.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?a.ccBits[0]:l<27?a.ccBits[1]:a.ccBits[2]},i.getBestModeForData=function(a){return e.testNumeric(a)?i.NUMERIC:e.testAlphanumeric(a)?i.ALPHANUMERIC:e.testKanji(a)?i.KANJI:i.BYTE},i.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},i.isValid=function(a){return a&&a.bit&&a.ccBits};function n(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return i.NUMERIC;case"alphanumeric":return i.ALPHANUMERIC;case"kanji":return i.KANJI;case"byte":return i.BYTE;default:throw new Error("Unknown mode: "+s)}}i.from=function(a,l){if(i.isValid(a))return a;try{return n(a)}catch{return l}}})(xr);(function(i){const t=Dn,e=$h,n=qh,s=xr,a=cd,l=7973,u=t.getBCHDigit(l);function c(E,I,S){for(let R=1;R<=40;R++)if(I<=i.getCapacity(R,S,E))return R}function p(E,I){return s.getCharCountIndicator(E,I)+4}function y(E,I){let S=0;return E.forEach(function(R){const D=p(R.mode,I);S+=D+R.getBitsLength()}),S}function _(E,I){for(let S=1;S<=40;S++)if(y(E,S)<=i.getCapacity(S,I,s.MIXED))return S}i.from=function(I,S){return a.isValid(I)?parseInt(I,10):S},i.getCapacity=function(I,S,R){if(!a.isValid(I))throw new Error("Invalid QR Code version");typeof R>"u"&&(R=s.BYTE);const D=t.getSymbolTotalCodewords(I),T=e.getTotalCodewordsCount(I,S),v=(D-T)*8;if(R===s.MIXED)return v;const k=v-p(R,I);switch(R){case s.NUMERIC:return Math.floor(k/10*3);case s.ALPHANUMERIC:return Math.floor(k/11*2);case s.KANJI:return Math.floor(k/13);case s.BYTE:default:return Math.floor(k/8)}},i.getBestVersionForData=function(I,S){let R;const D=n.from(S,n.M);if(Array.isArray(I)){if(I.length>1)return _(I,D);if(I.length===0)return 1;R=I[0]}else R=I;return c(R.mode,R.getLength(),D)},i.getEncodedBits=function(I){if(!a.isValid(I)||I<7)throw new Error("Invalid QR Code version");let S=I<<12;for(;t.getBCHDigit(S)-u>=0;)S^=l<<t.getBCHDigit(S)-u;return I<<12|S}})(Wy);var jy={};const Uc=Dn,Hy=1335,cC=21522,v1=Uc.getBCHDigit(Hy);jy.getEncodedBits=function(t,e){const n=t.bit<<3|e;let s=n<<10;for(;Uc.getBCHDigit(s)-v1>=0;)s^=Hy<<Uc.getBCHDigit(s)-v1;return(n<<10|s)^cC};var Yy={};const fC=xr;function Sa(i){this.mode=fC.NUMERIC,this.data=i.toString()}Sa.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};Sa.prototype.getLength=function(){return this.data.length};Sa.prototype.getBitsLength=function(){return Sa.getBitsLength(this.data.length)};Sa.prototype.write=function(t){let e,n,s;for(e=0;e+3<=this.data.length;e+=3)n=this.data.substr(e,3),s=parseInt(n,10),t.put(s,10);const a=this.data.length-e;a>0&&(n=this.data.substr(e),s=parseInt(n,10),t.put(s,a*3+1))};var dC=Sa;const gC=xr,ju=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Ta(i){this.mode=gC.ALPHANUMERIC,this.data=i}Ta.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};Ta.prototype.getLength=function(){return this.data.length};Ta.prototype.getBitsLength=function(){return Ta.getBitsLength(this.data.length)};Ta.prototype.write=function(t){let e;for(e=0;e+2<=this.data.length;e+=2){let n=ju.indexOf(this.data[e])*45;n+=ju.indexOf(this.data[e+1]),t.put(n,11)}this.data.length%2&&t.put(ju.indexOf(this.data[e]),6)};var mC=Ta,pC=function(t){for(var e=[],n=t.length,s=0;s<n;s++){var a=t.charCodeAt(s);if(a>=55296&&a<=56319&&n>s+1){var l=t.charCodeAt(s+1);l>=56320&&l<=57343&&(a=(a-55296)*1024+l-56320+65536,s+=1)}if(a<128){e.push(a);continue}if(a<2048){e.push(a>>6|192),e.push(a&63|128);continue}if(a<55296||a>=57344&&a<65536){e.push(a>>12|224),e.push(a>>6&63|128),e.push(a&63|128);continue}if(a>=65536&&a<=1114111){e.push(a>>18|240),e.push(a>>12&63|128),e.push(a>>6&63|128),e.push(a&63|128);continue}e.push(239,191,189)}return new Uint8Array(e).buffer};const yC=pC,xC=xr;function Da(i){this.mode=xC.BYTE,typeof i=="string"&&(i=yC(i)),this.data=new Uint8Array(i)}Da.getBitsLength=function(t){return t*8};Da.prototype.getLength=function(){return this.data.length};Da.prototype.getBitsLength=function(){return Da.getBitsLength(this.data.length)};Da.prototype.write=function(i){for(let t=0,e=this.data.length;t<e;t++)i.put(this.data[t],8)};var _C=Da;const wC=xr,bC=Dn;function Ma(i){this.mode=wC.KANJI,this.data=i}Ma.getBitsLength=function(t){return t*13};Ma.prototype.getLength=function(){return this.data.length};Ma.prototype.getBitsLength=function(){return Ma.getBitsLength(this.data.length)};Ma.prototype.write=function(i){let t;for(t=0;t<this.data.length;t++){let e=bC.toSJIS(this.data[t]);if(e>=33088&&e<=40956)e-=33088;else if(e>=57408&&e<=60351)e-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);e=(e>>>8&255)*192+(e&255),i.put(e,13)}};var EC=Ma,Zy={exports:{}};(function(i){var t={single_source_shortest_paths:function(e,n,s){var a={},l={};l[n]=0;var u=t.PriorityQueue.make();u.push(n,0);for(var c,p,y,_,E,I,S,R,D;!u.empty();){c=u.pop(),p=c.value,_=c.cost,E=e[p]||{};for(y in E)E.hasOwnProperty(y)&&(I=E[y],S=_+I,R=l[y],D=typeof l[y]>"u",(D||R>S)&&(l[y]=S,u.push(y,S),a[y]=p))}if(typeof s<"u"&&typeof l[s]>"u"){var T=["Could not find a path from ",n," to ",s,"."].join("");throw new Error(T)}return a},extract_shortest_path_from_predecessor_list:function(e,n){for(var s=[],a=n;a;)s.push(a),e[a],a=e[a];return s.reverse(),s},find_path:function(e,n,s){var a=t.single_source_shortest_paths(e,n,s);return t.extract_shortest_path_from_predecessor_list(a,s)},PriorityQueue:{make:function(e){var n=t.PriorityQueue,s={},a;e=e||{};for(a in n)n.hasOwnProperty(a)&&(s[a]=n[a]);return s.queue=[],s.sorter=e.sorter||n.default_sorter,s},default_sorter:function(e,n){return e.cost-n.cost},push:function(e,n){var s={value:e,cost:n};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};i.exports=t})(Zy);var IC=Zy.exports;(function(i){const t=xr,e=dC,n=mC,s=_C,a=EC,l=xs,u=Dn,c=IC;function p(T){return unescape(encodeURIComponent(T)).length}function y(T,v,k){const X=[];let H;for(;(H=T.exec(k))!==null;)X.push({data:H[0],index:H.index,mode:v,length:H[0].length});return X}function _(T){const v=y(l.NUMERIC,t.NUMERIC,T),k=y(l.ALPHANUMERIC,t.ALPHANUMERIC,T);let X,H;return u.isKanjiModeEnabled()?(X=y(l.BYTE,t.BYTE,T),H=y(l.KANJI,t.KANJI,T)):(X=y(l.BYTE_KANJI,t.BYTE,T),H=[]),v.concat(k,X,H).sort(function(z,q){return z.index-q.index}).map(function(z){return{data:z.data,mode:z.mode,length:z.length}})}function E(T,v){switch(v){case t.NUMERIC:return e.getBitsLength(T);case t.ALPHANUMERIC:return n.getBitsLength(T);case t.KANJI:return a.getBitsLength(T);case t.BYTE:return s.getBitsLength(T)}}function I(T){return T.reduce(function(v,k){const X=v.length-1>=0?v[v.length-1]:null;return X&&X.mode===k.mode?(v[v.length-1].data+=k.data,v):(v.push(k),v)},[])}function S(T){const v=[];for(let k=0;k<T.length;k++){const X=T[k];switch(X.mode){case t.NUMERIC:v.push([X,{data:X.data,mode:t.ALPHANUMERIC,length:X.length},{data:X.data,mode:t.BYTE,length:X.length}]);break;case t.ALPHANUMERIC:v.push([X,{data:X.data,mode:t.BYTE,length:X.length}]);break;case t.KANJI:v.push([X,{data:X.data,mode:t.BYTE,length:p(X.data)}]);break;case t.BYTE:v.push([{data:X.data,mode:t.BYTE,length:p(X.data)}])}}return v}function R(T,v){const k={},X={start:{}};let H=["start"];for(let K=0;K<T.length;K++){const z=T[K],q=[];for(let V=0;V<z.length;V++){const nt=z[V],ot=""+K+V;q.push(ot),k[ot]={node:nt,lastCount:0},X[ot]={};for(let j=0;j<H.length;j++){const tt=H[j];k[tt]&&k[tt].node.mode===nt.mode?(X[tt][ot]=E(k[tt].lastCount+nt.length,nt.mode)-E(k[tt].lastCount,nt.mode),k[tt].lastCount+=nt.length):(k[tt]&&(k[tt].lastCount=nt.length),X[tt][ot]=E(nt.length,nt.mode)+4+t.getCharCountIndicator(nt.mode,v))}}H=q}for(let K=0;K<H.length;K++)X[H[K]].end=0;return{map:X,table:k}}function D(T,v){let k;const X=t.getBestModeForData(T);if(k=t.from(v,X),k!==t.BYTE&&k.bit<X.bit)throw new Error('"'+T+'" cannot be encoded with mode '+t.toString(k)+`.
 Suggested mode is: `+t.toString(X));switch(k===t.KANJI&&!u.isKanjiModeEnabled()&&(k=t.BYTE),k){case t.NUMERIC:return new e(T);case t.ALPHANUMERIC:return new n(T);case t.KANJI:return new a(T);case t.BYTE:return new s(T)}}i.fromArray=function(v){return v.reduce(function(k,X){return typeof X=="string"?k.push(D(X,null)):X.data&&k.push(D(X.data,X.mode)),k},[])},i.fromString=function(v,k){const X=_(v,u.isKanjiModeEnabled()),H=S(X),K=R(H,k),z=c.find_path(K.map,"start","end"),q=[];for(let V=1;V<z.length-1;V++)q.push(K.table[z[V]].node);return i.fromArray(I(q))},i.rawSplit=function(v){return i.fromArray(_(v,u.isKanjiModeEnabled()))}})(Yy);const Qh=Dn,Hu=qh,CC=iC,AC=nC,RC=By,SC=Vy,Wc=Gy,Xc=$h,TC=rC,xh=Wy,DC=jy,MC=xr,Yu=Yy;function vC(i,t){const e=i.size,n=SC.getPositions(t);for(let s=0;s<n.length;s++){const a=n[s][0],l=n[s][1];for(let u=-1;u<=7;u++)if(!(a+u<=-1||e<=a+u))for(let c=-1;c<=7;c++)l+c<=-1||e<=l+c||(u>=0&&u<=6&&(c===0||c===6)||c>=0&&c<=6&&(u===0||u===6)||u>=2&&u<=4&&c>=2&&c<=4?i.set(a+u,l+c,!0,!0):i.set(a+u,l+c,!1,!0))}}function OC(i){const t=i.size;for(let e=8;e<t-8;e++){const n=e%2===0;i.set(e,6,n,!0),i.set(6,e,n,!0)}}function PC(i,t){const e=RC.getPositions(t);for(let n=0;n<e.length;n++){const s=e[n][0],a=e[n][1];for(let l=-2;l<=2;l++)for(let u=-2;u<=2;u++)l===-2||l===2||u===-2||u===2||l===0&&u===0?i.set(s+l,a+u,!0,!0):i.set(s+l,a+u,!1,!0)}}function NC(i,t){const e=i.size,n=xh.getEncodedBits(t);let s,a,l;for(let u=0;u<18;u++)s=Math.floor(u/3),a=u%3+e-8-3,l=(n>>u&1)===1,i.set(s,a,l,!0),i.set(a,s,l,!0)}function Zu(i,t,e){const n=i.size,s=DC.getEncodedBits(t,e);let a,l;for(a=0;a<15;a++)l=(s>>a&1)===1,a<6?i.set(a,8,l,!0):a<8?i.set(a+1,8,l,!0):i.set(n-15+a,8,l,!0),a<8?i.set(8,n-a-1,l,!0):a<9?i.set(8,15-a-1+1,l,!0):i.set(8,15-a-1,l,!0);i.set(n-8,8,1,!0)}function LC(i,t){const e=i.size;let n=-1,s=e-1,a=7,l=0;for(let u=e-1;u>0;u-=2)for(u===6&&u--;;){for(let c=0;c<2;c++)if(!i.isReserved(s,u-c)){let p=!1;l<t.length&&(p=(t[l]>>>a&1)===1),i.set(s,u-c,p),a--,a===-1&&(l++,a=7)}if(s+=n,s<0||e<=s){s-=n,n=-n;break}}}function kC(i,t,e){const n=new CC;e.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),MC.getCharCountIndicator(c.mode,i)),c.write(n)});const s=Qh.getSymbolTotalCodewords(i),a=Xc.getTotalCodewordsCount(i,t),l=(s-a)*8;for(n.getLengthInBits()+4<=l&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const u=(l-n.getLengthInBits())/8;for(let c=0;c<u;c++)n.put(c%2?17:236,8);return FC(n,i,t)}function FC(i,t,e){const n=Qh.getSymbolTotalCodewords(t),s=Xc.getTotalCodewordsCount(t,e),a=n-s,l=Xc.getBlocksCount(t,e),u=n%l,c=l-u,p=Math.floor(n/l),y=Math.floor(a/l),_=y+1,E=p-y,I=new TC(E);let S=0;const R=new Array(l),D=new Array(l);let T=0;const v=new Uint8Array(i.buffer);for(let z=0;z<l;z++){const q=z<c?y:_;R[z]=v.slice(S,S+q),D[z]=I.encode(R[z]),S+=q,T=Math.max(T,q)}const k=new Uint8Array(n);let X=0,H,K;for(H=0;H<T;H++)for(K=0;K<l;K++)H<R[K].length&&(k[X++]=R[K][H]);for(H=0;H<E;H++)for(K=0;K<l;K++)k[X++]=D[K][H];return k}function BC(i,t,e,n){let s;if(Array.isArray(i))s=Yu.fromArray(i);else if(typeof i=="string"){let p=t;if(!p){const y=Yu.rawSplit(i);p=xh.getBestVersionForData(y,e)}s=Yu.fromString(i,p||40)}else throw new Error("Invalid data");const a=xh.getBestVersionForData(s,e);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=a;else if(t<a)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+a+`.
`);const l=kC(t,e,s),u=Qh.getSymbolSize(t),c=new AC(u);return vC(c,t),OC(c),PC(c,t),Zu(c,e,0),t>=7&&NC(c,t),LC(c,l),isNaN(n)&&(n=Wc.getBestMask(c,Zu.bind(null,c,e))),Wc.applyMask(n,c),Zu(c,e,n),{modules:c,version:t,errorCorrectionLevel:e,maskPattern:n,segments:s}}ky.create=function(t,e){if(typeof t>"u"||t==="")throw new Error("No input text");let n=Hu.M,s,a;return typeof e<"u"&&(n=Hu.from(e.errorCorrectionLevel,Hu.M),s=xh.from(e.version),a=Wc.from(e.maskPattern),e.toSJISFunc&&Qh.setToSJISFunction(e.toSJISFunc)),BC(t,s,n,a)};var Ky={},fd={};(function(i){function t(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let n=e.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+e);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(a){return[a,a]}))),n.length===6&&n.push("F","F");const s=parseInt(n.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+n.slice(0,6).join("")}}i.getOptions=function(n){n||(n={}),n.color||(n.color={});const s=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,a=n.width&&n.width>=21?n.width:void 0,l=n.scale||4;return{width:a,scale:a?4:l,margin:s,color:{dark:t(n.color.dark||"#000000ff"),light:t(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},i.getScale=function(n,s){return s.width&&s.width>=n+s.margin*2?s.width/(n+s.margin*2):s.scale},i.getImageWidth=function(n,s){const a=i.getScale(n,s);return Math.floor((n+s.margin*2)*a)},i.qrToImageData=function(n,s,a){const l=s.modules.size,u=s.modules.data,c=i.getScale(l,a),p=Math.floor((l+a.margin*2)*c),y=a.margin*c,_=[a.color.light,a.color.dark];for(let E=0;E<p;E++)for(let I=0;I<p;I++){let S=(E*p+I)*4,R=a.color.light;if(E>=y&&I>=y&&E<p-y&&I<p-y){const D=Math.floor((E-y)/c),T=Math.floor((I-y)/c);R=_[u[D*l+T]?1:0]}n[S++]=R.r,n[S++]=R.g,n[S++]=R.b,n[S]=R.a}}})(fd);(function(i){const t=fd;function e(s,a,l){s.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=l,a.width=l,a.style.height=l+"px",a.style.width=l+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}i.render=function(a,l,u){let c=u,p=l;typeof c>"u"&&(!l||!l.getContext)&&(c=l,l=void 0),l||(p=n()),c=t.getOptions(c);const y=t.getImageWidth(a.modules.size,c),_=p.getContext("2d"),E=_.createImageData(y,y);return t.qrToImageData(E.data,a,c),e(_,p,y),_.putImageData(E,0,0),p},i.renderToDataURL=function(a,l,u){let c=u;typeof c>"u"&&(!l||!l.getContext)&&(c=l,l=void 0),c||(c={});const p=i.render(a,l,c),y=c.type||"image/png",_=c.rendererOpts||{};return p.toDataURL(y,_.quality)}})(Ky);var qy={};const VC=fd;function O1(i,t){const e=i.a/255,n=t+'="'+i.hex+'"';return e<1?n+" "+t+'-opacity="'+e.toFixed(2).slice(1)+'"':n}function Ku(i,t,e){let n=i+t;return typeof e<"u"&&(n+=" "+e),n}function GC(i,t,e){let n="",s=0,a=!1,l=0;for(let u=0;u<i.length;u++){const c=Math.floor(u%t),p=Math.floor(u/t);!c&&!a&&(a=!0),i[u]?(l++,u>0&&c>0&&i[u-1]||(n+=a?Ku("M",c+e,.5+p+e):Ku("m",s,0),s=0,a=!1),c+1<t&&i[u+1]||(n+=Ku("h",l),l=0)):s++}return n}qy.render=function(t,e,n){const s=VC.getOptions(e),a=t.modules.size,l=t.modules.data,u=a+s.margin*2,c=s.color.light.a?"<path "+O1(s.color.light,"fill")+' d="M0 0h'+u+"v"+u+'H0z"/>':"",p="<path "+O1(s.color.dark,"stroke")+' d="'+GC(l,a,s.margin)+'"/>',y='viewBox="0 0 '+u+" "+u+'"',E='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+y+' shape-rendering="crispEdges">'+c+p+`</svg>
`;return typeof n=="function"&&n(null,E),E};const zC=tC,jc=ky,$y=Ky,UC=qy;function dd(i,t,e,n,s){const a=[].slice.call(arguments,1),l=a.length,u=typeof a[l-1]=="function";if(!u&&!zC())throw new Error("Callback required as last argument");if(u){if(l<2)throw new Error("Too few arguments provided");l===2?(s=e,e=t,t=n=void 0):l===3&&(t.getContext&&typeof s>"u"?(s=n,n=void 0):(s=n,n=e,e=t,t=void 0))}else{if(l<1)throw new Error("Too few arguments provided");return l===1?(e=t,t=n=void 0):l===2&&!t.getContext&&(n=e,e=t,t=void 0),new Promise(function(c,p){try{const y=jc.create(e,n);c(i(y,t,n))}catch(y){p(y)}})}try{const c=jc.create(e,n);s(null,i(c,t,n))}catch(c){s(c)}}cl.create=jc.create;cl.toCanvas=dd.bind(null,$y.render);cl.toDataURL=dd.bind(null,$y.renderToDataURL);cl.toString=dd.bind(null,function(i,t,e){return UC.render(i,e)});const Va=new URLSearchParams(window.location.search),rs=Va.get("geoserver_address"),_h=Va.get("namespace"),WC=_h+":"+Va.get("wfs_feature_name"),er=_h+":"+Va.get("wfs_files_view"),nr=Va.get("id_property"),XC=JSON.parse(Va.get("info_attrs"));var _t;(function(i){i.AllocationStamp="ASP",i.BaseStation="BSN",i.CodedComment="CCT",i.CodedCommentGroup="CCG",i.CodedCommentListValue="CCL",i.ColourLegend="CLD",i.ColourRange="CRG",i.CommentAllocation="CAN",i.Connection="CNN",i.ControlAssignment="CAT",i.CropType="CTP",i.CropVariety="CVT",i.CulturalPractice="CPC",i.Customer="CTR",i.DataLogTrigger="DLT",i.DataLogValue="DLV",i.Device="DVC",i.DeviceAllocation="DAN",i.DeviceElement="DET",i.DeviceObjectReference="DOR",i.DeviceProcessData="DPD",i.DeviceProperty="DPT",i.DeviceValuePresentation="DVP",i.Farm="FRM",i.Grid="GRD",i.GuidanceAllocation="GAN",i.GuidanceGroup="GGP",i.GuidancePattern="GPN",i.GuidanceShift="GST",i.LineString="LSG",i.OperationTechnique="OTQ",i.OperationTechniqueReference="OTR",i.OperTechPractice="OTP",i.Partfield="PFD",i.Point="PNT",i.Polygon="PLN",i.Position="PTN",i.ProcessDataVariable="PDV",i.Product="PDT",i.ProductAllocation="PAN",i.ProductGroup="PGP",i.ProductRelation="PRN",i.Task="TSK",i.Time="TIM",i.TimeLog="TLG",i.TreatmentZone="TZN",i.ValuePresentation="VPN",i.Worker="WKR",i.WorkerAllocation="WAN",i.AttachedFile="AFE",i.ISO11783TaskDataFile="ISO11783_TaskData",i.TaskControllerCapabilities="TCC",i.ExternalFileReference="XFR",i.ISO11783LinkListFile="ISO11783LinkList",i.Link="LNK",i.LinkGroup="LGP",i.ExternalFileContents="XFC"})(_t||(_t={}));const Kl={};function $t(i,t,e){Kl[i]=Kl[i]||{},Kl[i][t]=e}function oo(i,t){return Kl[i][t]}const jC={0:{DDI:0,name:"Data Dictionary Version",unit:"",bitResolution:1},1:{DDI:1,name:"Setpoint Volume Per Area Application Rate as [mm³/m²]",unit:"mm³/m²",bitResolution:.01},2:{DDI:2,name:"Actual Volume Per Area Application Rate as [mm³/m²]",unit:"mm³/m²",bitResolution:.01},3:{DDI:3,name:"Default Volume Per Area Application Rate as [mm³/m²]",unit:"mm³/m²",bitResolution:.01},4:{DDI:4,name:"Minimum Volume Per Area Application Rate as [mm³/m²]",unit:"mm³/m²",bitResolution:.01},5:{DDI:5,name:"Maximum Volume Per Area Application Rate as [mm³/m²]",unit:"mm³/m²",bitResolution:.01},6:{DDI:6,name:"Setpoint Mass Per Area Application Rate",unit:"mg/m²",bitResolution:1},7:{DDI:7,name:"Actual Mass Per Area Application Rate",unit:"mg/m²",bitResolution:1},8:{DDI:8,name:"Default Mass Per Area Application Rate",unit:"mg/m²",bitResolution:1},9:{DDI:9,name:"Minimum Mass Per Area Application Rate",unit:"mg/m²",bitResolution:1},10:{DDI:10,name:"Maximum Mass Per Area Application Rate",unit:"mg/m²",bitResolution:1},11:{DDI:11,name:"Setpoint Count Per Area Application Rate",unit:"/m²",bitResolution:.001},12:{DDI:12,name:"Actual Count Per Area Application Rate",unit:"/m²",bitResolution:.001},13:{DDI:13,name:"Default Count Per Area Application Rate",unit:"/m²",bitResolution:.001},14:{DDI:14,name:"Minimum Count Per Area Application Rate",unit:"/m²",bitResolution:.001},15:{DDI:15,name:"Maximum Count Per Area Application Rate",unit:"/m²",bitResolution:.001},16:{DDI:16,name:"Setpoint Spacing Application Rate",unit:"mm",bitResolution:1},17:{DDI:17,name:"Actual Spacing Application Rate",unit:"mm",bitResolution:1},18:{DDI:18,name:"Default Spacing Application Rate",unit:"mm",bitResolution:1},19:{DDI:19,name:"Minimum Spacing Application Rate",unit:"mm",bitResolution:1},20:{DDI:20,name:"Maximum Spacing Application Rate",unit:"mm",bitResolution:1},21:{DDI:21,name:"Setpoint Volume Per Volume Application Rate",unit:"mm³/m³",bitResolution:1},22:{DDI:22,name:"Actual Volume Per Volume Application Rate",unit:"mm³/m³",bitResolution:1},23:{DDI:23,name:"Default Volume Per Volume Application Rate",unit:"mm³/m³",bitResolution:1},24:{DDI:24,name:"Minimum Volume Per Volume Application Rate",unit:"mm³/m³",bitResolution:1},25:{DDI:25,name:"Maximum Volume Per Volume Application Rate",unit:"mm³/m³",bitResolution:1},26:{DDI:26,name:"Setpoint Mass Per Mass Application Rate",unit:"mg/kg",bitResolution:1},27:{DDI:27,name:"Actual Mass Per Mass Application Rate",unit:"mg/kg",bitResolution:1},28:{DDI:28,name:"Default Mass Per Mass Application Rate",unit:"mg/kg",bitResolution:1},29:{DDI:29,name:"Minimum Mass Per Mass Application Rate",unit:"mg/kg",bitResolution:1},30:{DDI:30,name:"MaximumMass Per Mass Application Rate",unit:"mg/kg",bitResolution:1},31:{DDI:31,name:"Setpoint Volume Per Mass Application Rate",unit:"mm³/kg",bitResolution:1},32:{DDI:32,name:"Actual Volume Per Mass Application Rate",unit:"mm³/kg",bitResolution:1},33:{DDI:33,name:"Default Volume Per Mass Application Rate",unit:"mm³/kg",bitResolution:1},34:{DDI:34,name:"Minimum Volume Per Mass Application Rate",unit:"mm³/kg",bitResolution:1},35:{DDI:35,name:"Maximum Volume Per Mass Application Rate",unit:"mm³/kg",bitResolution:1},36:{DDI:36,name:"Setpoint Volume Per Time Application Rate",unit:"mm³/s",bitResolution:1},37:{DDI:37,name:"Actual Volume Per Time Application Rate",unit:"mm³/s",bitResolution:1},38:{DDI:38,name:"Default Volume Per Time Application Rate",unit:"mm³/s",bitResolution:1},39:{DDI:39,name:"Minimum Volume Per Time Application Rate",unit:"mm³/s",bitResolution:1},40:{DDI:40,name:"Maximum Volume Per Time Application Rate",unit:"mm³/s",bitResolution:1},41:{DDI:41,name:"Setpoint Mass Per Time Application Rate",unit:"mg/s",bitResolution:1},42:{DDI:42,name:"Actual Mass Per Time Application Rate",unit:"mg/s",bitResolution:1},43:{DDI:43,name:"Default Mass Per Time Application Rate",unit:"mg/s",bitResolution:1},44:{DDI:44,name:"Minimum Mass Per Time Application Rate",unit:"mg/s",bitResolution:1},45:{DDI:45,name:"Maximum Mass Per Time Application Rate",unit:"mg/s",bitResolution:1},46:{DDI:46,name:"Setpoint Count Per Time Application Rate",unit:"/s",bitResolution:.001},47:{DDI:47,name:"Actual Count Per Time Application Rate",unit:"/s",bitResolution:.001},48:{DDI:48,name:"Default Count Per Time Application Rate",unit:"/s",bitResolution:.001},49:{DDI:49,name:"Minimum Count Per Time Application Rate",unit:"/s",bitResolution:.001},50:{DDI:50,name:"Maximum Count Per Time Application Rate",unit:"/s",bitResolution:.001},51:{DDI:51,name:"Setpoint Tillage Depth",unit:"mm",bitResolution:1},52:{DDI:52,name:"Actual Tillage Depth",unit:"mm",bitResolution:1},53:{DDI:53,name:"Default Tillage Depth",unit:"mm",bitResolution:1},54:{DDI:54,name:"Minimum Tillage Depth",unit:"mm",bitResolution:1},55:{DDI:55,name:"Maximum Tillage Depth",unit:"mm",bitResolution:1},56:{DDI:56,name:"Setpoint Seeding Depth",unit:"mm",bitResolution:1},57:{DDI:57,name:"Actual Seeding Depth",unit:"mm",bitResolution:1},58:{DDI:58,name:"Default Seeding Depth",unit:"mm",bitResolution:1},59:{DDI:59,name:"Minimum Seeding Depth",unit:"mm",bitResolution:1},60:{DDI:60,name:"Maximum Seeding Depth",unit:"mm",bitResolution:1},61:{DDI:61,name:"Setpoint Working Height",unit:"mm",bitResolution:1},62:{DDI:62,name:"Actual Working Height",unit:"mm",bitResolution:1},63:{DDI:63,name:"Default Working Height",unit:"mm",bitResolution:1},64:{DDI:64,name:"Minimum Working Height",unit:"mm",bitResolution:1},65:{DDI:65,name:"Maximum Working Height",unit:"mm",bitResolution:1},66:{DDI:66,name:"Setpoint Working Width",unit:"mm",bitResolution:1},67:{DDI:67,name:"Actual Working Width",unit:"mm",bitResolution:1},68:{DDI:68,name:"Default Working Width",unit:"mm",bitResolution:1},69:{DDI:69,name:"Minimum Working Width",unit:"mm",bitResolution:1},70:{DDI:70,name:"Maximum Working Width",unit:"mm",bitResolution:1},71:{DDI:71,name:"Setpoint Volume Content",unit:"ml",bitResolution:1},72:{DDI:72,name:"Actual Volume Content",unit:"ml",bitResolution:1},73:{DDI:73,name:"Maximum Volume Content",unit:"ml",bitResolution:1},74:{DDI:74,name:"Setpoint Mass Content",unit:"g",bitResolution:1},75:{DDI:75,name:"Actual Mass Content",unit:"g",bitResolution:1},76:{DDI:76,name:"Maximum Mass Content",unit:"g",bitResolution:1},77:{DDI:77,name:"Setpoint Count Content",unit:"#",bitResolution:1},78:{DDI:78,name:"Actual Count Content",unit:"#",bitResolution:1},79:{DDI:79,name:"Maximum Count Content",unit:"#",bitResolution:1},80:{DDI:80,name:"Application Total Volume as [L]",unit:"L",bitResolution:1},81:{DDI:81,name:"Application Total Mass in [kg]",unit:"kg",bitResolution:1},82:{DDI:82,name:"Application Total Count",unit:"#",bitResolution:1},83:{DDI:83,name:"Volume Per Area Yield",unit:"ml/m²",bitResolution:1},84:{DDI:84,name:"Mass Per Area Yield",unit:"mg/m²",bitResolution:1},85:{DDI:85,name:"Count Per Area Yield",unit:"/m²",bitResolution:.001},86:{DDI:86,name:"Volume Per Time Yield",unit:"ml/s",bitResolution:1},87:{DDI:87,name:"Mass Per Time Yield",unit:"mg/s",bitResolution:1},88:{DDI:88,name:"Count Per Time Yield",unit:"/s",bitResolution:.001},89:{DDI:89,name:"Yield Total Volume",unit:"L",bitResolution:1},90:{DDI:90,name:"Yield Total Mass",unit:"kg",bitResolution:1},91:{DDI:91,name:"Yield Total Count",unit:"#",bitResolution:1},92:{DDI:92,name:"Volume Per Area Crop Loss",unit:"ml/m²",bitResolution:1},93:{DDI:93,name:"Mass Per Area Crop Loss",unit:"mg/m²",bitResolution:1},94:{DDI:94,name:"Count Per Area Crop Loss",unit:"/m²",bitResolution:.001},95:{DDI:95,name:"Volume Per Time Crop Loss",unit:"ml/s",bitResolution:1},96:{DDI:96,name:"Mass Per Time Crop Loss",unit:"mg/s",bitResolution:1},97:{DDI:97,name:"Count Per Time Crop Loss",unit:"/s",bitResolution:.001},98:{DDI:98,name:"Percentage Crop Loss",unit:"ppm",bitResolution:1},99:{DDI:99,name:"Crop Moisture",unit:"ppm",bitResolution:1},100:{DDI:100,name:"Crop Contamination",unit:"ppm",bitResolution:1},101:{DDI:101,name:"Setpoint Bale Width",unit:"mm",bitResolution:1},102:{DDI:102,name:"Actual Bale Width",unit:"mm",bitResolution:1},103:{DDI:103,name:"Default Bale Width",unit:"mm",bitResolution:1},104:{DDI:104,name:"Minimum Bale Width",unit:"mm",bitResolution:1},105:{DDI:105,name:"Maximum Bale Width",unit:"mm",bitResolution:1},106:{DDI:106,name:"Setpoint Bale Height",unit:"mm",bitResolution:1},107:{DDI:107,name:"ActualBaleHeight",unit:"mm",bitResolution:1},108:{DDI:108,name:"Default Bale Height",unit:"mm",bitResolution:1},109:{DDI:109,name:"Minimum Bale Height",unit:"mm",bitResolution:1},110:{DDI:110,name:"Maximum Bale Height",unit:"mm",bitResolution:1},111:{DDI:111,name:"Setpoint Bale Size",unit:"mm",bitResolution:1},112:{DDI:112,name:"Actual Bale Size",unit:"mm",bitResolution:1},113:{DDI:113,name:"Default Bale Size",unit:"mm",bitResolution:1},114:{DDI:114,name:"Minimum Bale Size",unit:"mm",bitResolution:1},115:{DDI:115,name:"Maximum Bale Size",unit:"mm",bitResolution:1},116:{DDI:116,name:"Total Area",unit:"m²",bitResolution:1},117:{DDI:117,name:"Effective Total Distance",unit:"mm",bitResolution:1},118:{DDI:118,name:"Ineffective Total Distance",unit:"mm",bitResolution:1},119:{DDI:119,name:"Effective Total Time",unit:"s",bitResolution:1},120:{DDI:120,name:"Ineffective Total Time",unit:"s",bitResolution:1},121:{DDI:121,name:"Product Density Mass Per Volume",unit:"mg/l",bitResolution:1},122:{DDI:122,name:"Product Density Mass PerCount",unit:"mg/1000",bitResolution:1},123:{DDI:123,name:"Product Density Volume Per Count",unit:"ml/1000",bitResolution:1},124:{DDI:124,name:"Auxiliary Valve Scaling Extend",unit:"0.00%",bitResolution:.1},125:{DDI:125,name:"Auxiliary Valve Scaling Retract",unit:"0.00%",bitResolution:.1},126:{DDI:126,name:"Auxiliary Valve Ramp Extend Up",unit:"ms",bitResolution:1},127:{DDI:127,name:"Auxiliary Valve Ramp Extend Down",unit:"ms",bitResolution:1},128:{DDI:128,name:"Auxiliary Valve Ramp Retract Up",unit:"ms",bitResolution:1},129:{DDI:129,name:"Auxiliary Valve Ramp Retract Down",unit:"ms",bitResolution:1},130:{DDI:130,name:"Auxiliary Valve Float Threshold",unit:"0.00%",bitResolution:.1},131:{DDI:131,name:"Auxiliary Valve Progressivity Extend",unit:"n.a.",bitResolution:1},132:{DDI:132,name:"Auxiliary Valve Progressivity Retract",unit:"n.a.",bitResolution:1},133:{DDI:133,name:"Auxiliary Valve Invert Ports",unit:"n.a.",bitResolution:1},134:{DDI:134,name:"Device Element Offset X",unit:"mm",bitResolution:1},135:{DDI:135,name:"Device Element Offset Y",unit:"mm",bitResolution:1},136:{DDI:136,name:"Device Element Offset Z",unit:"mm",bitResolution:1},137:{DDI:137,name:"Device Volume Capacity",unit:"ml",bitResolution:1},138:{DDI:138,name:"Device Mass Capacity",unit:"g",bitResolution:1},139:{DDI:139,name:"Device Count Capacity",unit:"#",bitResolution:1},140:{DDI:140,name:"Setpoint Percentage Application Rate",unit:"ppm",bitResolution:1},141:{DDI:141,name:"Actual Work State",unit:"n.a.",bitResolution:1},142:{DDI:142,name:"Physical Setpoint Time Latency",unit:"ms",bitResolution:1},143:{DDI:143,name:"Physical Actual Value Time Latency",unit:"ms",bitResolution:1},144:{DDI:144,name:"Yaw Angle",unit:"°",bitResolution:.001},145:{DDI:145,name:"Roll Angle",unit:"°",bitResolution:.001},146:{DDI:146,name:"Pitch Angle",unit:"°",bitResolution:.001},147:{DDI:147,name:"Log Count",unit:"n.a.",bitResolution:1},148:{DDI:148,name:"Total Fuel Consumption",unit:"ml",bitResolution:1},149:{DDI:149,name:"Instantaneous Fuel Consumption per Time",unit:"mm³/s",bitResolution:1},150:{DDI:150,name:"Instantaneous Fuel Consumption per Area",unit:"mm³/m²",bitResolution:1},151:{DDI:151,name:"Instantaneous Area Per Time Capacity",unit:"mm²/s",bitResolution:1},153:{DDI:153,name:"Actual Normalized Difference Vegetative Index (NDVI)",unit:"n.a.",bitResolution:.001},154:{DDI:154,name:"Physical Object Length",unit:"mm",bitResolution:1},155:{DDI:155,name:"Physical Object Width",unit:"mm",bitResolution:1},156:{DDI:156,name:"Physical Object Height",unit:"mm",bitResolution:1},157:{DDI:157,name:"Connector Type",unit:"n.a.",bitResolution:1},158:{DDI:158,name:"Prescription Control State",unit:"n.a.",bitResolution:1},159:{DDI:159,name:"Number of Sub-Units per Section",unit:"#",bitResolution:1},160:{DDI:160,name:"Section Control State",unit:"n.a.",bitResolution:1},161:{DDI:161,name:"Actual Condensed Work State (1-16)",unit:"n.a.",bitResolution:1},162:{DDI:162,name:"Actual Condensed Work State (17-32)",unit:"n.a.",bitResolution:1},163:{DDI:163,name:"Actual Condensed Work State (33-48)",unit:"n.a.",bitResolution:1},164:{DDI:164,name:"Actual Condensed Work State (49-64)",unit:"n.a.",bitResolution:1},165:{DDI:165,name:"Actual Condensed Work State (65-80)",unit:"n.a.",bitResolution:1},166:{DDI:166,name:"Actual Condensed Work State (81-96)",unit:"n.a.",bitResolution:1},167:{DDI:167,name:"Actual Condensed Work State (97-112)",unit:"n.a.",bitResolution:1},168:{DDI:168,name:"Actual Condensed Work State (113-128)",unit:"n.a.",bitResolution:1},169:{DDI:169,name:"Actual Condensed Work State (129-144)",unit:"n.a.",bitResolution:1},170:{DDI:170,name:"Actual Condensed Work State (145-160)",unit:"n.a.",bitResolution:1},171:{DDI:171,name:"Actual Condensed Work State (161-176)",unit:"n.a.",bitResolution:1},172:{DDI:172,name:"Actual Condensed Work State (177-192)",unit:"n.a.",bitResolution:1},173:{DDI:173,name:"Actual Condensed Work State (193-208)",unit:"n.a.",bitResolution:1},174:{DDI:174,name:"Actual Condensed Work State (209-224)",unit:"n.a.",bitResolution:1},175:{DDI:175,name:"Actual Condensed Work State (225-240)",unit:"n.a.",bitResolution:1},176:{DDI:176,name:"Actual Condensed Work State (241-256)",unit:"n.a.",bitResolution:1},177:{DDI:177,name:"Actual length of cut",unit:"mm",bitResolution:.001},178:{DDI:178,name:"Element Type Instance",unit:"n.a.",bitResolution:1},179:{DDI:179,name:"Actual Cultural Practice",unit:"n.a.",bitResolution:1},180:{DDI:180,name:"Device Reference Point (DRP) to Ground distance",unit:"mm",bitResolution:1},181:{DDI:181,name:"Dry Mass Per Area Yield",unit:"mg/m²",bitResolution:1},182:{DDI:182,name:"Dry Mass Per Time Yield",unit:"mg/s",bitResolution:1},183:{DDI:183,name:"Yield Total Dry Mass",unit:"kg",bitResolution:1},184:{DDI:184,name:"Reference Moisture For Dry Mass",unit:"ppm",bitResolution:1},185:{DDI:185,name:"Seed Cotton Mass Per Area Yield",unit:"mg/m²",bitResolution:1},186:{DDI:186,name:"Lint Cotton Mass Per Area Yield",unit:"mg/m²",bitResolution:1},187:{DDI:187,name:"Seed Cotton Mass Per Time Yield",unit:"mg/s",bitResolution:1},188:{DDI:188,name:"Lint Cotton Mass Per Time Yield",unit:"mg/s",bitResolution:1},189:{DDI:189,name:"Yield Total Seed Cotton Mass",unit:"kg",bitResolution:1},190:{DDI:190,name:"Yield Total Lint Cotton Mass",unit:"kg",bitResolution:1},191:{DDI:191,name:"Lint Turnout Percentage ",unit:"ppm",bitResolution:1},192:{DDI:192,name:"Ambient temperature",unit:"mK",bitResolution:1},193:{DDI:193,name:"Setpoint Product Pressure",unit:"Pa",bitResolution:.1},194:{DDI:194,name:"Actual Product Pressure",unit:"Pa",bitResolution:.1},195:{DDI:195,name:"Minimum Product Pressure",unit:"Pa",bitResolution:.1},196:{DDI:196,name:"Maximum Product Pressure",unit:"Pa",bitResolution:.1},197:{DDI:197,name:"Setpoint Pump Output Pressure",unit:"Pa",bitResolution:.1},198:{DDI:198,name:"Actual Pump Output Pressure",unit:"Pa",bitResolution:.1},199:{DDI:199,name:"Minimum Pump Output Pressure",unit:"Pa",bitResolution:.1},200:{DDI:200,name:"Maximum Pump Output Pressure",unit:"Pa",bitResolution:.1},201:{DDI:201,name:"Setpoint Tank Agitation Pressure",unit:"Pa",bitResolution:.1},202:{DDI:202,name:"Actual Tank Agitation Pressure",unit:"Pa",bitResolution:.1},203:{DDI:203,name:"Minimum Tank Agitation Pressure",unit:"Pa",bitResolution:.1},204:{DDI:204,name:"Maximum Tank Agitation Pressure",unit:"Pa",bitResolution:.1},205:{DDI:205,name:"SC Turn On Time",unit:"ms",bitResolution:1},206:{DDI:206,name:"SC Turn Off Time",unit:"ms",bitResolution:1},207:{DDI:207,name:"Wind speed",unit:"mm/s",bitResolution:1},208:{DDI:208,name:"Wind direction",unit:"°",bitResolution:1},209:{DDI:209,name:"Relative Humidity",unit:"0.00%",bitResolution:1},210:{DDI:210,name:"Sky conditions",unit:"n.a.",bitResolution:1},211:{DDI:211,name:"Last Bale Flakes per Bale",unit:"#",bitResolution:1},212:{DDI:212,name:"Last Bale Average Moisture",unit:"ppm",bitResolution:1},213:{DDI:213,name:"Last Bale Average Strokes per Flake",unit:"#",bitResolution:1},214:{DDI:214,name:"Lifetime Bale Count",unit:"#",bitResolution:1},215:{DDI:215,name:"Lifetime Working Hours",unit:"h",bitResolution:.05},216:{DDI:216,name:"Actual Bale Hydraulic Pressure",unit:"Pa",bitResolution:1},217:{DDI:217,name:"Last Bale Average Hydraulic Pressure",unit:"Pa",bitResolution:1},218:{DDI:218,name:"Setpoint Bale Compression Plunger Load",unit:"ppm",bitResolution:1},219:{DDI:219,name:"Actual Bale Compression Plunger Load",unit:"ppm",bitResolution:1},220:{DDI:220,name:"Last Bale Average Bale Compression Plunger Load",unit:"ppm",bitResolution:1},221:{DDI:221,name:"Last Bale Applied Preservative",unit:"ml",bitResolution:1},222:{DDI:222,name:"Last Bale Tag Number",unit:"n.a.",bitResolution:1},223:{DDI:223,name:"Last Bale Mass",unit:"g",bitResolution:1},224:{DDI:224,name:"Delta T",unit:"mK",bitResolution:1},225:{DDI:225,name:"Setpoint Working Length",unit:"mm",bitResolution:1},226:{DDI:226,name:"Actual Working Length",unit:"mm",bitResolution:1},227:{DDI:227,name:"Minimum Working Length",unit:"mm",bitResolution:1},228:{DDI:228,name:"Maximum Working Length",unit:"mm",bitResolution:1},229:{DDI:229,name:"Actual Net Weight",unit:"g",bitResolution:1},230:{DDI:230,name:"Net Weight State",unit:"n.a.",bitResolution:1},231:{DDI:231,name:"Setpoint Net Weight",unit:"g",bitResolution:1},232:{DDI:232,name:"Actual Gross Weight",unit:"g",bitResolution:1},233:{DDI:233,name:"Gross Weight State",unit:"n.a.",bitResolution:1},234:{DDI:234,name:"Minimum Gross Weight",unit:"g",bitResolution:1},235:{DDI:235,name:"Maximum Gross Weight",unit:"g",bitResolution:1},236:{DDI:236,name:"Thresher Engagement Total Time",unit:"s",bitResolution:1},237:{DDI:237,name:"Actual Header Working Height Status",unit:"n.a.",bitResolution:1},238:{DDI:238,name:"Actual Header Rotational Speed Status",unit:"n.a.",bitResolution:1},239:{DDI:239,name:"Yield Hold Status",unit:"n.a.",bitResolution:1},240:{DDI:240,name:"Actual (Un)Loading System Status",unit:"n.a.",bitResolution:1},241:{DDI:241,name:"Crop Temperature",unit:"mK",bitResolution:1},242:{DDI:242,name:"Setpoint Sieve Clearance",unit:"mm",bitResolution:1},243:{DDI:243,name:"Actual Sieve Clearance",unit:"mm",bitResolution:1},244:{DDI:244,name:"Minimum Sieve Clearance",unit:"mm",bitResolution:1},245:{DDI:245,name:"Maximum Sieve Clearance",unit:"mm",bitResolution:1},246:{DDI:246,name:"Setpoint Chaffer Clearance",unit:"mm",bitResolution:1},247:{DDI:247,name:"Actual Chaffer Clearance",unit:"mm",bitResolution:1},248:{DDI:248,name:"Minimum Chaffer Clearance",unit:"mm",bitResolution:1},249:{DDI:249,name:"Maximum Chaffer Clearance",unit:"mm",bitResolution:1},250:{DDI:250,name:"Setpoint Concave Clearance",unit:"mm",bitResolution:1},251:{DDI:251,name:"Actual Concave Clearance",unit:"mm",bitResolution:1},252:{DDI:252,name:"Minimum Concave Clearance",unit:"mm",bitResolution:1},253:{DDI:253,name:"Maximum Concave Clearance",unit:"mm",bitResolution:1},254:{DDI:254,name:"Setpoint Separation Fan Rotational Speed",unit:"/s",bitResolution:.001},255:{DDI:255,name:"Actual Separation Fan Rotational Speed",unit:"/s",bitResolution:.001},256:{DDI:256,name:"Minimum Separation Fan Rotational Speed",unit:"/s",bitResolution:.001},257:{DDI:257,name:"Maximum Separation Fan Rotational Speed",unit:"/s",bitResolution:.001},258:{DDI:258,name:"Hydraulic Oil Temperature",unit:"mK",bitResolution:1},259:{DDI:259,name:"Yield Lag Ignore Time",unit:"ms",bitResolution:1},260:{DDI:260,name:"Yield Lead Ignore Time",unit:"ms",bitResolution:1},261:{DDI:261,name:"Average Yield Mass Per Time",unit:"mg/s",bitResolution:1},262:{DDI:262,name:"Average Crop Moisture",unit:"ppm",bitResolution:1},263:{DDI:263,name:"Average Yield Mass Per Area",unit:"mg/m²",bitResolution:1},264:{DDI:264,name:"Connector Pivot X-Offset",unit:"mm",bitResolution:1},265:{DDI:265,name:"Remaining Area",unit:"m²",bitResolution:1},266:{DDI:266,name:"Lifetime Application Total Mass",unit:"kg",bitResolution:1},267:{DDI:267,name:"Lifetime Application Total Count",unit:"#",bitResolution:1},268:{DDI:268,name:"Lifetime Yield Total Volume",unit:"L",bitResolution:1},269:{DDI:269,name:"Lifetime Yield Total Mass",unit:"kg",bitResolution:1},270:{DDI:270,name:"Lifetime Yield Total Count",unit:"#",bitResolution:1},271:{DDI:271,name:"Lifetime Total Area",unit:"m²",bitResolution:1},272:{DDI:272,name:"Lifetime Effective Total Distance",unit:"m",bitResolution:1},273:{DDI:273,name:"Lifetime Ineffective Total Distance",unit:"m",bitResolution:1},274:{DDI:274,name:"Lifetime Effective Total Time",unit:"s",bitResolution:1},275:{DDI:275,name:"Lifetime Ineffective Total Time",unit:"s",bitResolution:1},276:{DDI:276,name:"Lifetime Fuel Consumption",unit:"L",bitResolution:.5},277:{DDI:277,name:"Lifetime Average Fuel Consumption per Time",unit:"mm³/s",bitResolution:1},278:{DDI:278,name:"Lifetime Average Fuel Consumption per Area",unit:"mm³/m²",bitResolution:1},279:{DDI:279,name:"Lifetime Yield Total Dry Mass",unit:"kg",bitResolution:1},280:{DDI:280,name:"Lifetime Yield Total Seed Cotton Mass",unit:"kg",bitResolution:1},281:{DDI:281,name:"Lifetime Yield Total Lint Cotton Mass",unit:"kg",bitResolution:1},282:{DDI:282,name:"Lifetime Threshing Engagement Total Time",unit:"s",bitResolution:1},283:{DDI:283,name:"Precut Total Count",unit:"#",bitResolution:1},284:{DDI:284,name:"Uncut Total Count",unit:"#",bitResolution:1},285:{DDI:285,name:"Lifetime Precut Total Count",unit:"#",bitResolution:1},286:{DDI:286,name:"Lifetime Uncut Total Count",unit:"#",bitResolution:1},287:{DDI:287,name:"Setpoint Prescription Mode",unit:"n.a.",bitResolution:1},288:{DDI:288,name:"Actual Prescription Mode",unit:"n.a.",bitResolution:1},289:{DDI:289,name:"Setpoint Work State",unit:"n.a.",bitResolution:1},290:{DDI:290,name:"Setpoint Condensed Work State (1-16)",unit:"n.a.",bitResolution:1},291:{DDI:291,name:"Setpoint Condensed Work State (17-32)",unit:"n.a.",bitResolution:1},292:{DDI:292,name:"Setpoint Condensed Work State (33-48)",unit:"n.a.",bitResolution:1},293:{DDI:293,name:"Setpoint Condensed Work State (49-64)",unit:"n.a.",bitResolution:1},294:{DDI:294,name:"Setpoint Condensed Work State (65-80)",unit:"n.a.",bitResolution:1},295:{DDI:295,name:"Setpoint Condensed Work State (81-96)",unit:"n.a.",bitResolution:1},296:{DDI:296,name:"Setpoint Condensed Work State (97-112)",unit:"n.a.",bitResolution:1},297:{DDI:297,name:"Setpoint Condensed Work State (113-128)",unit:"n.a.",bitResolution:1},298:{DDI:298,name:"Setpoint Condensed Work State (129-144)",unit:"n.a.",bitResolution:1},299:{DDI:299,name:"Setpoint Condensed Work State (145-160)",unit:"n.a.",bitResolution:1},300:{DDI:300,name:"Setpoint Condensed Work State (161-176)",unit:"n.a.",bitResolution:1},301:{DDI:301,name:"Setpoint Condensed Work State (177-192)",unit:"n.a.",bitResolution:1},302:{DDI:302,name:"Setpoint Condensed Work State (193-208)",unit:"n.a.",bitResolution:1},303:{DDI:303,name:"Setpoint Condensed Work State (209-224)",unit:"n.a.",bitResolution:1},304:{DDI:304,name:"Setpoint Condensed Work State (225-240)",unit:"n.a.",bitResolution:1},305:{DDI:305,name:"Setpoint Condensed Work State (241-256)",unit:"n.a.",bitResolution:1},306:{DDI:306,name:"True Rotation Point  X-Offset ",unit:"mm",bitResolution:1},307:{DDI:307,name:"True Rotation Point Y-Offset",unit:"mm",bitResolution:1},308:{DDI:308,name:"Actual Percentage Application Rate",unit:"ppm",bitResolution:1},309:{DDI:309,name:"Minimum Percentage Application Rate",unit:"ppm",bitResolution:1},310:{DDI:310,name:"Maximum Percentage Application Rate",unit:"ppm",bitResolution:1},311:{DDI:311,name:"Relative Yield Potential",unit:"ppm",bitResolution:1},312:{DDI:312,name:"Minimum Relative Yield Potential",unit:"ppm",bitResolution:1},313:{DDI:313,name:"Maximum Relative Yield Potential",unit:"ppm",bitResolution:1},314:{DDI:314,name:"Actual Percentage Crop Dry Matter",unit:"ppm",bitResolution:1},315:{DDI:315,name:"Average Percentage Crop Dry Matter ",unit:"ppm",bitResolution:1},316:{DDI:316,name:"Effective Total Fuel Consumption",unit:"ml",bitResolution:1},317:{DDI:317,name:"Ineffective Total Fuel Consumption",unit:"ml",bitResolution:1},318:{DDI:318,name:"Effective Total Diesel Exhaust Fluid Consumption",unit:"ml",bitResolution:1},319:{DDI:319,name:"Ineffective Total Diesel Exhaust Fluid Consumption",unit:"ml",bitResolution:1},320:{DDI:320,name:"Last loaded Weight",unit:"g",bitResolution:1},321:{DDI:321,name:"Last unloaded Weight",unit:"g",bitResolution:1},322:{DDI:322,name:"Load Identification Number",unit:"#",bitResolution:1},323:{DDI:323,name:"Unload Identification Number",unit:"#",bitResolution:1},324:{DDI:324,name:"Chopper Engagement Total Time",unit:"s",bitResolution:1},325:{DDI:325,name:"Lifetime Application Total Volume",unit:"L",bitResolution:1},326:{DDI:326,name:"Setpoint Header Speed",unit:"/s",bitResolution:.001},327:{DDI:327,name:"Actual Header Speed",unit:"/s",bitResolution:.001},328:{DDI:328,name:"Minimum Header Speed",unit:"/s",bitResolution:.001},329:{DDI:329,name:"Maximum Header Speed",unit:"/s",bitResolution:.001},330:{DDI:330,name:"Setpoint Cutting drum speed",unit:"/s",bitResolution:.001},331:{DDI:331,name:"Actual Cutting drum speed",unit:"/s",bitResolution:.001},332:{DDI:332,name:"Minimum Cutting drum speed",unit:"/s",bitResolution:.001},333:{DDI:333,name:"Maximum Cutting drum speed",unit:"/s",bitResolution:.001},334:{DDI:334,name:"Operating Hours Since Last Sharpening",unit:"s",bitResolution:1},335:{DDI:335,name:"Front PTO hours",unit:"s",bitResolution:1},336:{DDI:336,name:"Rear PTO hours",unit:"s",bitResolution:1},337:{DDI:337,name:"Lifetime Front PTO hours",unit:"h",bitResolution:.1},338:{DDI:338,name:"Lifetime Rear PTO Hours",unit:"h",bitResolution:.1},339:{DDI:339,name:"Effective Total Loading Time",unit:"s",bitResolution:1},340:{DDI:340,name:"Effective Total Unloading Time",unit:"s",bitResolution:1},341:{DDI:341,name:"Setpoint Grain Kernel Cracker Gap",unit:"mm",bitResolution:.001},342:{DDI:342,name:"Actual Grain Kernel Cracker Gap",unit:"mm",bitResolution:.001},343:{DDI:343,name:"Minimum Grain Kernel Cracker Gap",unit:"mm",bitResolution:.001},344:{DDI:344,name:"Maximum Grain Kernel Cracker Gap",unit:"mm",bitResolution:.001},345:{DDI:345,name:"Setpoint Swathing Width",unit:"mm",bitResolution:1},346:{DDI:346,name:"Actual Swathing Width",unit:"mm",bitResolution:1},347:{DDI:347,name:"Minimum Swathing Width",unit:"mm",bitResolution:1},348:{DDI:348,name:"Maximum Swathing Width",unit:"mm",bitResolution:1},349:{DDI:349,name:"Nozzle Drift Reduction",unit:"ppm",bitResolution:1},350:{DDI:350,name:"Function or Operation Technique",unit:"n.a.",bitResolution:1},351:{DDI:351,name:"Application Total Volume in [ml]",unit:"ml",bitResolution:1},352:{DDI:352,name:"Application Total Mass in gram [g]",unit:"g",bitResolution:1},353:{DDI:353,name:"Total Application of Nitrogen",unit:"g",bitResolution:1},354:{DDI:354,name:"Total Application of Ammonium",unit:"g",bitResolution:1},355:{DDI:355,name:"Total Application of Phosphor",unit:"g",bitResolution:1},356:{DDI:356,name:"Total Application of Potassium",unit:"g",bitResolution:1},357:{DDI:357,name:"Total Application of Dry Matter",unit:"kg",bitResolution:1},358:{DDI:358,name:"Average Dry Yield Mass Per Time",unit:"mg/s",bitResolution:1},359:{DDI:359,name:"Average Dry Yield Mass Per Area",unit:"mg/m²",bitResolution:1},360:{DDI:360,name:"Last Bale Size",unit:"mm",bitResolution:1},361:{DDI:361,name:"Last Bale Density",unit:"mg/l",bitResolution:1},362:{DDI:362,name:"Total Bale Length",unit:"mm",bitResolution:1},363:{DDI:363,name:"Last Bale Dry Mass",unit:"g",bitResolution:1},364:{DDI:364,name:"Actual Flake Size",unit:"mm",bitResolution:1},365:{DDI:365,name:"Setpoint Downforce Pressure",unit:"Pa",bitResolution:1},366:{DDI:366,name:"Actual Downforce Pressure",unit:"Pa",bitResolution:1},367:{DDI:367,name:"Condensed Section Override State (1-16)",unit:"",bitResolution:1},368:{DDI:368,name:"Condensed Section Override State (17-32) ",unit:"",bitResolution:1},369:{DDI:369,name:"Condensed Section Override State (33-48) ",unit:"",bitResolution:1},370:{DDI:370,name:"Condensed Section Override State (49-64) ",unit:"",bitResolution:1},371:{DDI:371,name:"Condensed Section Override State (65-80) ",unit:"",bitResolution:1},372:{DDI:372,name:"Condensed Section Override State (81-96) ",unit:"",bitResolution:1},373:{DDI:373,name:"Condensed Section Override State (97-112) ",unit:"",bitResolution:1},374:{DDI:374,name:"Condensed Section Override State (113-128) ",unit:"",bitResolution:1},375:{DDI:375,name:"Condensed Section Override State (129-144) ",unit:"",bitResolution:1},376:{DDI:376,name:"Condensed Section Override State (145-160) ",unit:"",bitResolution:1},377:{DDI:377,name:"Condensed Section Override State (161-176) ",unit:"",bitResolution:1},378:{DDI:378,name:"Condensed Section Override State (177-192) ",unit:"",bitResolution:1},379:{DDI:379,name:"Condensed Section Override State (193-208) ",unit:"",bitResolution:1},380:{DDI:380,name:"Condensed Section Override State (209-224) ",unit:"",bitResolution:1},381:{DDI:381,name:"Condensed Section Override State (225-240) ",unit:"",bitResolution:1},382:{DDI:382,name:"Condensed Section Override State (241-256) ",unit:"",bitResolution:1},383:{DDI:383,name:"Apparent Wind Direction",unit:"°",bitResolution:1},384:{DDI:384,name:"Apparent Wind Speed",unit:"mm/s",bitResolution:1},385:{DDI:385,name:"MSL Atmospheric Pressure ",unit:"Pa",bitResolution:.1},386:{DDI:386,name:"Actual Atmospheric Pressure",unit:"Pa",bitResolution:.1},387:{DDI:387,name:"Total Revolutions in Fractional Revolutions",unit:"#",bitResolution:1e-4},388:{DDI:388,name:"Total Revolutions in Complete Revolutions",unit:"#",bitResolution:1},389:{DDI:389,name:"Setpoint Revolutions specified as count per time",unit:"r/min",bitResolution:1e-4},390:{DDI:390,name:"Actual Revolutions Per Time",unit:"r/min",bitResolution:1e-4},391:{DDI:391,name:"Default Revolutions Per Time",unit:"r/min",bitResolution:1e-4},392:{DDI:392,name:"Minimum Revolutions Per Time",unit:"r/min",bitResolution:1e-4},393:{DDI:393,name:"Maximum Revolutions Per Time",unit:"r/min",bitResolution:1e-4},394:{DDI:394,name:"Actual Fuel Tank Content",unit:"ml",bitResolution:1},395:{DDI:395,name:"Actual Diesel Exhaust Fluid Tank Content",unit:"ml",bitResolution:1},396:{DDI:396,name:"Setpoint Speed",unit:"mm/s",bitResolution:1},397:{DDI:397,name:"Actual Speed",unit:"mm/s",bitResolution:1},398:{DDI:398,name:"Minimum Speed",unit:"mm/s",bitResolution:1},399:{DDI:399,name:"Maximum Speed",unit:"mm/s",bitResolution:1},400:{DDI:400,name:"Speed Source",unit:"n.a.",bitResolution:1},401:{DDI:401,name:"Actual Application of Nitrogen as [mg/l]",unit:"mg/l",bitResolution:1},402:{DDI:402,name:"Actual application of Ammonium",unit:"mg/l",bitResolution:1},403:{DDI:403,name:"Actual application of Phosphor",unit:"mg/l",bitResolution:1},404:{DDI:404,name:"Actual application of Potassium",unit:"mg/l",bitResolution:1},405:{DDI:405,name:"Actual application of Dry Matter",unit:"mg/l",bitResolution:1},406:{DDI:406,name:"Actual Protein Content ",unit:"ppm",bitResolution:1},407:{DDI:407,name:"Average Protein Content",unit:"ppm",bitResolution:1},408:{DDI:408,name:"Average Crop Contamination",unit:"ppm",bitResolution:1},409:{DDI:409,name:"Total Diesel Exhaust Fluid Consumption",unit:"ml",bitResolution:1},410:{DDI:410,name:"Instantaneous Diesel Exhaust Fluid Consumption per Time",unit:"mm³/s",bitResolution:1},411:{DDI:411,name:"Instantaneous Diesel Exhaust Fluid Consumption per Area",unit:"mm³/m²",bitResolution:1},412:{DDI:412,name:"Lifetime Diesel Exhaust Fluid Consumption",unit:"L",bitResolution:.5},413:{DDI:413,name:"Lifetime Average Diesel Exhaust Fluid Consumption per Time",unit:"mm³/s",bitResolution:1},414:{DDI:414,name:"Lifetime Average Diesel Exhaust Fluid Consumption per Area",unit:"mm³/m²",bitResolution:1},415:{DDI:415,name:"Actual Seed Singulation Percentage",unit:"ppm",bitResolution:1},416:{DDI:416,name:"Average Seed Singulation Percentage",unit:"ppm",bitResolution:1},417:{DDI:417,name:"Actual Seed Skip Percentage",unit:"ppm",bitResolution:1},418:{DDI:418,name:"Average Seed Skip Percentage",unit:"ppm",bitResolution:1},419:{DDI:419,name:"Actual Seed Multiple Percentage",unit:"ppm",bitResolution:1},420:{DDI:420,name:"Average Seed Multiple Percentage",unit:"ppm",bitResolution:1},421:{DDI:421,name:"Actual Seed Spacing Deviation",unit:"mm",bitResolution:1},422:{DDI:422,name:"Average Seed Spacing Deviation",unit:"mm",bitResolution:1},423:{DDI:423,name:"Actual Coefficient of Variation of Seed Spacing Percentage ",unit:"ppm",bitResolution:1},424:{DDI:424,name:"Average Coefficient of Variation of Seed Spacing Percentage",unit:"ppm",bitResolution:1},425:{DDI:425,name:"Setpoint Maximum Allowed Seed Spacing Deviation",unit:"mm",bitResolution:1},426:{DDI:426,name:"Setpoint Downforce as Force",unit:"N",bitResolution:1},427:{DDI:427,name:"Actual Downforce as Force",unit:"N",bitResolution:1},428:{DDI:428,name:"Loaded Total Mass",unit:"kg",bitResolution:1},429:{DDI:429,name:"Unloaded Total Mass",unit:"kg",bitResolution:1},430:{DDI:430,name:"Lifetime Loaded Total Mass",unit:"kg",bitResolution:1},431:{DDI:431,name:"Lifetime Unloaded Total Mass",unit:"kg",bitResolution:1},432:{DDI:432,name:"Setpoint Application Rate of Nitrogen",unit:"mg/m²",bitResolution:1},433:{DDI:433,name:"Actual  Application Rate of Nitrogen",unit:"mg/m²",bitResolution:1},434:{DDI:434,name:"Minimum Application Rate of Nitrogen",unit:"mg/m²",bitResolution:1},435:{DDI:435,name:"Maximum  Application Rate of Nitrogen",unit:"mg/m²",bitResolution:1},436:{DDI:436,name:"Setpoint  Application Rate of Ammonium",unit:"mg/m²",bitResolution:1},437:{DDI:437,name:"Actual  Application Rate of Ammonium",unit:"mg/m²",bitResolution:1},438:{DDI:438,name:"Minimum  Application Rate of Ammonium",unit:"mg/m²",bitResolution:1},439:{DDI:439,name:"Maximum  Application Rate of Ammonium",unit:"mg/m²",bitResolution:1},440:{DDI:440,name:"Setpoint  Application Rate of Phosphor",unit:"mg/m²",bitResolution:1},441:{DDI:441,name:"Actual  Application Rate of Phosphor",unit:"mg/m²",bitResolution:1},442:{DDI:442,name:"Minimum  Application Rate of Phosphor",unit:"mg/m²",bitResolution:1},443:{DDI:443,name:"Maximum  Application Rate of Phosphor",unit:"mg/m²",bitResolution:1},444:{DDI:444,name:"Setpoint  Application Rate of Potassium",unit:"mg/m²",bitResolution:1},445:{DDI:445,name:"Actual  Application Rate of Potassium",unit:"mg/m²",bitResolution:1},446:{DDI:446,name:"Minimum Application Rate of Potassium",unit:"mg/m²",bitResolution:1},447:{DDI:447,name:"Maximum Application Rate of Potassium",unit:"mg/m²",bitResolution:1},448:{DDI:448,name:"Setpoint Application Rate of Dry Matter",unit:"ppm",bitResolution:1},449:{DDI:449,name:"Actual  Application Rate of Dry Matter",unit:"ppm",bitResolution:1},450:{DDI:450,name:"Minimum Application Rate of Dry Matter",unit:"ppm",bitResolution:1},451:{DDI:451,name:"Maximum Application Rate of Dry Matter",unit:"ppm",bitResolution:1},452:{DDI:452,name:"Loaded Total Volume",unit:"ml",bitResolution:1},453:{DDI:453,name:"Unloaded Total Volume",unit:"ml",bitResolution:1},454:{DDI:454,name:"Lifetime loaded Total Volume",unit:"L",bitResolution:1},455:{DDI:455,name:"Lifetime Unloaded Total Volume",unit:"L",bitResolution:1},456:{DDI:456,name:"Last loaded Volume",unit:"ml",bitResolution:1},457:{DDI:457,name:"Last unloaded Volume",unit:"ml",bitResolution:1},458:{DDI:458,name:"Loaded Total Count",unit:"#",bitResolution:1},459:{DDI:459,name:"Unloaded Total Count",unit:"#",bitResolution:1},460:{DDI:460,name:"Lifetime Loaded Total Count",unit:"#",bitResolution:1},461:{DDI:461,name:"Lifetime Unloaded Total Count",unit:"#",bitResolution:1},462:{DDI:462,name:"Last loaded Count",unit:"#",bitResolution:1},463:{DDI:463,name:"Last unloaded Count",unit:"#",bitResolution:1},464:{DDI:464,name:"Haul Counter",unit:"#",bitResolution:1},465:{DDI:465,name:"Lifetime Haul Counter",unit:"#",bitResolution:1},466:{DDI:466,name:"Actual relative connector angle",unit:"°",bitResolution:.001},467:{DDI:467,name:"Actual Percentage Content",unit:"0.00%",bitResolution:.01},468:{DDI:468,name:"Soil Snow/Frozen Condtion",unit:"n.a.",bitResolution:1},469:{DDI:469,name:"Estimated Soil Water Condtion",unit:"n.a.",bitResolution:1},470:{DDI:470,name:"Soil Compaction",unit:"n.a.",bitResolution:1},472:{DDI:472,name:"Setpoint Length of Cut",unit:"mm",bitResolution:.001},473:{DDI:473,name:"Minimum length of cut",unit:"mm",bitResolution:.001},474:{DDI:474,name:"Maximum Length of Cut",unit:"mm",bitResolution:.001},475:{DDI:475,name:"Setpoint Bale Hydraulic Pressure",unit:"Pa",bitResolution:1},476:{DDI:476,name:"Minimum Bale Hydraulic Pressure",unit:"Pa",bitResolution:1},477:{DDI:477,name:"Maximum Bale Hydraulic Pressure",unit:"Pa",bitResolution:1},478:{DDI:478,name:"Setpoint Flake Size",unit:"mm",bitResolution:1},479:{DDI:479,name:"Minimum Flake Size",unit:"mm",bitResolution:1},480:{DDI:480,name:"Maximum Flake Size",unit:"mm",bitResolution:1},481:{DDI:481,name:"Setpoint Number of Subbales",unit:"",bitResolution:1},482:{DDI:482,name:"Last Bale Number of Subbales",unit:"",bitResolution:1},483:{DDI:483,name:"Setpoint Engine Speed",unit:"r/min",bitResolution:1e-4},484:{DDI:484,name:"Actual Engine Speed",unit:"r/min",bitResolution:1e-4},485:{DDI:485,name:"Minimum Engine Speed",unit:"r/min",bitResolution:1e-4},486:{DDI:486,name:"Maximum Engine Speed",unit:"r/min",bitResolution:1e-4},488:{DDI:488,name:"Diesel Exhaust Fluid Tank Percentage Level",unit:"0.00%",bitResolution:.01},489:{DDI:489,name:"Maximum Diesel Exhaust Fluid Tank Content",unit:"ml",bitResolution:1},490:{DDI:490,name:"Maximum Fuel Tank Content",unit:"ml",bitResolution:1},491:{DDI:491,name:"Fuel Percentage Level",unit:"0.00%",bitResolution:.01},492:{DDI:492,name:"Total Engine Hours",unit:"h",bitResolution:.05},493:{DDI:493,name:"Lifetime Engine Hours",unit:"h",bitResolution:.1},494:{DDI:494,name:"Last Event Partner ID (Byte 1-4)",unit:"",bitResolution:1},495:{DDI:495,name:"Last Event Partner ID (Byte 5-8)",unit:"n.a.",bitResolution:1},496:{DDI:496,name:"Last Event Partner ID (Byte 9-12)",unit:"n.a.",bitResolution:1},497:{DDI:497,name:"Last Event Partner ID (Byte 13-16)",unit:"",bitResolution:1},498:{DDI:498,name:"Last Event Partner ID Type",unit:"n.a.",bitResolution:1},499:{DDI:499,name:"Last Event Partner ID Manufacturer ID Code",unit:"",bitResolution:1},500:{DDI:500,name:"Last Event Partner ID Device Class",unit:"n.a.",bitResolution:1},501:{DDI:501,name:"Setpoint Engine Torque",unit:"0.00%",bitResolution:.001},502:{DDI:502,name:"Actual Engine Torque",unit:"0.00%",bitResolution:.001},503:{DDI:503,name:"Minimum Engine Torque",unit:"0.00%",bitResolution:.001},504:{DDI:504,name:"Maximum Engine Torque",unit:"0.00%",bitResolution:.001},505:{DDI:505,name:"Tramline Control Level",unit:"n.a.",bitResolution:1},506:{DDI:506,name:"Setpoint Tramline Control Level",unit:"n.a.",bitResolution:1},507:{DDI:507,name:"Tramline Sequence Number",unit:"n.a.",bitResolution:1},508:{DDI:508,name:"Unique A-B Guidance Reference Line ID",unit:"n.a.",bitResolution:1},509:{DDI:509,name:"Actual Track Number",unit:"n.a.",bitResolution:1},510:{DDI:510,name:"Track Number to the right",unit:"n.a.",bitResolution:1},511:{DDI:511,name:"Track Number to the left",unit:"n.a.",bitResolution:1},512:{DDI:512,name:"Guidance Line Swath Width",unit:"mm",bitResolution:1},513:{DDI:513,name:"Guidance Line Deviation",unit:"mm",bitResolution:1},514:{DDI:514,name:"GNSS Quality",unit:"n.a.",bitResolution:1},515:{DDI:515,name:"Tramline Control State",unit:"n.a.",bitResolution:1},516:{DDI:516,name:"Tramline Overdosing Rate",unit:"ppm",bitResolution:1},517:{DDI:517,name:"Setpoint Tramline Condensed Work State (1-16)",unit:"n.a.",bitResolution:1},518:{DDI:518,name:"Actual Tramline Condensed Work State (1-16)",unit:"n.a.",bitResolution:1},519:{DDI:519,name:"Last Bale Lifetime Count",unit:"n.a.",bitResolution:1},520:{DDI:520,name:"Actual Canopy Height",unit:"mm",bitResolution:1},521:{DDI:521,name:"GNSS Installation Type",unit:"n.a.",bitResolution:1},522:{DDI:522,name:"Twine Bale Total Count",unit:"#",bitResolution:1},523:{DDI:523,name:"Mesh Bale Total Count",unit:"#",bitResolution:1},524:{DDI:524,name:"Lifetime Twine Bale Total Count",unit:"#",bitResolution:1},525:{DDI:525,name:"Lifetime Mesh Bale Total Count",unit:"#",bitResolution:1},526:{DDI:526,name:"Actual Cooling Fluid Temperature",unit:"mK",bitResolution:1},528:{DDI:528,name:"Last Bale Capacity",unit:"kg/h",bitResolution:1},529:{DDI:529,name:"Setpoint Tillage Disc Gang Angle",unit:"°",bitResolution:.001},530:{DDI:530,name:"Actual Tillage Disc Gang Angle",unit:"°",bitResolution:.001},531:{DDI:531,name:"Actual Applied Preservative Per Yield Mass",unit:"mm³/kg",bitResolution:1},532:{DDI:532,name:"Setpoint Applied Preservative Per Yield Mass",unit:"mm³/kg",bitResolution:1},533:{DDI:533,name:"Default Applied Preservative Per Yield Mass",unit:"mm³/kg",bitResolution:1},534:{DDI:534,name:"Minimum Applied Preservative Per Yield Mass",unit:"mm³/kg",bitResolution:1},535:{DDI:535,name:"Maximum Applied Preservative Per Yield Mass",unit:"mm³/kg",bitResolution:1},536:{DDI:536,name:"Total Applied Preservative",unit:"ml",bitResolution:1},537:{DDI:537,name:"Lifetime Applied Preservative",unit:"ml",bitResolution:1},538:{DDI:538,name:"Average Applied Preservative Per Yield Mass",unit:"mm³/kg",bitResolution:1},539:{DDI:539,name:"Actual Preservative Tank Volume",unit:"ml",bitResolution:1},540:{DDI:540,name:"Actual Preservative Tank Level",unit:"ppm",bitResolution:1},541:{DDI:541,name:"Actual PTO Speed",unit:"r/min",bitResolution:1e-4},542:{DDI:542,name:"Setpoint PTO Speed",unit:"r/min",bitResolution:1e-4},543:{DDI:543,name:"Default PTO Speed",unit:"r/min",bitResolution:1e-4},544:{DDI:544,name:"Minimum PTO Speed",unit:"r/min",bitResolution:1e-4},545:{DDI:545,name:"Maximum PTO Speed",unit:"r/min",bitResolution:1e-4},546:{DDI:546,name:"Lifetime Chopping Engagement Total Time",unit:"s",bitResolution:1},547:{DDI:547,name:"Setpoint Bale Compression Plunger Load (N)",unit:"N",bitResolution:1},548:{DDI:548,name:"Actual Bale Compression Plunger Load (N)",unit:"N",bitResolution:1},549:{DDI:549,name:"Last Bale Average Bale Compression Plunger Load (N)",unit:"N",bitResolution:1},550:{DDI:550,name:"Ground Cover",unit:"0.00%",bitResolution:.1},551:{DDI:551,name:"Actual PTO Torque",unit:"N*m",bitResolution:1e-4},552:{DDI:552,name:"Setpoint PTO Torque",unit:"N*m",bitResolution:1e-4},553:{DDI:553,name:"Default PTO Torque",unit:"N*m",bitResolution:1e-4},554:{DDI:554,name:"Minimum PTO Torque",unit:"N*m",bitResolution:1e-4},555:{DDI:555,name:"Maximum PTO Torque",unit:"N*m",bitResolution:1e-4},556:{DDI:556,name:"Present Weather Conditions",unit:"",bitResolution:1},557:{DDI:557,name:"Setpoint Electrical Current",unit:"A",bitResolution:.005},558:{DDI:558,name:"Actual Electrical Current",unit:"A",bitResolution:.005},559:{DDI:559,name:"Minimum Electrical Current",unit:"A",bitResolution:.005},560:{DDI:560,name:"Maximum Electrical Current",unit:"A",bitResolution:.005},561:{DDI:561,name:"Default Electrical Current",unit:"A",bitResolution:.005},562:{DDI:562,name:"Setpoint Voltage",unit:"V",bitResolution:.001},563:{DDI:563,name:"Default Voltage",unit:"V",bitResolution:.001},564:{DDI:564,name:"Actual Voltage",unit:"V",bitResolution:.001},565:{DDI:565,name:"Minimum Voltage",unit:"V",bitResolution:.001},566:{DDI:566,name:"Maximum Voltage",unit:"V",bitResolution:.001},567:{DDI:567,name:"Actual Electrical Resistance",unit:"Ohm",bitResolution:.01},568:{DDI:568,name:"Setpoint Electrical Power",unit:"W",bitResolution:.001},569:{DDI:569,name:"Actual Electrical Power",unit:"W",bitResolution:.001},570:{DDI:570,name:"Default Electrical Power ",unit:"W",bitResolution:.001},571:{DDI:571,name:"Maximum Electrical Power",unit:"W",bitResolution:.001},572:{DDI:572,name:"Minimum Electrical Power",unit:"W",bitResolution:.001},573:{DDI:573,name:"Total Electrical Energy",unit:"kWh",bitResolution:.001},574:{DDI:574,name:"Setpoint Electrical Energy per Area Application Rate",unit:"kWh/m²",bitResolution:1e-7},575:{DDI:575,name:"Actual  Electrical Energy per Area Application Rate",unit:"kWh/m²",bitResolution:1e-7},576:{DDI:576,name:"Maximum  Electrical Energy  per Area Application Rate",unit:"kWh/m²",bitResolution:1e-7},577:{DDI:577,name:"Minimum  Electrical Energy per Area Application Rate",unit:"kWh/m²",bitResolution:1e-7},578:{DDI:578,name:"Setpoint Temperature",unit:"mK",bitResolution:1},579:{DDI:579,name:"Actual Temperature",unit:"mK",bitResolution:1},580:{DDI:580,name:"Minimum Temperature",unit:"mK",bitResolution:1},581:{DDI:581,name:"Maximum Temperature",unit:"mK",bitResolution:1},582:{DDI:582,name:"Default Temperature",unit:"mK",bitResolution:1},583:{DDI:583,name:"Setpoint Frequency ",unit:"Hz",bitResolution:.001},584:{DDI:584,name:"Actual Frequency ",unit:"Hz",bitResolution:.001},585:{DDI:585,name:"Minimum Frequency ",unit:"Hz",bitResolution:.001},586:{DDI:586,name:"Maximum Frequency ",unit:"Hz",bitResolution:.001},587:{DDI:587,name:"Previous Rainfall",unit:"",bitResolution:1},588:{DDI:588,name:"Setpoint Volume Per Area Application Rate as [ml/m²]",unit:"ml/m²",bitResolution:.1},589:{DDI:589,name:"Actual Volume Per Area Application Rate as [ml/m²]",unit:"ml/m²",bitResolution:.1},590:{DDI:590,name:"Minimum Volume Per Area Application Rate as [ml/m²]",unit:"ml/m²",bitResolution:.1},591:{DDI:591,name:"Maximum Volume Per Area Application Rate as [ml/m²]",unit:"ml/m²",bitResolution:.1},592:{DDI:592,name:"Default Volume Per Area Application Rate as [ml/m²]",unit:"ml/m²",bitResolution:.1},593:{DDI:593,name:"Traction Type",unit:"n.a.",bitResolution:1},594:{DDI:594,name:"Steering Type",unit:"n.a.",bitResolution:1},595:{DDI:595,name:"Machine Mode",unit:"n.a.",bitResolution:1},596:{DDI:596,name:"Cargo Area Cover State",unit:"0.00%",bitResolution:1},597:{DDI:597,name:"Total Distance",unit:"mm",bitResolution:1},598:{DDI:598,name:"Lifetime Total Distance",unit:"m",bitResolution:1},599:{DDI:599,name:"Total Distance Field",unit:"mm",bitResolution:1},600:{DDI:600,name:"Lifetime Total Distance Field",unit:"m",bitResolution:1},601:{DDI:601,name:"Total Distance Street",unit:"mm",bitResolution:1},602:{DDI:602,name:"Lifetime Total Distance Street",unit:"m",bitResolution:1},603:{DDI:603,name:"Actual Tramline Condensed Work State (17-32)",unit:"n.a.",bitResolution:1},604:{DDI:604,name:"Actual Tramline Condensed Work State (33-48)",unit:"n.a.",bitResolution:1},605:{DDI:605,name:"Actual Tramline Condensed Work State (49-64)",unit:"n.a.",bitResolution:1},606:{DDI:606,name:"Actual Tramline Condensed Work State (65-80)",unit:"n.a.",bitResolution:1},607:{DDI:607,name:"Actual Tramline Condensed Work State (81-96)",unit:"n.a.",bitResolution:1},608:{DDI:608,name:"Actual Tramline Condensed Work State (97-112)",unit:"n.a.",bitResolution:1},609:{DDI:609,name:"Actual Tramline Condensed Work State (113-128)",unit:"n.a.",bitResolution:1},610:{DDI:610,name:"Actual Tramline Condensed Work State (129-144)",unit:"n.a.",bitResolution:1},611:{DDI:611,name:"Actual Tramline Condensed Work State (145-160)",unit:"n.a.",bitResolution:1},612:{DDI:612,name:"Actual Tramline Condensed Work State (161-176)",unit:"n.a.",bitResolution:1},613:{DDI:613,name:"Actual Tramline Condensed Work State (177-192)",unit:"n.a.",bitResolution:1},614:{DDI:614,name:"Actual Tramline Condensed Work State (193-208)",unit:"n.a.",bitResolution:1},615:{DDI:615,name:"Actual Tramline Condensed Work State (209-224)",unit:"n.a.",bitResolution:1},616:{DDI:616,name:"Actual Tramline Condensed Work State (225-240)",unit:"n.a.",bitResolution:1},617:{DDI:617,name:"Actual Tramline Condensed Work State (241-256)",unit:"n.a.",bitResolution:1},618:{DDI:618,name:"Setpoint Tramline Condensed Work State (17-32)",unit:"n.a.",bitResolution:1},619:{DDI:619,name:"Setpoint Tramline Condensed Work State (33-48)",unit:"n.a.",bitResolution:1},620:{DDI:620,name:"Setpoint Tramline Condensed Work State (49-64)",unit:"n.a.",bitResolution:1},621:{DDI:621,name:"Setpoint Tramline Condensed Work State (65-80)",unit:"n.a.",bitResolution:1},622:{DDI:622,name:"Setpoint Tramline Condensed Work State (81-96)",unit:"n.a.",bitResolution:1},623:{DDI:623,name:"Setpoint Tramline Condensed Work State (97-112)",unit:"n.a.",bitResolution:1},624:{DDI:624,name:"Setpoint Tramline Condensed Work State (113-128)",unit:"n.a.",bitResolution:1},625:{DDI:625,name:"Setpoint Tramline Condensed Work State (129-144)",unit:"n.a.",bitResolution:1},626:{DDI:626,name:"Setpoint Tramline Condensed Work State (145-160)",unit:"n.a.",bitResolution:1},627:{DDI:627,name:"Setpoint Tramline Condensed Work State (161-176)",unit:"n.a.",bitResolution:1},628:{DDI:628,name:"Setpoint Tramline Condensed Work State (177-192)",unit:"n.a.",bitResolution:1},629:{DDI:629,name:"Setpoint Tramline Condensed Work State (193-208)",unit:"n.a.",bitResolution:1},630:{DDI:630,name:"Setpoint Tramline Condensed Work State (209-224)",unit:"n.a.",bitResolution:1},631:{DDI:631,name:"Setpoint Tramline Condensed Work State (225-240)",unit:"n.a.",bitResolution:1},632:{DDI:632,name:"Setpoint Tramline Condensed Work State (241-256)",unit:"n.a.",bitResolution:1},633:{DDI:633,name:"Setpoint Volume per distance Application Rate",unit:"ml/m",bitResolution:.001},634:{DDI:634,name:"Actual Volume per distance Application Rate",unit:"ml/m",bitResolution:.001},635:{DDI:635,name:"Default Volume per distance Application Rate",unit:"ml/m",bitResolution:.001},636:{DDI:636,name:"Minimum Volume per distance Application Rate",unit:"ml/m",bitResolution:.001},637:{DDI:637,name:"Maximum Volume per distance Application Rate",unit:"ml/m",bitResolution:.001},638:{DDI:638,name:"Setpoint Tire Pressure",unit:"Pa",bitResolution:.1},639:{DDI:639,name:"Actual Tire Pressure",unit:"Pa",bitResolution:.1},640:{DDI:640,name:"Default Tire Pressure",unit:"Pa",bitResolution:.1},641:{DDI:641,name:"Minimum Tire Pressure",unit:"Pa",bitResolution:.1},642:{DDI:642,name:"Maximum Tire Pressure",unit:"Pa",bitResolution:.1},57342:{DDI:57342,name:"PGN Based Data",unit:"n.a.",bitResolution:1},57343:{DDI:57343,name:"Request Default Process Data",unit:"n.a.",bitResolution:1}};var Jy=function(i,t,e,n){function s(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function u(y){try{p(n.next(y))}catch(_){l(_)}}function c(y){try{p(n.throw(y))}catch(_){l(_)}}function p(y){y.done?a(y.value):s(y.value).then(u,c)}p((n=n.apply(i,t||[])).next())})};function HC(i,t,e){return e.registerEntity(null,i)}function zl(i,t){return i===""&&t.allowEmptyString?null:parseInt(i,10)}function P1(i,t){return i===""&&t.allowEmptyString?null:parseFloat(i)}function YC(i){return new Date(i)}function ZC(i){return i.xmlId}function aa(i,t){return t.allowEmptyString&&i===null?"":"fractionDigits"in t?parseFloat(i.toFixed(t.fractionDigits)).toString():i.toString()}function KC(i,t,e){return e.options.version===3?i.toISOString().split(".")[0]:i.toISOString()}const qC={"xs:IDREF":HC,"xs:unsignedByte":zl,"xs:long":zl,"xs:unsignedShort":zl,"xs:unsignedLong":zl,"xs:decimal":P1,"xs:double":P1,"xs:dateTime":YC},$C={"xs:IDREF":ZC,"xs:unsignedByte":aa,"xs:long":aa,"xs:unsignedShort":aa,"xs:unsignedLong":aa,"xs:decimal":aa,"xs:double":aa,"xs:dateTime":KC},Qy=/^P\d+_/;function JC(i,t,e,n){const s={};return Object.keys(i._attributes||{}).forEach(a=>{const l=t[a];if(!l){a.match(Qy)?(s.ProprietaryAttributes=s.ProprietaryAttributes||[],s.ProprietaryAttributes[a]=i._attributes[a]):e.addWarning(`[${n}] Unknown attribute "${a}"`);return}if(l.isPrimaryId)return;const u=qC[l.type];s[l.name]=u?u(i._attributes[a],l,e):i._attributes[a]}),Object.keys(t).forEach(a=>{!t[a].isOptional&&(!i._attributes||!(a in i._attributes))&&e.addWarning(`[${n}] Missing required attribute "${a}"`)}),s}function QC(i,t){const e=i.isoxmlManager.options.version,n=Object.assign({},i.attributes.ProprietaryAttributes),s=Object.keys(t).find(a=>t[a].isPrimaryId);if(s&&!(e===3&&t[s].isOnlyV4)){const a=i.isoxmlManager.getReferenceByEntity(i);a&&(n[s]=a.xmlId)}return Object.keys(i.attributes).forEach(a=>{const l=Object.keys(t).find(p=>t[p].name===a),u=t[l];if(!u||e===3&&u.isOnlyV4)return;const c=$C[u.type];n[l]=c?c(i.attributes[a],u,i.isoxmlManager):i.attributes[a]}),n}function t4(i,t,e,n){return Jy(this,void 0,void 0,function*(){const s={};for(const a of Object.keys(i)){const l=t[a];if(!l){a.match(Qy)&&(s.ProprietaryTags=s.ProprietaryTags||{},s.ProprietaryTags[a]=s.ProprietaryTags[a]||[],s.ProprietaryTags[a].push(...i[a]));continue}s[l.name]=[];for(const[u,c]of i[a].entries()){const p=`${n}->${a}[${u}]`;s[l.name].push(yield e.createEntityFromXML(a,c,p))}}return s})}function e4(i,t){const e=i.isoxmlManager.options.version,n=Object.assign({},i.attributes.ProprietaryTags);return Object.keys(i.attributes).forEach(s=>{const a=Object.keys(t).find(u=>t[u].name===s),l=t[a];!l||e===3&&l.isOnlyV4||(n[a]=i.attributes[s].map(u=>u.toXML()))}),n}function ie(i,t,e,n,s,a){return Jy(this,void 0,void 0,function*(){const l=Object.keys(n).find(_=>n[_].isPrimaryId),u=l?i._attributes[l]:null,c=u||a,p=yield t4(i,s,t,c),y=new e(Object.assign(Object.assign({},JC(i,n,t,c)),p),t,c);return u&&y.isoxmlManager.registerEntity(y,u),y})}function ne(i,t,e){return Object.assign({_attributes:QC(i,t)},e4(i,e))}function i4(i){return i.toString(16).toUpperCase().padStart(4,"0")}function tx(i,t,e){var n,s;const a=parseInt(i,16),l=jC[a],u=t?t.attributes.UnitDesignator||"":l?.unit||"",c=t?t.attributes.Scale:(n=l?.bitResolution)!==null&&n!==void 0?n:1,p=t?t.attributes.Offset:0,y=t?t.attributes.NumberOfDecimals:Math.ceil(-Math.log10(l?.bitResolution||1)),_=l?.name,E=e?.attributes.DeviceProcessDataDesignator,I=_&&E?`${E} (${_})`:(s=_??E)!==null&&s!==void 0?s:"";return{DDINumber:a,DDIString:i,DDEntityName:I,unit:u,scale:c,offset:p,numberOfDecimals:y,isProprietary:a>=57344&&a<=65534}}var N1;(function(i){i.Planned="1",i.EffectiveRealized="4"})(N1||(N1={}));const L1={A:{name:"Start",type:"xs:dateTime",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"Stop",type:"xs:dateTime",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"Duration",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:4294967294},D:{name:"Type",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},k1={PTN:{name:"Position",isOnlyV4:!1}};class gd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.AllocationStamp}static fromXML(t,e,n,s=gd){return ie(t,e,s,L1,k1,n)}toXML(){return ne(this,L1,k1)}}$t("main",_t.AllocationStamp,gd);const F1={A:{name:"BaseStationId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:void 0},B:{name:"BaseStationDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},C:{name:"BaseStationNorth",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:-90,maxValue:90,fractionDigits:9},D:{name:"BaseStationEast",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:-180,maxValue:180,fractionDigits:9},E:{name:"BaseStationUp",type:"xs:long",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:-2147483647,maxValue:2147483647}},B1={};class md{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.BaseStation}static fromXML(t,e,n,s=md){return ie(t,e,s,F1,B1,n)}toXML(){return ne(this,F1,B1)}}$t("main",_t.BaseStation,md);var V1;(function(i){i.Point="1",i.Global="2",i.Continuous="3"})(V1||(V1={}));const G1={A:{name:"CodedCommentId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"CodedCommentDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"CodedCommentScope",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},D:{name:"CodedCommentGroupIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},z1={CCL:{name:"CodedCommentListValue",isOnlyV4:!1}};class pd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.CodedComment}static fromXML(t,e,n,s=pd){return ie(t,e,s,G1,z1,n)}toXML(){return ne(this,G1,z1)}}$t("main",_t.CodedComment,pd);const U1={A:{name:"CodedCommentGroupId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"CodedCommentGroupDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},W1={};class yd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.CodedCommentGroup}static fromXML(t,e,n,s=yd){return ie(t,e,s,U1,W1,n)}toXML(){return ne(this,U1,W1)}}$t("main",_t.CodedCommentGroup,yd);const X1={A:{name:"CodedCommentListValueId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"CodedCommentListValueDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},j1={};class xd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.CodedCommentListValue}static fromXML(t,e,n,s=xd){return ie(t,e,s,X1,j1,n)}toXML(){return ne(this,X1,j1)}}$t("main",_t.CodedCommentListValue,xd);const H1={A:{name:"ColourLegendId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"DefaultColor",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254}},Y1={CRG:{name:"ColourRange",isOnlyV4:!1}};class _d{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ColourLegend}static fromXML(t,e,n,s=_d){return ie(t,e,s,H1,Y1,n)}toXML(){return ne(this,H1,Y1)}}$t("main",_t.ColourLegend,_d);const Z1={A:{name:"MinimumValue",type:"xs:long",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-2147483647,maxValue:2147483647},B:{name:"MaximumValue",type:"xs:long",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-2147483647,maxValue:2147483647},C:{name:"Colour",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:254}},K1={};class wd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ColourRange}static fromXML(t,e,n,s=wd){return ie(t,e,s,Z1,K1,n)}toXML(){return ne(this,Z1,K1)}}$t("main",_t.ColourRange,wd);const q1={A:{name:"CodedCommentIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},B:{name:"CodedCommentListValueIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"FreeCommentText",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},$1={ASP:{name:"AllocationStamp",isOnlyV4:!1}};class bd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.CommentAllocation}static fromXML(t,e,n,s=bd){return ie(t,e,s,q1,$1,n)}toXML(){return ne(this,q1,$1)}}$t("main",_t.CommentAllocation,bd);const J1={A:{name:"DeviceIdRef_0",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"DeviceElementIdRef_0",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"DeviceIdRef_1",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},D:{name:"DeviceElementIdRef_1",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},Q1={};class Ed{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Connection}static fromXML(t,e,n,s=Ed){return ie(t,e,s,J1,Q1,n)}toXML(){return ne(this,J1,Q1)}}$t("main",_t.Connection,Ed);const tg={A:{name:"SourceClientNAME",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},B:{name:"UserClientNAME",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},C:{name:"SourceDeviceStructureLabel",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},D:{name:"UserDeviceStructureLabel",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},E:{name:"SourceDeviceElementNumber",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:0,maxValue:4095},F:{name:"UserDeviceElementNumber",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:0,maxValue:4095},G:{name:"ProcessDataDDI",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0}},eg={ASP:{name:"AllocationStamp",isOnlyV4:void 0}};class Id{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ControlAssignment}static fromXML(t,e,n,s=Id){return ie(t,e,s,tg,eg,n)}toXML(){return ne(this,tg,eg)}}$t("main",_t.ControlAssignment,Id);const ig={A:{name:"CropTypeId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"CropTypeDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"ProductGroupIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0}},ng={CVT:{name:"CropVariety",isOnlyV4:!1}};class Cd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.CropType}static fromXML(t,e,n,s=Cd){return ie(t,e,s,ig,ng,n)}toXML(){return ne(this,ig,ng)}}$t("main",_t.CropType,Cd);const sg={A:{name:"CropVarietyId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"CropVarietyDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"ProductIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0}},rg={};class Ad{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.CropVariety}static fromXML(t,e,n,s=Ad){return ie(t,e,s,sg,rg,n)}toXML(){return ne(this,sg,rg)}}$t("main",_t.CropVariety,Ad);const ag={A:{name:"CulturalPracticeId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"CulturalPracticeDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},og={OTR:{name:"OperationTechniqueReference",isOnlyV4:!1}};class Rd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.CulturalPractice}static fromXML(t,e,n,s=Rd){return ie(t,e,s,ag,og,n)}toXML(){return ne(this,ag,og)}}$t("main",_t.CulturalPractice,Rd);const lg={A:{name:"CustomerId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"CustomerLastName",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"CustomerFirstName",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},D:{name:"CustomerStreet",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},E:{name:"CustomerPOBox",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"CustomerPostalCode",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},G:{name:"CustomerCity",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},H:{name:"CustomerState",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},I:{name:"CustomerCountry",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},J:{name:"CustomerPhone",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},K:{name:"CustomerMobile",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},L:{name:"CustomerFax",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},M:{name:"CustomerEMail",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},hg={};class Sd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Customer}static fromXML(t,e,n,s=Sd){return ie(t,e,s,lg,hg,n)}toXML(){return ne(this,lg,hg)}}$t("main",_t.Customer,Sd);const ug={A:{name:"DataLogDDI",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"DataLogMethod",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:1,maxValue:31},C:{name:"DataLogDistanceInterval",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:1e6},D:{name:"DataLogTimeInterval",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:6e4},E:{name:"DataLogThresholdMinimum",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:-2147483647,maxValue:2147483647},F:{name:"DataLogThresholdMaximum",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:-2147483647,maxValue:2147483647},G:{name:"DataLogThresholdChange",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:-2147483647,maxValue:2147483647},H:{name:"DeviceElementIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},I:{name:"ValuePresentationIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},J:{name:"DataLogPGN",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:262143},K:{name:"DataLogPGNStartBit",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:63},L:{name:"DataLogPGNStopBit",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:63}},cg={};class Td{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.DataLogTrigger}static fromXML(t,e,n,s=Td){return ie(t,e,s,ug,cg,n)}toXML(){return ne(this,ug,cg)}}$t("main",_t.DataLogTrigger,Td);const fg={A:{name:"ProcessDataDDI",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"ProcessDataValue",type:"xs:long",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-2147483648,maxValue:2147483647},C:{name:"DeviceElementIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},D:{name:"DataLogPGN",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:262143},E:{name:"DataLogPGNStartBit",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:63},F:{name:"DataLogPGNStopBit",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:63}},dg={};class Dd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.DataLogValue}static fromXML(t,e,n,s=Dd){return ie(t,e,s,fg,dg,n)}toXML(){return ne(this,fg,dg)}}$t("main",_t.DataLogValue,Dd);const gg={A:{name:"DeviceId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"DeviceDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"DeviceSoftwareVersion",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},D:{name:"ClientNAME",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},E:{name:"DeviceSerialNumber",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"DeviceStructureLabel",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},G:{name:"DeviceLocalizationLabel",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},mg={DET:{name:"DeviceElement",isOnlyV4:!1},DPT:{name:"DeviceProperty",isOnlyV4:!1},DPD:{name:"DeviceProcessData",isOnlyV4:!1},DVP:{name:"DeviceValuePresentation",isOnlyV4:!1}};class Md{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Device}static fromXML(t,e,n,s=Md){return ie(t,e,s,gg,mg,n)}toXML(){return ne(this,gg,mg)}}$t("main",_t.Device,Md);const pg={A:{name:"ClientNAMEValue",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"ClientNAMEMask",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"DeviceIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},yg={ASP:{name:"AllocationStamp",isOnlyV4:!1}};class vd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.DeviceAllocation}static fromXML(t,e,n,s=vd){return ie(t,e,s,pg,yg,n)}toXML(){return ne(this,pg,yg)}}$t("main",_t.DeviceAllocation,vd);var xg;(function(i){i.Device="1",i.Function="2",i.Bin="3",i.Section="4",i.Unit="5",i.Connector="6",i.Navigation="7"})(xg||(xg={}));const _g={A:{name:"DeviceElementId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"DeviceElementObjectId",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:1,maxValue:65534},C:{name:"DeviceElementType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},D:{name:"DeviceElementDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},E:{name:"DeviceElementNumber",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:4095},F:{name:"ParentObjectId",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:65534}},wg={DOR:{name:"DeviceObjectReference",isOnlyV4:!1}};class vo{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.DeviceElement}static fromXML(t,e,n,s=vo){return ie(t,e,s,_g,wg,n)}toXML(){return ne(this,_g,wg)}}$t("main",_t.DeviceElement,vo);const bg={A:{name:"DeviceObjectId",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:1,maxValue:65534}},Eg={};class Od{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.DeviceObjectReference}static fromXML(t,e,n,s=Od){return ie(t,e,s,bg,Eg,n)}toXML(){return ne(this,bg,Eg)}}$t("main",_t.DeviceObjectReference,Od);const Ig={A:{name:"DeviceProcessDataObjectId",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:1,maxValue:65534},B:{name:"DeviceProcessDataDDI",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"DeviceProcessDataProperty",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:7},D:{name:"DeviceProcessDataTriggerMethods",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:31},E:{name:"DeviceProcessDataDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"DeviceValuePresentationObjectId",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:1,maxValue:65534}},Cg={};class Pd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.DeviceProcessData}static fromXML(t,e,n,s=Pd){return ie(t,e,s,Ig,Cg,n)}toXML(){return ne(this,Ig,Cg)}}$t("main",_t.DeviceProcessData,Pd);const Ag={A:{name:"DevicePropertyObjectId",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:1,maxValue:65534},B:{name:"DevicePropertyDDI",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"DevicePropertyValue",type:"xs:long",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-2147483648,maxValue:2147483647},D:{name:"DevicePropertyDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},E:{name:"DeviceValuePresentationObjectId",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:1,maxValue:65534}},Rg={};class Nd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.DeviceProperty}static fromXML(t,e,n,s=Nd){return ie(t,e,s,Ag,Rg,n)}toXML(){return ne(this,Ag,Rg)}}$t("main",_t.DeviceProperty,Nd);const Sg={A:{name:"DeviceValuePresentationObjectId",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:1,maxValue:65534},B:{name:"Offset",type:"xs:long",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-2147483648,maxValue:2147483647},C:{name:"Scale",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:1e-9,maxValue:1e8},D:{name:"NumberOfDecimals",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:7},E:{name:"UnitDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},Tg={};class Ld{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.DeviceValuePresentation}static fromXML(t,e,n,s=Ld){return ie(t,e,s,Sg,Tg,n)}toXML(){return ne(this,Sg,Tg)}}$t("main",_t.DeviceValuePresentation,Ld);const Dg={A:{name:"FarmId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"FarmDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"FarmStreet",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},D:{name:"FarmPOBox",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},E:{name:"FarmPostalCode",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"FarmCity",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},G:{name:"FarmState",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},H:{name:"FarmCountry",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},I:{name:"CustomerIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},Mg={};class kd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Farm}static fromXML(t,e,n,s=kd){return ie(t,e,s,Dg,Mg,n)}toXML(){return ne(this,Dg,Mg)}}$t("main",_t.Farm,kd);var Vr;(function(i){i.GridType1="1",i.GridType2="2"})(Vr||(Vr={}));const vg={A:{name:"GridMinimumNorthPosition",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-90,maxValue:90,fractionDigits:9},B:{name:"GridMinimumEastPosition",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-180,maxValue:180,fractionDigits:9},C:{name:"GridCellNorthSize",type:"xs:double",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:1},D:{name:"GridCellEastSize",type:"xs:double",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:1},E:{name:"GridMaximumColumn",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:4294967295},F:{name:"GridMaximumRow",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:4294967295},G:{name:"Filename",type:"xs:ID",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},H:{name:"Filelength",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:4294967294},I:{name:"GridType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},J:{name:"TreatmentZoneCode",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254}},Og={};class Oo{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Grid}static fromXML(t,e,n,s=Oo){return ie(t,e,s,vg,Og,n)}toXML(){return ne(this,vg,Og)}}$t("main",_t.Grid,Oo);const Pg={A:{name:"GuidanceGroupIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0}},Ng={ASP:{name:"AllocationStamp",isOnlyV4:void 0},GST:{name:"GuidanceShift",isOnlyV4:void 0}};class Fd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.GuidanceAllocation}static fromXML(t,e,n,s=Fd){return ie(t,e,s,Pg,Ng,n)}toXML(){return ne(this,Pg,Ng)}}$t("main",_t.GuidanceAllocation,Fd);const Lg={A:{name:"GuidanceGroupId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:void 0},B:{name:"GuidanceGroupDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0}},kg={GPN:{name:"GuidancePattern",isOnlyV4:void 0},PLN:{name:"BoundaryPolygon",isOnlyV4:void 0}};class Bd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.GuidanceGroup}static fromXML(t,e,n,s=Bd){return ie(t,e,s,Lg,kg,n)}toXML(){return ne(this,Lg,kg)}}$t("main",_t.GuidanceGroup,Bd);var Fg;(function(i){i.AB="1",i.A="2",i.Curve="3",i.Pivot="4",i.Spiral="5"})(Fg||(Fg={}));var Bg;(function(i){i.ClockwiseForPivot="1",i.CounterClockwiseForPivot="2",i.FullCircleForPivot="3"})(Bg||(Bg={}));var Vg;(function(i){i.BothDirections="1",i.LeftDirectionOnly="2",i.RightDirectionOnly="3",i.NoPropagation="4"})(Vg||(Vg={}));var Gg;(function(i){i.FromBothFirstAndLastPoint="1",i.FromFirstPointAOnly="2",i.FromLastPointBOnly="3",i.NoExtensions="4"})(Gg||(Gg={}));var zg;(function(i){i.NoGPSFix="0",i.GNSSFix="1",i.DGNSSFix="2",i.PreciseGNSS="3",i.RTKFixedInteger="4",i.RTKFloat="5",i.EstDRMode="6",i.ManualInput="7",i.SimulateMode="8",i.DesktopGeneratedData="16",i.Other="17"})(zg||(zg={}));const Ug={A:{name:"GuidancePatternId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:void 0},B:{name:"GuidancePatternDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},C:{name:"GuidancePatternType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},D:{name:"GuidancePatternOptions",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},E:{name:"GuidancePatternPropagationDirection",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},F:{name:"GuidancePatternExtension",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},G:{name:"GuidancePatternHeading",type:"xs:decimal",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:0,maxValue:360},H:{name:"GuidancePatternRadius",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:0,maxValue:4294967294},I:{name:"GuidancePatternGNSSMethod",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},J:{name:"GuidancePatternHorizontalAccuracy",type:"xs:decimal",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:0,maxValue:65},K:{name:"GuidancePatternVerticalAccuracy",type:"xs:decimal",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:0,maxValue:65},L:{name:"BaseStationIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},M:{name:"OriginalSRID",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},N:{name:"NumberOfSwathsLeft",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:0,maxValue:4294967294},O:{name:"NumberOfSwathsRight",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:0,maxValue:4294967294}},Wg={LSG:{name:"LineString",isOnlyV4:void 0},PLN:{name:"BoundaryPolygon",isOnlyV4:void 0}};class Vd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.GuidancePattern}static fromXML(t,e,n,s=Vd){return ie(t,e,s,Ug,Wg,n)}toXML(){return ne(this,Ug,Wg)}}$t("main",_t.GuidancePattern,Vd);const Xg={A:{name:"GuidanceGroupIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},B:{name:"GuidancePatternIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},C:{name:"GuidanceEastShift",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:-2147483648,maxValue:2147483647},D:{name:"GuidanceNorthShift",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:-2147483648,maxValue:2147483647},E:{name:"PropagationOffset",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:-2147483648,maxValue:2147483647}},jg={ASP:{name:"AllocationStamp",isOnlyV4:void 0}};class Gd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.GuidanceShift}static fromXML(t,e,n,s=Gd){return ie(t,e,s,Xg,jg,n)}toXML(){return ne(this,Xg,jg)}}$t("main",_t.GuidanceShift,Gd);var as;(function(i){i.PolygonExterior="1",i.PolygonInterior="2",i.TramLine="3",i.SamplingRoute="4",i.GuidancePattern="5",i.Drainage="6",i.Fence="7",i.Flag="8",i.Obstacle="9"})(as||(as={}));const Hg={A:{name:"LineStringType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"LineStringDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"LineStringWidth",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:4294967294},D:{name:"LineStringLength",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:4294967294},E:{name:"LineStringColour",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254},F:{name:"LineStringId",type:"xs:ID",isPrimaryId:!0,isOptional:!0,isOnlyV4:!0}},Yg={PNT:{name:"Point",isOnlyV4:!1}};class Po{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.LineString}static fromXML(t,e,n,s=Po){return ie(t,e,s,Hg,Yg,n)}toXML(){return ne(this,Hg,Yg)}}$t("main",_t.LineString,Po);const Zg={A:{name:"OperationTechniqueId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"OperationTechniqueDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},Kg={};class zd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.OperationTechnique}static fromXML(t,e,n,s=zd){return ie(t,e,s,Zg,Kg,n)}toXML(){return ne(this,Zg,Kg)}}$t("main",_t.OperationTechnique,zd);const qg={A:{name:"OperationTechniqueIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},$g={};class Ud{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.OperationTechniqueReference}static fromXML(t,e,n,s=Ud){return ie(t,e,s,qg,$g,n)}toXML(){return ne(this,qg,$g)}}$t("main",_t.OperationTechniqueReference,Ud);const Jg={A:{name:"CulturalPracticeIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"OperationTechniqueIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},Qg={};class Wd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.OperTechPractice}static fromXML(t,e,n,s=Wd){return ie(t,e,s,Jg,Qg,n)}toXML(){return ne(this,Jg,Qg)}}$t("main",_t.OperTechPractice,Wd);const tm={A:{name:"PartfieldId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"PartfieldCode",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"PartfieldDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},D:{name:"PartfieldArea",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:4294967294},E:{name:"CustomerIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"FarmIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},G:{name:"CropTypeIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},H:{name:"CropVarietyIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},I:{name:"FieldIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},em={PLN:{name:"PolygonnonTreatmentZoneonly",isOnlyV4:!1},LSG:{name:"LineString",isOnlyV4:!1},PNT:{name:"Point",isOnlyV4:!1},GGP:{name:"GuidanceGroup",isOnlyV4:!0}};class No{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Partfield}static fromXML(t,e,n,s=No){return ie(t,e,s,tm,em,n)}toXML(){return ne(this,tm,em)}}$t("main",_t.Partfield,No);var Hc;(function(i){i.Flag="1",i.Other="2",i.FieldAccess="3",i.Storage="4",i.Obstacle="5",i.GuidanceReferenceA="6",i.GuidanceReferenceB="7",i.GuidanceReferenceCenter="8",i.GuidancePoint="9",i.PartfieldReferencePoint="10",i.Homebase="11"})(Hc||(Hc={}));const im={A:{name:"PointType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,allowEmptyString:!0},B:{name:"PointDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"PointNorth",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-90,maxValue:90,fractionDigits:9,allowEmptyString:!0},D:{name:"PointEast",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-180,maxValue:180,fractionDigits:9,allowEmptyString:!0},E:{name:"PointUp",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:-2147483647,maxValue:2147483647,allowEmptyString:!0},F:{name:"PointColour",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254,allowEmptyString:!0},G:{name:"PointId",type:"xs:ID",isPrimaryId:!0,isOptional:!0,isOnlyV4:!0},H:{name:"PointHorizontalAccuracy",type:"xs:decimal",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0,minValue:0,maxValue:65,allowEmptyString:!0},I:{name:"PointVerticalAccuracy",type:"xs:decimal",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0,minValue:0,maxValue:65,allowEmptyString:!0},J:{name:"Filename",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0},K:{name:"Filelength",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0,minValue:0,maxValue:4294967294}},nm={};class tu{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Point}static fromXML(t,e,n,s=tu){return ie(t,e,s,im,nm,n)}toXML(){return ne(this,im,nm)}}$t("main",_t.Point,tu);var Yc;(function(i){i.PartfieldBoundary="1",i.TreatmentZone="2",i.WaterSurface="3",i.Building="4",i.Road="5",i.Obstacle="6",i.Flag="7",i.Other="8",i.Mainfield="9",i.Headland="10",i.BufferZone="11",i.Windbreak="12"})(Yc||(Yc={}));const sm={A:{name:"PolygonType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"PolygonDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"PolygonArea",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:4294967294},D:{name:"PolygonColour",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254},E:{name:"PolygonId",type:"xs:ID",isPrimaryId:!0,isOptional:!0,isOnlyV4:!0}},rm={LSG:{name:"LineString",isOnlyV4:!1}};class Lo{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Polygon}static fromXML(t,e,n,s=Lo){return ie(t,e,s,sm,rm,n)}toXML(){return ne(this,sm,rm)}}$t("main",_t.Polygon,Lo);var am;(function(i){i.NoGPSFix="0",i.GNSSFix="1",i.DGNSSFix="2",i.PreciseGNSS="3",i.RTKFixedInteger="4",i.RTKFloat="5",i.EstDRMode="6",i.ManualInput="7",i.SimulateMode="8",i.Reserved9="9",i.Reserved10="10",i.Reserved11="11",i.Reserved12="12",i.Reserved13="13",i.Error="14",i.PositionStatusValueIsNotAvailable="15"})(am||(am={}));const om={A:{name:"PositionNorth",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-90,maxValue:90,fractionDigits:9},B:{name:"PositionEast",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-180,maxValue:180,fractionDigits:9},C:{name:"PositionUp",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:-2147483648,maxValue:2147483647},D:{name:"PositionStatus",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},E:{name:"PDOP",type:"xs:decimal",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:99.9},F:{name:"HDOP",type:"xs:decimal",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:99.9},G:{name:"NumberOfSatellites",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254},H:{name:"GpsUtcTime",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:4294967294},I:{name:"GpsUtcDate",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:65534}},lm={};class Xd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Position}static fromXML(t,e,n,s=Xd){return ie(t,e,s,om,lm,n)}toXML(){return ne(this,om,lm)}}$t("main",_t.Position,Xd);const hm={A:{name:"ProcessDataDDI",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"ProcessDataValue",type:"xs:long",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-2147483648,maxValue:2147483647},C:{name:"ProductIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},D:{name:"DeviceElementIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},E:{name:"ValuePresentationIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"ActualCulturalPracticeValue",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0,minValue:-2147483648,maxValue:2147483647},G:{name:"ElementTypeInstanceValue",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0,minValue:-2147483648,maxValue:2147483647}},um={PDV:{name:"ProcessDataVariable",isOnlyV4:!1}};class jd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ProcessDataVariable}static fromXML(t,e,n,s=jd){return ie(t,e,s,hm,um,n)}toXML(){return ne(this,hm,um)}}$t("main",_t.ProcessDataVariable,jd);var cm;(function(i){i.SingleDefault="1",i.Mixture="2",i.TemporaryMixture="3"})(cm||(cm={}));const fm={A:{name:"ProductId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"ProductDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"ProductGroupIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},D:{name:"ValuePresentationIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},E:{name:"QuantityDDI",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"ProductType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0},G:{name:"MixtureRecipeQuantity",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0,minValue:0,maxValue:2147483647},H:{name:"DensityMassPerVolume",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0,minValue:0,maxValue:2147483647},I:{name:"DensityMassPerCount",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0,minValue:0,maxValue:2147483647},J:{name:"DensityVolumePerCount",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0,minValue:0,maxValue:2147483647}},dm={PRN:{name:"ProductRelation",isOnlyV4:!0}};class Hd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Product}static fromXML(t,e,n,s=Hd){return ie(t,e,s,fm,dm,n)}toXML(){return ne(this,fm,dm)}}$t("main",_t.Product,Hd);var gm;(function(i){i.Filling="1",i.Emptying="2",i.Remainder="3"})(gm||(gm={}));const mm={A:{name:"ProductIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"QuantityDDI",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"QuantityValue",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:2147483647},D:{name:"TransferMode",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},E:{name:"DeviceElementIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"ValuePresentationIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},G:{name:"ProductSubTypeIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0}},pm={ASP:{name:"AllocationStamp",isOnlyV4:!1}};class Yd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ProductAllocation}static fromXML(t,e,n,s=Yd){return ie(t,e,s,mm,pm,n)}toXML(){return ne(this,mm,pm)}}$t("main",_t.ProductAllocation,Yd);var ym;(function(i){i.ProductGroupDefault="1",i.CropType="2"})(ym||(ym={}));const xm={A:{name:"ProductGroupId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"ProductGroupDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"ProductGroupType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0}},_m={};class Zd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ProductGroup}static fromXML(t,e,n,s=Zd){return ie(t,e,s,xm,_m,n)}toXML(){return ne(this,xm,_m)}}$t("main",_t.ProductGroup,Zd);const wm={A:{name:"ProductIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},B:{name:"QuantityValue",type:"xs:long",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:0,maxValue:2147483647}},bm={};class Kd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ProductRelation}static fromXML(t,e,n,s=Kd){return ie(t,e,s,wm,bm,n)}toXML(){return ne(this,wm,bm)}}$t("main",_t.ProductRelation,Kd);var Em;(function(i){i.Planned="1",i.Running="2",i.Paused="3",i.Completed="4",i.Template="5",i.Canceled="6"})(Em||(Em={}));const Im={A:{name:"TaskId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"TaskDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"CustomerIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},D:{name:"FarmIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},E:{name:"PartfieldIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"ResponsibleWorkerIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},G:{name:"TaskStatus",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},H:{name:"DefaultTreatmentZoneCode",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254},I:{name:"PositionLostTreatmentZoneCode",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254},J:{name:"OutOfFieldTreatmentZoneCode",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254}},Cm={TZN:{name:"TreatmentZone",isOnlyV4:!1},TIM:{name:"Time",isOnlyV4:!1},OTP:{name:"OperTechPractice",isOnlyV4:!1},WAN:{name:"WorkerAllocation",isOnlyV4:!1},DAN:{name:"DeviceAllocation",isOnlyV4:!1},CNN:{name:"Connection",isOnlyV4:!1},PAN:{name:"ProductAllocation",isOnlyV4:!1},DLT:{name:"DataLogTrigger",isOnlyV4:!1},CAN:{name:"CommentAllocation",isOnlyV4:!1},TLG:{name:"TimeLog",isOnlyV4:!1},GRD:{name:"Grid",isOnlyV4:!1},CAT:{name:"ControlAssignment",isOnlyV4:!0},GAN:{name:"GuidanceAllocation",isOnlyV4:!0}};class ko{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Task}static fromXML(t,e,n,s=ko){return ie(t,e,s,Im,Cm,n)}toXML(){return ne(this,Im,Cm)}}$t("main",_t.Task,ko);var Am;(function(i){i.Planned="1",i.Preliminary="2",i.Effective="4",i.Ineffective="5",i.Repair="6",i.Clearing="7",i.PoweredDown="8"})(Am||(Am={}));const Rm={A:{name:"Start",type:"xs:dateTime",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"Stop",type:"xs:dateTime",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"Duration",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:4294967294},D:{name:"Type",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},Sm={PTN:{name:"Position",isOnlyV4:!1},DLV:{name:"DataLogValue",isOnlyV4:!1}};class qd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Time}static fromXML(t,e,n,s=qd){return ie(t,e,s,Rm,Sm,n)}toXML(){return ne(this,Rm,Sm)}}$t("main",_t.Time,qd);var Tm;(function(i){i.BinaryTimelogFileType1="1"})(Tm||(Tm={}));const Dm={A:{name:"Filename",type:"xs:ID",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"Filelength",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:4294967294},C:{name:"TimeLogType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},Mm={};class Fo{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.TimeLog}static fromXML(t,e,n,s=Fo){return ie(t,e,s,Dm,Mm,n)}toXML(){return ne(this,Dm,Mm)}}$t("main",_t.TimeLog,Fo);const vm={A:{name:"TreatmentZoneCode",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:254},B:{name:"TreatmentZoneDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},C:{name:"TreatmentZoneColour",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254}},Om={PLN:{name:"PolygonTreatmentZoneonly",isOnlyV4:!1},PDV:{name:"ProcessDataVariable",isOnlyV4:!1}};class Bo{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.TreatmentZone}static fromXML(t,e,n,s=Bo){return ie(t,e,s,vm,Om,n)}toXML(){return ne(this,vm,Om)}}$t("main",_t.TreatmentZone,Bo);const Pm={A:{name:"ValuePresentationId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"Offset",type:"xs:long",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-2147483648,maxValue:2147483647},C:{name:"Scale",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:1e-9,maxValue:1e8},D:{name:"NumberOfDecimals",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:0,maxValue:7},E:{name:"UnitDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"ColourLegendIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},Nm={};class $d{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ValuePresentation}static fromXML(t,e,n,s=$d){return ie(t,e,s,Pm,Nm,n)}toXML(){return ne(this,Pm,Nm)}}$t("main",_t.ValuePresentation,$d);const Lm={A:{name:"WorkerId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:!1},B:{name:"WorkerLastName",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"WorkerFirstName",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},D:{name:"WorkerStreet",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},E:{name:"WorkerPOBox",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},F:{name:"WorkerPostalCode",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},G:{name:"WorkerCity",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},H:{name:"WorkerState",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},I:{name:"WorkerCountry",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},J:{name:"WorkerPhone",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},K:{name:"WorkerMobile",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},L:{name:"WorkerLicenseNumber",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},M:{name:"WorkerEMail",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1}},km={};class Jd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Worker}static fromXML(t,e,n,s=Jd){return ie(t,e,s,Lm,km,n)}toXML(){return ne(this,Lm,km)}}$t("main",_t.Worker,Jd);const Fm={A:{name:"WorkerIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},Bm={ASP:{name:"AllocationStamp",isOnlyV4:!1}};class Qd{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.WorkerAllocation}static fromXML(t,e,n,s=Qd){return ie(t,e,s,Fm,Bm,n)}toXML(){return ne(this,Fm,Bm)}}$t("main",_t.WorkerAllocation,Qd);var Zc;(function(i){i.TaskControllerDoesNotNeedToPreserveAttachedFile="1",i.PreserveOnTaskControllerAndSendBackToFMIS="2"})(Zc||(Zc={}));const Vm={A:{name:"FilenameWithExtension",type:"xs:ID",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},B:{name:"Preserve",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},C:{name:"ManufacturerGLN",type:"xs:anyURI",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},D:{name:"FileType",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:1,maxValue:254},E:{name:"FileVersion",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},F:{name:"FileLength",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0,minValue:0,maxValue:4294967294}},Gm={};class Vo{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.AttachedFile}static fromXML(t,e,n,s=Vo){return ie(t,e,s,Vm,Gm,n)}toXML(){return ne(this,Vm,Gm)}}$t("main",_t.AttachedFile,Vo);var zm;(function(i){i.TheVersionOfTheSecondEditionPublishedAsAFinalDraftInternationalStandard="4"})(zm||(zm={}));var Um;(function(i){i.Value0="0",i.Value1="1",i.Value2="2",i.Value3="3"})(Um||(Um={}));var Kc;(function(i){i.FMIS="1",i.MICS="2"})(Kc||(Kc={}));const Wm={VersionMajor:{name:"VersionMajor",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},VersionMinor:{name:"VersionMinor",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},ManagementSoftwareManufacturer:{name:"ManagementSoftwareManufacturer",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},ManagementSoftwareVersion:{name:"ManagementSoftwareVersion",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},TaskControllerManufacturer:{name:"TaskControllerManufacturer",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},TaskControllerVersion:{name:"TaskControllerVersion",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1},DataTransferOrigin:{name:"DataTransferOrigin",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},lang:{name:"lang",type:"xs:language",isPrimaryId:!1,isOptional:!0,isOnlyV4:!0}},Xm={AFE:{name:"AttachedFile",isOnlyV4:!0},BSN:{name:"BaseStation",isOnlyV4:!0},CCT:{name:"CodedComment",isOnlyV4:!1},CCG:{name:"CodedCommentGroup",isOnlyV4:!1},CLD:{name:"ColourLegend",isOnlyV4:!1},CTP:{name:"CropType",isOnlyV4:!1},CPC:{name:"CulturalPractice",isOnlyV4:!1},CTR:{name:"Customer",isOnlyV4:!1},DVC:{name:"Device",isOnlyV4:!1},FRM:{name:"Farm",isOnlyV4:!1},OTQ:{name:"OperationTechnique",isOnlyV4:!1},PFD:{name:"Partfield",isOnlyV4:!1},PDT:{name:"Product",isOnlyV4:!1},PGP:{name:"ProductGroup",isOnlyV4:!1},TSK:{name:"Task",isOnlyV4:!1},TCC:{name:"TaskControllerCapabilities",isOnlyV4:!0},VPN:{name:"ValuePresentation",isOnlyV4:!1},WKR:{name:"Worker",isOnlyV4:!1},XFR:{name:"ExternalFileReference",isOnlyV4:!1}};class Go{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ISO11783TaskDataFile}static fromXML(t,e,n,s=Go){return ie(t,e,s,Wm,Xm,n)}toXML(){return ne(this,Wm,Xm)}}$t("main",_t.ISO11783TaskDataFile,Go);var jm;(function(i){i.TheVersionOfTheDIS1FirstDraftInternationalStandard="0",i.TheVersionOfTheFDIS1FinalDraftInternationalStandardFirstEdition="1",i.TheVersionOfTheFDIS2AndTheFirstEditionPublishedAsAnInternationalStandard="2",i.TheVersionOfTheSecondEditionPublishedAsADraftInternationalStandardE2DIS="3",i.TheVersionOfTheSecondEditionPublishedAsAFinalDraftInternationalStandardE2FDIS="4"})(jm||(jm={}));const Hm={A:{name:"TaskControllerControlFunctionNAME",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},B:{name:"TaskControllerDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},C:{name:"VersionNumber",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},D:{name:"ProvidedCapabilities",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:0,maxValue:63},E:{name:"NumberOfBoomsSectionControl",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:0,maxValue:254},F:{name:"NumberOfSectionsSectionControl",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:0,maxValue:254},G:{name:"NumberOfControlChannels",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0,minValue:0,maxValue:254}},Ym={};class t0{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.TaskControllerCapabilities}static fromXML(t,e,n,s=t0){return ie(t,e,s,Hm,Ym,n)}toXML(){return ne(this,Hm,Ym)}}$t("main",_t.TaskControllerCapabilities,t0);var Zm;(function(i){i.XML="1"})(Zm||(Zm={}));const Km={A:{name:"Filename",type:"xs:ID",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"Filetype",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},qm={};class e0{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ExternalFileReference}static fromXML(t,e,n,s=e0){return ie(t,e,s,Km,qm,n)}toXML(){return ne(this,Km,qm)}}$t("main",_t.ExternalFileReference,e0);var $m;(function(i){i.TheVersionOfTheSecondEditionPublishedAsAFinalDraftInternationalStandard="4"})($m||($m={}));var Jm;(function(i){i.Value0="0",i.Value1="1",i.Value2="2",i.Value3="3"})(Jm||(Jm={}));var qc;(function(i){i.FMIS="1",i.MICS="2"})(qc||(qc={}));const Qm={VersionMajor:{name:"VersionMajor",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},VersionMinor:{name:"VersionMinor",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},ManagementSoftwareManufacturer:{name:"ManagementSoftwareManufacturer",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},ManagementSoftwareVersion:{name:"ManagementSoftwareVersion",type:"xs:string",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},TaskControllerManufacturer:{name:"TaskControllerManufacturer",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},TaskControllerVersion:{name:"TaskControllerVersion",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},FileVersion:{name:"FileVersion",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},DataTransferOrigin:{name:"DataTransferOrigin",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0}},tp={LGP:{name:"LinkGroup",isOnlyV4:void 0}};class zo{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ISO11783LinkListFile}static fromXML(t,e,n,s=zo){return ie(t,e,s,Qm,tp,n)}toXML(){return ne(this,Qm,tp)}}$t("main",_t.ISO11783LinkListFile,zo);const ep={A:{name:"ObjectIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},B:{name:"LinkValue",type:"xs:token",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},C:{name:"LinkDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0}},ip={};class eu{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Link}static fromXML(t,e,n,s=eu){return ie(t,e,s,ep,ip,n)}toXML(){return ne(this,ep,ip)}}$t("main",_t.Link,eu);var wh;(function(i){i.UUIDs="1",i.ManufacturerProprietary="2",i.UniqueResolvableURIs="3",i.InformationalResolvableURIs="4"})(wh||(wh={}));const np={A:{name:"LinkGroupId",type:"xs:ID",isPrimaryId:!0,isOptional:!1,isOnlyV4:void 0},B:{name:"LinkGroupType",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:void 0},C:{name:"ManufacturerGLN",type:"xs:anyURI",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},D:{name:"LinkGroupNamespace",type:"xs:token",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0},E:{name:"LinkGroupDesignator",type:"xs:string",isPrimaryId:!1,isOptional:!0,isOnlyV4:void 0}},sp={LNK:{name:"Link",isOnlyV4:void 0}};class i0{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.LinkGroup}static fromXML(t,e,n,s=i0){return ie(t,e,s,np,sp,n)}toXML(){return ne(this,np,sp)}}$t("main",_t.LinkGroup,i0);const rp={},ap={BSN:{name:"BaseStation",isOnlyV4:void 0},CCT:{name:"CodedComment",isOnlyV4:void 0},CCG:{name:"CodedCommentGroup",isOnlyV4:void 0},CLD:{name:"ColourLegend",isOnlyV4:void 0},CTP:{name:"CropType",isOnlyV4:void 0},CPC:{name:"CulturalPractice",isOnlyV4:void 0},CTR:{name:"Customer",isOnlyV4:void 0},DVC:{name:"Device",isOnlyV4:void 0},FRM:{name:"Farm",isOnlyV4:void 0},OTQ:{name:"OperationTechnique",isOnlyV4:void 0},PFD:{name:"Partfield",isOnlyV4:void 0},PDT:{name:"Product",isOnlyV4:void 0},PGP:{name:"ProductGroup",isOnlyV4:void 0},TSK:{name:"Task",isOnlyV4:void 0},VPN:{name:"ValuePresentation",isOnlyV4:void 0},WKR:{name:"Worker",isOnlyV4:void 0}};class n0{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.ExternalFileContents}static fromXML(t,e,n,s=n0){return ie(t,e,s,rp,ap,n)}toXML(){return ne(this,rp,ap)}}$t("main",_t.ExternalFileContents,n0);const op={A:{name:"ProcessDataDDI",type:"xs:hexBinary",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},B:{name:"ProcessDataValue",type:"emptyString",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},C:{name:"DeviceElementIdRef",type:"xs:IDREF",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},D:{name:"DataLogPGN",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:262143},E:{name:"DataLogPGNStartBit",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:63},F:{name:"DataLogPGNStopBit",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:63}},lp={};class s0{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.DataLogValue}static fromXML(t,e,n,s=s0){return ie(t,e,s,op,lp,n)}toXML(){return ne(this,op,lp)}}$t("timelog",_t.DataLogValue,s0);var hp;(function(i){i.NoGPSFix="0",i.GNSSFix="1",i.DGNSSFix="2",i.PreciseGNSS="3",i.RTKFixedInteger="4",i.RTKFloat="5",i.EstDRMode="6",i.ManualInput="7",i.SimulateMode="8",i.Reserved9="9",i.Reserved10="10",i.Reserved11="11",i.Reserved12="12",i.Reserved13="13",i.Error="14",i.PositionStatusValueIsNotAvailable="15"})(hp||(hp={}));const up={A:{name:"PositionNorth",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-90,maxValue:90,fractionDigits:9,allowEmptyString:!0},B:{name:"PositionEast",type:"xs:decimal",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,minValue:-180,maxValue:180,fractionDigits:9,allowEmptyString:!0},C:{name:"PositionUp",type:"xs:long",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:-2147483648,maxValue:2147483647,allowEmptyString:!0},D:{name:"PositionStatus",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1,allowEmptyString:!0},E:{name:"PDOP",type:"xs:decimal",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:99.9,allowEmptyString:!0},F:{name:"HDOP",type:"xs:decimal",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:99.9,allowEmptyString:!0},G:{name:"NumberOfSatellites",type:"xs:unsignedByte",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:254,allowEmptyString:!0},H:{name:"GpsUtcTime",type:"xs:unsignedLong",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:4294967294,allowEmptyString:!0},I:{name:"GpsUtcDate",type:"xs:unsignedShort",isPrimaryId:!1,isOptional:!0,isOnlyV4:!1,minValue:0,maxValue:65534,allowEmptyString:!0}},cp={};class r0{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Position}static fromXML(t,e,n,s=r0){return ie(t,e,s,up,cp,n)}toXML(){return ne(this,up,cp)}}$t("timelog",_t.Position,r0);var fp;(function(i){i.Effective="4"})(fp||(fp={}));const dp={A:{name:"Start",type:"emptyString",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1},D:{name:"Type",type:"xs:NMTOKEN",isPrimaryId:!1,isOptional:!1,isOnlyV4:!1}},gp={PTN:{name:"Position",isOnlyV4:!1},DLV:{name:"DataLogValue",isOnlyV4:!1}};class iu{constructor(t,e){this.attributes=t,this.isoxmlManager=e,this.tag=_t.Time}static fromXML(t,e,n,s=iu){return ie(t,e,s,dp,gp,n)}toXML(){return ne(this,dp,gp)}}$t("timelog",_t.Time,iu);var a0={},nu={};(function(i){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",e=t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",n="["+t+"]["+e+"]*",s=new RegExp("^"+n+"$"),a=function(u,c){const p=[];let y=c.exec(u);for(;y;){const _=[];_.startIndex=c.lastIndex-y[0].length;const E=y.length;for(let I=0;I<E;I++)_.push(y[I]);p.push(_),y=c.exec(u)}return p},l=function(u){const c=s.exec(u);return!(c===null||typeof c>"u")};i.isExist=function(u){return typeof u<"u"},i.isEmptyObject=function(u){return Object.keys(u).length===0},i.merge=function(u,c,p){if(c){const y=Object.keys(c),_=y.length;for(let E=0;E<_;E++)p==="strict"?u[y[E]]=[c[y[E]]]:u[y[E]]=c[y[E]]}},i.getValue=function(u){return i.isExist(u)?u:""},i.isName=l,i.getAllMatches=a,i.nameRegexp=n})(nu);const o0=nu,n4={allowBooleanAttributes:!1,unpairedTags:[]};a0.validate=function(i,t){t=Object.assign({},n4,t);const e=[];let n=!1,s=!1;i[0]==="\uFEFF"&&(i=i.substr(1));for(let a=0;a<i.length;a++)if(i[a]==="<"&&i[a+1]==="?"){if(a+=2,a=pp(i,a),a.err)return a}else if(i[a]==="<"){let l=a;if(a++,i[a]==="!"){a=yp(i,a);continue}else{let u=!1;i[a]==="/"&&(u=!0,a++);let c="";for(;a<i.length&&i[a]!==">"&&i[a]!==" "&&i[a]!=="	"&&i[a]!==`
`&&i[a]!=="\r";a++)c+=i[a];if(c=c.trim(),c[c.length-1]==="/"&&(c=c.substring(0,c.length-1),a--),!c4(c)){let _;return c.trim().length===0?_="Invalid space after '<'.":_="Tag '"+c+"' is an invalid name.",Ti("InvalidTag",_,ln(i,a))}const p=a4(i,a);if(p===!1)return Ti("InvalidAttr","Attributes for '"+c+"' have open quote.",ln(i,a));let y=p.value;if(a=p.index,y[y.length-1]==="/"){const _=a-y.length;y=y.substring(0,y.length-1);const E=xp(y,t);if(E===!0)n=!0;else return Ti(E.err.code,E.err.msg,ln(i,_+E.err.line))}else if(u)if(p.tagClosed){if(y.trim().length>0)return Ti("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",ln(i,l));if(e.length===0)return Ti("InvalidTag","Closing tag '"+c+"' has not been opened.",ln(i,l));{const _=e.pop();if(c!==_.tagName){let E=ln(i,_.tagStartPos);return Ti("InvalidTag","Expected closing tag '"+_.tagName+"' (opened in line "+E.line+", col "+E.col+") instead of closing tag '"+c+"'.",ln(i,l))}e.length==0&&(s=!0)}}else return Ti("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",ln(i,a));else{const _=xp(y,t);if(_!==!0)return Ti(_.err.code,_.err.msg,ln(i,a-y.length+_.err.line));if(s===!0)return Ti("InvalidXml","Multiple possible root nodes found.",ln(i,a));t.unpairedTags.indexOf(c)!==-1||e.push({tagName:c,tagStartPos:l}),n=!0}for(a++;a<i.length;a++)if(i[a]==="<")if(i[a+1]==="!"){a++,a=yp(i,a);continue}else if(i[a+1]==="?"){if(a=pp(i,++a),a.err)return a}else break;else if(i[a]==="&"){const _=h4(i,a);if(_==-1)return Ti("InvalidChar","char '&' is not expected.",ln(i,a));a=_}else if(s===!0&&!mp(i[a]))return Ti("InvalidXml","Extra text at the end",ln(i,a));i[a]==="<"&&a--}}else{if(mp(i[a]))continue;return Ti("InvalidChar","char '"+i[a]+"' is not expected.",ln(i,a))}if(n){if(e.length==1)return Ti("InvalidTag","Unclosed tag '"+e[0].tagName+"'.",ln(i,e[0].tagStartPos));if(e.length>0)return Ti("InvalidXml","Invalid '"+JSON.stringify(e.map(a=>a.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return Ti("InvalidXml","Start tag expected.",1);return!0};function mp(i){return i===" "||i==="	"||i===`
`||i==="\r"}function pp(i,t){const e=t;for(;t<i.length;t++)if(i[t]=="?"||i[t]==" "){const n=i.substr(e,t-e);if(t>5&&n==="xml")return Ti("InvalidXml","XML declaration allowed only at the start of the document.",ln(i,t));if(i[t]=="?"&&i[t+1]==">"){t++;break}else continue}return t}function yp(i,t){if(i.length>t+5&&i[t+1]==="-"&&i[t+2]==="-"){for(t+=3;t<i.length;t++)if(i[t]==="-"&&i[t+1]==="-"&&i[t+2]===">"){t+=2;break}}else if(i.length>t+8&&i[t+1]==="D"&&i[t+2]==="O"&&i[t+3]==="C"&&i[t+4]==="T"&&i[t+5]==="Y"&&i[t+6]==="P"&&i[t+7]==="E"){let e=1;for(t+=8;t<i.length;t++)if(i[t]==="<")e++;else if(i[t]===">"&&(e--,e===0))break}else if(i.length>t+9&&i[t+1]==="["&&i[t+2]==="C"&&i[t+3]==="D"&&i[t+4]==="A"&&i[t+5]==="T"&&i[t+6]==="A"&&i[t+7]==="["){for(t+=8;t<i.length;t++)if(i[t]==="]"&&i[t+1]==="]"&&i[t+2]===">"){t+=2;break}}return t}const s4='"',r4="'";function a4(i,t){let e="",n="",s=!1;for(;t<i.length;t++){if(i[t]===s4||i[t]===r4)n===""?n=i[t]:n!==i[t]||(n="");else if(i[t]===">"&&n===""){s=!0;break}e+=i[t]}return n!==""?!1:{value:e,index:t,tagClosed:s}}const o4=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function xp(i,t){const e=o0.getAllMatches(i,o4),n={};for(let s=0;s<e.length;s++){if(e[s][1].length===0)return Ti("InvalidAttr","Attribute '"+e[s][2]+"' has no space in starting.",Qa(e[s]));if(e[s][3]!==void 0&&e[s][4]===void 0)return Ti("InvalidAttr","Attribute '"+e[s][2]+"' is without value.",Qa(e[s]));if(e[s][3]===void 0&&!t.allowBooleanAttributes)return Ti("InvalidAttr","boolean attribute '"+e[s][2]+"' is not allowed.",Qa(e[s]));const a=e[s][2];if(!u4(a))return Ti("InvalidAttr","Attribute '"+a+"' is an invalid name.",Qa(e[s]));if(!n.hasOwnProperty(a))n[a]=1;else return Ti("InvalidAttr","Attribute '"+a+"' is repeated.",Qa(e[s]))}return!0}function l4(i,t){let e=/\d/;for(i[t]==="x"&&(t++,e=/[\da-fA-F]/);t<i.length;t++){if(i[t]===";")return t;if(!i[t].match(e))break}return-1}function h4(i,t){if(t++,i[t]===";")return-1;if(i[t]==="#")return t++,l4(i,t);let e=0;for(;t<i.length;t++,e++)if(!(i[t].match(/\w/)&&e<20)){if(i[t]===";")break;return-1}return t}function Ti(i,t,e){return{err:{code:i,msg:t,line:e.line||e,col:e.col}}}function u4(i){return o0.isName(i)}function c4(i){return o0.isName(i)}function ln(i,t){const e=i.substring(0,t).split(/\r?\n/);return{line:e.length,col:e[e.length-1].length+1}}function Qa(i){return i.startIndex+i[1].length}var l0={};const ex={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(i,t){return t},attributeValueProcessor:function(i,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(i,t,e){return i}},f4=function(i){return Object.assign({},ex,i)};l0.buildOptions=f4;l0.defaultOptions=ex;class d4{constructor(t){this.tagname=t,this.child=[],this[":@"]={}}add(t,e){t==="__proto__"&&(t="#__proto__"),this.child.push({[t]:e})}addChild(t){t.tagname==="__proto__"&&(t.tagname="#__proto__"),t[":@"]&&Object.keys(t[":@"]).length>0?this.child.push({[t.tagname]:t.child,":@":t[":@"]}):this.child.push({[t.tagname]:t.child})}}var g4=d4;const m4=nu;function p4(i,t){const e={};if(i[t+3]==="O"&&i[t+4]==="C"&&i[t+5]==="T"&&i[t+6]==="Y"&&i[t+7]==="P"&&i[t+8]==="E"){t=t+9;let n=1,s=!1,a=!1,l="";for(;t<i.length;t++)if(i[t]==="<"&&!a){if(s&&_4(i,t)){t+=7;let u,c;[u,c,t]=y4(i,t+1),c.indexOf("&")===-1&&(e[I4(u)]={regx:RegExp(`&${u};`,"g"),val:c})}else if(s&&w4(i,t))t+=8;else if(s&&b4(i,t))t+=8;else if(s&&E4(i,t))t+=9;else if(x4)a=!0;else throw new Error("Invalid DOCTYPE");n++,l=""}else if(i[t]===">"){if(a?i[t-1]==="-"&&i[t-2]==="-"&&(a=!1,n--):n--,n===0)break}else i[t]==="["?s=!0:l+=i[t];if(n!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:e,i:t}}function y4(i,t){let e="";for(;t<i.length&&i[t]!=="'"&&i[t]!=='"';t++)e+=i[t];if(e=e.trim(),e.indexOf(" ")!==-1)throw new Error("External entites are not supported");const n=i[t++];let s="";for(;t<i.length&&i[t]!==n;t++)s+=i[t];return[e,s,t]}function x4(i,t){return i[t+1]==="!"&&i[t+2]==="-"&&i[t+3]==="-"}function _4(i,t){return i[t+1]==="!"&&i[t+2]==="E"&&i[t+3]==="N"&&i[t+4]==="T"&&i[t+5]==="I"&&i[t+6]==="T"&&i[t+7]==="Y"}function w4(i,t){return i[t+1]==="!"&&i[t+2]==="E"&&i[t+3]==="L"&&i[t+4]==="E"&&i[t+5]==="M"&&i[t+6]==="E"&&i[t+7]==="N"&&i[t+8]==="T"}function b4(i,t){return i[t+1]==="!"&&i[t+2]==="A"&&i[t+3]==="T"&&i[t+4]==="T"&&i[t+5]==="L"&&i[t+6]==="I"&&i[t+7]==="S"&&i[t+8]==="T"}function E4(i,t){return i[t+1]==="!"&&i[t+2]==="N"&&i[t+3]==="O"&&i[t+4]==="T"&&i[t+5]==="A"&&i[t+6]==="T"&&i[t+7]==="I"&&i[t+8]==="O"&&i[t+9]==="N"}function I4(i){if(m4.isName(i))return i;throw new Error(`Invalid entity name ${i}`)}var C4=p4;const A4=/^[-+]?0x[a-fA-F0-9]+$/,R4=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const S4={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function T4(i,t={}){if(t=Object.assign({},S4,t),!i||typeof i!="string")return i;let e=i.trim();if(t.skipLike!==void 0&&t.skipLike.test(e))return i;if(t.hex&&A4.test(e))return Number.parseInt(e,16);{const n=R4.exec(e);if(n){const s=n[1],a=n[2];let l=D4(n[3]);const u=n[4]||n[6];if(!t.leadingZeros&&a.length>0&&s&&e[2]!==".")return i;if(!t.leadingZeros&&a.length>0&&!s&&e[1]!==".")return i;{const c=Number(e),p=""+c;return p.search(/[eE]/)!==-1||u?t.eNotation?c:i:e.indexOf(".")!==-1?p==="0"&&l===""||p===l||s&&p==="-"+l?c:i:a?l===p||s+l===p?c:i:e===p||e===s+p?c:i}}else return i}}function D4(i){return i&&i.indexOf(".")!==-1&&(i=i.replace(/0+$/,""),i==="."?i="0":i[0]==="."?i="0"+i:i[i.length-1]==="."&&(i=i.substr(0,i.length-1))),i}var M4=T4;function v4(i){return typeof i=="function"?i:Array.isArray(i)?t=>{for(const e of i)if(typeof e=="string"&&t===e||e instanceof RegExp&&e.test(t))return!0}:()=>!1}var ix=v4;const nx=nu,to=g4,O4=C4,P4=M4,N4=ix;let L4=class{constructor(t){this.options=t,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,n)=>String.fromCharCode(Number.parseInt(n,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,n)=>String.fromCharCode(Number.parseInt(n,16))}},this.addExternalEntities=k4,this.parseXml=z4,this.parseTextData=F4,this.resolveNameSpace=B4,this.buildAttributesMap=G4,this.isItStopNode=j4,this.replaceEntitiesValue=W4,this.readStopNodeData=Y4,this.saveTextToParentTag=X4,this.addChild=U4,this.ignoreAttributesFn=N4(this.options.ignoreAttributes)}};function k4(i){const t=Object.keys(i);for(let e=0;e<t.length;e++){const n=t[e];this.lastEntities[n]={regex:new RegExp("&"+n+";","g"),val:i[n]}}}function F4(i,t,e,n,s,a,l){if(i!==void 0&&(this.options.trimValues&&!n&&(i=i.trim()),i.length>0)){l||(i=this.replaceEntitiesValue(i));const u=this.options.tagValueProcessor(t,i,e,s,a);return u==null?i:typeof u!=typeof i||u!==i?u:this.options.trimValues?Jc(i,this.options.parseTagValue,this.options.numberParseOptions):i.trim()===i?Jc(i,this.options.parseTagValue,this.options.numberParseOptions):i}}function B4(i){if(this.options.removeNSPrefix){const t=i.split(":"),e=i.charAt(0)==="/"?"/":"";if(t[0]==="xmlns")return"";t.length===2&&(i=e+t[1])}return i}const V4=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function G4(i,t,e){if(this.options.ignoreAttributes!==!0&&typeof i=="string"){const n=nx.getAllMatches(i,V4),s=n.length,a={};for(let l=0;l<s;l++){const u=this.resolveNameSpace(n[l][1]);if(this.ignoreAttributesFn(u,t))continue;let c=n[l][4],p=this.options.attributeNamePrefix+u;if(u.length)if(this.options.transformAttributeName&&(p=this.options.transformAttributeName(p)),p==="__proto__"&&(p="#__proto__"),c!==void 0){this.options.trimValues&&(c=c.trim()),c=this.replaceEntitiesValue(c);const y=this.options.attributeValueProcessor(u,c,t);y==null?a[p]=c:typeof y!=typeof c||y!==c?a[p]=y:a[p]=Jc(c,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(a[p]=!0)}if(!Object.keys(a).length)return;if(this.options.attributesGroupName){const l={};return l[this.options.attributesGroupName]=a,l}return a}}const z4=function(i){i=i.replace(/\r\n?/g,`
`);const t=new to("!xml");let e=t,n="",s="";for(let a=0;a<i.length;a++)if(i[a]==="<")if(i[a+1]==="/"){const u=Lr(i,">",a,"Closing Tag is not closed.");let c=i.substring(a+2,u).trim();if(this.options.removeNSPrefix){const _=c.indexOf(":");_!==-1&&(c=c.substr(_+1))}this.options.transformTagName&&(c=this.options.transformTagName(c)),e&&(n=this.saveTextToParentTag(n,e,s));const p=s.substring(s.lastIndexOf(".")+1);if(c&&this.options.unpairedTags.indexOf(c)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${c}>`);let y=0;p&&this.options.unpairedTags.indexOf(p)!==-1?(y=s.lastIndexOf(".",s.lastIndexOf(".")-1),this.tagsNodeStack.pop()):y=s.lastIndexOf("."),s=s.substring(0,y),e=this.tagsNodeStack.pop(),n="",a=u}else if(i[a+1]==="?"){let u=$c(i,a,!1,"?>");if(!u)throw new Error("Pi Tag is not closed.");if(n=this.saveTextToParentTag(n,e,s),!(this.options.ignoreDeclaration&&u.tagName==="?xml"||this.options.ignorePiTags)){const c=new to(u.tagName);c.add(this.options.textNodeName,""),u.tagName!==u.tagExp&&u.attrExpPresent&&(c[":@"]=this.buildAttributesMap(u.tagExp,s,u.tagName)),this.addChild(e,c,s)}a=u.closeIndex+1}else if(i.substr(a+1,3)==="!--"){const u=Lr(i,"-->",a+4,"Comment is not closed.");if(this.options.commentPropName){const c=i.substring(a+4,u-2);n=this.saveTextToParentTag(n,e,s),e.add(this.options.commentPropName,[{[this.options.textNodeName]:c}])}a=u}else if(i.substr(a+1,2)==="!D"){const u=O4(i,a);this.docTypeEntities=u.entities,a=u.i}else if(i.substr(a+1,2)==="!["){const u=Lr(i,"]]>",a,"CDATA is not closed.")-2,c=i.substring(a+9,u);n=this.saveTextToParentTag(n,e,s);let p=this.parseTextData(c,e.tagname,s,!0,!1,!0,!0);p==null&&(p=""),this.options.cdataPropName?e.add(this.options.cdataPropName,[{[this.options.textNodeName]:c}]):e.add(this.options.textNodeName,p),a=u+2}else{let u=$c(i,a,this.options.removeNSPrefix),c=u.tagName;const p=u.rawTagName;let y=u.tagExp,_=u.attrExpPresent,E=u.closeIndex;this.options.transformTagName&&(c=this.options.transformTagName(c)),e&&n&&e.tagname!=="!xml"&&(n=this.saveTextToParentTag(n,e,s,!1));const I=e;if(I&&this.options.unpairedTags.indexOf(I.tagname)!==-1&&(e=this.tagsNodeStack.pop(),s=s.substring(0,s.lastIndexOf("."))),c!==t.tagname&&(s+=s?"."+c:c),this.isItStopNode(this.options.stopNodes,s,c)){let S="";if(y.length>0&&y.lastIndexOf("/")===y.length-1)c[c.length-1]==="/"?(c=c.substr(0,c.length-1),s=s.substr(0,s.length-1),y=c):y=y.substr(0,y.length-1),a=u.closeIndex;else if(this.options.unpairedTags.indexOf(c)!==-1)a=u.closeIndex;else{const D=this.readStopNodeData(i,p,E+1);if(!D)throw new Error(`Unexpected end of ${p}`);a=D.i,S=D.tagContent}const R=new to(c);c!==y&&_&&(R[":@"]=this.buildAttributesMap(y,s,c)),S&&(S=this.parseTextData(S,c,s,!0,_,!0,!0)),s=s.substr(0,s.lastIndexOf(".")),R.add(this.options.textNodeName,S),this.addChild(e,R,s)}else{if(y.length>0&&y.lastIndexOf("/")===y.length-1){c[c.length-1]==="/"?(c=c.substr(0,c.length-1),s=s.substr(0,s.length-1),y=c):y=y.substr(0,y.length-1),this.options.transformTagName&&(c=this.options.transformTagName(c));const S=new to(c);c!==y&&_&&(S[":@"]=this.buildAttributesMap(y,s,c)),this.addChild(e,S,s),s=s.substr(0,s.lastIndexOf("."))}else{const S=new to(c);this.tagsNodeStack.push(e),c!==y&&_&&(S[":@"]=this.buildAttributesMap(y,s,c)),this.addChild(e,S,s),e=S}n="",a=E}}else n+=i[a];return t.child};function U4(i,t,e){const n=this.options.updateTag(t.tagname,e,t[":@"]);n===!1||(typeof n=="string"&&(t.tagname=n),i.addChild(t))}const W4=function(i){if(this.options.processEntities){for(let t in this.docTypeEntities){const e=this.docTypeEntities[t];i=i.replace(e.regx,e.val)}for(let t in this.lastEntities){const e=this.lastEntities[t];i=i.replace(e.regex,e.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const e=this.htmlEntities[t];i=i.replace(e.regex,e.val)}i=i.replace(this.ampEntity.regex,this.ampEntity.val)}return i};function X4(i,t,e,n){return i&&(n===void 0&&(n=Object.keys(t.child).length===0),i=this.parseTextData(i,t.tagname,e,!1,t[":@"]?Object.keys(t[":@"]).length!==0:!1,n),i!==void 0&&i!==""&&t.add(this.options.textNodeName,i),i=""),i}function j4(i,t,e){const n="*."+e;for(const s in i){const a=i[s];if(n===a||t===a)return!0}return!1}function H4(i,t,e=">"){let n,s="";for(let a=t;a<i.length;a++){let l=i[a];if(n)l===n&&(n="");else if(l==='"'||l==="'")n=l;else if(l===e[0])if(e[1]){if(i[a+1]===e[1])return{data:s,index:a}}else return{data:s,index:a};else l==="	"&&(l=" ");s+=l}}function Lr(i,t,e,n){const s=i.indexOf(t,e);if(s===-1)throw new Error(n);return s+t.length-1}function $c(i,t,e,n=">"){const s=H4(i,t+1,n);if(!s)return;let a=s.data;const l=s.index,u=a.search(/\s/);let c=a,p=!0;u!==-1&&(c=a.substring(0,u),a=a.substring(u+1).trimStart());const y=c;if(e){const _=c.indexOf(":");_!==-1&&(c=c.substr(_+1),p=c!==s.data.substr(_+1))}return{tagName:c,tagExp:a,closeIndex:l,attrExpPresent:p,rawTagName:y}}function Y4(i,t,e){const n=e;let s=1;for(;e<i.length;e++)if(i[e]==="<")if(i[e+1]==="/"){const a=Lr(i,">",e,`${t} is not closed`);if(i.substring(e+2,a).trim()===t&&(s--,s===0))return{tagContent:i.substring(n,e),i:a};e=a}else if(i[e+1]==="?")e=Lr(i,"?>",e+1,"StopNode is not closed.");else if(i.substr(e+1,3)==="!--")e=Lr(i,"-->",e+3,"StopNode is not closed.");else if(i.substr(e+1,2)==="![")e=Lr(i,"]]>",e,"StopNode is not closed.")-2;else{const a=$c(i,e,">");a&&((a&&a.tagName)===t&&a.tagExp[a.tagExp.length-1]!=="/"&&s++,e=a.closeIndex)}}function Jc(i,t,e){if(t&&typeof i=="string"){const n=i.trim();return n==="true"?!0:n==="false"?!1:P4(i,e)}else return nx.isExist(i)?i:""}var Z4=L4,sx={};function K4(i,t){return rx(i,t)}function rx(i,t,e){let n;const s={};for(let a=0;a<i.length;a++){const l=i[a],u=q4(l);let c="";if(e===void 0?c=u:c=e+"."+u,u===t.textNodeName)n===void 0?n=l[u]:n+=""+l[u];else{if(u===void 0)continue;if(l[u]){let p=rx(l[u],t,c);const y=J4(p,t);l[":@"]?$4(p,l[":@"],c,t):Object.keys(p).length===1&&p[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?p=p[t.textNodeName]:Object.keys(p).length===0&&(t.alwaysCreateTextNode?p[t.textNodeName]="":p=""),s[u]!==void 0&&s.hasOwnProperty(u)?(Array.isArray(s[u])||(s[u]=[s[u]]),s[u].push(p)):t.isArray(u,c,y)?s[u]=[p]:s[u]=p}}}return typeof n=="string"?n.length>0&&(s[t.textNodeName]=n):n!==void 0&&(s[t.textNodeName]=n),s}function q4(i){const t=Object.keys(i);for(let e=0;e<t.length;e++){const n=t[e];if(n!==":@")return n}}function $4(i,t,e,n){if(t){const s=Object.keys(t),a=s.length;for(let l=0;l<a;l++){const u=s[l];n.isArray(u,e+"."+u,!0,!0)?i[u]=[t[u]]:i[u]=t[u]}}}function J4(i,t){const{textNodeName:e}=t,n=Object.keys(i).length;return!!(n===0||n===1&&(i[e]||typeof i[e]=="boolean"||i[e]===0))}sx.prettify=K4;const{buildOptions:Q4}=l0,tA=Z4,{prettify:eA}=sx,iA=a0;let nA=class{constructor(t){this.externalEntities={},this.options=Q4(t)}parse(t,e){if(typeof t!="string")if(t.toString)t=t.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(e){e===!0&&(e={});const a=iA.validate(t,e);if(a!==!0)throw Error(`${a.err.msg}:${a.err.line}:${a.err.col}`)}const n=new tA(this.options);n.addExternalEntities(this.externalEntities);const s=n.parseXml(t);return this.options.preserveOrder||s===void 0?s:eA(s,this.options)}addEntity(t,e){if(e.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(t.indexOf("&")!==-1||t.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(e==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[t]=e}};var sA=nA;const rA=`
`;function aA(i,t){let e="";return t.format&&t.indentBy.length>0&&(e=rA),ax(i,t,"",e)}function ax(i,t,e,n){let s="",a=!1;for(let l=0;l<i.length;l++){const u=i[l],c=oA(u);if(c===void 0)continue;let p="";if(e.length===0?p=c:p=`${e}.${c}`,c===t.textNodeName){let S=u[c];lA(p,t)||(S=t.tagValueProcessor(c,S),S=ox(S,t)),a&&(s+=n),s+=S,a=!1;continue}else if(c===t.cdataPropName){a&&(s+=n),s+=`<![CDATA[${u[c][0][t.textNodeName]}]]>`,a=!1;continue}else if(c===t.commentPropName){s+=n+`<!--${u[c][0][t.textNodeName]}-->`,a=!0;continue}else if(c[0]==="?"){const S=_p(u[":@"],t),R=c==="?xml"?"":n;let D=u[c][0][t.textNodeName];D=D.length!==0?" "+D:"",s+=R+`<${c}${D}${S}?>`,a=!0;continue}let y=n;y!==""&&(y+=t.indentBy);const _=_p(u[":@"],t),E=n+`<${c}${_}`,I=ax(u[c],t,p,y);t.unpairedTags.indexOf(c)!==-1?t.suppressUnpairedNode?s+=E+">":s+=E+"/>":(!I||I.length===0)&&t.suppressEmptyNode?s+=E+"/>":I&&I.endsWith(">")?s+=E+`>${I}${n}</${c}>`:(s+=E+">",I&&n!==""&&(I.includes("/>")||I.includes("</"))?s+=n+t.indentBy+I+n:s+=I,s+=`</${c}>`),a=!0}return s}function oA(i){const t=Object.keys(i);for(let e=0;e<t.length;e++){const n=t[e];if(i.hasOwnProperty(n)&&n!==":@")return n}}function _p(i,t){let e="";if(i&&!t.ignoreAttributes)for(let n in i){if(!i.hasOwnProperty(n))continue;let s=t.attributeValueProcessor(n,i[n]);s=ox(s,t),s===!0&&t.suppressBooleanAttributes?e+=` ${n.substr(t.attributeNamePrefix.length)}`:e+=` ${n.substr(t.attributeNamePrefix.length)}="${s}"`}return e}function lA(i,t){i=i.substr(0,i.length-t.textNodeName.length-1);let e=i.substr(i.lastIndexOf(".")+1);for(let n in t.stopNodes)if(t.stopNodes[n]===i||t.stopNodes[n]==="*."+e)return!0;return!1}function ox(i,t){if(i&&i.length>0&&t.processEntities)for(let e=0;e<t.entities.length;e++){const n=t.entities[e];i=i.replace(n.regex,n.val)}return i}var hA=aA;const uA=hA,cA=ix,fA={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(i,t){return t},attributeValueProcessor:function(i,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function _r(i){this.options=Object.assign({},fA,i),this.options.ignoreAttributes===!0||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.ignoreAttributesFn=cA(this.options.ignoreAttributes),this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=mA),this.processTextOrObjNode=dA,this.options.format?(this.indentate=gA,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}_r.prototype.build=function(i){return this.options.preserveOrder?uA(i,this.options):(Array.isArray(i)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(i={[this.options.arrayNodeName]:i}),this.j2x(i,0,[]).val)};_r.prototype.j2x=function(i,t,e){let n="",s="";const a=e.join(".");for(let l in i)if(Object.prototype.hasOwnProperty.call(i,l))if(typeof i[l]>"u")this.isAttribute(l)&&(s+="");else if(i[l]===null)this.isAttribute(l)?s+="":l[0]==="?"?s+=this.indentate(t)+"<"+l+"?"+this.tagEndChar:s+=this.indentate(t)+"<"+l+"/"+this.tagEndChar;else if(i[l]instanceof Date)s+=this.buildTextValNode(i[l],l,"",t);else if(typeof i[l]!="object"){const u=this.isAttribute(l);if(u&&!this.ignoreAttributesFn(u,a))n+=this.buildAttrPairStr(u,""+i[l]);else if(!u)if(l===this.options.textNodeName){let c=this.options.tagValueProcessor(l,""+i[l]);s+=this.replaceEntitiesValue(c)}else s+=this.buildTextValNode(i[l],l,"",t)}else if(Array.isArray(i[l])){const u=i[l].length;let c="",p="";for(let y=0;y<u;y++){const _=i[l][y];if(!(typeof _>"u"))if(_===null)l[0]==="?"?s+=this.indentate(t)+"<"+l+"?"+this.tagEndChar:s+=this.indentate(t)+"<"+l+"/"+this.tagEndChar;else if(typeof _=="object")if(this.options.oneListGroup){const E=this.j2x(_,t+1,e.concat(l));c+=E.val,this.options.attributesGroupName&&_.hasOwnProperty(this.options.attributesGroupName)&&(p+=E.attrStr)}else c+=this.processTextOrObjNode(_,l,t,e);else if(this.options.oneListGroup){let E=this.options.tagValueProcessor(l,_);E=this.replaceEntitiesValue(E),c+=E}else c+=this.buildTextValNode(_,l,"",t)}this.options.oneListGroup&&(c=this.buildObjectNode(c,l,p,t)),s+=c}else if(this.options.attributesGroupName&&l===this.options.attributesGroupName){const u=Object.keys(i[l]),c=u.length;for(let p=0;p<c;p++)n+=this.buildAttrPairStr(u[p],""+i[l][u[p]])}else s+=this.processTextOrObjNode(i[l],l,t,e);return{attrStr:n,val:s}};_r.prototype.buildAttrPairStr=function(i,t){return t=this.options.attributeValueProcessor(i,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&t==="true"?" "+i:" "+i+'="'+t+'"'};function dA(i,t,e,n){const s=this.j2x(i,e+1,n.concat(t));return i[this.options.textNodeName]!==void 0&&Object.keys(i).length===1?this.buildTextValNode(i[this.options.textNodeName],t,s.attrStr,e):this.buildObjectNode(s.val,t,s.attrStr,e)}_r.prototype.buildObjectNode=function(i,t,e,n){if(i==="")return t[0]==="?"?this.indentate(n)+"<"+t+e+"?"+this.tagEndChar:this.indentate(n)+"<"+t+e+this.closeTag(t)+this.tagEndChar;{let s="</"+t+this.tagEndChar,a="";return t[0]==="?"&&(a="?",s=""),(e||e==="")&&i.indexOf("<")===-1?this.indentate(n)+"<"+t+e+a+">"+i+s:this.options.commentPropName!==!1&&t===this.options.commentPropName&&a.length===0?this.indentate(n)+`<!--${i}-->`+this.newLine:this.indentate(n)+"<"+t+e+a+this.tagEndChar+i+this.indentate(n)+s}};_r.prototype.closeTag=function(i){let t="";return this.options.unpairedTags.indexOf(i)!==-1?this.options.suppressUnpairedNode||(t="/"):this.options.suppressEmptyNode?t="/":t=`></${i}`,t};_r.prototype.buildTextValNode=function(i,t,e,n){if(this.options.cdataPropName!==!1&&t===this.options.cdataPropName)return this.indentate(n)+`<![CDATA[${i}]]>`+this.newLine;if(this.options.commentPropName!==!1&&t===this.options.commentPropName)return this.indentate(n)+`<!--${i}-->`+this.newLine;if(t[0]==="?")return this.indentate(n)+"<"+t+e+"?"+this.tagEndChar;{let s=this.options.tagValueProcessor(t,i);return s=this.replaceEntitiesValue(s),s===""?this.indentate(n)+"<"+t+e+this.closeTag(t)+this.tagEndChar:this.indentate(n)+"<"+t+e+">"+s+"</"+t+this.tagEndChar}};_r.prototype.replaceEntitiesValue=function(i){if(i&&i.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const e=this.options.entities[t];i=i.replace(e.regex,e.val)}return i};function gA(i){return this.options.indentBy.repeat(i)}function mA(i){return i.startsWith(this.options.attributeNamePrefix)&&i!==this.options.textNodeName?i.substr(this.attrPrefixLen):!1}var pA=_r;const yA=a0,xA=sA,_A=pA;var lx={XMLParser:xA,XMLValidator:yA,XMLBuilder:_A};const wA={textNodeName:"_text",attributeNamePrefix:"",ignoreAttributes:!1,attributesGroupName:"_attributes",parseTagValue:!1,parseAttributeValue:!1,isArray:(i,t,e,n)=>!n,attributeValueProcessor:(i,t)=>t.replace(/&amp;/g,"&").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")},bA={textNodeName:"_text",attributeNamePrefix:"",ignoreAttributes:!1,attributesGroupName:"_attributes",format:!0,attributeValueProcessor:(i,t)=>t.replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};function h0(i){return`<?xml version="1.0" encoding="UTF-8"?>
${new lx.XMLBuilder(bA).build(i)}`}function Uo(i){return new lx.XMLParser(wA).parse(i)}var EA=function(i,t,e,n){function s(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function u(y){try{p(n.next(y))}catch(_){l(_)}}function c(y){try{p(n.throw(y))}catch(_){l(_)}}function p(y){y.done?a(y.value):s(y.value).then(u,c)}p((n=n.apply(i,t||[])).next())})};class va extends zo{constructor(t,e){super(t,e),this.tag=_t.ISO11783LinkListFile}static fromXML(t,e,n){var s,a;return EA(this,void 0,void 0,function*(){const l=yield zo.fromXML(t,e,n,va),u=(s=l.attributes.LinkGroup)===null||s===void 0?void 0:s.find(c=>c.attributes.LinkGroupType===wh.UniqueResolvableURIs&&c.attributes.LinkGroupNamespace===e.options.fmisURI);return(a=u?.attributes.Link)===null||a===void 0||a.forEach(c=>{e.registerEntity(null,c.attributes.ObjectIdRef.xmlId,c.attributes.LinkValue)}),l})}toXML(){if(this.attributes.LinkGroup=[],this.isoxmlManager.options.fmisURI){const t=Object.values(this.isoxmlManager.xmlReferences).filter(n=>n.fmisId).map(n=>new eu({ObjectIdRef:n,LinkValue:n.fmisId},this.isoxmlManager)),e=this.isoxmlManager.createEntityFromAttributes(_t.LinkGroup,{LinkGroupType:wh.UniqueResolvableURIs,LinkGroupNamespace:this.isoxmlManager.options.fmisURI,Link:t});this.isoxmlManager.registerEntity(e),this.attributes.LinkGroup=[e]}return super.toXML()}static fromISOXMLManager(t){const e=t.options.version;return new va({VersionMajor:e===4?"4":"3",VersionMinor:e===4?"2":"3",ManagementSoftwareManufacturer:t.options.fmisTitle,ManagementSoftwareVersion:t.options.fmisVersion,DataTransferOrigin:qc.FMIS},t)}}$t("main",_t.ISO11783LinkListFile,va);var IA=function(i,t,e,n){function s(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function u(y){try{p(n.next(y))}catch(_){l(_)}}function c(y){try{p(n.throw(y))}catch(_){l(_)}}function p(y){y.done?a(y.value):s(y.value).then(u,c)}p((n=n.apply(i,t||[])).next())})};class Wo extends Vo{constructor(t,e){super(t,e),this.tag=_t.AttachedFile}static fromXML(t,e,n){return IA(this,void 0,void 0,function*(){const s=yield Vo.fromXML(t,e,n,Wo),a=s.attributes.FilenameWithExtension;if(a.toUpperCase()!==a&&e.addWarning(`[${n}] Name of attached file must be uppercase (real name: ${a})`),s.attributes.FileType===1){const l=yield e.getParsedFile(a,!1);let u;try{u=Uo(l)}catch{throw new Error("Failed to parse LinkList file")}yield va.fromXML(u[_t.ISO11783LinkListFile][0],e,"LINKLIST")}else s.fileData=yield e.getParsedFile(a,!0);return s})}toXML(){if(this.attributes.FileType===1){const t=va.fromISOXMLManager(this.isoxmlManager),e={[_t.ISO11783LinkListFile]:t.toXML()},n=h0(e);this.isoxmlManager.addFileToSave(n,this.attributes.FilenameWithExtension)}else this.isoxmlManager.addFileToSave(this.fileData,this.attributes.FilenameWithExtension);return super.toXML()}static linkListFromISOXMLManager(t){return new Wo({FilenameWithExtension:"LINKLIST.XML",Preserve:Zc.PreserveOnTaskControllerAndSendBackToFMIS,FileType:1,ManufacturerGLN:""},t)}}$t("main",_t.AttachedFile,Wo);var mn=63710088e-1,CA={centimeters:mn*100,centimetres:mn*100,degrees:mn/111325,feet:mn*3.28084,inches:mn*39.37,kilometers:mn/1e3,kilometres:mn/1e3,meters:mn,metres:mn,miles:mn/1609.344,millimeters:mn*1e3,millimetres:mn*1e3,nauticalmiles:mn/1852,radians:1,yards:mn*1.0936};function AA(i,t){t===void 0&&(t="kilometers");var e=CA[t];if(!e)throw new Error(t+" units is invalid");return i/e}function wp(i,t){return RA(AA(i,t))}function RA(i){var t=i%(2*Math.PI);return t*180/Math.PI}function SA(i){var t=i%360;return t*Math.PI/180}function hx(i,t,e){if(i!==null)for(var n,s,a,l,u,c,p,y=0,_=0,E,I=i.type,S=I==="FeatureCollection",R=I==="Feature",D=S?i.features.length:1,T=0;T<D;T++){p=S?i.features[T].geometry:R?i.geometry:i,E=p?p.type==="GeometryCollection":!1,u=E?p.geometries.length:1;for(var v=0;v<u;v++){var k=0,X=0;if(l=E?p.geometries[v]:p,l!==null){c=l.coordinates;var H=l.type;switch(y=e&&(H==="Polygon"||H==="MultiPolygon")?1:0,H){case null:break;case"Point":if(t(c,_,T,k,X)===!1)return!1;_++,k++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(t(c[n],_,T,k,X)===!1)return!1;_++,H==="MultiPoint"&&k++}H==="LineString"&&k++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(s=0;s<c[n].length-y;s++){if(t(c[n][s],_,T,k,X)===!1)return!1;_++}H==="MultiLineString"&&k++,H==="Polygon"&&X++}H==="Polygon"&&k++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(X=0,s=0;s<c[n].length;s++){for(a=0;a<c[n][s].length-y;a++){if(t(c[n][s][a],_,T,k,X)===!1)return!1;_++}X++}k++}break;case"GeometryCollection":for(n=0;n<l.geometries.length;n++)if(hx(l.geometries[n],t,e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function TA(i,t){var e,n,s,a,l,u,c,p,y,_,E=0,I=i.type==="FeatureCollection",S=i.type==="Feature",R=I?i.features.length:1;for(e=0;e<R;e++){for(u=I?i.features[e].geometry:S?i.geometry:i,p=I?i.features[e].properties:S?i.properties:{},y=I?i.features[e].bbox:S?i.bbox:void 0,_=I?i.features[e].id:S?i.id:void 0,c=u?u.type==="GeometryCollection":!1,l=c?u.geometries.length:1,s=0;s<l;s++){if(a=c?u.geometries[s]:u,a===null){if(t(null,E,p,y,_)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,E,p,y,_)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(t(a.geometries[n],E,p,y,_)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function DA(i,t,e){var n=e;return TA(i,function(s,a,l,u,c){a===0&&e===void 0?n=s:n=t(n,s,a,l,u,c)}),n}function Xo(i){var t=[1/0,1/0,-1/0,-1/0];return hx(i,function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])}),t}Xo.default=Xo;var bp=6378137;function Qc(i){return DA(i,function(t,e){return t+MA(e)},0)}function MA(i){var t=0,e;switch(i.type){case"Polygon":return Ep(i.coordinates);case"MultiPolygon":for(e=0;e<i.coordinates.length;e++)t+=Ep(i.coordinates[e]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function Ep(i){var t=0;if(i&&i.length>0){t+=Math.abs(Ip(i[0]));for(var e=1;e<i.length;e++)t-=Math.abs(Ip(i[e]))}return t}function Ip(i){var t,e,n,s,a,l,u,c=0,p=i.length;if(p>2){for(u=0;u<p;u++)u===p-2?(s=p-2,a=p-1,l=0):u===p-1?(s=p-1,a=0,l=1):(s=u,a=u+1,l=u+2),t=i[s],e=i[a],n=i[l],c+=(qu(n[0])-qu(t[0]))*Math.sin(qu(e[1]));c=c*bp*bp/2}return c}function qu(i){return i*Math.PI/180}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function vA(i,t){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,s,a,l;return l={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function u(p){return function(y){return c([p,y])}}function c(p){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,s&&(a=p[0]&2?s.return:p[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,p[1])).done)return a;switch(s=0,a&&(p=[p[0]&2,a.value]),p[0]){case 0:case 1:a=p;break;case 4:return e.label++,{value:p[1],done:!1};case 5:e.label++,s=p[1],p=[0];continue;case 7:p=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(p[0]===6||p[0]===2)){e=0;continue}if(p[0]===3&&(!a||p[1]>a[0]&&p[1]<a[3])){e.label=p[1];break}if(p[0]===6&&e.label<a[1]){e.label=a[1],a=p;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(p);break}a[2]&&e.ops.pop(),e.trys.pop();continue}p=t.call(i,e)}catch(y){p=[6,y],s=0}finally{n=a=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}var pr=function(){function i(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}return i}();function OA(i,t){return i>t?1:i<t?-1:0}function rr(i,t,e){for(var n=new pr(null,null),s=n,a=n;;){var l=e(i,t.key);if(l<0){if(t.left===null)break;if(e(i,t.left.key)<0){var u=t.left;if(t.left=u.right,u.right=t,t=u,t.left===null)break}a.left=t,a=t,t=t.left}else if(l>0){if(t.right===null)break;if(e(i,t.right.key)>0){var u=t.right;if(t.right=u.left,u.left=t,t=u,t.right===null)break}s.right=t,s=t,t=t.right}else break}return s.right=t.left,a.left=t.right,t.left=n.right,t.right=n.left,t}function $u(i,t,e,n){var s=new pr(i,t);if(e===null)return s.left=s.right=null,s;e=rr(i,e,n);var a=n(i,e.key);return a<0?(s.left=e.left,s.right=e,e.left=null):a>=0&&(s.right=e.right,s.left=e,e.right=null),s}function Cp(i,t,e){var n=null,s=null;if(t){t=rr(i,t,e);var a=e(t.key,i);a===0?(n=t.left,s=t.right):a<0?(s=t.right,t.right=null,n=t):(n=t.left,t.left=null,s=t)}return{left:n,right:s}}function PA(i,t,e){return t===null?i:(i===null||(t=rr(i.key,t,e),t.left=i),t)}function tf(i,t,e,n,s){if(i){n(""+t+(e?"└── ":"├── ")+s(i)+`
`);var a=t+(e?"    ":"│   ");i.left&&tf(i.left,a,!1,n,s),i.right&&tf(i.right,a,!0,n,s)}}var u0=function(){function i(t){t===void 0&&(t=OA),this._root=null,this._size=0,this._comparator=t}return i.prototype.insert=function(t,e){return this._size++,this._root=$u(t,e,this._root,this._comparator)},i.prototype.add=function(t,e){var n=new pr(t,e);this._root===null&&(n.left=n.right=null,this._size++,this._root=n);var s=this._comparator,a=rr(t,this._root,s),l=s(t,a.key);return l===0?this._root=a:(l<0?(n.left=a.left,n.right=a,a.left=null):l>0&&(n.right=a.right,n.left=a,a.right=null),this._size++,this._root=n),this._root},i.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},i.prototype._remove=function(t,e,n){var s;if(e===null)return null;e=rr(t,e,n);var a=n(t,e.key);return a===0?(e.left===null?s=e.right:(s=rr(t,e.left,n),s.right=e.right),this._size--,s):e},i.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=rr(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},i.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var s=n(t,e.key);if(s===0)return e;s<0?e=e.left:e=e.right}return null},i.prototype.find=function(t){return this._root&&(this._root=rr(t,this._root,this._comparator),this._comparator(t,this._root.key)!==0)?null:this._root},i.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var s=n(t,e.key);if(s===0)return!0;s<0?e=e.left:e=e.right}return!1},i.prototype.forEach=function(t,e){for(var n=this._root,s=[],a=!1;!a;)n!==null?(s.push(n),n=n.left):s.length!==0?(n=s.pop(),t.call(e,n),n=n.right):a=!0;return this},i.prototype.range=function(t,e,n,s){for(var a=[],l=this._comparator,u=this._root,c;a.length!==0||u;)if(u)a.push(u),u=u.left;else{if(u=a.pop(),c=l(u.key,e),c>0)break;if(l(u.key,t)>=0&&n.call(s,u))return this;u=u.right}return this},i.prototype.keys=function(){var t=[];return this.forEach(function(e){var n=e.key;return t.push(n)}),t},i.prototype.values=function(){var t=[];return this.forEach(function(e){var n=e.data;return t.push(n)}),t},i.prototype.min=function(){return this._root?this.minNode(this._root).key:null},i.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},i.prototype.minNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.left;)t=t.left;return t},i.prototype.maxNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.right;)t=t.right;return t},i.prototype.at=function(t){for(var e=this._root,n=!1,s=0,a=[];!n;)if(e)a.push(e),e=e.left;else if(a.length>0){if(e=a.pop(),s===t)return e;s++,e=e.right}else n=!0;return null},i.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var s=this._comparator;e;){var a=s(t.key,e.key);if(a===0)break;a<0?(n=e,e=e.left):e=e.right}return n},i.prototype.prev=function(t){var e=this._root,n=null;if(t.left!==null){for(n=t.left;n.right;)n=n.right;return n}for(var s=this._comparator;e;){var a=s(t.key,e.key);if(a===0)break;a<0?e=e.left:(n=e,e=e.right)}return n},i.prototype.clear=function(){return this._root=null,this._size=0,this},i.prototype.toList=function(){return LA(this._root)},i.prototype.load=function(t,e,n){e===void 0&&(e=[]),n===void 0&&(n=!1);var s=t.length,a=this._comparator;if(n&&sf(t,e,0,s-1,a),this._root===null)this._root=ef(t,e,0,s),this._size=s;else{var l=kA(this.toList(),NA(t,e),a);s=this._size+s,this._root=nf({head:l},0,s)}return this},i.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(i.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),i.prototype.toString=function(t){t===void 0&&(t=function(n){return String(n.key)});var e=[];return tf(this._root,"",!0,function(n){return e.push(n)},t),e.join("")},i.prototype.update=function(t,e,n){var s=this._comparator,a=Cp(t,this._root,s),l=a.left,u=a.right;s(t,e)<0?u=$u(e,n,u,s):l=$u(e,n,l,s),this._root=PA(l,u,s)},i.prototype.split=function(t){return Cp(t,this._root,this._comparator)},i.prototype[Symbol.iterator]=function(){var t,e,n;return vA(this,function(s){switch(s.label){case 0:t=this._root,e=[],n=!1,s.label=1;case 1:return n?[3,6]:t===null?[3,2]:(e.push(t),t=t.left,[3,5]);case 2:return e.length===0?[3,4]:(t=e.pop(),[4,t]);case 3:return s.sent(),t=t.right,[3,5];case 4:n=!0,s.label=5;case 5:return[3,1];case 6:return[2]}})},i}();function ef(i,t,e,n){var s=n-e;if(s>0){var a=e+Math.floor(s/2),l=i[a],u=t[a],c=new pr(l,u);return c.left=ef(i,t,e,a),c.right=ef(i,t,a+1,n),c}return null}function NA(i,t){for(var e=new pr(null,null),n=e,s=0;s<i.length;s++)n=n.next=new pr(i[s],t[s]);return n.next=null,e.next}function LA(i){for(var t=i,e=[],n=!1,s=new pr(null,null),a=s;!n;)t?(e.push(t),t=t.left):e.length>0?(t=a=a.next=e.pop(),t=t.right):n=!0;return a.next=null,s.next}function nf(i,t,e){var n=e-t;if(n>0){var s=t+Math.floor(n/2),a=nf(i,t,s),l=i.head;return l.left=a,i.head=i.head.next,l.right=nf(i,s+1,e),l}return null}function kA(i,t,e){for(var n=new pr(null,null),s=n,a=i,l=t;a!==null&&l!==null;)e(a.key,l.key)<0?(s.next=a,a=a.next):(s.next=l,l=l.next),s=s.next;return a!==null?s.next=a:l!==null&&(s.next=l),n.next}function sf(i,t,e,n,s){if(!(e>=n)){for(var a=i[e+n>>1],l=e-1,u=n+1;;){do l++;while(s(i[l],a)<0);do u--;while(s(i[u],a)>0);if(l>=u)break;var c=i[l];i[l]=i[u],i[u]=c,c=t[l],t[l]=t[u],t[u]=c}sf(i,t,e,u,s),sf(i,t,u+1,n,s)}}const Vs=11102230246251565e-32,Ji=134217729,FA=(3+8*Vs)*Vs;function Ju(i,t,e,n,s){let a,l,u,c,p=t[0],y=n[0],_=0,E=0;y>p==y>-p?(a=p,p=t[++_]):(a=y,y=n[++E]);let I=0;if(_<i&&E<e)for(y>p==y>-p?(l=p+a,u=a-(l-p),p=t[++_]):(l=y+a,u=a-(l-y),y=n[++E]),a=l,u!==0&&(s[I++]=u);_<i&&E<e;)y>p==y>-p?(l=a+p,c=l-a,u=a-(l-c)+(p-c),p=t[++_]):(l=a+y,c=l-a,u=a-(l-c)+(y-c),y=n[++E]),a=l,u!==0&&(s[I++]=u);for(;_<i;)l=a+p,c=l-a,u=a-(l-c)+(p-c),p=t[++_],a=l,u!==0&&(s[I++]=u);for(;E<e;)l=a+y,c=l-a,u=a-(l-c)+(y-c),y=n[++E],a=l,u!==0&&(s[I++]=u);return(a!==0||I===0)&&(s[I++]=a),I}function BA(i,t){let e=t[0];for(let n=1;n<i;n++)e+=t[n];return e}function dl(i){return new Float64Array(i)}const VA=(3+16*Vs)*Vs,GA=(2+12*Vs)*Vs,zA=(9+64*Vs)*Vs*Vs,oa=dl(4),Ap=dl(8),Rp=dl(12),Sp=dl(16),on=dl(4);function UA(i,t,e,n,s,a,l){let u,c,p,y,_,E,I,S,R,D,T,v,k,X,H,K,z,q;const V=i-s,nt=e-s,ot=t-a,j=n-a;X=V*j,E=Ji*V,I=E-(E-V),S=V-I,E=Ji*j,R=E-(E-j),D=j-R,H=S*D-(X-I*R-S*R-I*D),K=ot*nt,E=Ji*ot,I=E-(E-ot),S=ot-I,E=Ji*nt,R=E-(E-nt),D=nt-R,z=S*D-(K-I*R-S*R-I*D),T=H-z,_=H-T,oa[0]=H-(T+_)+(_-z),v=X+T,_=v-X,k=X-(v-_)+(T-_),T=k-K,_=k-T,oa[1]=k-(T+_)+(_-K),q=v+T,_=q-v,oa[2]=v-(q-_)+(T-_),oa[3]=q;let tt=BA(4,oa),N=GA*l;if(tt>=N||-tt>=N||(_=i-V,u=i-(V+_)+(_-s),_=e-nt,p=e-(nt+_)+(_-s),_=t-ot,c=t-(ot+_)+(_-a),_=n-j,y=n-(j+_)+(_-a),u===0&&c===0&&p===0&&y===0)||(N=zA*l+FA*Math.abs(tt),tt+=V*y+j*u-(ot*p+nt*c),tt>=N||-tt>=N))return tt;X=u*j,E=Ji*u,I=E-(E-u),S=u-I,E=Ji*j,R=E-(E-j),D=j-R,H=S*D-(X-I*R-S*R-I*D),K=c*nt,E=Ji*c,I=E-(E-c),S=c-I,E=Ji*nt,R=E-(E-nt),D=nt-R,z=S*D-(K-I*R-S*R-I*D),T=H-z,_=H-T,on[0]=H-(T+_)+(_-z),v=X+T,_=v-X,k=X-(v-_)+(T-_),T=k-K,_=k-T,on[1]=k-(T+_)+(_-K),q=v+T,_=q-v,on[2]=v-(q-_)+(T-_),on[3]=q;const Z=Ju(4,oa,4,on,Ap);X=V*y,E=Ji*V,I=E-(E-V),S=V-I,E=Ji*y,R=E-(E-y),D=y-R,H=S*D-(X-I*R-S*R-I*D),K=ot*p,E=Ji*ot,I=E-(E-ot),S=ot-I,E=Ji*p,R=E-(E-p),D=p-R,z=S*D-(K-I*R-S*R-I*D),T=H-z,_=H-T,on[0]=H-(T+_)+(_-z),v=X+T,_=v-X,k=X-(v-_)+(T-_),T=k-K,_=k-T,on[1]=k-(T+_)+(_-K),q=v+T,_=q-v,on[2]=v-(q-_)+(T-_),on[3]=q;const ft=Ju(Z,Ap,4,on,Rp);X=u*y,E=Ji*u,I=E-(E-u),S=u-I,E=Ji*y,R=E-(E-y),D=y-R,H=S*D-(X-I*R-S*R-I*D),K=c*p,E=Ji*c,I=E-(E-c),S=c-I,E=Ji*p,R=E-(E-p),D=p-R,z=S*D-(K-I*R-S*R-I*D),T=H-z,_=H-T,on[0]=H-(T+_)+(_-z),v=X+T,_=v-X,k=X-(v-_)+(T-_),T=k-K,_=k-T,on[1]=k-(T+_)+(_-K),q=v+T,_=q-v,on[2]=v-(q-_)+(T-_),on[3]=q;const rt=Ju(ft,Rp,4,on,Sp);return Sp[rt-1]}function WA(i,t,e,n,s,a){const l=(t-a)*(e-s),u=(i-s)*(n-a),c=l-u,p=Math.abs(l+u);return Math.abs(c)>=VA*p?c:-UA(i,t,e,n,s,a,p)}var ux={};const eo=(i,t)=>i.ll.x<=t.x&&t.x<=i.ur.x&&i.ll.y<=t.y&&t.y<=i.ur.y,rf=(i,t)=>{if(t.ur.x<i.ll.x||i.ur.x<t.ll.x||t.ur.y<i.ll.y||i.ur.y<t.ll.y)return null;const e=i.ll.x<t.ll.x?t.ll.x:i.ll.x,n=i.ur.x<t.ur.x?i.ur.x:t.ur.x,s=i.ll.y<t.ll.y?t.ll.y:i.ll.y,a=i.ur.y<t.ur.y?i.ur.y:t.ur.y;return{ll:{x:e,y:s},ur:{x:n,y:a}}};let cr=Number.EPSILON;cr===void 0&&(cr=Math.pow(2,-52));const XA=cr*cr,Tp=(i,t)=>{if(-cr<i&&i<cr&&-cr<t&&t<cr)return 0;const e=i-t;return e*e<XA*i*t?0:i<t?-1:1};class jA{constructor(){this.reset()}reset(){this.xRounder=new Dp,this.yRounder=new Dp}round(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}class Dp{constructor(){this.tree=new u0,this.round(0)}round(t){const e=this.tree.add(t),n=this.tree.prev(e);if(n!==null&&Tp(e.key,n.key)===0)return this.tree.remove(t),n.key;const s=this.tree.next(e);return s!==null&&Tp(e.key,s.key)===0?(this.tree.remove(t),s.key):t}}const jo=new jA,ql=(i,t)=>i.x*t.y-i.y*t.x,cx=(i,t)=>i.x*t.x+i.y*t.y,Mp=(i,t,e)=>{const n=WA(i.x,i.y,t.x,t.y,e.x,e.y);return n>0?-1:n<0?1:0},bh=i=>Math.sqrt(cx(i,i)),HA=(i,t,e)=>{const n={x:t.x-i.x,y:t.y-i.y},s={x:e.x-i.x,y:e.y-i.y};return ql(s,n)/bh(s)/bh(n)},YA=(i,t,e)=>{const n={x:t.x-i.x,y:t.y-i.y},s={x:e.x-i.x,y:e.y-i.y};return cx(s,n)/bh(s)/bh(n)},vp=(i,t,e)=>t.y===0?null:{x:i.x+t.x/t.y*(e-i.y),y:e},Op=(i,t,e)=>t.x===0?null:{x:e,y:i.y+t.y/t.x*(e-i.x)},ZA=(i,t,e,n)=>{if(t.x===0)return Op(e,n,i.x);if(n.x===0)return Op(i,t,e.x);if(t.y===0)return vp(e,n,i.y);if(n.y===0)return vp(i,t,e.y);const s=ql(t,n);if(s==0)return null;const a={x:e.x-i.x,y:e.y-i.y},l=ql(a,t)/s,u=ql(a,n)/s,c=i.x+u*t.x,p=e.x+l*n.x,y=i.y+u*t.y,_=e.y+l*n.y,E=(c+p)/2,I=(y+_)/2;return{x:E,y:I}};class Vn{static compare(t,e){const n=Vn.comparePoints(t.point,e.point);return n!==0?n:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:dr.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}constructor(t,e){t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let n=0,s=e.length;n<s;n++){const a=e[n];this.point.events.push(a),a.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const n=this.point.events[e];if(n.segment.consumedBy===void 0)for(let s=e+1;s<t;s++){const a=this.point.events[s];a.consumedBy===void 0&&n.otherSE.point.events===a.otherSE.point.events&&n.segment.consume(a.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,n=this.point.events.length;e<n;e++){const s=this.point.events[e];s!==this&&!s.segment.ringOut&&s.segment.isInResult()&&t.push(s)}return t}getLeftmostComparator(t){const e=new Map,n=s=>{const a=s.otherSE;e.set(s,{sine:HA(this.point,t.point,a.point),cosine:YA(this.point,t.point,a.point)})};return(s,a)=>{e.has(s)||n(s),e.has(a)||n(a);const{sine:l,cosine:u}=e.get(s),{sine:c,cosine:p}=e.get(a);return l>=0&&c>=0?u<p?1:u>p?-1:0:l<0&&c<0?u<p?-1:u>p?1:0:c<l?-1:c>l?1:0}}}let KA=0;class dr{static compare(t,e){const n=t.leftSE.point.x,s=e.leftSE.point.x,a=t.rightSE.point.x,l=e.rightSE.point.x;if(l<n)return 1;if(a<s)return-1;const u=t.leftSE.point.y,c=e.leftSE.point.y,p=t.rightSE.point.y,y=e.rightSE.point.y;if(n<s){if(c<u&&c<p)return 1;if(c>u&&c>p)return-1;const _=t.comparePoint(e.leftSE.point);if(_<0)return 1;if(_>0)return-1;const E=e.comparePoint(t.rightSE.point);return E!==0?E:-1}if(n>s){if(u<c&&u<y)return-1;if(u>c&&u>y)return 1;const _=e.comparePoint(t.leftSE.point);if(_!==0)return _;const E=t.comparePoint(e.rightSE.point);return E<0?1:E>0?-1:1}if(u<c)return-1;if(u>c)return 1;if(a<l){const _=e.comparePoint(t.rightSE.point);if(_!==0)return _}if(a>l){const _=t.comparePoint(e.rightSE.point);if(_<0)return 1;if(_>0)return-1}if(a!==l){const _=p-u,E=a-n,I=y-c,S=l-s;if(_>E&&I<S)return 1;if(_<E&&I>S)return-1}return a>l?1:a<l||p<y?-1:p>y?1:t.id<e.id?-1:t.id>e.id?1:0}constructor(t,e,n,s){this.id=++KA,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=n,this.windings=s}static fromRing(t,e,n){let s,a,l;const u=Vn.comparePoints(t,e);if(u<0)s=t,a=e,l=1;else if(u>0)s=e,a=t,l=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const c=new Vn(s,!0),p=new Vn(a,!1);return new dr(c,p,[n],[l])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;const e=this.leftSE.point,n=this.rightSE.point,s=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;const a=(t.y-e.y)/s.y,l=e.x+a*s.x;if(t.x===l)return 0;const u=(t.x-e.x)/s.x,c=e.y+u*s.y;return t.y===c?0:t.y<c?-1:1}getIntersection(t){const e=this.bbox(),n=t.bbox(),s=rf(e,n);if(s===null)return null;const a=this.leftSE.point,l=this.rightSE.point,u=t.leftSE.point,c=t.rightSE.point,p=eo(e,u)&&this.comparePoint(u)===0,y=eo(n,a)&&t.comparePoint(a)===0,_=eo(e,c)&&this.comparePoint(c)===0,E=eo(n,l)&&t.comparePoint(l)===0;if(y&&p)return E&&!_?l:!E&&_?c:null;if(y)return _&&a.x===c.x&&a.y===c.y?null:a;if(p)return E&&l.x===u.x&&l.y===u.y?null:u;if(E&&_)return null;if(E)return l;if(_)return c;const I=ZA(a,this.vector(),u,t.vector());return I===null||!eo(s,I)?null:jo.round(I.x,I.y)}split(t){const e=[],n=t.events!==void 0,s=new Vn(t,!0),a=new Vn(t,!1),l=this.rightSE;this.replaceRightSE(a),e.push(a),e.push(s);const u=new dr(s,l,this.rings.slice(),this.windings.slice());return Vn.comparePoints(u.leftSE.point,u.rightSE.point)>0&&u.swapEvents(),Vn.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(s.checkForConsuming(),a.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}consume(t){let e=this,n=t;for(;e.consumedBy;)e=e.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const s=dr.compare(e,n);if(s!==0){if(s>0){const a=e;e=n,n=a}if(e.prev===n){const a=e;e=n,n=a}for(let a=0,l=n.rings.length;a<l;a++){const u=n.rings[a],c=n.windings[a],p=e.rings.indexOf(u);p===-1?(e.rings.push(u),e.windings.push(c)):e.windings[p]+=c}n.rings=null,n.windings=null,n.consumedBy=e,n.leftSE.consumedBy=e.leftSE,n.rightSE.consumedBy=e.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,n=this._afterState.windings,s=this._afterState.multiPolys;for(let u=0,c=this.rings.length;u<c;u++){const p=this.rings[u],y=this.windings[u],_=e.indexOf(p);_===-1?(e.push(p),n.push(y)):n[_]+=y}const a=[],l=[];for(let u=0,c=e.length;u<c;u++){if(n[u]===0)continue;const p=e[u],y=p.poly;if(l.indexOf(y)===-1)if(p.isExterior)a.push(y);else{l.indexOf(y)===-1&&l.push(y);const _=a.indexOf(p.poly);_!==-1&&a.splice(_,1)}}for(let u=0,c=a.length;u<c;u++){const p=a[u].multiPoly;s.indexOf(p)===-1&&s.push(p)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(qn.type){case"union":{const n=t.length===0,s=e.length===0;this._isInResult=n!==s;break}case"intersection":{let n,s;t.length<e.length?(n=t.length,s=e.length):(n=e.length,s=t.length),this._isInResult=s===qn.numMultiPolys&&n<s;break}case"xor":{const n=Math.abs(t.length-e.length);this._isInResult=n%2===1;break}case"difference":{const n=s=>s.length===1&&s[0].isSubject;this._isInResult=n(t)!==n(e);break}default:throw new Error(`Unrecognized operation type found ${qn.type}`)}return this._isInResult}}class Pp{constructor(t,e,n){if(!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=n,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const s=jo.round(t[0][0],t[0][1]);this.bbox={ll:{x:s.x,y:s.y},ur:{x:s.x,y:s.y}};let a=s;for(let l=1,u=t.length;l<u;l++){if(typeof t[l][0]!="number"||typeof t[l][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let c=jo.round(t[l][0],t[l][1]);c.x===a.x&&c.y===a.y||(this.segments.push(dr.fromRing(a,c,this)),c.x<this.bbox.ll.x&&(this.bbox.ll.x=c.x),c.y<this.bbox.ll.y&&(this.bbox.ll.y=c.y),c.x>this.bbox.ur.x&&(this.bbox.ur.x=c.x),c.y>this.bbox.ur.y&&(this.bbox.ur.y=c.y),a=c)}(s.x!==a.x||s.y!==a.y)&&this.segments.push(dr.fromRing(a,s,this))}getSweepEvents(){const t=[];for(let e=0,n=this.segments.length;e<n;e++){const s=this.segments[e];t.push(s.leftSE),t.push(s.rightSE)}return t}}class qA{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Pp(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,s=t.length;n<s;n++){const a=new Pp(t[n],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=e}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let e=0,n=this.interiorRings.length;e<n;e++){const s=this.interiorRings[e].getSweepEvents();for(let a=0,l=s.length;a<l;a++)t.push(s[a])}return t}}class Np{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let n=0,s=t.length;n<s;n++){const a=new qA(t[n],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=e}getSweepEvents(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const s=this.polys[e].getSweepEvents();for(let a=0,l=s.length;a<l;a++)t.push(s[a])}return t}}class Eh{static factory(t){const e=[];for(let n=0,s=t.length;n<s;n++){const a=t[n];if(!a.isInResult()||a.ringOut)continue;let l=null,u=a.leftSE,c=a.rightSE;const p=[u],y=u.point,_=[];for(;l=u,u=c,p.push(u),u.point!==y;)for(;;){const E=u.getAvailableLinkedEvents();if(E.length===0){const R=p[0].point,D=p[p.length-1].point;throw new Error(`Unable to complete output ring starting at [${R.x}, ${R.y}]. Last matching segment found ends at [${D.x}, ${D.y}].`)}if(E.length===1){c=E[0].otherSE;break}let I=null;for(let R=0,D=_.length;R<D;R++)if(_[R].point===u.point){I=R;break}if(I!==null){const R=_.splice(I)[0],D=p.splice(R.index);D.unshift(D[0].otherSE),e.push(new Eh(D.reverse()));continue}_.push({index:p.length,point:u.point});const S=u.getLeftmostComparator(l);c=E.sort(S)[0].otherSE;break}e.push(new Eh(p))}return e}constructor(t){this.events=t;for(let e=0,n=t.length;e<n;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const e=[t];for(let p=1,y=this.events.length-1;p<y;p++){const _=this.events[p].point,E=this.events[p+1].point;Mp(_,t,E)!==0&&(e.push(_),t=_)}if(e.length===1)return null;const n=e[0],s=e[1];Mp(n,t,s)===0&&e.shift(),e.push(e[0]);const a=this.isExteriorRing()?1:-1,l=this.isExteriorRing()?0:e.length-1,u=this.isExteriorRing()?e.length:-1,c=[];for(let p=l;p!=u;p+=a)c.push([e[p].x,e[p].y]);return c}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let s=1,a=this.events.length;s<a;s++){const l=this.events[s];Vn.compare(t,l)>0&&(t=l)}let e=t.segment.prevInResult(),n=e?e.prevInResult():null;for(;;){if(!e)return null;if(!n)return e.ringOut;if(n.ringOut!==e.ringOut)return n.ringOut.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut.enclosingRing();e=n.prevInResult(),n=e?e.prevInResult():null}}}class Lp{constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(let e=0,n=this.interiorRings.length;e<n;e++){const s=this.interiorRings[e].getGeom();s!==null&&t.push(s)}return t}}class $A{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const s=this.polys[e].getGeom();s!==null&&t.push(s)}return t}_composePolys(t){const e=[];for(let n=0,s=t.length;n<s;n++){const a=t[n];if(!a.poly)if(a.isExteriorRing())e.push(new Lp(a));else{const l=a.enclosingRing();l.poly||e.push(new Lp(l)),l.poly.addInterior(a)}}return e}}class JA{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dr.compare;this.queue=t,this.tree=new u0(e),this.segments=[]}process(t){const e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;const s=t.isLeft?this.tree.add(e):this.tree.find(e);if(!s)throw new Error(`Unable to find segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] in SweepLine tree.`);let a=s,l=s,u,c;for(;u===void 0;)a=this.tree.prev(a),a===null?u=null:a.key.consumedBy===void 0&&(u=a.key);for(;c===void 0;)l=this.tree.next(l),l===null?c=null:l.key.consumedBy===void 0&&(c=l.key);if(t.isLeft){let p=null;if(u){const _=u.getIntersection(e);if(_!==null&&(e.isAnEndpoint(_)||(p=_),!u.isAnEndpoint(_))){const E=this._splitSafely(u,_);for(let I=0,S=E.length;I<S;I++)n.push(E[I])}}let y=null;if(c){const _=c.getIntersection(e);if(_!==null&&(e.isAnEndpoint(_)||(y=_),!c.isAnEndpoint(_))){const E=this._splitSafely(c,_);for(let I=0,S=E.length;I<S;I++)n.push(E[I])}}if(p!==null||y!==null){let _=null;p===null?_=y:y===null?_=p:_=Vn.comparePoints(p,y)<=0?p:y,this.queue.remove(e.rightSE),n.push(e.rightSE);const E=e.split(_);for(let I=0,S=E.length;I<S;I++)n.push(E[I])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=u)}else{if(u&&c){const p=u.getIntersection(c);if(p!==null){if(!u.isAnEndpoint(p)){const y=this._splitSafely(u,p);for(let _=0,E=y.length;_<E;_++)n.push(y[_])}if(!c.isAnEndpoint(p)){const y=this._splitSafely(c,p);for(let _=0,E=y.length;_<E;_++)n.push(y[_])}}}this.tree.remove(e)}return n}_splitSafely(t,e){this.tree.remove(t);const n=t.rightSE;this.queue.remove(n);const s=t.split(e);return s.push(n),t.consumedBy===void 0&&this.tree.add(t),s}}const kp=typeof process<"u"&&ux.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,QA=typeof process<"u"&&ux.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class tR{run(t,e,n){qn.type=t,jo.reset();const s=[new Np(e,!0)];for(let _=0,E=n.length;_<E;_++)s.push(new Np(n[_],!1));if(qn.numMultiPolys=s.length,qn.type==="difference"){const _=s[0];let E=1;for(;E<s.length;)rf(s[E].bbox,_.bbox)!==null?E++:s.splice(E,1)}if(qn.type==="intersection")for(let _=0,E=s.length;_<E;_++){const I=s[_];for(let S=_+1,R=s.length;S<R;S++)if(rf(I.bbox,s[S].bbox)===null)return[]}const a=new u0(Vn.compare);for(let _=0,E=s.length;_<E;_++){const I=s[_].getSweepEvents();for(let S=0,R=I.length;S<R;S++)if(a.insert(I[S]),a.size>kp)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const l=new JA(a);let u=a.size,c=a.pop();for(;c;){const _=c.key;if(a.size===u){const I=_.segment;throw new Error(`Unable to pop() ${_.isLeft?"left":"right"} SweepEvent [${_.point.x}, ${_.point.y}] from segment #${I.id} [${I.leftSE.point.x}, ${I.leftSE.point.y}] -> [${I.rightSE.point.x}, ${I.rightSE.point.y}] from queue.`)}if(a.size>kp)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(l.segments.length>QA)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const E=l.process(_);for(let I=0,S=E.length;I<S;I++){const R=E[I];R.consumedBy===void 0&&a.insert(R)}u=a.size,c=a.pop()}jo.reset();const p=Eh.factory(l.segments);return new $A(p).getGeom()}}const qn=new tR,eR=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return qn.run("union",i,e)},iR=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return qn.run("intersection",i,e)},nR=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return qn.run("xor",i,e)},sR=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return qn.run("difference",i,e)};var Fp={union:eR,intersection:iR,xor:nR,difference:sR};function rR(i,t){return e=>{const[n,s,a,l]=Xo(e),u=wp(t,"meters"),c=wp(i,"meters")/Math.cos(SA((s+l)/2)),p=Math.floor((a-n)/c),y=Math.floor((l-s)/u);return{minX:n,minY:s,numCols:p,numRows:y,cellWidth:(a-n)/p,cellHeight:(l-s)/y}}}class aR{constructor(t){this.features=t.features.map(e=>{const n=Object.assign({},e.geometry);n.type==="Polygon"&&(n.type="MultiPolygon",n.coordinates=[n.coordinates]),n.coordinates=n.coordinates.map(a=>a.map(l=>l[0][0]===l[l.length-1][0]&&l[0][1]===l[l.length-1][1]?l.slice(0,l.length-1):l));const s=n.coordinates.map(a=>a.map(l=>{const u=new Float32Array(2*l.length);for(let c=0;c<l.length;c++)u[2*c+0]=l[c][0],u[2*c+1]=l[c][1];return u}));return{type:"Feature",properties:e.properties,bbox:Xo(e),geometry:n,binaryCoordinates:s}}),this.rtree=new Gf,this.rtree.load(this.features.map(e=>{const[n,s,a,l]=e.bbox;return{minX:n,minY:s,maxX:a,maxY:l,feature:e}}))}findFeature(t){var e;return(e=this.rtree.search({minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}).find(s=>{const a=s.feature.binaryCoordinates;let l=!1;for(let u=0;u<a.length&&!l;u++)if(this.inRingTyped(t,a[u][0])){let c=!1,p=1;for(;p<a[u].length&&!c;)this.inRingTyped(t,a[u][p])&&(c=!0),p++;c||(l=!0)}return l}))===null||e===void 0?void 0:e.feature}inRingTyped(t,e){let n=!1;for(let s=0,a=e.length/2-1;s<e.length/2;a=s++){const l=e[2*s+0],u=e[2*s+1],c=e[2*a+0],p=e[2*a+1];u>t[1]!=p>t[1]&&t[0]<(c-l)*(t[1]-u)/(p-u)+l&&(n=!n)}return n}}function oR(i,t){const{minX:e,minY:n,numCols:s,numRows:a,cellWidth:l,cellHeight:u}=t,c=s*a*4,p=new ArrayBuffer(c),y=new Int32Array(p),_=new aR(i);for(let E=0;E<a;E++)for(let I=0;I<s;I++){const S=e+(I+.5)*l,R=n+(E+.5)*u,D=_.findFeature([S,R]),T=D?D.properties.DOSE:0;y[E*s+I]=Math.round(T)}return p}var lR=function(i,t,e,n){function s(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function u(y){try{p(n.next(y))}catch(_){l(_)}}function c(y){try{p(n.throw(y))}catch(_){l(_)}}function p(y){y.done?a(y.value):s(y.value).then(u,c)}p((n=n.apply(i,t||[])).next())})};const Bp=10;class Ho extends Oo{constructor(t,e){super(t,e),this.tag=_t.Grid}static fromXML(t,e,n){return lR(this,void 0,void 0,function*(){const s=yield Oo.fromXML(t,e,n,Ho),a=s.attributes.Filename;s.binaryData=yield e.getParsedFile(`${a}.bin`,!0);const l=s.attributes.GridMaximumRow,u=s.attributes.GridMaximumColumn,c=s.attributes.GridType===Vr.GridType1?1:4,p=l*u*c;return s.binaryData?p!==s.binaryData.length&&e.addWarning(`[${n}] Invalid size of grid file ${a}.bin: expected ${p} bytes, but real size is ${s.binaryData.length}`):e.addWarning(`[${n}] Missing grid file ${a}.bin`),s})}static fromGeoJSON(t,e,n){const a=(e.options.gridParamsGenerator||rR(Bp,Bp))(t),l=e.options.gridGenerator||oR,{minX:u,minY:c,numCols:p,numRows:y,cellWidth:_,cellHeight:E}=a,I=l(t,a),S=e.generateUniqueFilename(_t.Grid);e.addFileToSave(new Uint8Array(I),`${S}.bin`);const R=new Ho(Object.assign({GridMinimumNorthPosition:c,GridMinimumEastPosition:u,GridCellNorthSize:E,GridCellEastSize:_,GridMaximumColumn:p,GridMaximumRow:y,Filename:S,Filelength:p*y*4,GridType:Vr.GridType2},typeof n=="number"&&{TreatmentZoneCode:n}),e);return R.binaryData=new Uint8Array(I),R}toXML(){return this.isoxmlManager.addFileToSave(this.binaryData,`${this.attributes.Filename}.bin`),super.toXML()}toGeoJSON(){const t=new Int32Array(this.binaryData.buffer),e=this.attributes.GridMaximumRow,n=this.attributes.GridMaximumColumn,s=this.attributes.GridCellEastSize,a=this.attributes.GridCellNorthSize,l=this.attributes.GridMinimumEastPosition,u=this.attributes.GridMinimumNorthPosition,c=new Array(e*n);for(let p=0;p<e;p++)for(let y=0;y<n;y++){const _=t[p*n+y];if(_===0){c[p*n+y]=null;continue}c[p*n+y]={type:"Feature",properties:{DOSE:_},geometry:{type:"Polygon",coordinates:[[[l+y*s,u+p*a],[l+y*s+s,u+p*a],[l+y*s+s,u+p*a+a],[l+y*s,u+p*a+a],[l+y*s,u+p*a]]]}}}return{type:"FeatureCollection",features:c.filter(p=>p)}}getAllReferencedTZNCodes(){if(!this.allReferencedTZNCodes)if(this.attributes.GridType===Vr.GridType1){const t=new Set;for(let e=0;e<this.binaryData.length;e++)t.add(this.binaryData[e]);this.allReferencedTZNCodes=[...t]}else this.allReferencedTZNCodes=[this.attributes.TreatmentZoneCode];return this.allReferencedTZNCodes}}$t("main",_t.Grid,Ho);var hR=function(i,t,e,n){function s(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function u(y){try{p(n.next(y))}catch(_){l(_)}}function c(y){try{p(n.throw(y))}catch(_){l(_)}}function p(y){y.done?a(y.value):s(y.value).then(u,c)}p((n=n.apply(i,t||[])).next())})};function uR(i){const t=i.options;return{VersionMajor:t.version===4?"4":"3",VersionMinor:t.version===4?"2":"3",ManagementSoftwareManufacturer:t.fmisTitle,ManagementSoftwareVersion:t.fmisVersion,DataTransferOrigin:Kc.FMIS}}class Yo extends Go{constructor(t,e){super(t,e),this.tag=_t.ISO11783TaskDataFile}static fromISOXMLManagerOptions(t){return new Yo(uR(t),t)}static fromXML(t,e,n){return hR(this,void 0,void 0,function*(){const s=yield Go.fromXML(t,e,n,Yo),a=s.attributes.ExternalFileReference||[];for(const l of a){const u=l.attributes.Filename,c=yield e.getParsedFile(`${u}.XML`,!1),p=Uo(c),y=yield oo("main",_t.ExternalFileContents).fromXML(p[_t.ExternalFileContents][0],e,u);s.appendFromExternalFile(y)}return s.attributes.ExternalFileReference=[],e.options.version=s.attributes.VersionMajor==="4"?4:3,e.options.fmisTitle=s.attributes.ManagementSoftwareManufacturer,e.options.fmisVersion=s.attributes.ManagementSoftwareVersion,s})}toXML(){return this.isoxmlManager.options.version===4?(this.attributes.VersionMajor="4",this.attributes.VersionMinor="2"):(this.attributes.VersionMajor="3",this.attributes.VersionMinor="3"),this.attributes.ManagementSoftwareManufacturer=this.isoxmlManager.options.fmisTitle,this.attributes.ManagementSoftwareVersion=this.isoxmlManager.options.fmisVersion,super.toXML()}appendFromExternalFile(t){Object.keys(t.attributes).forEach(e=>{this.attributes[e]=[...this.attributes[e]||[],...t.attributes[e]]})}addLinkListFile(){const t=(this.attributes.AttachedFile||[]).filter(e=>e.attributes.FileType!==1);this.attributes.AttachedFile=[...t,Wo.linkListFromISOXMLManager(this.isoxmlManager)]}}$t("main",_t.ISO11783TaskDataFile,Yo);class Oa extends Po{constructor(t,e){super(t,e),this.tag=_t.LineString}static fromXML(t,e,n){return Po.fromXML(t,e,n,Oa)}toCoordinatesArray(){return this.attributes.Point.map(t=>[t.attributes.PointEast,t.attributes.PointNorth])}static fromGeoJSONCoordinates(t,e,n){return new Oa({LineStringType:n,Point:t.map(s=>new tu(Object.assign({PointType:Hc.Other,PointNorth:s[1],PointEast:s[0]},s[2]!=null&&{PointUp:s[2]/1e3}),e))},e)}}$t("main",_t.LineString,Oa);class Kn extends Lo{constructor(t,e){super(t,e),this.tag=_t.Polygon}static fromXML(t,e,n){return Lo.fromXML(t,e,n,Kn)}static fromGeoJSON(t,e,n){if(t.type==="Polygon"&&(t={type:"MultiPolygon",coordinates:[t.coordinates]}),n.options.version===3){const s=[].concat(...t.coordinates.map(a=>a.map((l,u)=>Oa.fromGeoJSONCoordinates(l,n,u?as.PolygonInterior:as.PolygonExterior))));return[new Kn({PolygonType:e,LineString:s},n)]}else return t.coordinates.map(s=>new Kn({PolygonType:e,LineString:s.map((a,l)=>Oa.fromGeoJSONCoordinates(a,n,l?as.PolygonInterior:as.PolygonExterior))},n))}static normalizePolygons(t){if(!t||t.length===0)return[];const e=t[0].isoxmlManager;if(e.options.version===3){if(t.length===1)return t;const n=[].concat(...t.map(a=>a.attributes.LineString)),s=new Kn(Object.assign(Object.assign({},t[0].attributes),{LineString:n}),e);return delete s.attributes.PolygonArea,[s]}else{const n=[];return t.forEach(s=>{const a=s.attributes.LineString.filter(c=>c.attributes.LineStringType===as.PolygonExterior);if(a.length<=1){n.push(s);return}const l=s.attributes.LineString.filter(c=>c.attributes.LineStringType===as.PolygonInterior),u=l.map(c=>{let p=0,y=-1;return a.forEach((_,E)=>{const I=Fp.intersection([_.toCoordinatesArray()],[c.toCoordinatesArray()]);if(I){const S=Qc({type:"MultiPolygon",coordinates:I});S>p&&(p=S,y=E)}}),y});a.forEach((c,p)=>{const y=new Kn(Object.assign(Object.assign({},s.attributes),{LineString:[c,...l.filter((_,E)=>u[E]===p)]}),e);delete y.attributes.PolygonArea,n.push(y)})}),n}}static toGeoJSON(t){if(!t||t.length===0)return null;const e=[];t.forEach(s=>{const a=s.attributes.LineString.filter(c=>c.attributes.LineStringType===as.PolygonExterior).map(c=>c.toCoordinatesArray()),l=s.attributes.LineString.filter(c=>c.attributes.LineStringType===as.PolygonInterior).map(c=>c.toCoordinatesArray());if(a.length===0)return;if(a.length===1){e.push([a[0],...l]);return}const u=l.map(c=>{let p=0,y=-1;return a.forEach((_,E)=>{const I=Fp.intersection([_],[c]);if(I){const S=Qc({type:"MultiPolygon",coordinates:I});S>p&&(p=S,y=E)}}),y});a.forEach((c,p)=>{e.push([c,...l.filter((y,_)=>u[_]===p)])})});const n={type:"MultiPolygon",coordinates:e};return n.bbox=Xo(n),n}}$t("main",_t.Polygon,Kn);class c0 extends No{constructor(t,e){super(t,e),this.tag=_t.Partfield}static fromXML(t,e,n){return No.fromXML(t,e,n,c0)}toXML(){return this.attributes.PolygonnonTreatmentZoneonly=Kn.normalizePolygons(this.attributes.PolygonnonTreatmentZoneonly),super.toXML()}boundaryFromGeoJSON(t,e){this.attributes.PolygonnonTreatmentZoneonly=Kn.fromGeoJSON(t,Yc.PartfieldBoundary,e),this.attributes.PartfieldArea=Math.round(Qc(t))}toGeoJSON(){return Kn.toGeoJSON(this.attributes.PolygonnonTreatmentZoneonly)}}$t("main",_t.Partfield,c0);class f0 extends ko{constructor(t,e){super(t,e),this.tag=_t.Task}static fromXML(t,e,n){return ko.fromXML(t,e,n,f0)}findFreeTZNCode(){var t;const e=new Set((t=this.attributes.TreatmentZone)===null||t===void 0?void 0:t.map(n=>n.attributes.TreatmentZoneCode));for(let n=0;n<255;n++)if(!e.has(n))return n}addGridFromGeoJSON(t,e,n,s,a,l,u){var c;const p=_=>this.isoxmlManager.createEntityFromAttributes(_t.ProcessDataVariable,Object.assign(Object.assign({ProcessDataDDI:i4(e),ProcessDataValue:_},n&&{DeviceElementIdRef:n}),s&&{ValuePresentationIdRef:s}));this.attributes.TreatmentZone=(c=this.attributes.TreatmentZone)!==null&&c!==void 0?c:[],(this.attributes.OutOfFieldTreatmentZoneCode===void 0||u!==void 0)&&(this.attributes.OutOfFieldTreatmentZoneCode=this.findFreeTZNCode(),this.attributes.TreatmentZone.push(this.isoxmlManager.createEntityFromAttributes(_t.TreatmentZone,{TreatmentZoneCode:this.attributes.OutOfFieldTreatmentZoneCode,ProcessDataVariable:[p(u??0)]})));const y=this.findFreeTZNCode();this.attributes.TreatmentZone.push(this.isoxmlManager.createEntityFromAttributes(_t.TreatmentZone,{TreatmentZoneCode:y,ProcessDataVariable:[p(0)]})),this.attributes.Grid=[Ho.fromGeoJSON(t,this.isoxmlManager,y)],a!==void 0&&(this.attributes.DefaultTreatmentZoneCode=this.findFreeTZNCode(),this.attributes.TreatmentZone.push(this.isoxmlManager.createEntityFromAttributes(_t.TreatmentZone,{TreatmentZoneCode:this.attributes.DefaultTreatmentZoneCode,ProcessDataVariable:[p(a)]}))),l!==void 0&&(this.attributes.PositionLostTreatmentZoneCode=this.findFreeTZNCode(),this.attributes.TreatmentZone.push(this.isoxmlManager.createEntityFromAttributes(_t.TreatmentZone,{TreatmentZoneCode:this.attributes.PositionLostTreatmentZoneCode,ProcessDataVariable:[p(l)]})))}getGridAsGeoJSON(){return this.attributes.Grid?this.attributes.Grid[0].toGeoJSON():null}getGridValuesDescription(){var t;const e=(t=this.attributes.Grid)===null||t===void 0?void 0:t[0];if(!e)return[];const n=e.getAllReferencedTZNCodes();if(n.length===0)return[];const s=(this.attributes.TreatmentZone||[]).find(a=>a.attributes.TreatmentZoneCode===n[0]);return s?(s.attributes.ProcessDataVariable||[]).map(a=>{var l,u;const c=(l=a.attributes.ValuePresentationIdRef)===null||l===void 0?void 0:l.entity,p=(u=a.attributes.DeviceElementIdRef)===null||u===void 0?void 0:u.entity,y=p?.getDataProcess(a.attributes.ProcessDataDDI);return tx(a.attributes.ProcessDataDDI,c,y)}):[]}}$t("main",_t.Task,f0);const Vp={Int8:1,Uint8:1,Int16:2,Uint16:2,Int32:4,Uint32:4,Float:4,Double:8},gl=function(i){i=i||new ArrayBuffer(0),this.buf=i,this.view=new DataView(this.buf),this.offset=0};gl.prototype.tell=function(){return this.offset};gl.prototype.seek=function(i){this.offset=i};gl.prototype.move=function(i){this.offset+=i};function cR(i,t){gl.prototype["next"+i]=function(){const e=this.view["get"+i](this.offset,!0);return this.offset+=t,e}}Object.keys(Vp).forEach(i=>{cR(i,Vp[i])});function Ul(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var fx={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(i,t){(function(e){i.exports=e()})(function(){return function e(n,s,a){function l(p,y){if(!s[p]){if(!n[p]){var _=typeof Ul=="function"&&Ul;if(!y&&_)return _(p,!0);if(u)return u(p,!0);var E=new Error("Cannot find module '"+p+"'");throw E.code="MODULE_NOT_FOUND",E}var I=s[p]={exports:{}};n[p][0].call(I.exports,function(S){var R=n[p][1][S];return l(R||S)},I,I.exports,e,n,s,a)}return s[p].exports}for(var u=typeof Ul=="function"&&Ul,c=0;c<a.length;c++)l(a[c]);return l}({1:[function(e,n,s){var a=e("./utils"),l=e("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(c){for(var p,y,_,E,I,S,R,D=[],T=0,v=c.length,k=v,X=a.getTypeOf(c)!=="string";T<c.length;)k=v-T,_=X?(p=c[T++],y=T<v?c[T++]:0,T<v?c[T++]:0):(p=c.charCodeAt(T++),y=T<v?c.charCodeAt(T++):0,T<v?c.charCodeAt(T++):0),E=p>>2,I=(3&p)<<4|y>>4,S=1<k?(15&y)<<2|_>>6:64,R=2<k?63&_:64,D.push(u.charAt(E)+u.charAt(I)+u.charAt(S)+u.charAt(R));return D.join("")},s.decode=function(c){var p,y,_,E,I,S,R=0,D=0,T="data:";if(c.substr(0,T.length)===T)throw new Error("Invalid base64 input, it looks like a data url.");var v,k=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===u.charAt(64)&&k--,c.charAt(c.length-2)===u.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=l.uint8array?new Uint8Array(0|k):new Array(0|k);R<c.length;)p=u.indexOf(c.charAt(R++))<<2|(E=u.indexOf(c.charAt(R++)))>>4,y=(15&E)<<4|(I=u.indexOf(c.charAt(R++)))>>2,_=(3&I)<<6|(S=u.indexOf(c.charAt(R++))),v[D++]=p,I!==64&&(v[D++]=y),S!==64&&(v[D++]=_);return v}},{"./support":30,"./utils":32}],2:[function(e,n,s){var a=e("./external"),l=e("./stream/DataWorker"),u=e("./stream/Crc32Probe"),c=e("./stream/DataLengthProbe");function p(y,_,E,I,S){this.compressedSize=y,this.uncompressedSize=_,this.crc32=E,this.compression=I,this.compressedContent=S}p.prototype={getContentWorker:function(){var y=new l(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),_=this;return y.on("end",function(){if(this.streamInfo.data_length!==_.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),y},getCompressedWorker:function(){return new l(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},p.createWorkerFrom=function(y,_,E){return y.pipe(new u).pipe(new c("uncompressedSize")).pipe(_.compressWorker(E)).pipe(new c("compressedSize")).withStreamInfo("compression",_)},n.exports=p},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,n,s){var a=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,n,s){var a=e("./utils"),l=function(){for(var u,c=[],p=0;p<256;p++){u=p;for(var y=0;y<8;y++)u=1&u?3988292384^u>>>1:u>>>1;c[p]=u}return c}();n.exports=function(u,c){return u!==void 0&&u.length?a.getTypeOf(u)!=="string"?function(p,y,_,E){var I=l,S=E+_;p^=-1;for(var R=E;R<S;R++)p=p>>>8^I[255&(p^y[R])];return-1^p}(0|c,u,u.length,0):function(p,y,_,E){var I=l,S=E+_;p^=-1;for(var R=E;R<S;R++)p=p>>>8^I[255&(p^y.charCodeAt(R))];return-1^p}(0|c,u,u.length,0):0}},{"./utils":32}],5:[function(e,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,n,s){var a=null;a=typeof Promise<"u"?Promise:e("lie"),n.exports={Promise:a}},{lie:37}],7:[function(e,n,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=e("pako"),u=e("./utils"),c=e("./stream/GenericWorker"),p=a?"uint8array":"array";function y(_,E){c.call(this,"FlateWorker/"+_),this._pako=null,this._pakoAction=_,this._pakoOptions=E,this.meta={}}s.magic="\b\0",u.inherits(y,c),y.prototype.processChunk=function(_){this.meta=_.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(p,_.data),!1)},y.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},y.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},y.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var _=this;this._pako.onData=function(E){_.push({data:E,meta:_.meta})}},s.compressWorker=function(_){return new y("Deflate",_)},s.uncompressWorker=function(){return new y("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,n,s){function a(I,S){var R,D="";for(R=0;R<S;R++)D+=String.fromCharCode(255&I),I>>>=8;return D}function l(I,S,R,D,T,v){var k,X,H=I.file,K=I.compression,z=v!==p.utf8encode,q=u.transformTo("string",v(H.name)),V=u.transformTo("string",p.utf8encode(H.name)),nt=H.comment,ot=u.transformTo("string",v(nt)),j=u.transformTo("string",p.utf8encode(nt)),tt=V.length!==H.name.length,N=j.length!==nt.length,Z="",ft="",rt="",At=H.dir,bt=H.date,Dt={crc32:0,compressedSize:0,uncompressedSize:0};S&&!R||(Dt.crc32=I.crc32,Dt.compressedSize=I.compressedSize,Dt.uncompressedSize=I.uncompressedSize);var ct=0;S&&(ct|=8),z||!tt&&!N||(ct|=2048);var at=0,Pt=0;At&&(at|=16),T==="UNIX"?(Pt=798,at|=function(Lt,Vt){var Ee=Lt;return Lt||(Ee=Vt?16893:33204),(65535&Ee)<<16}(H.unixPermissions,At)):(Pt=20,at|=function(Lt){return 63&(Lt||0)}(H.dosPermissions)),k=bt.getUTCHours(),k<<=6,k|=bt.getUTCMinutes(),k<<=5,k|=bt.getUTCSeconds()/2,X=bt.getUTCFullYear()-1980,X<<=4,X|=bt.getUTCMonth()+1,X<<=5,X|=bt.getUTCDate(),tt&&(ft=a(1,1)+a(y(q),4)+V,Z+="up"+a(ft.length,2)+ft),N&&(rt=a(1,1)+a(y(ot),4)+j,Z+="uc"+a(rt.length,2)+rt);var mt="";return mt+=`
\0`,mt+=a(ct,2),mt+=K.magic,mt+=a(k,2),mt+=a(X,2),mt+=a(Dt.crc32,4),mt+=a(Dt.compressedSize,4),mt+=a(Dt.uncompressedSize,4),mt+=a(q.length,2),mt+=a(Z.length,2),{fileRecord:_.LOCAL_FILE_HEADER+mt+q+Z,dirRecord:_.CENTRAL_FILE_HEADER+a(Pt,2)+mt+a(ot.length,2)+"\0\0\0\0"+a(at,4)+a(D,4)+q+Z+ot}}var u=e("../utils"),c=e("../stream/GenericWorker"),p=e("../utf8"),y=e("../crc32"),_=e("../signature");function E(I,S,R,D){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=S,this.zipPlatform=R,this.encodeFileName=D,this.streamFiles=I,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}u.inherits(E,c),E.prototype.push=function(I){var S=I.meta.percent||0,R=this.entriesCount,D=this._sources.length;this.accumulate?this.contentBuffer.push(I):(this.bytesWritten+=I.data.length,c.prototype.push.call(this,{data:I.data,meta:{currentFile:this.currentFile,percent:R?(S+100*(R-D-1))/R:100}}))},E.prototype.openedSource=function(I){this.currentSourceOffset=this.bytesWritten,this.currentFile=I.file.name;var S=this.streamFiles&&!I.file.dir;if(S){var R=l(I,S,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:R.fileRecord,meta:{percent:0}})}else this.accumulate=!0},E.prototype.closedSource=function(I){this.accumulate=!1;var S=this.streamFiles&&!I.file.dir,R=l(I,S,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(R.dirRecord),S)this.push({data:function(D){return _.DATA_DESCRIPTOR+a(D.crc32,4)+a(D.compressedSize,4)+a(D.uncompressedSize,4)}(I),meta:{percent:100}});else for(this.push({data:R.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},E.prototype.flush=function(){for(var I=this.bytesWritten,S=0;S<this.dirRecords.length;S++)this.push({data:this.dirRecords[S],meta:{percent:100}});var R=this.bytesWritten-I,D=function(T,v,k,X,H){var K=u.transformTo("string",H(X));return _.CENTRAL_DIRECTORY_END+"\0\0\0\0"+a(T,2)+a(T,2)+a(v,4)+a(k,4)+a(K.length,2)+K}(this.dirRecords.length,R,I,this.zipComment,this.encodeFileName);this.push({data:D,meta:{percent:100}})},E.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},E.prototype.registerPrevious=function(I){this._sources.push(I);var S=this;return I.on("data",function(R){S.processChunk(R)}),I.on("end",function(){S.closedSource(S.previous.streamInfo),S._sources.length?S.prepareNextSource():S.end()}),I.on("error",function(R){S.error(R)}),this},E.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},E.prototype.error=function(I){var S=this._sources;if(!c.prototype.error.call(this,I))return!1;for(var R=0;R<S.length;R++)try{S[R].error(I)}catch{}return!0},E.prototype.lock=function(){c.prototype.lock.call(this);for(var I=this._sources,S=0;S<I.length;S++)I[S].lock()},n.exports=E},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,n,s){var a=e("../compressions"),l=e("./ZipFileWorker");s.generateWorker=function(u,c,p){var y=new l(c.streamFiles,p,c.platform,c.encodeFileName),_=0;try{u.forEach(function(E,I){_++;var S=function(v,k){var X=v||k,H=a[X];if(!H)throw new Error(X+" is not a valid compression method !");return H}(I.options.compression,c.compression),R=I.options.compressionOptions||c.compressionOptions||{},D=I.dir,T=I.date;I._compressWorker(S,R).withStreamInfo("file",{name:E,dir:D,date:T,comment:I.comment||"",unixPermissions:I.unixPermissions,dosPermissions:I.dosPermissions}).pipe(y)}),y.entriesCount=_}catch(E){y.error(E)}return y}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,n,s){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new a;for(var u in this)typeof this[u]!="function"&&(l[u]=this[u]);return l}}(a.prototype=e("./object")).loadAsync=e("./load"),a.support=e("./support"),a.defaults=e("./defaults"),a.version="3.10.1",a.loadAsync=function(l,u){return new a().loadAsync(l,u)},a.external=e("./external"),n.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,n,s){var a=e("./utils"),l=e("./external"),u=e("./utf8"),c=e("./zipEntries"),p=e("./stream/Crc32Probe"),y=e("./nodejsUtils");function _(E){return new l.Promise(function(I,S){var R=E.decompressed.getContentWorker().pipe(new p);R.on("error",function(D){S(D)}).on("end",function(){R.streamInfo.crc32!==E.decompressed.crc32?S(new Error("Corrupted zip : CRC32 mismatch")):I()}).resume()})}n.exports=function(E,I){var S=this;return I=a.extend(I||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),y.isNode&&y.isStream(E)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",E,!0,I.optimizedBinaryString,I.base64).then(function(R){var D=new c(I);return D.load(R),D}).then(function(R){var D=[l.Promise.resolve(R)],T=R.files;if(I.checkCRC32)for(var v=0;v<T.length;v++)D.push(_(T[v]));return l.Promise.all(D)}).then(function(R){for(var D=R.shift(),T=D.files,v=0;v<T.length;v++){var k=T[v],X=k.fileNameStr,H=a.resolve(k.fileNameStr);S.file(H,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:I.createFolders}),k.dir||(S.file(H).unsafeOriginalName=X)}return D.zipComment.length&&(S.comment=D.zipComment),S})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,n,s){var a=e("../utils"),l=e("../stream/GenericWorker");function u(c,p){l.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(p)}a.inherits(u,l),u.prototype._bindStream=function(c){var p=this;(this._stream=c).pause(),c.on("data",function(y){p.push({data:y,meta:{percent:0}})}).on("error",function(y){p.isPaused?this.generatedError=y:p.error(y)}).on("end",function(){p.isPaused?p._upstreamEnded=!0:p.end()})},u.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,n,s){var a=e("readable-stream").Readable;function l(u,c,p){a.call(this,c),this._helper=u;var y=this;u.on("data",function(_,E){y.push(_)||y._helper.pause(),p&&p(E)}).on("error",function(_){y.emit("error",_)}).on("end",function(){y.push(null)})}e("../utils").inherits(l,a),l.prototype._read=function(){this._helper.resume()},n.exports=l},{"../utils":32,"readable-stream":16}],14:[function(e,n,s){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,l);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,l)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var l=new Buffer(a);return l.fill(0),l},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(e,n,s){function a(H,K,z){var q,V=u.getTypeOf(K),nt=u.extend(z||{},y);nt.date=nt.date||new Date,nt.compression!==null&&(nt.compression=nt.compression.toUpperCase()),typeof nt.unixPermissions=="string"&&(nt.unixPermissions=parseInt(nt.unixPermissions,8)),nt.unixPermissions&&16384&nt.unixPermissions&&(nt.dir=!0),nt.dosPermissions&&16&nt.dosPermissions&&(nt.dir=!0),nt.dir&&(H=T(H)),nt.createFolders&&(q=D(H))&&v.call(this,q,!0);var ot=V==="string"&&nt.binary===!1&&nt.base64===!1;z&&z.binary!==void 0||(nt.binary=!ot),(K instanceof _&&K.uncompressedSize===0||nt.dir||!K||K.length===0)&&(nt.base64=!1,nt.binary=!0,K="",nt.compression="STORE",V="string");var j=null;j=K instanceof _||K instanceof c?K:S.isNode&&S.isStream(K)?new R(H,K):u.prepareContent(H,K,nt.binary,nt.optimizedBinaryString,nt.base64);var tt=new E(H,j,nt);this.files[H]=tt}var l=e("./utf8"),u=e("./utils"),c=e("./stream/GenericWorker"),p=e("./stream/StreamHelper"),y=e("./defaults"),_=e("./compressedObject"),E=e("./zipObject"),I=e("./generate"),S=e("./nodejsUtils"),R=e("./nodejs/NodejsStreamInputAdapter"),D=function(H){H.slice(-1)==="/"&&(H=H.substring(0,H.length-1));var K=H.lastIndexOf("/");return 0<K?H.substring(0,K):""},T=function(H){return H.slice(-1)!=="/"&&(H+="/"),H},v=function(H,K){return K=K!==void 0?K:y.createFolders,H=T(H),this.files[H]||a.call(this,H,null,{dir:!0,createFolders:K}),this.files[H]};function k(H){return Object.prototype.toString.call(H)==="[object RegExp]"}var X={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(H){var K,z,q;for(K in this.files)q=this.files[K],(z=K.slice(this.root.length,K.length))&&K.slice(0,this.root.length)===this.root&&H(z,q)},filter:function(H){var K=[];return this.forEach(function(z,q){H(z,q)&&K.push(q)}),K},file:function(H,K,z){if(arguments.length!==1)return H=this.root+H,a.call(this,H,K,z),this;if(k(H)){var q=H;return this.filter(function(nt,ot){return!ot.dir&&q.test(nt)})}var V=this.files[this.root+H];return V&&!V.dir?V:null},folder:function(H){if(!H)return this;if(k(H))return this.filter(function(V,nt){return nt.dir&&H.test(V)});var K=this.root+H,z=v.call(this,K),q=this.clone();return q.root=z.name,q},remove:function(H){H=this.root+H;var K=this.files[H];if(K||(H.slice(-1)!=="/"&&(H+="/"),K=this.files[H]),K&&!K.dir)delete this.files[H];else for(var z=this.filter(function(V,nt){return nt.name.slice(0,H.length)===H}),q=0;q<z.length;q++)delete this.files[z[q].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(H){var K,z={};try{if((z=u.extend(H||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=z.type.toLowerCase(),z.compression=z.compression.toUpperCase(),z.type==="binarystring"&&(z.type="string"),!z.type)throw new Error("No output type specified.");u.checkSupport(z.type),z.platform!=="darwin"&&z.platform!=="freebsd"&&z.platform!=="linux"&&z.platform!=="sunos"||(z.platform="UNIX"),z.platform==="win32"&&(z.platform="DOS");var q=z.comment||this.comment||"";K=I.generateWorker(this,z,q)}catch(V){(K=new c("error")).error(V)}return new p(K,z.type||"string",z.mimeType)},generateAsync:function(H,K){return this.generateInternalStream(H).accumulate(K)},generateNodeStream:function(H,K){return(H=H||{}).type||(H.type="nodebuffer"),this.generateInternalStream(H).toNodejsStream(K)}};n.exports=X},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,n,s){n.exports=e("stream")},{stream:void 0}],17:[function(e,n,s){var a=e("./DataReader");function l(u){a.call(this,u);for(var c=0;c<this.data.length;c++)u[c]=255&u[c]}e("../utils").inherits(l,a),l.prototype.byteAt=function(u){return this.data[this.zero+u]},l.prototype.lastIndexOfSignature=function(u){for(var c=u.charCodeAt(0),p=u.charCodeAt(1),y=u.charCodeAt(2),_=u.charCodeAt(3),E=this.length-4;0<=E;--E)if(this.data[E]===c&&this.data[E+1]===p&&this.data[E+2]===y&&this.data[E+3]===_)return E-this.zero;return-1},l.prototype.readAndCheckSignature=function(u){var c=u.charCodeAt(0),p=u.charCodeAt(1),y=u.charCodeAt(2),_=u.charCodeAt(3),E=this.readData(4);return c===E[0]&&p===E[1]&&y===E[2]&&_===E[3]},l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,c},n.exports=l},{"../utils":32,"./DataReader":18}],18:[function(e,n,s){var a=e("../utils");function l(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var c,p=0;for(this.checkOffset(u),c=this.index+u-1;c>=this.index;c--)p=(p<<8)+this.byteAt(c);return this.index+=u,p},readString:function(u){return a.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC(1980+(u>>25&127),(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(31&u)<<1))}},n.exports=l},{"../utils":32}],19:[function(e,n,s){var a=e("./Uint8ArrayReader");function l(u){a.call(this,u)}e("../utils").inherits(l,a),l.prototype.readData=function(u){this.checkOffset(u);var c=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,c},n.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,n,s){var a=e("./DataReader");function l(u){a.call(this,u)}e("../utils").inherits(l,a),l.prototype.byteAt=function(u){return this.data.charCodeAt(this.zero+u)},l.prototype.lastIndexOfSignature=function(u){return this.data.lastIndexOf(u)-this.zero},l.prototype.readAndCheckSignature=function(u){return u===this.readData(4)},l.prototype.readData=function(u){this.checkOffset(u);var c=this.data.slice(this.zero+this.index,this.zero+this.index+u);return this.index+=u,c},n.exports=l},{"../utils":32,"./DataReader":18}],21:[function(e,n,s){var a=e("./ArrayReader");function l(u){a.call(this,u)}e("../utils").inherits(l,a),l.prototype.readData=function(u){if(this.checkOffset(u),u===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+u);return this.index+=u,c},n.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(e,n,s){var a=e("../utils"),l=e("../support"),u=e("./ArrayReader"),c=e("./StringReader"),p=e("./NodeBufferReader"),y=e("./Uint8ArrayReader");n.exports=function(_){var E=a.getTypeOf(_);return a.checkSupport(E),E!=="string"||l.uint8array?E==="nodebuffer"?new p(_):l.uint8array?new y(a.transformTo("uint8array",_)):new u(a.transformTo("array",_)):new c(_)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,n,s){var a=e("./GenericWorker"),l=e("../utils");function u(c){a.call(this,"ConvertWorker to "+c),this.destType=c}l.inherits(u,a),u.prototype.processChunk=function(c){this.push({data:l.transformTo(this.destType,c.data),meta:c.meta})},n.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(e,n,s){var a=e("./GenericWorker"),l=e("../crc32");function u(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(u,a),u.prototype.processChunk=function(c){this.streamInfo.crc32=l(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=u},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,n,s){var a=e("../utils"),l=e("./GenericWorker");function u(c){l.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}a.inherits(u,l),u.prototype.processChunk=function(c){if(c){var p=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=p+c.data.length}l.prototype.processChunk.call(this,c)},n.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(e,n,s){var a=e("../utils"),l=e("./GenericWorker");function u(c){l.call(this,"DataWorker");var p=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(y){p.dataIsReady=!0,p.data=y,p.max=y&&y.length||0,p.type=a.getTypeOf(y),p.isPaused||p._tickAndRepeat()},function(y){p.error(y)})}a.inherits(u,l),u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},u.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0)},u.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},u.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,p=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,p);break;case"uint8array":c=this.data.subarray(this.index,p);break;case"array":case"nodebuffer":c=this.data.slice(this.index,p)}return this.index=p,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=u},{"../utils":32,"./GenericWorker":28}],28:[function(e,n,s){function a(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,u){return this._listeners[l].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,u){if(this._listeners[l])for(var c=0;c<this._listeners[l].length;c++)this._listeners[l][c].call(this,u)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var u=this;return l.on("data",function(c){u.processChunk(c)}),l.on("end",function(){u.end()}),l.on("error",function(c){u.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,u){return this.extraStreamInfo[l]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},n.exports=a},{}],29:[function(e,n,s){var a=e("../utils"),l=e("./ConvertWorker"),u=e("./GenericWorker"),c=e("../base64"),p=e("../support"),y=e("../external"),_=null;if(p.nodestream)try{_=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(S,R){return new y.Promise(function(D,T){var v=[],k=S._internalType,X=S._outputType,H=S._mimeType;S.on("data",function(K,z){v.push(K),R&&R(z)}).on("error",function(K){v=[],T(K)}).on("end",function(){try{var K=function(z,q,V){switch(z){case"blob":return a.newBlob(a.transformTo("arraybuffer",q),V);case"base64":return c.encode(q);default:return a.transformTo(z,q)}}(X,function(z,q){var V,nt=0,ot=null,j=0;for(V=0;V<q.length;V++)j+=q[V].length;switch(z){case"string":return q.join("");case"array":return Array.prototype.concat.apply([],q);case"uint8array":for(ot=new Uint8Array(j),V=0;V<q.length;V++)ot.set(q[V],nt),nt+=q[V].length;return ot;case"nodebuffer":return Buffer.concat(q);default:throw new Error("concat : unsupported type '"+z+"'")}}(k,v),H);D(K)}catch(z){T(z)}v=[]}).resume()})}function I(S,R,D){var T=R;switch(R){case"blob":case"arraybuffer":T="uint8array";break;case"base64":T="string"}try{this._internalType=T,this._outputType=R,this._mimeType=D,a.checkSupport(T),this._worker=S.pipe(new l(T)),S.lock()}catch(v){this._worker=new u("error"),this._worker.error(v)}}I.prototype={accumulate:function(S){return E(this,S)},on:function(S,R){var D=this;return S==="data"?this._worker.on(S,function(T){R.call(D,T.data,T.meta)}):this._worker.on(S,function(){a.delay(R,arguments,D)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(S){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new _(this,{objectMode:this._outputType!=="nodebuffer"},S)}},n.exports=I},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var a=new ArrayBuffer(0);try{s.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(a),s.blob=l.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,n,s){for(var a=e("./utils"),l=e("./support"),u=e("./nodejsUtils"),c=e("./stream/GenericWorker"),p=new Array(256),y=0;y<256;y++)p[y]=252<=y?6:248<=y?5:240<=y?4:224<=y?3:192<=y?2:1;p[254]=p[254]=1;function _(){c.call(this,"utf-8 decode"),this.leftOver=null}function E(){c.call(this,"utf-8 encode")}s.utf8encode=function(I){return l.nodebuffer?u.newBufferFrom(I,"utf-8"):function(S){var R,D,T,v,k,X=S.length,H=0;for(v=0;v<X;v++)(64512&(D=S.charCodeAt(v)))==55296&&v+1<X&&(64512&(T=S.charCodeAt(v+1)))==56320&&(D=65536+(D-55296<<10)+(T-56320),v++),H+=D<128?1:D<2048?2:D<65536?3:4;for(R=l.uint8array?new Uint8Array(H):new Array(H),v=k=0;k<H;v++)(64512&(D=S.charCodeAt(v)))==55296&&v+1<X&&(64512&(T=S.charCodeAt(v+1)))==56320&&(D=65536+(D-55296<<10)+(T-56320),v++),D<128?R[k++]=D:(D<2048?R[k++]=192|D>>>6:(D<65536?R[k++]=224|D>>>12:(R[k++]=240|D>>>18,R[k++]=128|D>>>12&63),R[k++]=128|D>>>6&63),R[k++]=128|63&D);return R}(I)},s.utf8decode=function(I){return l.nodebuffer?a.transformTo("nodebuffer",I).toString("utf-8"):function(S){var R,D,T,v,k=S.length,X=new Array(2*k);for(R=D=0;R<k;)if((T=S[R++])<128)X[D++]=T;else if(4<(v=p[T]))X[D++]=65533,R+=v-1;else{for(T&=v===2?31:v===3?15:7;1<v&&R<k;)T=T<<6|63&S[R++],v--;1<v?X[D++]=65533:T<65536?X[D++]=T:(T-=65536,X[D++]=55296|T>>10&1023,X[D++]=56320|1023&T)}return X.length!==D&&(X.subarray?X=X.subarray(0,D):X.length=D),a.applyFromCharCode(X)}(I=a.transformTo(l.uint8array?"uint8array":"array",I))},a.inherits(_,c),_.prototype.processChunk=function(I){var S=a.transformTo(l.uint8array?"uint8array":"array",I.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var R=S;(S=new Uint8Array(R.length+this.leftOver.length)).set(this.leftOver,0),S.set(R,this.leftOver.length)}else S=this.leftOver.concat(S);this.leftOver=null}var D=function(v,k){var X;for((k=k||v.length)>v.length&&(k=v.length),X=k-1;0<=X&&(192&v[X])==128;)X--;return X<0||X===0?k:X+p[v[X]]>k?X:k}(S),T=S;D!==S.length&&(l.uint8array?(T=S.subarray(0,D),this.leftOver=S.subarray(D,S.length)):(T=S.slice(0,D),this.leftOver=S.slice(D,S.length))),this.push({data:s.utf8decode(T),meta:I.meta})},_.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=_,a.inherits(E,c),E.prototype.processChunk=function(I){this.push({data:s.utf8encode(I.data),meta:I.meta})},s.Utf8EncodeWorker=E},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,n,s){var a=e("./support"),l=e("./base64"),u=e("./nodejsUtils"),c=e("./external");function p(R){return R}function y(R,D){for(var T=0;T<R.length;++T)D[T]=255&R.charCodeAt(T);return D}e("setimmediate"),s.newBlob=function(R,D){s.checkSupport("blob");try{return new Blob([R],{type:D})}catch{try{var T=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return T.append(R),T.getBlob(D)}catch{throw new Error("Bug : can't construct the Blob.")}}};var _={stringifyByChunk:function(R,D,T){var v=[],k=0,X=R.length;if(X<=T)return String.fromCharCode.apply(null,R);for(;k<X;)D==="array"||D==="nodebuffer"?v.push(String.fromCharCode.apply(null,R.slice(k,Math.min(k+T,X)))):v.push(String.fromCharCode.apply(null,R.subarray(k,Math.min(k+T,X)))),k+=T;return v.join("")},stringifyByChar:function(R){for(var D="",T=0;T<R.length;T++)D+=String.fromCharCode(R[T]);return D},applyCanBeUsed:{uint8array:function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}}()}};function E(R){var D=65536,T=s.getTypeOf(R),v=!0;if(T==="uint8array"?v=_.applyCanBeUsed.uint8array:T==="nodebuffer"&&(v=_.applyCanBeUsed.nodebuffer),v)for(;1<D;)try{return _.stringifyByChunk(R,T,D)}catch{D=Math.floor(D/2)}return _.stringifyByChar(R)}function I(R,D){for(var T=0;T<R.length;T++)D[T]=R[T];return D}s.applyFromCharCode=E;var S={};S.string={string:p,array:function(R){return y(R,new Array(R.length))},arraybuffer:function(R){return S.string.uint8array(R).buffer},uint8array:function(R){return y(R,new Uint8Array(R.length))},nodebuffer:function(R){return y(R,u.allocBuffer(R.length))}},S.array={string:E,array:p,arraybuffer:function(R){return new Uint8Array(R).buffer},uint8array:function(R){return new Uint8Array(R)},nodebuffer:function(R){return u.newBufferFrom(R)}},S.arraybuffer={string:function(R){return E(new Uint8Array(R))},array:function(R){return I(new Uint8Array(R),new Array(R.byteLength))},arraybuffer:p,uint8array:function(R){return new Uint8Array(R)},nodebuffer:function(R){return u.newBufferFrom(new Uint8Array(R))}},S.uint8array={string:E,array:function(R){return I(R,new Array(R.length))},arraybuffer:function(R){return R.buffer},uint8array:p,nodebuffer:function(R){return u.newBufferFrom(R)}},S.nodebuffer={string:E,array:function(R){return I(R,new Array(R.length))},arraybuffer:function(R){return S.nodebuffer.uint8array(R).buffer},uint8array:function(R){return I(R,new Uint8Array(R.length))},nodebuffer:p},s.transformTo=function(R,D){if(D=D||"",!R)return D;s.checkSupport(R);var T=s.getTypeOf(D);return S[T][R](D)},s.resolve=function(R){for(var D=R.split("/"),T=[],v=0;v<D.length;v++){var k=D[v];k==="."||k===""&&v!==0&&v!==D.length-1||(k===".."?T.pop():T.push(k))}return T.join("/")},s.getTypeOf=function(R){return typeof R=="string"?"string":Object.prototype.toString.call(R)==="[object Array]"?"array":a.nodebuffer&&u.isBuffer(R)?"nodebuffer":a.uint8array&&R instanceof Uint8Array?"uint8array":a.arraybuffer&&R instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(R){if(!a[R.toLowerCase()])throw new Error(R+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(R){var D,T,v="";for(T=0;T<(R||"").length;T++)v+="\\x"+((D=R.charCodeAt(T))<16?"0":"")+D.toString(16).toUpperCase();return v},s.delay=function(R,D,T){setImmediate(function(){R.apply(T||null,D||[])})},s.inherits=function(R,D){function T(){}T.prototype=D.prototype,R.prototype=new T},s.extend=function(){var R,D,T={};for(R=0;R<arguments.length;R++)for(D in arguments[R])Object.prototype.hasOwnProperty.call(arguments[R],D)&&T[D]===void 0&&(T[D]=arguments[R][D]);return T},s.prepareContent=function(R,D,T,v,k){return c.Promise.resolve(D).then(function(X){return a.blob&&(X instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(X))!==-1)&&typeof FileReader<"u"?new c.Promise(function(H,K){var z=new FileReader;z.onload=function(q){H(q.target.result)},z.onerror=function(q){K(q.target.error)},z.readAsArrayBuffer(X)}):X}).then(function(X){var H=s.getTypeOf(X);return H?(H==="arraybuffer"?X=s.transformTo("uint8array",X):H==="string"&&(k?X=l.decode(X):T&&v!==!0&&(X=function(K){return y(K,a.uint8array?new Uint8Array(K.length):new Array(K.length))}(X))),X):c.Promise.reject(new Error("Can't read the data of '"+R+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,n,s){var a=e("./reader/readerFor"),l=e("./utils"),u=e("./signature"),c=e("./zipEntry"),p=e("./support");function y(_){this.files=[],this.loadOptions=_}y.prototype={checkSignature:function(_){if(!this.reader.readAndCheckSignature(_)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(E)+", expected "+l.pretty(_)+")")}},isSignature:function(_,E){var I=this.reader.index;this.reader.setIndex(_);var S=this.reader.readString(4)===E;return this.reader.setIndex(I),S},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var _=this.reader.readData(this.zipCommentLength),E=p.uint8array?"uint8array":"array",I=l.transformTo(E,_);this.zipComment=this.loadOptions.decodeFileName(I)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var _,E,I,S=this.zip64EndOfCentralSize-44;0<S;)_=this.reader.readInt(2),E=this.reader.readInt(4),I=this.reader.readData(E),this.zip64ExtensibleData[_]={id:_,length:E,value:I}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var _,E;for(_=0;_<this.files.length;_++)E=this.files[_],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var _;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)(_=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(_);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var _=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(_<0)throw this.isSignature(0,u.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(_);var E=_;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(_=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(_),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var I=this.centralDirOffset+this.centralDirSize;this.zip64&&(I+=20,I+=12+this.zip64EndOfCentralSize);var S=E-I;if(0<S)this.isSignature(E,u.CENTRAL_FILE_HEADER)||(this.reader.zero=S);else if(S<0)throw new Error("Corrupted zip: missing "+Math.abs(S)+" bytes.")},prepareReader:function(_){this.reader=a(_)},load:function(_){this.prepareReader(_),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=y},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,n,s){var a=e("./reader/readerFor"),l=e("./utils"),u=e("./compressedObject"),c=e("./crc32"),p=e("./utf8"),y=e("./compressions"),_=e("./support");function E(I,S){this.options=I,this.loadOptions=S}E.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(I){var S,R;if(I.skip(22),this.fileNameLength=I.readInt(2),R=I.readInt(2),this.fileName=I.readData(this.fileNameLength),I.skip(R),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((S=function(D){for(var T in y)if(Object.prototype.hasOwnProperty.call(y,T)&&y[T].magic===D)return y[T];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,S,I.readData(this.compressedSize))},readCentralPart:function(I){this.versionMadeBy=I.readInt(2),I.skip(2),this.bitFlag=I.readInt(2),this.compressionMethod=I.readString(2),this.date=I.readDate(),this.crc32=I.readInt(4),this.compressedSize=I.readInt(4),this.uncompressedSize=I.readInt(4);var S=I.readInt(2);if(this.extraFieldsLength=I.readInt(2),this.fileCommentLength=I.readInt(2),this.diskNumberStart=I.readInt(2),this.internalFileAttributes=I.readInt(2),this.externalFileAttributes=I.readInt(4),this.localHeaderOffset=I.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");I.skip(S),this.readExtraFields(I),this.parseZIP64ExtraField(I),this.fileComment=I.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var I=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),I==0&&(this.dosPermissions=63&this.externalFileAttributes),I==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var I=a(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=I.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=I.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=I.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=I.readInt(4))}},readExtraFields:function(I){var S,R,D,T=I.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});I.index+4<T;)S=I.readInt(2),R=I.readInt(2),D=I.readData(R),this.extraFields[S]={id:S,length:R,value:D};I.setIndex(T)},handleUTF8:function(){var I=_.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=p.utf8decode(this.fileName),this.fileCommentStr=p.utf8decode(this.fileComment);else{var S=this.findExtraFieldUnicodePath();if(S!==null)this.fileNameStr=S;else{var R=l.transformTo(I,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(R)}var D=this.findExtraFieldUnicodeComment();if(D!==null)this.fileCommentStr=D;else{var T=l.transformTo(I,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(T)}}},findExtraFieldUnicodePath:function(){var I=this.extraFields[28789];if(I){var S=a(I.value);return S.readInt(1)!==1||c(this.fileName)!==S.readInt(4)?null:p.utf8decode(S.readData(I.length-5))}return null},findExtraFieldUnicodeComment:function(){var I=this.extraFields[25461];if(I){var S=a(I.value);return S.readInt(1)!==1||c(this.fileComment)!==S.readInt(4)?null:p.utf8decode(S.readData(I.length-5))}return null}},n.exports=E},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,n,s){function a(S,R,D){this.name=S,this.dir=D.dir,this.date=D.date,this.comment=D.comment,this.unixPermissions=D.unixPermissions,this.dosPermissions=D.dosPermissions,this._data=R,this._dataBinary=D.binary,this.options={compression:D.compression,compressionOptions:D.compressionOptions}}var l=e("./stream/StreamHelper"),u=e("./stream/DataWorker"),c=e("./utf8"),p=e("./compressedObject"),y=e("./stream/GenericWorker");a.prototype={internalStream:function(S){var R=null,D="string";try{if(!S)throw new Error("No output type specified.");var T=(D=S.toLowerCase())==="string"||D==="text";D!=="binarystring"&&D!=="text"||(D="string"),R=this._decompressWorker();var v=!this._dataBinary;v&&!T&&(R=R.pipe(new c.Utf8EncodeWorker)),!v&&T&&(R=R.pipe(new c.Utf8DecodeWorker))}catch(k){(R=new y("error")).error(k)}return new l(R,D,"")},async:function(S,R){return this.internalStream(S).accumulate(R)},nodeStream:function(S,R){return this.internalStream(S||"nodebuffer").toNodejsStream(R)},_compressWorker:function(S,R){if(this._data instanceof p&&this._data.compression.magic===S.magic)return this._data.getCompressedWorker();var D=this._decompressWorker();return this._dataBinary||(D=D.pipe(new c.Utf8EncodeWorker)),p.createWorkerFrom(D,S,R)},_decompressWorker:function(){return this._data instanceof p?this._data.getContentWorker():this._data instanceof y?this._data:new u(this._data)}};for(var _=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],E=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},I=0;I<_.length;I++)a.prototype[_[I]]=E;n.exports=a},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,n,s){(function(a){var l,u,c=a.MutationObserver||a.WebKitMutationObserver;if(c){var p=0,y=new c(S),_=a.document.createTextNode("");y.observe(_,{characterData:!0}),l=function(){_.data=p=++p%2}}else if(a.setImmediate||a.MessageChannel===void 0)l="document"in a&&"onreadystatechange"in a.document.createElement("script")?function(){var R=a.document.createElement("script");R.onreadystatechange=function(){S(),R.onreadystatechange=null,R.parentNode.removeChild(R),R=null},a.document.documentElement.appendChild(R)}:function(){setTimeout(S,0)};else{var E=new a.MessageChannel;E.port1.onmessage=S,l=function(){E.port2.postMessage(0)}}var I=[];function S(){var R,D;u=!0;for(var T=I.length;T;){for(D=I,I=[],R=-1;++R<T;)D[R]();T=I.length}u=!1}n.exports=function(R){I.push(R)!==1||u||l()}}).call(this,typeof hn<"u"?hn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,n,s){var a=e("immediate");function l(){}var u={},c=["REJECTED"],p=["FULFILLED"],y=["PENDING"];function _(T){if(typeof T!="function")throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,T!==l&&R(this,T)}function E(T,v,k){this.promise=T,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function I(T,v,k){a(function(){var X;try{X=v(k)}catch(H){return u.reject(T,H)}X===T?u.reject(T,new TypeError("Cannot resolve promise with itself")):u.resolve(T,X)})}function S(T){var v=T&&T.then;if(T&&(typeof T=="object"||typeof T=="function")&&typeof v=="function")return function(){v.apply(T,arguments)}}function R(T,v){var k=!1;function X(z){k||(k=!0,u.reject(T,z))}function H(z){k||(k=!0,u.resolve(T,z))}var K=D(function(){v(H,X)});K.status==="error"&&X(K.value)}function D(T,v){var k={};try{k.value=T(v),k.status="success"}catch(X){k.status="error",k.value=X}return k}(n.exports=_).prototype.finally=function(T){if(typeof T!="function")return this;var v=this.constructor;return this.then(function(k){return v.resolve(T()).then(function(){return k})},function(k){return v.resolve(T()).then(function(){throw k})})},_.prototype.catch=function(T){return this.then(null,T)},_.prototype.then=function(T,v){if(typeof T!="function"&&this.state===p||typeof v!="function"&&this.state===c)return this;var k=new this.constructor(l);return this.state!==y?I(k,this.state===p?T:v,this.outcome):this.queue.push(new E(k,T,v)),k},E.prototype.callFulfilled=function(T){u.resolve(this.promise,T)},E.prototype.otherCallFulfilled=function(T){I(this.promise,this.onFulfilled,T)},E.prototype.callRejected=function(T){u.reject(this.promise,T)},E.prototype.otherCallRejected=function(T){I(this.promise,this.onRejected,T)},u.resolve=function(T,v){var k=D(S,v);if(k.status==="error")return u.reject(T,k.value);var X=k.value;if(X)R(T,X);else{T.state=p,T.outcome=v;for(var H=-1,K=T.queue.length;++H<K;)T.queue[H].callFulfilled(v)}return T},u.reject=function(T,v){T.state=c,T.outcome=v;for(var k=-1,X=T.queue.length;++k<X;)T.queue[k].callRejected(v);return T},_.resolve=function(T){return T instanceof this?T:u.resolve(new this(l),T)},_.reject=function(T){var v=new this(l);return u.reject(v,T)},_.all=function(T){var v=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=T.length,X=!1;if(!k)return this.resolve([]);for(var H=new Array(k),K=0,z=-1,q=new this(l);++z<k;)V(T[z],z);return q;function V(nt,ot){v.resolve(nt).then(function(j){H[ot]=j,++K!==k||X||(X=!0,u.resolve(q,H))},function(j){X||(X=!0,u.reject(q,j))})}},_.race=function(T){var v=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=T.length,X=!1;if(!k)return this.resolve([]);for(var H=-1,K=new this(l);++H<k;)z=T[H],v.resolve(z).then(function(q){X||(X=!0,u.resolve(K,q))},function(q){X||(X=!0,u.reject(K,q))});var z;return K}},{immediate:36}],38:[function(e,n,s){var a={};(0,e("./lib/utils/common").assign)(a,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),n.exports=a},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,n,s){var a=e("./zlib/deflate"),l=e("./utils/common"),u=e("./utils/strings"),c=e("./zlib/messages"),p=e("./zlib/zstream"),y=Object.prototype.toString,_=0,E=-1,I=0,S=8;function R(T){if(!(this instanceof R))return new R(T);this.options=l.assign({level:E,method:S,chunkSize:16384,windowBits:15,memLevel:8,strategy:I,to:""},T||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var k=a.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(k!==_)throw new Error(c[k]);if(v.header&&a.deflateSetHeader(this.strm,v.header),v.dictionary){var X;if(X=typeof v.dictionary=="string"?u.string2buf(v.dictionary):y.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(k=a.deflateSetDictionary(this.strm,X))!==_)throw new Error(c[k]);this._dict_set=!0}}function D(T,v){var k=new R(v);if(k.push(T,!0),k.err)throw k.msg||c[k.err];return k.result}R.prototype.push=function(T,v){var k,X,H=this.strm,K=this.options.chunkSize;if(this.ended)return!1;X=v===~~v?v:v===!0?4:0,typeof T=="string"?H.input=u.string2buf(T):y.call(T)==="[object ArrayBuffer]"?H.input=new Uint8Array(T):H.input=T,H.next_in=0,H.avail_in=H.input.length;do{if(H.avail_out===0&&(H.output=new l.Buf8(K),H.next_out=0,H.avail_out=K),(k=a.deflate(H,X))!==1&&k!==_)return this.onEnd(k),!(this.ended=!0);H.avail_out!==0&&(H.avail_in!==0||X!==4&&X!==2)||(this.options.to==="string"?this.onData(u.buf2binstring(l.shrinkBuf(H.output,H.next_out))):this.onData(l.shrinkBuf(H.output,H.next_out)))}while((0<H.avail_in||H.avail_out===0)&&k!==1);return X===4?(k=a.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===_):X!==2||(this.onEnd(_),!(H.avail_out=0))},R.prototype.onData=function(T){this.chunks.push(T)},R.prototype.onEnd=function(T){T===_&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg},s.Deflate=R,s.deflate=D,s.deflateRaw=function(T,v){return(v=v||{}).raw=!0,D(T,v)},s.gzip=function(T,v){return(v=v||{}).gzip=!0,D(T,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,n,s){var a=e("./zlib/inflate"),l=e("./utils/common"),u=e("./utils/strings"),c=e("./zlib/constants"),p=e("./zlib/messages"),y=e("./zlib/zstream"),_=e("./zlib/gzheader"),E=Object.prototype.toString;function I(R){if(!(this instanceof I))return new I(R);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},R||{});var D=this.options;D.raw&&0<=D.windowBits&&D.windowBits<16&&(D.windowBits=-D.windowBits,D.windowBits===0&&(D.windowBits=-15)),!(0<=D.windowBits&&D.windowBits<16)||R&&R.windowBits||(D.windowBits+=32),15<D.windowBits&&D.windowBits<48&&!(15&D.windowBits)&&(D.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new y,this.strm.avail_out=0;var T=a.inflateInit2(this.strm,D.windowBits);if(T!==c.Z_OK)throw new Error(p[T]);this.header=new _,a.inflateGetHeader(this.strm,this.header)}function S(R,D){var T=new I(D);if(T.push(R,!0),T.err)throw T.msg||p[T.err];return T.result}I.prototype.push=function(R,D){var T,v,k,X,H,K,z=this.strm,q=this.options.chunkSize,V=this.options.dictionary,nt=!1;if(this.ended)return!1;v=D===~~D?D:D===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof R=="string"?z.input=u.binstring2buf(R):E.call(R)==="[object ArrayBuffer]"?z.input=new Uint8Array(R):z.input=R,z.next_in=0,z.avail_in=z.input.length;do{if(z.avail_out===0&&(z.output=new l.Buf8(q),z.next_out=0,z.avail_out=q),(T=a.inflate(z,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&V&&(K=typeof V=="string"?u.string2buf(V):E.call(V)==="[object ArrayBuffer]"?new Uint8Array(V):V,T=a.inflateSetDictionary(this.strm,K)),T===c.Z_BUF_ERROR&&nt===!0&&(T=c.Z_OK,nt=!1),T!==c.Z_STREAM_END&&T!==c.Z_OK)return this.onEnd(T),!(this.ended=!0);z.next_out&&(z.avail_out!==0&&T!==c.Z_STREAM_END&&(z.avail_in!==0||v!==c.Z_FINISH&&v!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=u.utf8border(z.output,z.next_out),X=z.next_out-k,H=u.buf2string(z.output,k),z.next_out=X,z.avail_out=q-X,X&&l.arraySet(z.output,z.output,k,X,0),this.onData(H)):this.onData(l.shrinkBuf(z.output,z.next_out)))),z.avail_in===0&&z.avail_out===0&&(nt=!0)}while((0<z.avail_in||z.avail_out===0)&&T!==c.Z_STREAM_END);return T===c.Z_STREAM_END&&(v=c.Z_FINISH),v===c.Z_FINISH?(T=a.inflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===c.Z_OK):v!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(z.avail_out=0))},I.prototype.onData=function(R){this.chunks.push(R)},I.prototype.onEnd=function(R){R===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=R,this.msg=this.strm.msg},s.Inflate=I,s.inflate=S,s.inflateRaw=function(R,D){return(D=D||{}).raw=!0,S(R,D)},s.ungzip=S},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,n,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(c){for(var p=Array.prototype.slice.call(arguments,1);p.length;){var y=p.shift();if(y){if(typeof y!="object")throw new TypeError(y+"must be non-object");for(var _ in y)y.hasOwnProperty(_)&&(c[_]=y[_])}}return c},s.shrinkBuf=function(c,p){return c.length===p?c:c.subarray?c.subarray(0,p):(c.length=p,c)};var l={arraySet:function(c,p,y,_,E){if(p.subarray&&c.subarray)c.set(p.subarray(y,y+_),E);else for(var I=0;I<_;I++)c[E+I]=p[y+I]},flattenChunks:function(c){var p,y,_,E,I,S;for(p=_=0,y=c.length;p<y;p++)_+=c[p].length;for(S=new Uint8Array(_),p=E=0,y=c.length;p<y;p++)I=c[p],S.set(I,E),E+=I.length;return S}},u={arraySet:function(c,p,y,_,E){for(var I=0;I<_;I++)c[E+I]=p[y+I]},flattenChunks:function(c){return[].concat.apply([],c)}};s.setTyped=function(c){c?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,l)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,u))},s.setTyped(a)},{}],42:[function(e,n,s){var a=e("./common"),l=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var c=new a.Buf8(256),p=0;p<256;p++)c[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;function y(_,E){if(E<65537&&(_.subarray&&u||!_.subarray&&l))return String.fromCharCode.apply(null,a.shrinkBuf(_,E));for(var I="",S=0;S<E;S++)I+=String.fromCharCode(_[S]);return I}c[254]=c[254]=1,s.string2buf=function(_){var E,I,S,R,D,T=_.length,v=0;for(R=0;R<T;R++)(64512&(I=_.charCodeAt(R)))==55296&&R+1<T&&(64512&(S=_.charCodeAt(R+1)))==56320&&(I=65536+(I-55296<<10)+(S-56320),R++),v+=I<128?1:I<2048?2:I<65536?3:4;for(E=new a.Buf8(v),R=D=0;D<v;R++)(64512&(I=_.charCodeAt(R)))==55296&&R+1<T&&(64512&(S=_.charCodeAt(R+1)))==56320&&(I=65536+(I-55296<<10)+(S-56320),R++),I<128?E[D++]=I:(I<2048?E[D++]=192|I>>>6:(I<65536?E[D++]=224|I>>>12:(E[D++]=240|I>>>18,E[D++]=128|I>>>12&63),E[D++]=128|I>>>6&63),E[D++]=128|63&I);return E},s.buf2binstring=function(_){return y(_,_.length)},s.binstring2buf=function(_){for(var E=new a.Buf8(_.length),I=0,S=E.length;I<S;I++)E[I]=_.charCodeAt(I);return E},s.buf2string=function(_,E){var I,S,R,D,T=E||_.length,v=new Array(2*T);for(I=S=0;I<T;)if((R=_[I++])<128)v[S++]=R;else if(4<(D=c[R]))v[S++]=65533,I+=D-1;else{for(R&=D===2?31:D===3?15:7;1<D&&I<T;)R=R<<6|63&_[I++],D--;1<D?v[S++]=65533:R<65536?v[S++]=R:(R-=65536,v[S++]=55296|R>>10&1023,v[S++]=56320|1023&R)}return y(v,S)},s.utf8border=function(_,E){var I;for((E=E||_.length)>_.length&&(E=_.length),I=E-1;0<=I&&(192&_[I])==128;)I--;return I<0||I===0?E:I+c[_[I]]>E?I:E}},{"./common":41}],43:[function(e,n,s){n.exports=function(a,l,u,c){for(var p=65535&a|0,y=a>>>16&65535|0,_=0;u!==0;){for(u-=_=2e3<u?2e3:u;y=y+(p=p+l[c++]|0)|0,--_;);p%=65521,y%=65521}return p|y<<16|0}},{}],44:[function(e,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,n,s){var a=function(){for(var l,u=[],c=0;c<256;c++){l=c;for(var p=0;p<8;p++)l=1&l?3988292384^l>>>1:l>>>1;u[c]=l}return u}();n.exports=function(l,u,c,p){var y=a,_=p+c;l^=-1;for(var E=p;E<_;E++)l=l>>>8^y[255&(l^u[E])];return-1^l}},{}],46:[function(e,n,s){var a,l=e("../utils/common"),u=e("./trees"),c=e("./adler32"),p=e("./crc32"),y=e("./messages"),_=0,E=4,I=0,S=-2,R=-1,D=4,T=2,v=8,k=9,X=286,H=30,K=19,z=2*X+1,q=15,V=3,nt=258,ot=nt+V+1,j=42,tt=113,N=1,Z=2,ft=3,rt=4;function At(F,St){return F.msg=y[St],St}function bt(F){return(F<<1)-(4<F?9:0)}function Dt(F){for(var St=F.length;0<=--St;)F[St]=0}function ct(F){var St=F.state,Et=St.pending;Et>F.avail_out&&(Et=F.avail_out),Et!==0&&(l.arraySet(F.output,St.pending_buf,St.pending_out,Et,F.next_out),F.next_out+=Et,St.pending_out+=Et,F.total_out+=Et,F.avail_out-=Et,St.pending-=Et,St.pending===0&&(St.pending_out=0))}function at(F,St){u._tr_flush_block(F,0<=F.block_start?F.block_start:-1,F.strstart-F.block_start,St),F.block_start=F.strstart,ct(F.strm)}function Pt(F,St){F.pending_buf[F.pending++]=St}function mt(F,St){F.pending_buf[F.pending++]=St>>>8&255,F.pending_buf[F.pending++]=255&St}function Lt(F,St){var Et,et,$=F.max_chain_length,lt=F.strstart,vt=F.prev_length,gt=F.nice_match,pt=F.strstart>F.w_size-ot?F.strstart-(F.w_size-ot):0,kt=F.window,Ht=F.w_mask,Ft=F.prev,qt=F.strstart+nt,ve=kt[lt+vt-1],re=kt[lt+vt];F.prev_length>=F.good_match&&($>>=2),gt>F.lookahead&&(gt=F.lookahead);do if(kt[(Et=St)+vt]===re&&kt[Et+vt-1]===ve&&kt[Et]===kt[lt]&&kt[++Et]===kt[lt+1]){lt+=2,Et++;do;while(kt[++lt]===kt[++Et]&&kt[++lt]===kt[++Et]&&kt[++lt]===kt[++Et]&&kt[++lt]===kt[++Et]&&kt[++lt]===kt[++Et]&&kt[++lt]===kt[++Et]&&kt[++lt]===kt[++Et]&&kt[++lt]===kt[++Et]&&lt<qt);if(et=nt-(qt-lt),lt=qt-nt,vt<et){if(F.match_start=St,gt<=(vt=et))break;ve=kt[lt+vt-1],re=kt[lt+vt]}}while((St=Ft[St&Ht])>pt&&--$!=0);return vt<=F.lookahead?vt:F.lookahead}function Vt(F){var St,Et,et,$,lt,vt,gt,pt,kt,Ht,Ft=F.w_size;do{if($=F.window_size-F.lookahead-F.strstart,F.strstart>=Ft+(Ft-ot)){for(l.arraySet(F.window,F.window,Ft,Ft,0),F.match_start-=Ft,F.strstart-=Ft,F.block_start-=Ft,St=Et=F.hash_size;et=F.head[--St],F.head[St]=Ft<=et?et-Ft:0,--Et;);for(St=Et=Ft;et=F.prev[--St],F.prev[St]=Ft<=et?et-Ft:0,--Et;);$+=Ft}if(F.strm.avail_in===0)break;if(vt=F.strm,gt=F.window,pt=F.strstart+F.lookahead,kt=$,Ht=void 0,Ht=vt.avail_in,kt<Ht&&(Ht=kt),Et=Ht===0?0:(vt.avail_in-=Ht,l.arraySet(gt,vt.input,vt.next_in,Ht,pt),vt.state.wrap===1?vt.adler=c(vt.adler,gt,Ht,pt):vt.state.wrap===2&&(vt.adler=p(vt.adler,gt,Ht,pt)),vt.next_in+=Ht,vt.total_in+=Ht,Ht),F.lookahead+=Et,F.lookahead+F.insert>=V)for(lt=F.strstart-F.insert,F.ins_h=F.window[lt],F.ins_h=(F.ins_h<<F.hash_shift^F.window[lt+1])&F.hash_mask;F.insert&&(F.ins_h=(F.ins_h<<F.hash_shift^F.window[lt+V-1])&F.hash_mask,F.prev[lt&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=lt,lt++,F.insert--,!(F.lookahead+F.insert<V)););}while(F.lookahead<ot&&F.strm.avail_in!==0)}function Ee(F,St){for(var Et,et;;){if(F.lookahead<ot){if(Vt(F),F.lookahead<ot&&St===_)return N;if(F.lookahead===0)break}if(Et=0,F.lookahead>=V&&(F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+V-1])&F.hash_mask,Et=F.prev[F.strstart&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=F.strstart),Et!==0&&F.strstart-Et<=F.w_size-ot&&(F.match_length=Lt(F,Et)),F.match_length>=V)if(et=u._tr_tally(F,F.strstart-F.match_start,F.match_length-V),F.lookahead-=F.match_length,F.match_length<=F.max_lazy_match&&F.lookahead>=V){for(F.match_length--;F.strstart++,F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+V-1])&F.hash_mask,Et=F.prev[F.strstart&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=F.strstart,--F.match_length!=0;);F.strstart++}else F.strstart+=F.match_length,F.match_length=0,F.ins_h=F.window[F.strstart],F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+1])&F.hash_mask;else et=u._tr_tally(F,0,F.window[F.strstart]),F.lookahead--,F.strstart++;if(et&&(at(F,!1),F.strm.avail_out===0))return N}return F.insert=F.strstart<V-1?F.strstart:V-1,St===E?(at(F,!0),F.strm.avail_out===0?ft:rt):F.last_lit&&(at(F,!1),F.strm.avail_out===0)?N:Z}function te(F,St){for(var Et,et,$;;){if(F.lookahead<ot){if(Vt(F),F.lookahead<ot&&St===_)return N;if(F.lookahead===0)break}if(Et=0,F.lookahead>=V&&(F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+V-1])&F.hash_mask,Et=F.prev[F.strstart&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=F.strstart),F.prev_length=F.match_length,F.prev_match=F.match_start,F.match_length=V-1,Et!==0&&F.prev_length<F.max_lazy_match&&F.strstart-Et<=F.w_size-ot&&(F.match_length=Lt(F,Et),F.match_length<=5&&(F.strategy===1||F.match_length===V&&4096<F.strstart-F.match_start)&&(F.match_length=V-1)),F.prev_length>=V&&F.match_length<=F.prev_length){for($=F.strstart+F.lookahead-V,et=u._tr_tally(F,F.strstart-1-F.prev_match,F.prev_length-V),F.lookahead-=F.prev_length-1,F.prev_length-=2;++F.strstart<=$&&(F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+V-1])&F.hash_mask,Et=F.prev[F.strstart&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=F.strstart),--F.prev_length!=0;);if(F.match_available=0,F.match_length=V-1,F.strstart++,et&&(at(F,!1),F.strm.avail_out===0))return N}else if(F.match_available){if((et=u._tr_tally(F,0,F.window[F.strstart-1]))&&at(F,!1),F.strstart++,F.lookahead--,F.strm.avail_out===0)return N}else F.match_available=1,F.strstart++,F.lookahead--}return F.match_available&&(et=u._tr_tally(F,0,F.window[F.strstart-1]),F.match_available=0),F.insert=F.strstart<V-1?F.strstart:V-1,St===E?(at(F,!0),F.strm.avail_out===0?ft:rt):F.last_lit&&(at(F,!1),F.strm.avail_out===0)?N:Z}function me(F,St,Et,et,$){this.good_length=F,this.max_lazy=St,this.nice_length=Et,this.max_chain=et,this.func=$}function Ie(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*z),this.dyn_dtree=new l.Buf16(2*(2*H+1)),this.bl_tree=new l.Buf16(2*(2*K+1)),Dt(this.dyn_ltree),Dt(this.dyn_dtree),Dt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(q+1),this.heap=new l.Buf16(2*X+1),Dt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*X+1),Dt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ce(F){var St;return F&&F.state?(F.total_in=F.total_out=0,F.data_type=T,(St=F.state).pending=0,St.pending_out=0,St.wrap<0&&(St.wrap=-St.wrap),St.status=St.wrap?j:tt,F.adler=St.wrap===2?0:1,St.last_flush=_,u._tr_init(St),I):At(F,S)}function Ge(F){var St=Ce(F);return St===I&&function(Et){Et.window_size=2*Et.w_size,Dt(Et.head),Et.max_lazy_match=a[Et.level].max_lazy,Et.good_match=a[Et.level].good_length,Et.nice_match=a[Et.level].nice_length,Et.max_chain_length=a[Et.level].max_chain,Et.strstart=0,Et.block_start=0,Et.lookahead=0,Et.insert=0,Et.match_length=Et.prev_length=V-1,Et.match_available=0,Et.ins_h=0}(F.state),St}function de(F,St,Et,et,$,lt){if(!F)return S;var vt=1;if(St===R&&(St=6),et<0?(vt=0,et=-et):15<et&&(vt=2,et-=16),$<1||k<$||Et!==v||et<8||15<et||St<0||9<St||lt<0||D<lt)return At(F,S);et===8&&(et=9);var gt=new Ie;return(F.state=gt).strm=F,gt.wrap=vt,gt.gzhead=null,gt.w_bits=et,gt.w_size=1<<gt.w_bits,gt.w_mask=gt.w_size-1,gt.hash_bits=$+7,gt.hash_size=1<<gt.hash_bits,gt.hash_mask=gt.hash_size-1,gt.hash_shift=~~((gt.hash_bits+V-1)/V),gt.window=new l.Buf8(2*gt.w_size),gt.head=new l.Buf16(gt.hash_size),gt.prev=new l.Buf16(gt.w_size),gt.lit_bufsize=1<<$+6,gt.pending_buf_size=4*gt.lit_bufsize,gt.pending_buf=new l.Buf8(gt.pending_buf_size),gt.d_buf=1*gt.lit_bufsize,gt.l_buf=3*gt.lit_bufsize,gt.level=St,gt.strategy=lt,gt.method=Et,Ge(F)}a=[new me(0,0,0,0,function(F,St){var Et=65535;for(Et>F.pending_buf_size-5&&(Et=F.pending_buf_size-5);;){if(F.lookahead<=1){if(Vt(F),F.lookahead===0&&St===_)return N;if(F.lookahead===0)break}F.strstart+=F.lookahead,F.lookahead=0;var et=F.block_start+Et;if((F.strstart===0||F.strstart>=et)&&(F.lookahead=F.strstart-et,F.strstart=et,at(F,!1),F.strm.avail_out===0)||F.strstart-F.block_start>=F.w_size-ot&&(at(F,!1),F.strm.avail_out===0))return N}return F.insert=0,St===E?(at(F,!0),F.strm.avail_out===0?ft:rt):(F.strstart>F.block_start&&(at(F,!1),F.strm.avail_out),N)}),new me(4,4,8,4,Ee),new me(4,5,16,8,Ee),new me(4,6,32,32,Ee),new me(4,4,16,16,te),new me(8,16,32,32,te),new me(8,16,128,128,te),new me(8,32,128,256,te),new me(32,128,258,1024,te),new me(32,258,258,4096,te)],s.deflateInit=function(F,St){return de(F,St,v,15,8,0)},s.deflateInit2=de,s.deflateReset=Ge,s.deflateResetKeep=Ce,s.deflateSetHeader=function(F,St){return F&&F.state?F.state.wrap!==2?S:(F.state.gzhead=St,I):S},s.deflate=function(F,St){var Et,et,$,lt;if(!F||!F.state||5<St||St<0)return F?At(F,S):S;if(et=F.state,!F.output||!F.input&&F.avail_in!==0||et.status===666&&St!==E)return At(F,F.avail_out===0?-5:S);if(et.strm=F,Et=et.last_flush,et.last_flush=St,et.status===j)if(et.wrap===2)F.adler=0,Pt(et,31),Pt(et,139),Pt(et,8),et.gzhead?(Pt(et,(et.gzhead.text?1:0)+(et.gzhead.hcrc?2:0)+(et.gzhead.extra?4:0)+(et.gzhead.name?8:0)+(et.gzhead.comment?16:0)),Pt(et,255&et.gzhead.time),Pt(et,et.gzhead.time>>8&255),Pt(et,et.gzhead.time>>16&255),Pt(et,et.gzhead.time>>24&255),Pt(et,et.level===9?2:2<=et.strategy||et.level<2?4:0),Pt(et,255&et.gzhead.os),et.gzhead.extra&&et.gzhead.extra.length&&(Pt(et,255&et.gzhead.extra.length),Pt(et,et.gzhead.extra.length>>8&255)),et.gzhead.hcrc&&(F.adler=p(F.adler,et.pending_buf,et.pending,0)),et.gzindex=0,et.status=69):(Pt(et,0),Pt(et,0),Pt(et,0),Pt(et,0),Pt(et,0),Pt(et,et.level===9?2:2<=et.strategy||et.level<2?4:0),Pt(et,3),et.status=tt);else{var vt=v+(et.w_bits-8<<4)<<8;vt|=(2<=et.strategy||et.level<2?0:et.level<6?1:et.level===6?2:3)<<6,et.strstart!==0&&(vt|=32),vt+=31-vt%31,et.status=tt,mt(et,vt),et.strstart!==0&&(mt(et,F.adler>>>16),mt(et,65535&F.adler)),F.adler=1}if(et.status===69)if(et.gzhead.extra){for($=et.pending;et.gzindex<(65535&et.gzhead.extra.length)&&(et.pending!==et.pending_buf_size||(et.gzhead.hcrc&&et.pending>$&&(F.adler=p(F.adler,et.pending_buf,et.pending-$,$)),ct(F),$=et.pending,et.pending!==et.pending_buf_size));)Pt(et,255&et.gzhead.extra[et.gzindex]),et.gzindex++;et.gzhead.hcrc&&et.pending>$&&(F.adler=p(F.adler,et.pending_buf,et.pending-$,$)),et.gzindex===et.gzhead.extra.length&&(et.gzindex=0,et.status=73)}else et.status=73;if(et.status===73)if(et.gzhead.name){$=et.pending;do{if(et.pending===et.pending_buf_size&&(et.gzhead.hcrc&&et.pending>$&&(F.adler=p(F.adler,et.pending_buf,et.pending-$,$)),ct(F),$=et.pending,et.pending===et.pending_buf_size)){lt=1;break}lt=et.gzindex<et.gzhead.name.length?255&et.gzhead.name.charCodeAt(et.gzindex++):0,Pt(et,lt)}while(lt!==0);et.gzhead.hcrc&&et.pending>$&&(F.adler=p(F.adler,et.pending_buf,et.pending-$,$)),lt===0&&(et.gzindex=0,et.status=91)}else et.status=91;if(et.status===91)if(et.gzhead.comment){$=et.pending;do{if(et.pending===et.pending_buf_size&&(et.gzhead.hcrc&&et.pending>$&&(F.adler=p(F.adler,et.pending_buf,et.pending-$,$)),ct(F),$=et.pending,et.pending===et.pending_buf_size)){lt=1;break}lt=et.gzindex<et.gzhead.comment.length?255&et.gzhead.comment.charCodeAt(et.gzindex++):0,Pt(et,lt)}while(lt!==0);et.gzhead.hcrc&&et.pending>$&&(F.adler=p(F.adler,et.pending_buf,et.pending-$,$)),lt===0&&(et.status=103)}else et.status=103;if(et.status===103&&(et.gzhead.hcrc?(et.pending+2>et.pending_buf_size&&ct(F),et.pending+2<=et.pending_buf_size&&(Pt(et,255&F.adler),Pt(et,F.adler>>8&255),F.adler=0,et.status=tt)):et.status=tt),et.pending!==0){if(ct(F),F.avail_out===0)return et.last_flush=-1,I}else if(F.avail_in===0&&bt(St)<=bt(Et)&&St!==E)return At(F,-5);if(et.status===666&&F.avail_in!==0)return At(F,-5);if(F.avail_in!==0||et.lookahead!==0||St!==_&&et.status!==666){var gt=et.strategy===2?function(pt,kt){for(var Ht;;){if(pt.lookahead===0&&(Vt(pt),pt.lookahead===0)){if(kt===_)return N;break}if(pt.match_length=0,Ht=u._tr_tally(pt,0,pt.window[pt.strstart]),pt.lookahead--,pt.strstart++,Ht&&(at(pt,!1),pt.strm.avail_out===0))return N}return pt.insert=0,kt===E?(at(pt,!0),pt.strm.avail_out===0?ft:rt):pt.last_lit&&(at(pt,!1),pt.strm.avail_out===0)?N:Z}(et,St):et.strategy===3?function(pt,kt){for(var Ht,Ft,qt,ve,re=pt.window;;){if(pt.lookahead<=nt){if(Vt(pt),pt.lookahead<=nt&&kt===_)return N;if(pt.lookahead===0)break}if(pt.match_length=0,pt.lookahead>=V&&0<pt.strstart&&(Ft=re[qt=pt.strstart-1])===re[++qt]&&Ft===re[++qt]&&Ft===re[++qt]){ve=pt.strstart+nt;do;while(Ft===re[++qt]&&Ft===re[++qt]&&Ft===re[++qt]&&Ft===re[++qt]&&Ft===re[++qt]&&Ft===re[++qt]&&Ft===re[++qt]&&Ft===re[++qt]&&qt<ve);pt.match_length=nt-(ve-qt),pt.match_length>pt.lookahead&&(pt.match_length=pt.lookahead)}if(pt.match_length>=V?(Ht=u._tr_tally(pt,1,pt.match_length-V),pt.lookahead-=pt.match_length,pt.strstart+=pt.match_length,pt.match_length=0):(Ht=u._tr_tally(pt,0,pt.window[pt.strstart]),pt.lookahead--,pt.strstart++),Ht&&(at(pt,!1),pt.strm.avail_out===0))return N}return pt.insert=0,kt===E?(at(pt,!0),pt.strm.avail_out===0?ft:rt):pt.last_lit&&(at(pt,!1),pt.strm.avail_out===0)?N:Z}(et,St):a[et.level].func(et,St);if(gt!==ft&&gt!==rt||(et.status=666),gt===N||gt===ft)return F.avail_out===0&&(et.last_flush=-1),I;if(gt===Z&&(St===1?u._tr_align(et):St!==5&&(u._tr_stored_block(et,0,0,!1),St===3&&(Dt(et.head),et.lookahead===0&&(et.strstart=0,et.block_start=0,et.insert=0))),ct(F),F.avail_out===0))return et.last_flush=-1,I}return St!==E?I:et.wrap<=0?1:(et.wrap===2?(Pt(et,255&F.adler),Pt(et,F.adler>>8&255),Pt(et,F.adler>>16&255),Pt(et,F.adler>>24&255),Pt(et,255&F.total_in),Pt(et,F.total_in>>8&255),Pt(et,F.total_in>>16&255),Pt(et,F.total_in>>24&255)):(mt(et,F.adler>>>16),mt(et,65535&F.adler)),ct(F),0<et.wrap&&(et.wrap=-et.wrap),et.pending!==0?I:1)},s.deflateEnd=function(F){var St;return F&&F.state?(St=F.state.status)!==j&&St!==69&&St!==73&&St!==91&&St!==103&&St!==tt&&St!==666?At(F,S):(F.state=null,St===tt?At(F,-3):I):S},s.deflateSetDictionary=function(F,St){var Et,et,$,lt,vt,gt,pt,kt,Ht=St.length;if(!F||!F.state||(lt=(Et=F.state).wrap)===2||lt===1&&Et.status!==j||Et.lookahead)return S;for(lt===1&&(F.adler=c(F.adler,St,Ht,0)),Et.wrap=0,Ht>=Et.w_size&&(lt===0&&(Dt(Et.head),Et.strstart=0,Et.block_start=0,Et.insert=0),kt=new l.Buf8(Et.w_size),l.arraySet(kt,St,Ht-Et.w_size,Et.w_size,0),St=kt,Ht=Et.w_size),vt=F.avail_in,gt=F.next_in,pt=F.input,F.avail_in=Ht,F.next_in=0,F.input=St,Vt(Et);Et.lookahead>=V;){for(et=Et.strstart,$=Et.lookahead-(V-1);Et.ins_h=(Et.ins_h<<Et.hash_shift^Et.window[et+V-1])&Et.hash_mask,Et.prev[et&Et.w_mask]=Et.head[Et.ins_h],Et.head[Et.ins_h]=et,et++,--$;);Et.strstart=et,Et.lookahead=V-1,Vt(Et)}return Et.strstart+=Et.lookahead,Et.block_start=Et.strstart,Et.insert=Et.lookahead,Et.lookahead=0,Et.match_length=Et.prev_length=V-1,Et.match_available=0,F.next_in=gt,F.input=pt,F.avail_in=vt,Et.wrap=lt,I},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,n,s){n.exports=function(a,l){var u,c,p,y,_,E,I,S,R,D,T,v,k,X,H,K,z,q,V,nt,ot,j,tt,N,Z;u=a.state,c=a.next_in,N=a.input,p=c+(a.avail_in-5),y=a.next_out,Z=a.output,_=y-(l-a.avail_out),E=y+(a.avail_out-257),I=u.dmax,S=u.wsize,R=u.whave,D=u.wnext,T=u.window,v=u.hold,k=u.bits,X=u.lencode,H=u.distcode,K=(1<<u.lenbits)-1,z=(1<<u.distbits)-1;t:do{k<15&&(v+=N[c++]<<k,k+=8,v+=N[c++]<<k,k+=8),q=X[v&K];e:for(;;){if(v>>>=V=q>>>24,k-=V,(V=q>>>16&255)===0)Z[y++]=65535&q;else{if(!(16&V)){if(!(64&V)){q=X[(65535&q)+(v&(1<<V)-1)];continue e}if(32&V){u.mode=12;break t}a.msg="invalid literal/length code",u.mode=30;break t}nt=65535&q,(V&=15)&&(k<V&&(v+=N[c++]<<k,k+=8),nt+=v&(1<<V)-1,v>>>=V,k-=V),k<15&&(v+=N[c++]<<k,k+=8,v+=N[c++]<<k,k+=8),q=H[v&z];i:for(;;){if(v>>>=V=q>>>24,k-=V,!(16&(V=q>>>16&255))){if(!(64&V)){q=H[(65535&q)+(v&(1<<V)-1)];continue i}a.msg="invalid distance code",u.mode=30;break t}if(ot=65535&q,k<(V&=15)&&(v+=N[c++]<<k,(k+=8)<V&&(v+=N[c++]<<k,k+=8)),I<(ot+=v&(1<<V)-1)){a.msg="invalid distance too far back",u.mode=30;break t}if(v>>>=V,k-=V,(V=y-_)<ot){if(R<(V=ot-V)&&u.sane){a.msg="invalid distance too far back",u.mode=30;break t}if(tt=T,(j=0)===D){if(j+=S-V,V<nt){for(nt-=V;Z[y++]=T[j++],--V;);j=y-ot,tt=Z}}else if(D<V){if(j+=S+D-V,(V-=D)<nt){for(nt-=V;Z[y++]=T[j++],--V;);if(j=0,D<nt){for(nt-=V=D;Z[y++]=T[j++],--V;);j=y-ot,tt=Z}}}else if(j+=D-V,V<nt){for(nt-=V;Z[y++]=T[j++],--V;);j=y-ot,tt=Z}for(;2<nt;)Z[y++]=tt[j++],Z[y++]=tt[j++],Z[y++]=tt[j++],nt-=3;nt&&(Z[y++]=tt[j++],1<nt&&(Z[y++]=tt[j++]))}else{for(j=y-ot;Z[y++]=Z[j++],Z[y++]=Z[j++],Z[y++]=Z[j++],2<(nt-=3););nt&&(Z[y++]=Z[j++],1<nt&&(Z[y++]=Z[j++]))}break}}break}}while(c<p&&y<E);c-=nt=k>>3,v&=(1<<(k-=nt<<3))-1,a.next_in=c,a.next_out=y,a.avail_in=c<p?p-c+5:5-(c-p),a.avail_out=y<E?E-y+257:257-(y-E),u.hold=v,u.bits=k}},{}],49:[function(e,n,s){var a=e("../utils/common"),l=e("./adler32"),u=e("./crc32"),c=e("./inffast"),p=e("./inftrees"),y=1,_=2,E=0,I=-2,S=1,R=852,D=592;function T(j){return(j>>>24&255)+(j>>>8&65280)+((65280&j)<<8)+((255&j)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(j){var tt;return j&&j.state?(tt=j.state,j.total_in=j.total_out=tt.total=0,j.msg="",tt.wrap&&(j.adler=1&tt.wrap),tt.mode=S,tt.last=0,tt.havedict=0,tt.dmax=32768,tt.head=null,tt.hold=0,tt.bits=0,tt.lencode=tt.lendyn=new a.Buf32(R),tt.distcode=tt.distdyn=new a.Buf32(D),tt.sane=1,tt.back=-1,E):I}function X(j){var tt;return j&&j.state?((tt=j.state).wsize=0,tt.whave=0,tt.wnext=0,k(j)):I}function H(j,tt){var N,Z;return j&&j.state?(Z=j.state,tt<0?(N=0,tt=-tt):(N=1+(tt>>4),tt<48&&(tt&=15)),tt&&(tt<8||15<tt)?I:(Z.window!==null&&Z.wbits!==tt&&(Z.window=null),Z.wrap=N,Z.wbits=tt,X(j))):I}function K(j,tt){var N,Z;return j?(Z=new v,(j.state=Z).window=null,(N=H(j,tt))!==E&&(j.state=null),N):I}var z,q,V=!0;function nt(j){if(V){var tt;for(z=new a.Buf32(512),q=new a.Buf32(32),tt=0;tt<144;)j.lens[tt++]=8;for(;tt<256;)j.lens[tt++]=9;for(;tt<280;)j.lens[tt++]=7;for(;tt<288;)j.lens[tt++]=8;for(p(y,j.lens,0,288,z,0,j.work,{bits:9}),tt=0;tt<32;)j.lens[tt++]=5;p(_,j.lens,0,32,q,0,j.work,{bits:5}),V=!1}j.lencode=z,j.lenbits=9,j.distcode=q,j.distbits=5}function ot(j,tt,N,Z){var ft,rt=j.state;return rt.window===null&&(rt.wsize=1<<rt.wbits,rt.wnext=0,rt.whave=0,rt.window=new a.Buf8(rt.wsize)),Z>=rt.wsize?(a.arraySet(rt.window,tt,N-rt.wsize,rt.wsize,0),rt.wnext=0,rt.whave=rt.wsize):(Z<(ft=rt.wsize-rt.wnext)&&(ft=Z),a.arraySet(rt.window,tt,N-Z,ft,rt.wnext),(Z-=ft)?(a.arraySet(rt.window,tt,N-Z,Z,0),rt.wnext=Z,rt.whave=rt.wsize):(rt.wnext+=ft,rt.wnext===rt.wsize&&(rt.wnext=0),rt.whave<rt.wsize&&(rt.whave+=ft))),0}s.inflateReset=X,s.inflateReset2=H,s.inflateResetKeep=k,s.inflateInit=function(j){return K(j,15)},s.inflateInit2=K,s.inflate=function(j,tt){var N,Z,ft,rt,At,bt,Dt,ct,at,Pt,mt,Lt,Vt,Ee,te,me,Ie,Ce,Ge,de,F,St,Et,et,$=0,lt=new a.Buf8(4),vt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!j||!j.state||!j.output||!j.input&&j.avail_in!==0)return I;(N=j.state).mode===12&&(N.mode=13),At=j.next_out,ft=j.output,Dt=j.avail_out,rt=j.next_in,Z=j.input,bt=j.avail_in,ct=N.hold,at=N.bits,Pt=bt,mt=Dt,St=E;t:for(;;)switch(N.mode){case S:if(N.wrap===0){N.mode=13;break}for(;at<16;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if(2&N.wrap&&ct===35615){lt[N.check=0]=255&ct,lt[1]=ct>>>8&255,N.check=u(N.check,lt,2,0),at=ct=0,N.mode=2;break}if(N.flags=0,N.head&&(N.head.done=!1),!(1&N.wrap)||(((255&ct)<<8)+(ct>>8))%31){j.msg="incorrect header check",N.mode=30;break}if((15&ct)!=8){j.msg="unknown compression method",N.mode=30;break}if(at-=4,F=8+(15&(ct>>>=4)),N.wbits===0)N.wbits=F;else if(F>N.wbits){j.msg="invalid window size",N.mode=30;break}N.dmax=1<<F,j.adler=N.check=1,N.mode=512&ct?10:12,at=ct=0;break;case 2:for(;at<16;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if(N.flags=ct,(255&N.flags)!=8){j.msg="unknown compression method",N.mode=30;break}if(57344&N.flags){j.msg="unknown header flags set",N.mode=30;break}N.head&&(N.head.text=ct>>8&1),512&N.flags&&(lt[0]=255&ct,lt[1]=ct>>>8&255,N.check=u(N.check,lt,2,0)),at=ct=0,N.mode=3;case 3:for(;at<32;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}N.head&&(N.head.time=ct),512&N.flags&&(lt[0]=255&ct,lt[1]=ct>>>8&255,lt[2]=ct>>>16&255,lt[3]=ct>>>24&255,N.check=u(N.check,lt,4,0)),at=ct=0,N.mode=4;case 4:for(;at<16;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}N.head&&(N.head.xflags=255&ct,N.head.os=ct>>8),512&N.flags&&(lt[0]=255&ct,lt[1]=ct>>>8&255,N.check=u(N.check,lt,2,0)),at=ct=0,N.mode=5;case 5:if(1024&N.flags){for(;at<16;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}N.length=ct,N.head&&(N.head.extra_len=ct),512&N.flags&&(lt[0]=255&ct,lt[1]=ct>>>8&255,N.check=u(N.check,lt,2,0)),at=ct=0}else N.head&&(N.head.extra=null);N.mode=6;case 6:if(1024&N.flags&&(bt<(Lt=N.length)&&(Lt=bt),Lt&&(N.head&&(F=N.head.extra_len-N.length,N.head.extra||(N.head.extra=new Array(N.head.extra_len)),a.arraySet(N.head.extra,Z,rt,Lt,F)),512&N.flags&&(N.check=u(N.check,Z,Lt,rt)),bt-=Lt,rt+=Lt,N.length-=Lt),N.length))break t;N.length=0,N.mode=7;case 7:if(2048&N.flags){if(bt===0)break t;for(Lt=0;F=Z[rt+Lt++],N.head&&F&&N.length<65536&&(N.head.name+=String.fromCharCode(F)),F&&Lt<bt;);if(512&N.flags&&(N.check=u(N.check,Z,Lt,rt)),bt-=Lt,rt+=Lt,F)break t}else N.head&&(N.head.name=null);N.length=0,N.mode=8;case 8:if(4096&N.flags){if(bt===0)break t;for(Lt=0;F=Z[rt+Lt++],N.head&&F&&N.length<65536&&(N.head.comment+=String.fromCharCode(F)),F&&Lt<bt;);if(512&N.flags&&(N.check=u(N.check,Z,Lt,rt)),bt-=Lt,rt+=Lt,F)break t}else N.head&&(N.head.comment=null);N.mode=9;case 9:if(512&N.flags){for(;at<16;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if(ct!==(65535&N.check)){j.msg="header crc mismatch",N.mode=30;break}at=ct=0}N.head&&(N.head.hcrc=N.flags>>9&1,N.head.done=!0),j.adler=N.check=0,N.mode=12;break;case 10:for(;at<32;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}j.adler=N.check=T(ct),at=ct=0,N.mode=11;case 11:if(N.havedict===0)return j.next_out=At,j.avail_out=Dt,j.next_in=rt,j.avail_in=bt,N.hold=ct,N.bits=at,2;j.adler=N.check=1,N.mode=12;case 12:if(tt===5||tt===6)break t;case 13:if(N.last){ct>>>=7&at,at-=7&at,N.mode=27;break}for(;at<3;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}switch(N.last=1&ct,at-=1,3&(ct>>>=1)){case 0:N.mode=14;break;case 1:if(nt(N),N.mode=20,tt!==6)break;ct>>>=2,at-=2;break t;case 2:N.mode=17;break;case 3:j.msg="invalid block type",N.mode=30}ct>>>=2,at-=2;break;case 14:for(ct>>>=7&at,at-=7&at;at<32;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if((65535&ct)!=(ct>>>16^65535)){j.msg="invalid stored block lengths",N.mode=30;break}if(N.length=65535&ct,at=ct=0,N.mode=15,tt===6)break t;case 15:N.mode=16;case 16:if(Lt=N.length){if(bt<Lt&&(Lt=bt),Dt<Lt&&(Lt=Dt),Lt===0)break t;a.arraySet(ft,Z,rt,Lt,At),bt-=Lt,rt+=Lt,Dt-=Lt,At+=Lt,N.length-=Lt;break}N.mode=12;break;case 17:for(;at<14;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if(N.nlen=257+(31&ct),ct>>>=5,at-=5,N.ndist=1+(31&ct),ct>>>=5,at-=5,N.ncode=4+(15&ct),ct>>>=4,at-=4,286<N.nlen||30<N.ndist){j.msg="too many length or distance symbols",N.mode=30;break}N.have=0,N.mode=18;case 18:for(;N.have<N.ncode;){for(;at<3;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}N.lens[vt[N.have++]]=7&ct,ct>>>=3,at-=3}for(;N.have<19;)N.lens[vt[N.have++]]=0;if(N.lencode=N.lendyn,N.lenbits=7,Et={bits:N.lenbits},St=p(0,N.lens,0,19,N.lencode,0,N.work,Et),N.lenbits=Et.bits,St){j.msg="invalid code lengths set",N.mode=30;break}N.have=0,N.mode=19;case 19:for(;N.have<N.nlen+N.ndist;){for(;me=($=N.lencode[ct&(1<<N.lenbits)-1])>>>16&255,Ie=65535&$,!((te=$>>>24)<=at);){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if(Ie<16)ct>>>=te,at-=te,N.lens[N.have++]=Ie;else{if(Ie===16){for(et=te+2;at<et;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if(ct>>>=te,at-=te,N.have===0){j.msg="invalid bit length repeat",N.mode=30;break}F=N.lens[N.have-1],Lt=3+(3&ct),ct>>>=2,at-=2}else if(Ie===17){for(et=te+3;at<et;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}at-=te,F=0,Lt=3+(7&(ct>>>=te)),ct>>>=3,at-=3}else{for(et=te+7;at<et;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}at-=te,F=0,Lt=11+(127&(ct>>>=te)),ct>>>=7,at-=7}if(N.have+Lt>N.nlen+N.ndist){j.msg="invalid bit length repeat",N.mode=30;break}for(;Lt--;)N.lens[N.have++]=F}}if(N.mode===30)break;if(N.lens[256]===0){j.msg="invalid code -- missing end-of-block",N.mode=30;break}if(N.lenbits=9,Et={bits:N.lenbits},St=p(y,N.lens,0,N.nlen,N.lencode,0,N.work,Et),N.lenbits=Et.bits,St){j.msg="invalid literal/lengths set",N.mode=30;break}if(N.distbits=6,N.distcode=N.distdyn,Et={bits:N.distbits},St=p(_,N.lens,N.nlen,N.ndist,N.distcode,0,N.work,Et),N.distbits=Et.bits,St){j.msg="invalid distances set",N.mode=30;break}if(N.mode=20,tt===6)break t;case 20:N.mode=21;case 21:if(6<=bt&&258<=Dt){j.next_out=At,j.avail_out=Dt,j.next_in=rt,j.avail_in=bt,N.hold=ct,N.bits=at,c(j,mt),At=j.next_out,ft=j.output,Dt=j.avail_out,rt=j.next_in,Z=j.input,bt=j.avail_in,ct=N.hold,at=N.bits,N.mode===12&&(N.back=-1);break}for(N.back=0;me=($=N.lencode[ct&(1<<N.lenbits)-1])>>>16&255,Ie=65535&$,!((te=$>>>24)<=at);){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if(me&&!(240&me)){for(Ce=te,Ge=me,de=Ie;me=($=N.lencode[de+((ct&(1<<Ce+Ge)-1)>>Ce)])>>>16&255,Ie=65535&$,!(Ce+(te=$>>>24)<=at);){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}ct>>>=Ce,at-=Ce,N.back+=Ce}if(ct>>>=te,at-=te,N.back+=te,N.length=Ie,me===0){N.mode=26;break}if(32&me){N.back=-1,N.mode=12;break}if(64&me){j.msg="invalid literal/length code",N.mode=30;break}N.extra=15&me,N.mode=22;case 22:if(N.extra){for(et=N.extra;at<et;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}N.length+=ct&(1<<N.extra)-1,ct>>>=N.extra,at-=N.extra,N.back+=N.extra}N.was=N.length,N.mode=23;case 23:for(;me=($=N.distcode[ct&(1<<N.distbits)-1])>>>16&255,Ie=65535&$,!((te=$>>>24)<=at);){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if(!(240&me)){for(Ce=te,Ge=me,de=Ie;me=($=N.distcode[de+((ct&(1<<Ce+Ge)-1)>>Ce)])>>>16&255,Ie=65535&$,!(Ce+(te=$>>>24)<=at);){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}ct>>>=Ce,at-=Ce,N.back+=Ce}if(ct>>>=te,at-=te,N.back+=te,64&me){j.msg="invalid distance code",N.mode=30;break}N.offset=Ie,N.extra=15&me,N.mode=24;case 24:if(N.extra){for(et=N.extra;at<et;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}N.offset+=ct&(1<<N.extra)-1,ct>>>=N.extra,at-=N.extra,N.back+=N.extra}if(N.offset>N.dmax){j.msg="invalid distance too far back",N.mode=30;break}N.mode=25;case 25:if(Dt===0)break t;if(Lt=mt-Dt,N.offset>Lt){if((Lt=N.offset-Lt)>N.whave&&N.sane){j.msg="invalid distance too far back",N.mode=30;break}Vt=Lt>N.wnext?(Lt-=N.wnext,N.wsize-Lt):N.wnext-Lt,Lt>N.length&&(Lt=N.length),Ee=N.window}else Ee=ft,Vt=At-N.offset,Lt=N.length;for(Dt<Lt&&(Lt=Dt),Dt-=Lt,N.length-=Lt;ft[At++]=Ee[Vt++],--Lt;);N.length===0&&(N.mode=21);break;case 26:if(Dt===0)break t;ft[At++]=N.length,Dt--,N.mode=21;break;case 27:if(N.wrap){for(;at<32;){if(bt===0)break t;bt--,ct|=Z[rt++]<<at,at+=8}if(mt-=Dt,j.total_out+=mt,N.total+=mt,mt&&(j.adler=N.check=N.flags?u(N.check,ft,mt,At-mt):l(N.check,ft,mt,At-mt)),mt=Dt,(N.flags?ct:T(ct))!==N.check){j.msg="incorrect data check",N.mode=30;break}at=ct=0}N.mode=28;case 28:if(N.wrap&&N.flags){for(;at<32;){if(bt===0)break t;bt--,ct+=Z[rt++]<<at,at+=8}if(ct!==(4294967295&N.total)){j.msg="incorrect length check",N.mode=30;break}at=ct=0}N.mode=29;case 29:St=1;break t;case 30:St=-3;break t;case 31:return-4;case 32:default:return I}return j.next_out=At,j.avail_out=Dt,j.next_in=rt,j.avail_in=bt,N.hold=ct,N.bits=at,(N.wsize||mt!==j.avail_out&&N.mode<30&&(N.mode<27||tt!==4))&&ot(j,j.output,j.next_out,mt-j.avail_out)?(N.mode=31,-4):(Pt-=j.avail_in,mt-=j.avail_out,j.total_in+=Pt,j.total_out+=mt,N.total+=mt,N.wrap&&mt&&(j.adler=N.check=N.flags?u(N.check,ft,mt,j.next_out-mt):l(N.check,ft,mt,j.next_out-mt)),j.data_type=N.bits+(N.last?64:0)+(N.mode===12?128:0)+(N.mode===20||N.mode===15?256:0),(Pt==0&&mt===0||tt===4)&&St===E&&(St=-5),St)},s.inflateEnd=function(j){if(!j||!j.state)return I;var tt=j.state;return tt.window&&(tt.window=null),j.state=null,E},s.inflateGetHeader=function(j,tt){var N;return j&&j.state&&2&(N=j.state).wrap?((N.head=tt).done=!1,E):I},s.inflateSetDictionary=function(j,tt){var N,Z=tt.length;return j&&j.state?(N=j.state).wrap!==0&&N.mode!==11?I:N.mode===11&&l(1,tt,Z,0)!==N.check?-3:ot(j,tt,Z,Z)?(N.mode=31,-4):(N.havedict=1,E):I},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,n,s){var a=e("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(y,_,E,I,S,R,D,T){var v,k,X,H,K,z,q,V,nt,ot=T.bits,j=0,tt=0,N=0,Z=0,ft=0,rt=0,At=0,bt=0,Dt=0,ct=0,at=null,Pt=0,mt=new a.Buf16(16),Lt=new a.Buf16(16),Vt=null,Ee=0;for(j=0;j<=15;j++)mt[j]=0;for(tt=0;tt<I;tt++)mt[_[E+tt]]++;for(ft=ot,Z=15;1<=Z&&mt[Z]===0;Z--);if(Z<ft&&(ft=Z),Z===0)return S[R++]=20971520,S[R++]=20971520,T.bits=1,0;for(N=1;N<Z&&mt[N]===0;N++);for(ft<N&&(ft=N),j=bt=1;j<=15;j++)if(bt<<=1,(bt-=mt[j])<0)return-1;if(0<bt&&(y===0||Z!==1))return-1;for(Lt[1]=0,j=1;j<15;j++)Lt[j+1]=Lt[j]+mt[j];for(tt=0;tt<I;tt++)_[E+tt]!==0&&(D[Lt[_[E+tt]]++]=tt);if(z=y===0?(at=Vt=D,19):y===1?(at=l,Pt-=257,Vt=u,Ee-=257,256):(at=c,Vt=p,-1),j=N,K=R,At=tt=ct=0,X=-1,H=(Dt=1<<(rt=ft))-1,y===1&&852<Dt||y===2&&592<Dt)return 1;for(;;){for(q=j-At,nt=D[tt]<z?(V=0,D[tt]):D[tt]>z?(V=Vt[Ee+D[tt]],at[Pt+D[tt]]):(V=96,0),v=1<<j-At,N=k=1<<rt;S[K+(ct>>At)+(k-=v)]=q<<24|V<<16|nt|0,k!==0;);for(v=1<<j-1;ct&v;)v>>=1;if(v!==0?(ct&=v-1,ct+=v):ct=0,tt++,--mt[j]==0){if(j===Z)break;j=_[E+D[tt]]}if(ft<j&&(ct&H)!==X){for(At===0&&(At=ft),K+=N,bt=1<<(rt=j-At);rt+At<Z&&!((bt-=mt[rt+At])<=0);)rt++,bt<<=1;if(Dt+=1<<rt,y===1&&852<Dt||y===2&&592<Dt)return 1;S[X=ct&H]=ft<<24|rt<<16|K-R|0}}return ct!==0&&(S[K+ct]=j-At<<24|64<<16|0),T.bits=ft,0}},{"../utils/common":41}],51:[function(e,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,n,s){var a=e("../utils/common"),l=0,u=1;function c($){for(var lt=$.length;0<=--lt;)$[lt]=0}var p=0,y=29,_=256,E=_+1+y,I=30,S=19,R=2*E+1,D=15,T=16,v=7,k=256,X=16,H=17,K=18,z=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],V=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],nt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ot=new Array(2*(E+2));c(ot);var j=new Array(2*I);c(j);var tt=new Array(512);c(tt);var N=new Array(256);c(N);var Z=new Array(y);c(Z);var ft,rt,At,bt=new Array(I);function Dt($,lt,vt,gt,pt){this.static_tree=$,this.extra_bits=lt,this.extra_base=vt,this.elems=gt,this.max_length=pt,this.has_stree=$&&$.length}function ct($,lt){this.dyn_tree=$,this.max_code=0,this.stat_desc=lt}function at($){return $<256?tt[$]:tt[256+($>>>7)]}function Pt($,lt){$.pending_buf[$.pending++]=255&lt,$.pending_buf[$.pending++]=lt>>>8&255}function mt($,lt,vt){$.bi_valid>T-vt?($.bi_buf|=lt<<$.bi_valid&65535,Pt($,$.bi_buf),$.bi_buf=lt>>T-$.bi_valid,$.bi_valid+=vt-T):($.bi_buf|=lt<<$.bi_valid&65535,$.bi_valid+=vt)}function Lt($,lt,vt){mt($,vt[2*lt],vt[2*lt+1])}function Vt($,lt){for(var vt=0;vt|=1&$,$>>>=1,vt<<=1,0<--lt;);return vt>>>1}function Ee($,lt,vt){var gt,pt,kt=new Array(D+1),Ht=0;for(gt=1;gt<=D;gt++)kt[gt]=Ht=Ht+vt[gt-1]<<1;for(pt=0;pt<=lt;pt++){var Ft=$[2*pt+1];Ft!==0&&($[2*pt]=Vt(kt[Ft]++,Ft))}}function te($){var lt;for(lt=0;lt<E;lt++)$.dyn_ltree[2*lt]=0;for(lt=0;lt<I;lt++)$.dyn_dtree[2*lt]=0;for(lt=0;lt<S;lt++)$.bl_tree[2*lt]=0;$.dyn_ltree[2*k]=1,$.opt_len=$.static_len=0,$.last_lit=$.matches=0}function me($){8<$.bi_valid?Pt($,$.bi_buf):0<$.bi_valid&&($.pending_buf[$.pending++]=$.bi_buf),$.bi_buf=0,$.bi_valid=0}function Ie($,lt,vt,gt){var pt=2*lt,kt=2*vt;return $[pt]<$[kt]||$[pt]===$[kt]&&gt[lt]<=gt[vt]}function Ce($,lt,vt){for(var gt=$.heap[vt],pt=vt<<1;pt<=$.heap_len&&(pt<$.heap_len&&Ie(lt,$.heap[pt+1],$.heap[pt],$.depth)&&pt++,!Ie(lt,gt,$.heap[pt],$.depth));)$.heap[vt]=$.heap[pt],vt=pt,pt<<=1;$.heap[vt]=gt}function Ge($,lt,vt){var gt,pt,kt,Ht,Ft=0;if($.last_lit!==0)for(;gt=$.pending_buf[$.d_buf+2*Ft]<<8|$.pending_buf[$.d_buf+2*Ft+1],pt=$.pending_buf[$.l_buf+Ft],Ft++,gt===0?Lt($,pt,lt):(Lt($,(kt=N[pt])+_+1,lt),(Ht=z[kt])!==0&&mt($,pt-=Z[kt],Ht),Lt($,kt=at(--gt),vt),(Ht=q[kt])!==0&&mt($,gt-=bt[kt],Ht)),Ft<$.last_lit;);Lt($,k,lt)}function de($,lt){var vt,gt,pt,kt=lt.dyn_tree,Ht=lt.stat_desc.static_tree,Ft=lt.stat_desc.has_stree,qt=lt.stat_desc.elems,ve=-1;for($.heap_len=0,$.heap_max=R,vt=0;vt<qt;vt++)kt[2*vt]!==0?($.heap[++$.heap_len]=ve=vt,$.depth[vt]=0):kt[2*vt+1]=0;for(;$.heap_len<2;)kt[2*(pt=$.heap[++$.heap_len]=ve<2?++ve:0)]=1,$.depth[pt]=0,$.opt_len--,Ft&&($.static_len-=Ht[2*pt+1]);for(lt.max_code=ve,vt=$.heap_len>>1;1<=vt;vt--)Ce($,kt,vt);for(pt=qt;vt=$.heap[1],$.heap[1]=$.heap[$.heap_len--],Ce($,kt,1),gt=$.heap[1],$.heap[--$.heap_max]=vt,$.heap[--$.heap_max]=gt,kt[2*pt]=kt[2*vt]+kt[2*gt],$.depth[pt]=($.depth[vt]>=$.depth[gt]?$.depth[vt]:$.depth[gt])+1,kt[2*vt+1]=kt[2*gt+1]=pt,$.heap[1]=pt++,Ce($,kt,1),2<=$.heap_len;);$.heap[--$.heap_max]=$.heap[1],function(re,pe){var Mn,Mi,rn,le,jt,He,ye=pe.dyn_tree,ze=pe.max_code,bn=pe.stat_desc.static_tree,vn=pe.stat_desc.has_stree,un=pe.stat_desc.extra_bits,Tt=pe.stat_desc.extra_base,Ii=pe.stat_desc.max_length,an=0;for(le=0;le<=D;le++)re.bl_count[le]=0;for(ye[2*re.heap[re.heap_max]+1]=0,Mn=re.heap_max+1;Mn<R;Mn++)Ii<(le=ye[2*ye[2*(Mi=re.heap[Mn])+1]+1]+1)&&(le=Ii,an++),ye[2*Mi+1]=le,ze<Mi||(re.bl_count[le]++,jt=0,Tt<=Mi&&(jt=un[Mi-Tt]),He=ye[2*Mi],re.opt_len+=He*(le+jt),vn&&(re.static_len+=He*(bn[2*Mi+1]+jt)));if(an!==0){do{for(le=Ii-1;re.bl_count[le]===0;)le--;re.bl_count[le]--,re.bl_count[le+1]+=2,re.bl_count[Ii]--,an-=2}while(0<an);for(le=Ii;le!==0;le--)for(Mi=re.bl_count[le];Mi!==0;)ze<(rn=re.heap[--Mn])||(ye[2*rn+1]!==le&&(re.opt_len+=(le-ye[2*rn+1])*ye[2*rn],ye[2*rn+1]=le),Mi--)}}($,lt),Ee(kt,ve,$.bl_count)}function F($,lt,vt){var gt,pt,kt=-1,Ht=lt[1],Ft=0,qt=7,ve=4;for(Ht===0&&(qt=138,ve=3),lt[2*(vt+1)+1]=65535,gt=0;gt<=vt;gt++)pt=Ht,Ht=lt[2*(gt+1)+1],++Ft<qt&&pt===Ht||(Ft<ve?$.bl_tree[2*pt]+=Ft:pt!==0?(pt!==kt&&$.bl_tree[2*pt]++,$.bl_tree[2*X]++):Ft<=10?$.bl_tree[2*H]++:$.bl_tree[2*K]++,kt=pt,ve=(Ft=0)===Ht?(qt=138,3):pt===Ht?(qt=6,3):(qt=7,4))}function St($,lt,vt){var gt,pt,kt=-1,Ht=lt[1],Ft=0,qt=7,ve=4;for(Ht===0&&(qt=138,ve=3),gt=0;gt<=vt;gt++)if(pt=Ht,Ht=lt[2*(gt+1)+1],!(++Ft<qt&&pt===Ht)){if(Ft<ve)for(;Lt($,pt,$.bl_tree),--Ft!=0;);else pt!==0?(pt!==kt&&(Lt($,pt,$.bl_tree),Ft--),Lt($,X,$.bl_tree),mt($,Ft-3,2)):Ft<=10?(Lt($,H,$.bl_tree),mt($,Ft-3,3)):(Lt($,K,$.bl_tree),mt($,Ft-11,7));kt=pt,ve=(Ft=0)===Ht?(qt=138,3):pt===Ht?(qt=6,3):(qt=7,4)}}c(bt);var Et=!1;function et($,lt,vt,gt){mt($,(p<<1)+(gt?1:0),3),function(pt,kt,Ht,Ft){me(pt),Ft&&(Pt(pt,Ht),Pt(pt,~Ht)),a.arraySet(pt.pending_buf,pt.window,kt,Ht,pt.pending),pt.pending+=Ht}($,lt,vt,!0)}s._tr_init=function($){Et||(function(){var lt,vt,gt,pt,kt,Ht=new Array(D+1);for(pt=gt=0;pt<y-1;pt++)for(Z[pt]=gt,lt=0;lt<1<<z[pt];lt++)N[gt++]=pt;for(N[gt-1]=pt,pt=kt=0;pt<16;pt++)for(bt[pt]=kt,lt=0;lt<1<<q[pt];lt++)tt[kt++]=pt;for(kt>>=7;pt<I;pt++)for(bt[pt]=kt<<7,lt=0;lt<1<<q[pt]-7;lt++)tt[256+kt++]=pt;for(vt=0;vt<=D;vt++)Ht[vt]=0;for(lt=0;lt<=143;)ot[2*lt+1]=8,lt++,Ht[8]++;for(;lt<=255;)ot[2*lt+1]=9,lt++,Ht[9]++;for(;lt<=279;)ot[2*lt+1]=7,lt++,Ht[7]++;for(;lt<=287;)ot[2*lt+1]=8,lt++,Ht[8]++;for(Ee(ot,E+1,Ht),lt=0;lt<I;lt++)j[2*lt+1]=5,j[2*lt]=Vt(lt,5);ft=new Dt(ot,z,_+1,E,D),rt=new Dt(j,q,0,I,D),At=new Dt(new Array(0),V,0,S,v)}(),Et=!0),$.l_desc=new ct($.dyn_ltree,ft),$.d_desc=new ct($.dyn_dtree,rt),$.bl_desc=new ct($.bl_tree,At),$.bi_buf=0,$.bi_valid=0,te($)},s._tr_stored_block=et,s._tr_flush_block=function($,lt,vt,gt){var pt,kt,Ht=0;0<$.level?($.strm.data_type===2&&($.strm.data_type=function(Ft){var qt,ve=4093624447;for(qt=0;qt<=31;qt++,ve>>>=1)if(1&ve&&Ft.dyn_ltree[2*qt]!==0)return l;if(Ft.dyn_ltree[18]!==0||Ft.dyn_ltree[20]!==0||Ft.dyn_ltree[26]!==0)return u;for(qt=32;qt<_;qt++)if(Ft.dyn_ltree[2*qt]!==0)return u;return l}($)),de($,$.l_desc),de($,$.d_desc),Ht=function(Ft){var qt;for(F(Ft,Ft.dyn_ltree,Ft.l_desc.max_code),F(Ft,Ft.dyn_dtree,Ft.d_desc.max_code),de(Ft,Ft.bl_desc),qt=S-1;3<=qt&&Ft.bl_tree[2*nt[qt]+1]===0;qt--);return Ft.opt_len+=3*(qt+1)+5+5+4,qt}($),pt=$.opt_len+3+7>>>3,(kt=$.static_len+3+7>>>3)<=pt&&(pt=kt)):pt=kt=vt+5,vt+4<=pt&&lt!==-1?et($,lt,vt,gt):$.strategy===4||kt===pt?(mt($,2+(gt?1:0),3),Ge($,ot,j)):(mt($,4+(gt?1:0),3),function(Ft,qt,ve,re){var pe;for(mt(Ft,qt-257,5),mt(Ft,ve-1,5),mt(Ft,re-4,4),pe=0;pe<re;pe++)mt(Ft,Ft.bl_tree[2*nt[pe]+1],3);St(Ft,Ft.dyn_ltree,qt-1),St(Ft,Ft.dyn_dtree,ve-1)}($,$.l_desc.max_code+1,$.d_desc.max_code+1,Ht+1),Ge($,$.dyn_ltree,$.dyn_dtree)),te($),gt&&me($)},s._tr_tally=function($,lt,vt){return $.pending_buf[$.d_buf+2*$.last_lit]=lt>>>8&255,$.pending_buf[$.d_buf+2*$.last_lit+1]=255&lt,$.pending_buf[$.l_buf+$.last_lit]=255&vt,$.last_lit++,lt===0?$.dyn_ltree[2*vt]++:($.matches++,lt--,$.dyn_ltree[2*(N[vt]+_+1)]++,$.dyn_dtree[2*at(lt)]++),$.last_lit===$.lit_bufsize-1},s._tr_align=function($){mt($,2,3),Lt($,k,ot),function(lt){lt.bi_valid===16?(Pt(lt,lt.bi_buf),lt.bi_buf=0,lt.bi_valid=0):8<=lt.bi_valid&&(lt.pending_buf[lt.pending++]=255&lt.bi_buf,lt.bi_buf>>=8,lt.bi_valid-=8)}($)}},{"../utils/common":41}],53:[function(e,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,n,s){(function(a){(function(l,u){if(!l.setImmediate){var c,p,y,_,E=1,I={},S=!1,R=l.document,D=Object.getPrototypeOf&&Object.getPrototypeOf(l);D=D&&D.setTimeout?D:l,c={}.toString.call(l.process)==="[object process]"?function(X){process.nextTick(function(){v(X)})}:function(){if(l.postMessage&&!l.importScripts){var X=!0,H=l.onmessage;return l.onmessage=function(){X=!1},l.postMessage("","*"),l.onmessage=H,X}}()?(_="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",k,!1):l.attachEvent("onmessage",k),function(X){l.postMessage(_+X,"*")}):l.MessageChannel?((y=new MessageChannel).port1.onmessage=function(X){v(X.data)},function(X){y.port2.postMessage(X)}):R&&"onreadystatechange"in R.createElement("script")?(p=R.documentElement,function(X){var H=R.createElement("script");H.onreadystatechange=function(){v(X),H.onreadystatechange=null,p.removeChild(H),H=null},p.appendChild(H)}):function(X){setTimeout(v,0,X)},D.setImmediate=function(X){typeof X!="function"&&(X=new Function(""+X));for(var H=new Array(arguments.length-1),K=0;K<H.length;K++)H[K]=arguments[K+1];var z={callback:X,args:H};return I[E]=z,c(E),E++},D.clearImmediate=T}function T(X){delete I[X]}function v(X){if(S)setTimeout(v,0,X);else{var H=I[X];if(H){S=!0;try{(function(K){var z=K.callback,q=K.args;switch(q.length){case 0:z();break;case 1:z(q[0]);break;case 2:z(q[0],q[1]);break;case 3:z(q[0],q[1],q[2]);break;default:z.apply(u,q)}})(H)}finally{T(X),S=!1}}}}function k(X){X.source===l&&typeof X.data=="string"&&X.data.indexOf(_)===0&&v(+X.data.slice(_.length))}})(typeof self>"u"?a===void 0?this:a:self)}).call(this,typeof hn<"u"?hn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(fx);var fR=fx.exports;const Gp=od(fR);var zp=function(i,t,e,n){function s(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function u(y){try{p(n.next(y))}catch(_){l(_)}}function c(y){try{p(n.throw(y))}catch(_){l(_)}}function p(y){y.done?a(y.value):s(y.value).then(u,c)}p((n=n.apply(i,t||[])).next())})};const la="TASKDATA.XML",Up="TASKDATA";class Zo{constructor(t={}){this.nextIds={},this.parsingWarnings=[],this.xmlReferences={},this.filesToSave={},this.options={version:4,fmisTitle:"FMIS",fmisVersion:"1.0",rootFolder:Up,realm:"main"},this.updateOptions(t),this.rootElement=Yo.fromISOXMLManagerOptions(this)}static parseXmlId(t){const e=t.match(/([A-Z]{3})(-?\d+)/);return e?{tag:e[1],id:parseInt(e[2],10)}:null}generateUniqueFilename(t){const e=Object.keys(this.filesToSave).map(s=>s.match(new RegExp(`^${t}(\\d{5})\\.\\w{3}$`))).filter(s=>s).map(s=>parseInt(s[1],10)),n=e.length?Math.max.apply(null,e)+1:1;return t+("0000"+n).substr(-5)}addFileToSave(t,e){this.filesToSave[e]=t}registerEntity(t,e,n){if(!t&&!e)return;if(e){const a=Zo.parseXmlId(e);if(!a||t&&t.tag!==a.tag)return;this.nextIds[a.tag]=Math.max(this.nextIds[a.tag]||1,a.id+1)}else{const a=t.tag,l=Object.values(this.xmlReferences).filter(u=>u.xmlId.startsWith(a)).find(u=>u.entity===t||n&&n===u.fmisId);l?e=l.xmlId:(this.nextIds[t.tag]=this.nextIds[t.tag]||1,e=`${t.tag}${this.nextIds[t.tag]++}`)}this.xmlReferences[e]=this.xmlReferences[e]||{xmlId:e};const s=this.xmlReferences[e];return t&&(s.entity=t),n&&(s.fmisId=n),s}createEntityFromXML(t,e,n){const s=oo(this.options.realm,t);return s?s.fromXML(e,this,n):null}createEntityFromAttributes(t,e){const n=oo(this.options.realm,t);return n?new n(e,this):null}parseISOXMLFile(t,e){var n;return zp(this,void 0,void 0,function*(){if(e==="application/xml"||e==="text/xml"){this.options.rootFolder="";const s=Uo(t);if(!s.ISO11783_TaskData)throw new Error("Incorrect structure of TASKDATA.XML");this.rootElement=yield oo(this.options.realm,_t.ISO11783TaskDataFile).fromXML(s[_t.ISO11783TaskDataFile][0],this,"")}else if(e==="application/zip"){this.originalZip=yield Gp.loadAsync(t);const s=Object.keys(this.originalZip.files).filter(p=>{const y=p.split("/");return y[y.length-1].toLowerCase()===la.toLowerCase()});if(s.length===0)throw new Error("ZIP file doesn't contain TASKDATA.XML");s.length>1&&this.addWarning("More than one TASKDATA.XML files found in ZIP file - selecting one of them");const a=(n=s.find(p=>p.toLowerCase()===`${Up}/${la}`.toLowerCase()))!==null&&n!==void 0?n:s[0];a.slice(-la.length)!==la&&this.addWarning(`Name of the main file must be uppercase (real name: ${a})`),this.options.rootFolder=a.slice(0,-la.length);const u=yield this.originalZip.file(a).async("string"),c=Uo(u);if(!c.ISO11783_TaskData)throw new Error("Incorrect structure of TASKDATA.XML");this.rootElement=yield oo(this.options.realm,_t.ISO11783TaskDataFile).fromXML(c[_t.ISO11783TaskDataFile][0],this,"")}else throw new Error("This data type is not supported")})}saveISOXML(){return zp(this,void 0,void 0,function*(){this.filesToSave={},this.options.fmisURI&&this.rootElement.addLinkListFile();const t={ISO11783_TaskData:this.rootElement.toXML()},e=h0(t),n=new Gp;return n.file(`${this.options.rootFolder}${la}`,e),Object.keys(this.filesToSave).forEach(s=>{const a=this.filesToSave[s];n.file(`${this.options.rootFolder}${s}`,a,{binary:typeof a!="string"})}),n.generateAsync({type:"uint8array"})})}getReferenceByEntity(t){return Object.values(this.xmlReferences).find(e=>e.entity===t)}getReferenceByXmlId(t){return this.xmlReferences[t]}getEntityByXmlId(t){var e;return!((e=this.xmlReferences[t])===null||e===void 0)&&e.entity?this.xmlReferences[t].entity:null}getEntitiesOfTag(t){return Object.values(this.xmlReferences).filter(e=>Zo.parseXmlId(e.xmlId).tag===t&&e.entity).map(e=>e.entity)}updateOptions(t){this.options=Object.assign(Object.assign({},this.options),t),this.options.rootFolder&&!this.options.rootFolder.endsWith("/")&&(this.options.rootFolder+="/")}getParsedFile(t,e,n=!0){if(!this.originalZip)return null;let s=null;return this.originalZip.folder(this.options.rootFolder).forEach((a,l)=>{a.toUpperCase()===t.toUpperCase()&&(a!==t&&n&&this.addWarning(`Letter case of filename ${t} doesn't match (real file: ${a})`),s=l)}),s?s.async(e?"uint8array":"string"):null}addWarning(t){this.parsingWarnings.push(t)}getWarnings(){return this.parsingWarnings}}var dR=function(i,t,e,n){function s(a){return a instanceof e?a:new e(function(l){l(a)})}return new(e||(e=Promise))(function(a,l){function u(y){try{p(n.next(y))}catch(_){l(_)}}function c(y){try{p(n.throw(y))}catch(_){l(_)}}function p(y){y.done?a(y.value):s(y.value).then(u,c)}p((n=n.apply(i,t||[])).next())})};class d0 extends Fo{constructor(t,e){super(t,e),this.tag=_t.TimeLog,this.parsingErrors=[],this.parsedTimeLog=null}static fromXML(t,e,n){return dR(this,void 0,void 0,function*(){const s=yield Fo.fromXML(t,e,n,d0),a=`${s.attributes.Filename}.xml`,l=`${s.attributes.Filename}.bin`;s.binaryData=yield e.getParsedFile(l,!0),s.binaryData||e.addWarning(`[${n}] TimeLog binary file "${l}" is missing`);const u=yield e.getParsedFile(a,!1);if(!u)return e.addWarning(`[${n}] TimeLog header file "${a}" is missing`),s;const c=Uo(u),p=new Zo({realm:"timelog"});return s.timeLogHeader=yield iu.fromXML(c[_t.Time][0],p,`${a}->${_t.Time}[0]`),p.getWarnings().forEach(y=>{e.addWarning(y)}),s})}getDLVDeviceElement(t){var e;const n=(e=t.attributes.DeviceElementIdRef)===null||e===void 0?void 0:e.xmlId;return n?this.isoxmlManager.getEntityByXmlId(n):null}toXML(){const t={[_t.Time]:this.timeLogHeader.toXML()},e=h0(t);return this.isoxmlManager.addFileToSave(e,`${this.attributes.Filename}.xml`),this.isoxmlManager.addFileToSave(this.binaryData,`${this.attributes.Filename}.bin`),super.toXML()}parseBinaryFile(){var t,e;if(this.parsedTimeLog)return this.parsedTimeLog;const n=[],s=new gl(this.binaryData.buffer),a=(e=(t=this.timeLogHeader.attributes.Position)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.attributes,l=[1/0,1/0],u=[-1/0,-1/0],c={};for(;s.tell()<this.binaryData.length;){const _={};let E=!1;const I={};try{const S=s.nextUint32(),R=s.nextUint16();_.time=new Date(1e3*60*60*24*R+S),a&&(a.PositionNorth===null?I.PositionNorth=s.nextInt32()/1e7:I.PositionNorth=a.PositionNorth,a.PositionEast===null?I.PositionEast=s.nextInt32()/1e7:I.PositionEast=a.PositionEast,a.PositionUp===null?I.PositionUp=s.nextInt32():I.PositionUp=a.PositionUp,a.PositionStatus===""?I.PositionStatus=s.nextUint8().toString():I.PositionStatus=a.PositionStatus,a.PDOP===null?I.PDOP=s.nextUint16()/10:I.PDOP=a.PDOP,a.HDOP===null?I.HDOP=s.nextUint16()/10:I.HDOP=a.HDOP,a.NumberOfSatellites===null?I.NumberOfSatellites=s.nextUint8():I.NumberOfSatellites=a.NumberOfSatellites,a.GpsUtcTime===null?I.GpsUtcTime=s.nextUint32():I.GpsUtcTime=a.GpsUtcTime,a.GpsUtcDate===null?I.GpsUtcDate=s.nextUint16():I.GpsUtcDate=a.GpsUtcDate,E=I.PositionEast!==0||I.PositionNorth!==0,_.position=I);const D=s.nextUint8(),T={};for(let v=0;v<D;v++){const k=s.nextUint8(),X=this.timeLogHeader.attributes.DataLogValue[k].attributes.ProcessDataDDI,H=this.timeLogHeader.attributes.DataLogValue[k].attributes.DeviceElementIdRef.xmlId,K=s.nextInt32(),z=`${X}_${H}`;E&&(c[z]?c[z]={min:Math.min(c[z].min,K),max:Math.max(c[z].max,K)}:c[z]={min:K,max:K}),T[z]=K}_.values=T,_.isValidPosition=E,n.push(_)}catch{this.parsingErrors.push(`Can't parse timelog record #${n.length}: not enough bytes in binary file`);break}E&&(l[0]=Math.min(l[0],I.PositionEast),l[1]=Math.min(l[1],I.PositionNorth),u[0]=Math.max(u[0],I.PositionEast),u[1]=Math.max(u[1],I.PositionNorth))}const p=[...l,...u],y=(this.timeLogHeader.attributes.DataLogValue||[]).map(_=>{var E,I;const S=_.attributes.ProcessDataDDI,R=this.getDLVDeviceElement(_),D=R?.getValuePresentation(S),T=R?.getDataProcess(S),v=tx(S,D,T),k=_.attributes.DeviceElementIdRef.xmlId,X=R?.getParentDevice(),H=`${S}_${k}`,K=(E=X?.attributes.DeviceDesignator)!==null&&E!==void 0?E:"",z=(I=R?.attributes.DeviceElementDesignator)!==null&&I!==void 0?I:"";return v.deviceElementId=k,v.deviceElementDesignator=[K,z].filter(q=>q).join(" - "),v.valueKey=H,H in c&&(v.minValue=c[H].min,v.maxValue=c[H].max),v});return this.parsedTimeLog={bbox:p,valuesInfo:y,timeLogs:n},this.parsedTimeLog}rangesWithoutOutliers(){const t=this.parseBinaryFile(),e={};return t.valuesInfo.forEach(s=>{e[s.valueKey]=new Set}),t.timeLogs.forEach(s=>{Object.keys(s.values).forEach(a=>{e[a].add(s.values[a])})}),t.valuesInfo.map(s=>{const a=[...e[s.valueKey]];if(a.length<8)return{minValue:s.minValue,maxValue:s.maxValue};a.sort((I,S)=>I-S);const l=a[a.length>>2],u=a[a.length*3>>2],c=u-l,p=u+2.5*c,y=l-2.5*c;let _,E;for(let I=0;I<a.length;I++)if(a[I]>=y){_=a[I];break}for(let I=a.length-1;I>=0;I--)if(a[I]<=p){E=a[I];break}return{minValue:_,maxValue:E}})}getFilledTimeLogs(){const t=this.parseBinaryFile(),e=t.timeLogs.sort((s,a)=>+s.time-+a.time),n={};return e.map(s=>{const a={};return t.valuesInfo.forEach(l=>{const u=l.valueKey;u in s.values?(a[u]=s.values[u],n[u]=s.values[u]):u in n&&(a[u]=n[u])}),Object.assign(Object.assign({},s),{values:a})})}}$t("main",_t.TimeLog,d0);class g0 extends Bo{constructor(t,e){super(t,e),this.tag=_t.TreatmentZone}static fromXML(t,e,n){return Bo.fromXML(t,e,n,g0)}toXML(){return this.attributes.PolygonTreatmentZoneonly=Kn.normalizePolygons(this.attributes.PolygonTreatmentZoneonly),super.toXML()}}$t("main",_t.TreatmentZone,g0);class m0 extends vo{constructor(t,e){super(t,e),this.tag=_t.DeviceElement}static fromXML(t,e,n){return vo.fromXML(t,e,n,m0)}getParentDevice(){return this.isoxmlManager.getEntitiesOfTag(_t.Device).find(t=>(t.attributes.DeviceElement||[]).find(e=>e===this))}getValuePresentation(t){const e=this.getParentDevice();if(!e)return null;const n=this.getDataProcess(t),s=n?.attributes.DeviceValuePresentationObjectId;return s?(e.attributes.DeviceValuePresentation||[]).find(a=>a.attributes.DeviceValuePresentationObjectId===s):null}getDataProcess(t){const e=this.getParentDevice();return e?(e.attributes.DeviceProcessData||[]).find(n=>n.attributes.DeviceProcessDataDDI===t&&(this.attributes.DeviceObjectReference||[]).find(s=>s.attributes.DeviceObjectId===n.attributes.DeviceProcessDataObjectId)):null}}$t("main",_t.DeviceElement,m0);class gR extends nl{constructor(t){t=t||{},super(t)}}class mR extends Uf{constructor(t){super(t),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],n=t.pixelRatio,s=t.viewState,a=s.resolution,l=this.getLayer().getSource(),u=t.viewHints;let c=t.extent;if(e.extent!==void 0&&(c=kr(c,Ls(e.extent,s.projection))),!u[Gi.ANIMATING]&&!u[Gi.INTERACTING]&&!Na(c))if(l){const p=s.projection,y=l.getImage(c,a,n,p);y&&(this.loadImage(y)?this.image_=y:y.getState()===se.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),s=Vi(e.pixelToCoordinateTransform,t.slice()),a=n.getExtent();if(a&&!zr(a,s))return null;const l=this.image_.getExtent(),u=this.image_.getImage(),c=Ve(l),p=Math.floor(u.width*((s[0]-l[0])/c));if(p<0||p>=u.width)return null;const y=Oi(l),_=Math.floor(u.height*((l[3]-s[1])/y));return _<0||_>=u.height?null:this.getImageData(u,p,_)}renderFrame(t,e){const n=this.image_,s=n.getExtent(),a=n.getResolution(),[l,u]=Array.isArray(a)?a:[a,a],c=n.getPixelRatio(),p=t.layerStatesArray[t.layerIndex],y=t.pixelRatio,_=t.viewState,E=_.center,I=_.resolution,S=y*l/(I*c),R=y*u/(I*c);this.prepareContainer(t,e);const D=this.context.canvas.width,T=this.context.canvas.height,v=this.getRenderContext(t);let k=!1,X=!0;if(p.extent){const V=Ls(p.extent,_.projection);X=en(V,t.extent),k=X&&!us(V,t.extent),k&&this.clipUnrotated(v,t,V)}const H=n.getImage(),K=ms(this.tempTransform,D/2,T/2,S,R,0,c*(s[0]-E[0])/l,c*(E[1]-s[3])/u);this.renderedResolution=u*y/c;const z=H.width*K[0],q=H.height*K[3];if(this.getLayer().getSource().getInterpolate()||(v.imageSmoothingEnabled=!1),this.preRender(v,t),X&&z>=.5&&q>=.5){const V=K[4],nt=K[5],ot=p.opacity;ot!==1&&(v.save(),v.globalAlpha=ot),v.drawImage(H,0,0,+H.width,+H.height,V,nt,z,q),ot!==1&&v.restore()}return this.postRender(this.context,t),k&&v.restore(),v.imageSmoothingEnabled=!0,this.container}}class pR extends gR{constructor(t){super(t)}createRenderer(){return new mR(this)}getData(t){return super.getData(t)}}const yR=pR,wa=(i,t=0,e=1)=>y0(x0(t,i),e),p0=i=>{i._clipped=!1,i._unclipped=i.slice(0);for(let t=0;t<=3;t++)t<3?((i[t]<0||i[t]>255)&&(i._clipped=!0),i[t]=wa(i[t],0,255)):t===3&&(i[t]=wa(i[t],0,1));return i},dx={};for(let i of["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"])dx[`[object ${i}]`]=i.toLowerCase();function Le(i){return dx[Object.prototype.toString.call(i)]||"object"}const ke=(i,t=null)=>i.length>=3?Array.prototype.slice.call(i):Le(i[0])=="object"&&t?t.split("").filter(e=>i[0][e]!==void 0).map(e=>i[0][e]):i[0],su=i=>{if(i.length<2)return null;const t=i.length-1;return Le(i[t])=="string"?i[t].toLowerCase():null},{PI:ru,min:y0,max:x0}=Math,Ps=ru*2,Qu=ru/3,xR=ru/180,_R=180/ru,Se={format:{},autodetect:[]};class Xt{constructor(...t){const e=this;if(Le(t[0])==="object"&&t[0].constructor&&t[0].constructor===this.constructor)return t[0];let n=su(t),s=!1;if(!n){s=!0,Se.sorted||(Se.autodetect=Se.autodetect.sort((a,l)=>l.p-a.p),Se.sorted=!0);for(let a of Se.autodetect)if(n=a.test(...t),n)break}if(Se.format[n]){const a=Se.format[n].apply(null,s?t:t.slice(0,-1));e._rgb=p0(a)}else throw new Error("unknown format: "+t);e._rgb.length===3&&e._rgb.push(1)}toString(){return Le(this.hex)=="function"?this.hex():`[${this._rgb.join(",")}]`}}const wR="2.6.0",Re=(...i)=>new Re.Color(...i);Re.Color=Xt;Re.version=wR;const bR=(...i)=>{i=ke(i,"cmyk");const[t,e,n,s]=i,a=i.length>4?i[4]:1;return s===1?[0,0,0,a]:[t>=1?0:255*(1-t)*(1-s),e>=1?0:255*(1-e)*(1-s),n>=1?0:255*(1-n)*(1-s),a]},{max:Wp}=Math,ER=(...i)=>{let[t,e,n]=ke(i,"rgb");t=t/255,e=e/255,n=n/255;const s=1-Wp(t,Wp(e,n)),a=s<1?1/(1-s):0,l=(1-t-s)*a,u=(1-e-s)*a,c=(1-n-s)*a;return[l,u,c,s]};Xt.prototype.cmyk=function(){return ER(this._rgb)};Re.cmyk=(...i)=>new Xt(...i,"cmyk");Se.format.cmyk=bR;Se.autodetect.push({p:2,test:(...i)=>{if(i=ke(i,"cmyk"),Le(i)==="array"&&i.length===4)return"cmyk"}});const tc=i=>Math.round(i*100)/100,IR=(...i)=>{const t=ke(i,"hsla");let e=su(i)||"lsa";return t[0]=tc(t[0]||0),t[1]=tc(t[1]*100)+"%",t[2]=tc(t[2]*100)+"%",e==="hsla"||t.length>3&&t[3]<1?(t[3]=t.length>3?t[3]:1,e="hsla"):t.length=3,`${e}(${t.join(",")})`},gx=(...i)=>{i=ke(i,"rgba");let[t,e,n]=i;t/=255,e/=255,n/=255;const s=y0(t,e,n),a=x0(t,e,n),l=(a+s)/2;let u,c;return a===s?(u=0,c=Number.NaN):u=l<.5?(a-s)/(a+s):(a-s)/(2-a-s),t==a?c=(e-n)/(a-s):e==a?c=2+(n-t)/(a-s):n==a&&(c=4+(t-e)/(a-s)),c*=60,c<0&&(c+=360),i.length>3&&i[3]!==void 0?[c,u,l,i[3]]:[c,u,l]},{round:ec}=Math,CR=(...i)=>{const t=ke(i,"rgba");let e=su(i)||"rgb";return e.substr(0,3)=="hsl"?IR(gx(t),e):(t[0]=ec(t[0]),t[1]=ec(t[1]),t[2]=ec(t[2]),(e==="rgba"||t.length>3&&t[3]<1)&&(t[3]=t.length>3?t[3]:1,e="rgba"),`${e}(${t.slice(0,e==="rgb"?3:4).join(",")})`)},{round:ic}=Math,af=(...i)=>{i=ke(i,"hsl");const[t,e,n]=i;let s,a,l;if(e===0)s=a=l=n*255;else{const u=[0,0,0],c=[0,0,0],p=n<.5?n*(1+e):n+e-n*e,y=2*n-p,_=t/360;u[0]=_+1/3,u[1]=_,u[2]=_-1/3;for(let E=0;E<3;E++)u[E]<0&&(u[E]+=1),u[E]>1&&(u[E]-=1),6*u[E]<1?c[E]=y+(p-y)*6*u[E]:2*u[E]<1?c[E]=p:3*u[E]<2?c[E]=y+(p-y)*(2/3-u[E])*6:c[E]=y;[s,a,l]=[ic(c[0]*255),ic(c[1]*255),ic(c[2]*255)]}return i.length>3?[s,a,l,i[3]]:[s,a,l,1]},mx=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,px=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,yx=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,xx=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,_x=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,wx=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,{round:Xp}=Math,_0=i=>{i=i.toLowerCase().trim();let t;if(Se.format.named)try{return Se.format.named(i)}catch{}if(t=i.match(mx)){const e=t.slice(1,4);for(let n=0;n<3;n++)e[n]=+e[n];return e[3]=1,e}if(t=i.match(px)){const e=t.slice(1,5);for(let n=0;n<4;n++)e[n]=+e[n];return e}if(t=i.match(yx)){const e=t.slice(1,4);for(let n=0;n<3;n++)e[n]=Xp(e[n]*2.55);return e[3]=1,e}if(t=i.match(xx)){const e=t.slice(1,5);for(let n=0;n<3;n++)e[n]=Xp(e[n]*2.55);return e[3]=+e[3],e}if(t=i.match(_x)){const e=t.slice(1,4);e[1]*=.01,e[2]*=.01;const n=af(e);return n[3]=1,n}if(t=i.match(wx)){const e=t.slice(1,4);e[1]*=.01,e[2]*=.01;const n=af(e);return n[3]=+t[4],n}};_0.test=i=>mx.test(i)||px.test(i)||yx.test(i)||xx.test(i)||_x.test(i)||wx.test(i);Xt.prototype.css=function(i){return CR(this._rgb,i)};Re.css=(...i)=>new Xt(...i,"css");Se.format.css=_0;Se.autodetect.push({p:5,test:(i,...t)=>{if(!t.length&&Le(i)==="string"&&_0.test(i))return"css"}});Se.format.gl=(...i)=>{const t=ke(i,"rgba");return t[0]*=255,t[1]*=255,t[2]*=255,t};Re.gl=(...i)=>new Xt(...i,"gl");Xt.prototype.gl=function(){const i=this._rgb;return[i[0]/255,i[1]/255,i[2]/255,i[3]]};const{floor:AR}=Math,RR=(...i)=>{i=ke(i,"hcg");let[t,e,n]=i,s,a,l;n=n*255;const u=e*255;if(e===0)s=a=l=n;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;const c=AR(t),p=t-c,y=n*(1-e),_=y+u*(1-p),E=y+u*p,I=y+u;switch(c){case 0:[s,a,l]=[I,E,y];break;case 1:[s,a,l]=[_,I,y];break;case 2:[s,a,l]=[y,I,E];break;case 3:[s,a,l]=[y,_,I];break;case 4:[s,a,l]=[E,y,I];break;case 5:[s,a,l]=[I,y,_];break}}return[s,a,l,i.length>3?i[3]:1]},SR=(...i)=>{const[t,e,n]=ke(i,"rgb"),s=y0(t,e,n),a=x0(t,e,n),l=a-s,u=l*100/255,c=s/(255-l)*100;let p;return l===0?p=Number.NaN:(t===a&&(p=(e-n)/l),e===a&&(p=2+(n-t)/l),n===a&&(p=4+(t-e)/l),p*=60,p<0&&(p+=360)),[p,u,c]};Xt.prototype.hcg=function(){return SR(this._rgb)};Re.hcg=(...i)=>new Xt(...i,"hcg");Se.format.hcg=RR;Se.autodetect.push({p:1,test:(...i)=>{if(i=ke(i,"hcg"),Le(i)==="array"&&i.length===3)return"hcg"}});const TR=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,DR=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,bx=i=>{if(i.match(TR)){(i.length===4||i.length===7)&&(i=i.substr(1)),i.length===3&&(i=i.split(""),i=i[0]+i[0]+i[1]+i[1]+i[2]+i[2]);const t=parseInt(i,16),e=t>>16,n=t>>8&255,s=t&255;return[e,n,s,1]}if(i.match(DR)){(i.length===5||i.length===9)&&(i=i.substr(1)),i.length===4&&(i=i.split(""),i=i[0]+i[0]+i[1]+i[1]+i[2]+i[2]+i[3]+i[3]);const t=parseInt(i,16),e=t>>24&255,n=t>>16&255,s=t>>8&255,a=Math.round((t&255)/255*100)/100;return[e,n,s,a]}throw new Error(`unknown hex color: ${i}`)},{round:Wl}=Math,Ex=(...i)=>{let[t,e,n,s]=ke(i,"rgba"),a=su(i)||"auto";s===void 0&&(s=1),a==="auto"&&(a=s<1?"rgba":"rgb"),t=Wl(t),e=Wl(e),n=Wl(n);let u="000000"+(t<<16|e<<8|n).toString(16);u=u.substr(u.length-6);let c="0"+Wl(s*255).toString(16);switch(c=c.substr(c.length-2),a.toLowerCase()){case"rgba":return`#${u}${c}`;case"argb":return`#${c}${u}`;default:return`#${u}`}};Xt.prototype.hex=function(i){return Ex(this._rgb,i)};Re.hex=(...i)=>new Xt(...i,"hex");Se.format.hex=bx;Se.autodetect.push({p:4,test:(i,...t)=>{if(!t.length&&Le(i)==="string"&&[3,4,5,6,7,8,9].indexOf(i.length)>=0)return"hex"}});const{cos:ha}=Math,MR=(...i)=>{i=ke(i,"hsi");let[t,e,n]=i,s,a,l;return isNaN(t)&&(t=0),isNaN(e)&&(e=0),t>360&&(t-=360),t<0&&(t+=360),t/=360,t<1/3?(l=(1-e)/3,s=(1+e*ha(Ps*t)/ha(Qu-Ps*t))/3,a=1-(l+s)):t<2/3?(t-=1/3,s=(1-e)/3,a=(1+e*ha(Ps*t)/ha(Qu-Ps*t))/3,l=1-(s+a)):(t-=2/3,a=(1-e)/3,l=(1+e*ha(Ps*t)/ha(Qu-Ps*t))/3,s=1-(a+l)),s=wa(n*s*3),a=wa(n*a*3),l=wa(n*l*3),[s*255,a*255,l*255,i.length>3?i[3]:1]},{min:vR,sqrt:OR,acos:PR}=Math,NR=(...i)=>{let[t,e,n]=ke(i,"rgb");t/=255,e/=255,n/=255;let s;const a=vR(t,e,n),l=(t+e+n)/3,u=l>0?1-a/l:0;return u===0?s=NaN:(s=(t-e+(t-n))/2,s/=OR((t-e)*(t-e)+(t-n)*(e-n)),s=PR(s),n>e&&(s=Ps-s),s/=Ps),[s*360,u,l]};Xt.prototype.hsi=function(){return NR(this._rgb)};Re.hsi=(...i)=>new Xt(...i,"hsi");Se.format.hsi=MR;Se.autodetect.push({p:2,test:(...i)=>{if(i=ke(i,"hsi"),Le(i)==="array"&&i.length===3)return"hsi"}});Xt.prototype.hsl=function(){return gx(this._rgb)};Re.hsl=(...i)=>new Xt(...i,"hsl");Se.format.hsl=af;Se.autodetect.push({p:2,test:(...i)=>{if(i=ke(i,"hsl"),Le(i)==="array"&&i.length===3)return"hsl"}});const{floor:LR}=Math,kR=(...i)=>{i=ke(i,"hsv");let[t,e,n]=i,s,a,l;if(n*=255,e===0)s=a=l=n;else{t===360&&(t=0),t>360&&(t-=360),t<0&&(t+=360),t/=60;const u=LR(t),c=t-u,p=n*(1-e),y=n*(1-e*c),_=n*(1-e*(1-c));switch(u){case 0:[s,a,l]=[n,_,p];break;case 1:[s,a,l]=[y,n,p];break;case 2:[s,a,l]=[p,n,_];break;case 3:[s,a,l]=[p,y,n];break;case 4:[s,a,l]=[_,p,n];break;case 5:[s,a,l]=[n,p,y];break}}return[s,a,l,i.length>3?i[3]:1]},{min:FR,max:BR}=Math,VR=(...i)=>{i=ke(i,"rgb");let[t,e,n]=i;const s=FR(t,e,n),a=BR(t,e,n),l=a-s;let u,c,p;return p=a/255,a===0?(u=Number.NaN,c=0):(c=l/a,t===a&&(u=(e-n)/l),e===a&&(u=2+(n-t)/l),n===a&&(u=4+(t-e)/l),u*=60,u<0&&(u+=360)),[u,c,p]};Xt.prototype.hsv=function(){return VR(this._rgb)};Re.hsv=(...i)=>new Xt(...i,"hsv");Se.format.hsv=kR;Se.autodetect.push({p:2,test:(...i)=>{if(i=ke(i,"hsv"),Le(i)==="array"&&i.length===3)return"hsv"}});const wn={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},{pow:GR}=Math,Ix=(...i)=>{i=ke(i,"lab");const[t,e,n]=i;let s,a,l,u,c,p;return a=(t+16)/116,s=isNaN(e)?a:a+e/500,l=isNaN(n)?a:a-n/200,a=wn.Yn*sc(a),s=wn.Xn*sc(s),l=wn.Zn*sc(l),u=nc(3.2404542*s-1.5371385*a-.4985314*l),c=nc(-.969266*s+1.8760108*a+.041556*l),p=nc(.0556434*s-.2040259*a+1.0572252*l),[u,c,p,i.length>3?i[3]:1]},nc=i=>255*(i<=.00304?12.92*i:1.055*GR(i,1/2.4)-.055),sc=i=>i>wn.t1?i*i*i:wn.t2*(i-wn.t0),{pow:Cx}=Math,Ax=(...i)=>{const[t,e,n]=ke(i,"rgb"),[s,a,l]=zR(t,e,n),u=116*a-16;return[u<0?0:u,500*(s-a),200*(a-l)]},rc=i=>(i/=255)<=.04045?i/12.92:Cx((i+.055)/1.055,2.4),ac=i=>i>wn.t3?Cx(i,1/3):i/wn.t2+wn.t0,zR=(i,t,e)=>{i=rc(i),t=rc(t),e=rc(e);const n=ac((.4124564*i+.3575761*t+.1804375*e)/wn.Xn),s=ac((.2126729*i+.7151522*t+.072175*e)/wn.Yn),a=ac((.0193339*i+.119192*t+.9503041*e)/wn.Zn);return[n,s,a]};Xt.prototype.lab=function(){return Ax(this._rgb)};Re.lab=(...i)=>new Xt(...i,"lab");Se.format.lab=Ix;Se.autodetect.push({p:2,test:(...i)=>{if(i=ke(i,"lab"),Le(i)==="array"&&i.length===3)return"lab"}});const{sin:UR,cos:WR}=Math,Rx=(...i)=>{let[t,e,n]=ke(i,"lch");return isNaN(n)&&(n=0),n=n*xR,[t,WR(n)*e,UR(n)*e]},Sx=(...i)=>{i=ke(i,"lch");const[t,e,n]=i,[s,a,l]=Rx(t,e,n),[u,c,p]=Ix(s,a,l);return[u,c,p,i.length>3?i[3]:1]},XR=(...i)=>{const t=ke(i,"hcl").reverse();return Sx(...t)},{sqrt:jR,atan2:HR,round:YR}=Math,Tx=(...i)=>{const[t,e,n]=ke(i,"lab"),s=jR(e*e+n*n);let a=(HR(n,e)*_R+360)%360;return YR(s*1e4)===0&&(a=Number.NaN),[t,s,a]},Dx=(...i)=>{const[t,e,n]=ke(i,"rgb"),[s,a,l]=Ax(t,e,n);return Tx(s,a,l)};Xt.prototype.lch=function(){return Dx(this._rgb)};Xt.prototype.hcl=function(){return Dx(this._rgb).reverse()};Re.lch=(...i)=>new Xt(...i,"lch");Re.hcl=(...i)=>new Xt(...i,"hcl");Se.format.lch=Sx;Se.format.hcl=XR;["lch","hcl"].forEach(i=>Se.autodetect.push({p:2,test:(...t)=>{if(t=ke(t,i),Le(t)==="array"&&t.length===3)return i}}));const Pa={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};Xt.prototype.name=function(){const i=Ex(this._rgb,"rgb");for(let t of Object.keys(Pa))if(Pa[t]===i)return t.toLowerCase();return i};Se.format.named=i=>{if(i=i.toLowerCase(),Pa[i])return bx(Pa[i]);throw new Error("unknown color name: "+i)};Se.autodetect.push({p:5,test:(i,...t)=>{if(!t.length&&Le(i)==="string"&&Pa[i.toLowerCase()])return"named"}});const ZR=i=>{if(Le(i)=="number"&&i>=0&&i<=16777215){const t=i>>16,e=i>>8&255,n=i&255;return[t,e,n,1]}throw new Error("unknown num color: "+i)},KR=(...i)=>{const[t,e,n]=ke(i,"rgb");return(t<<16)+(e<<8)+n};Xt.prototype.num=function(){return KR(this._rgb)};Re.num=(...i)=>new Xt(...i,"num");Se.format.num=ZR;Se.autodetect.push({p:5,test:(...i)=>{if(i.length===1&&Le(i[0])==="number"&&i[0]>=0&&i[0]<=16777215)return"num"}});const{round:Mx}=Math;Xt.prototype.rgb=function(i=!0){return i===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Mx)};Xt.prototype.rgba=function(i=!0){return this._rgb.slice(0,4).map((t,e)=>e<3?i===!1?t:Mx(t):t)};Re.rgb=(...i)=>new Xt(...i,"rgb");Se.format.rgb=(...i)=>{const t=ke(i,"rgba");return t[3]===void 0&&(t[3]=1),t};Se.autodetect.push({p:3,test:(...i)=>{if(i=ke(i,"rgba"),Le(i)==="array"&&(i.length===3||i.length===4&&Le(i[3])=="number"&&i[3]>=0&&i[3]<=1))return"rgb"}});const{log:Xl}=Math,vx=i=>{const t=i/100;let e,n,s;return t<66?(e=255,n=t<6?0:-155.25485562709179-.44596950469579133*(n=t-2)+104.49216199393888*Xl(n),s=t<20?0:-254.76935184120902+.8274096064007395*(s=t-10)+115.67994401066147*Xl(s)):(e=351.97690566805693+.114206453784165*(e=t-55)-40.25366309332127*Xl(e),n=325.4494125711974+.07943456536662342*(n=t-50)-28.0852963507957*Xl(n),s=255),[e,n,s,1]},{round:qR}=Math,$R=(...i)=>{const t=ke(i,"rgb"),e=t[0],n=t[2];let s=1e3,a=4e4;const l=.4;let u;for(;a-s>l;){u=(a+s)*.5;const c=vx(u);c[2]/c[0]>=n/e?a=u:s=u}return qR(u)};Xt.prototype.temp=Xt.prototype.kelvin=Xt.prototype.temperature=function(){return $R(this._rgb)};Re.temp=Re.kelvin=Re.temperature=(...i)=>new Xt(...i,"temp");Se.format.temp=Se.format.kelvin=Se.format.temperature=vx;const{pow:$l,sign:JR}=Math,Ox=(...i)=>{i=ke(i,"lab");const[t,e,n]=i,s=$l(t+.3963377774*e+.2158037573*n,3),a=$l(t-.1055613458*e-.0638541728*n,3),l=$l(t-.0894841775*e-1.291485548*n,3);return[255*oc(4.0767416621*s-3.3077115913*a+.2309699292*l),255*oc(-1.2684380046*s+2.6097574011*a-.3413193965*l),255*oc(-.0041960863*s-.7034186147*a+1.707614701*l),i.length>3?i[3]:1]};function oc(i){const t=Math.abs(i);return t>.0031308?(JR(i)||1)*(1.055*$l(t,1/2.4)-.055):i*12.92}const{cbrt:lc,pow:QR,sign:t8}=Math,Px=(...i)=>{const[t,e,n]=ke(i,"rgb"),[s,a,l]=[hc(t/255),hc(e/255),hc(n/255)],u=lc(.4122214708*s+.5363325363*a+.0514459929*l),c=lc(.2119034982*s+.6806995451*a+.1073969566*l),p=lc(.0883024619*s+.2817188376*a+.6299787005*l);return[.2104542553*u+.793617785*c-.0040720468*p,1.9779984951*u-2.428592205*c+.4505937099*p,.0259040371*u+.7827717662*c-.808675766*p]};function hc(i){const t=Math.abs(i);return t<.04045?i/12.92:(t8(i)||1)*QR((t+.055)/1.055,2.4)}Xt.prototype.oklab=function(){return Px(this._rgb)};Re.oklab=(...i)=>new Xt(...i,"oklab");Se.format.oklab=Ox;Se.autodetect.push({p:3,test:(...i)=>{if(i=ke(i,"oklab"),Le(i)==="array"&&i.length===3)return"oklab"}});const e8=(...i)=>{i=ke(i,"lch");const[t,e,n]=i,[s,a,l]=Rx(t,e,n),[u,c,p]=Ox(s,a,l);return[u,c,p,i.length>3?i[3]:1]},i8=(...i)=>{const[t,e,n]=ke(i,"rgb"),[s,a,l]=Px(t,e,n);return Tx(s,a,l)};Xt.prototype.oklch=function(){return i8(this._rgb)};Re.oklch=(...i)=>new Xt(...i,"oklch");Se.format.oklch=e8;Se.autodetect.push({p:3,test:(...i)=>{if(i=ke(i,"oklch"),Le(i)==="array"&&i.length===3)return"oklch"}});Xt.prototype.alpha=function(i,t=!1){return i!==void 0&&Le(i)==="number"?t?(this._rgb[3]=i,this):new Xt([this._rgb[0],this._rgb[1],this._rgb[2],i],"rgb"):this._rgb[3]};Xt.prototype.clipped=function(){return this._rgb._clipped||!1};Xt.prototype.darken=function(i=1){const t=this,e=t.lab();return e[0]-=wn.Kn*i,new Xt(e,"lab").alpha(t.alpha(),!0)};Xt.prototype.brighten=function(i=1){return this.darken(-i)};Xt.prototype.darker=Xt.prototype.darken;Xt.prototype.brighter=Xt.prototype.brighten;Xt.prototype.get=function(i){const[t,e]=i.split("."),n=this[t]();if(e){const s=t.indexOf(e)-(t.substr(0,2)==="ok"?2:0);if(s>-1)return n[s];throw new Error(`unknown channel ${e} in mode ${t}`)}else return n};const{pow:n8}=Math,s8=1e-7,r8=20;Xt.prototype.luminance=function(i,t="rgb"){if(i!==void 0&&Le(i)==="number"){if(i===0)return new Xt([0,0,0,this._rgb[3]],"rgb");if(i===1)return new Xt([255,255,255,this._rgb[3]],"rgb");let e=this.luminance(),n=r8;const s=(l,u)=>{const c=l.interpolate(u,.5,t),p=c.luminance();return Math.abs(i-p)<s8||!n--?c:p>i?s(l,c):s(c,u)},a=(e>i?s(new Xt([0,0,0]),this):s(this,new Xt([255,255,255]))).rgb();return new Xt([...a,this._rgb[3]])}return a8(...this._rgb.slice(0,3))};const a8=(i,t,e)=>(i=uc(i),t=uc(t),e=uc(e),.2126*i+.7152*t+.0722*e),uc=i=>(i/=255,i<=.03928?i/12.92:n8((i+.055)/1.055,2.4)),nn={},Ko=(i,t,e=.5,...n)=>{let s=n[0]||"lrgb";if(!nn[s]&&!n.length&&(s=Object.keys(nn)[0]),!nn[s])throw new Error(`interpolation mode ${s} is not defined`);return Le(i)!=="object"&&(i=new Xt(i)),Le(t)!=="object"&&(t=new Xt(t)),nn[s](i,t,e).alpha(i.alpha()+e*(t.alpha()-i.alpha()))};Xt.prototype.mix=Xt.prototype.interpolate=function(i,t=.5,...e){return Ko(this,i,t,...e)};Xt.prototype.premultiply=function(i=!1){const t=this._rgb,e=t[3];return i?(this._rgb=[t[0]*e,t[1]*e,t[2]*e,e],this):new Xt([t[0]*e,t[1]*e,t[2]*e,e],"rgb")};Xt.prototype.saturate=function(i=1){const t=this,e=t.lch();return e[1]+=wn.Kn*i,e[1]<0&&(e[1]=0),new Xt(e,"lch").alpha(t.alpha(),!0)};Xt.prototype.desaturate=function(i=1){return this.saturate(-i)};Xt.prototype.set=function(i,t,e=!1){const[n,s]=i.split("."),a=this[n]();if(s){const l=n.indexOf(s)-(n.substr(0,2)==="ok"?2:0);if(l>-1){if(Le(t)=="string")switch(t.charAt(0)){case"+":a[l]+=+t;break;case"-":a[l]+=+t;break;case"*":a[l]*=+t.substr(1);break;case"/":a[l]/=+t.substr(1);break;default:a[l]=+t}else if(Le(t)==="number")a[l]=t;else throw new Error("unsupported value for Color.set");const u=new Xt(a,n);return e?(this._rgb=u._rgb,this):u}throw new Error(`unknown channel ${s} in mode ${n}`)}else return a};Xt.prototype.tint=function(i=.5,...t){return Ko(this,"white",i,...t)};Xt.prototype.shade=function(i=.5,...t){return Ko(this,"black",i,...t)};const o8=(i,t,e)=>{const n=i._rgb,s=t._rgb;return new Xt(n[0]+e*(s[0]-n[0]),n[1]+e*(s[1]-n[1]),n[2]+e*(s[2]-n[2]),"rgb")};nn.rgb=o8;const{sqrt:cc,pow:ua}=Math,l8=(i,t,e)=>{const[n,s,a]=i._rgb,[l,u,c]=t._rgb;return new Xt(cc(ua(n,2)*(1-e)+ua(l,2)*e),cc(ua(s,2)*(1-e)+ua(u,2)*e),cc(ua(a,2)*(1-e)+ua(c,2)*e),"rgb")};nn.lrgb=l8;const h8=(i,t,e)=>{const n=i.lab(),s=t.lab();return new Xt(n[0]+e*(s[0]-n[0]),n[1]+e*(s[1]-n[1]),n[2]+e*(s[2]-n[2]),"lab")};nn.lab=h8;const Ga=(i,t,e,n)=>{let s,a;n==="hsl"?(s=i.hsl(),a=t.hsl()):n==="hsv"?(s=i.hsv(),a=t.hsv()):n==="hcg"?(s=i.hcg(),a=t.hcg()):n==="hsi"?(s=i.hsi(),a=t.hsi()):n==="lch"||n==="hcl"?(n="hcl",s=i.hcl(),a=t.hcl()):n==="oklch"&&(s=i.oklch().reverse(),a=t.oklch().reverse());let l,u,c,p,y,_;(n.substr(0,1)==="h"||n==="oklch")&&([l,c,y]=s,[u,p,_]=a);let E,I,S,R;return!isNaN(l)&&!isNaN(u)?(u>l&&u-l>180?R=u-(l+360):u<l&&l-u>180?R=u+360-l:R=u-l,I=l+e*R):isNaN(l)?isNaN(u)?I=Number.NaN:(I=u,(y==1||y==0)&&n!="hsv"&&(E=p)):(I=l,(_==1||_==0)&&n!="hsv"&&(E=c)),E===void 0&&(E=c+e*(p-c)),S=y+e*(_-y),n==="oklch"?new Xt([S,E,I],n):new Xt([I,E,S],n)},Nx=(i,t,e)=>Ga(i,t,e,"lch");nn.lch=Nx;nn.hcl=Nx;const u8=(i,t,e)=>{const n=i.num(),s=t.num();return new Xt(n+e*(s-n),"num")};nn.num=u8;const c8=(i,t,e)=>Ga(i,t,e,"hcg");nn.hcg=c8;const f8=(i,t,e)=>Ga(i,t,e,"hsi");nn.hsi=f8;const d8=(i,t,e)=>Ga(i,t,e,"hsl");nn.hsl=d8;const g8=(i,t,e)=>Ga(i,t,e,"hsv");nn.hsv=g8;const m8=(i,t,e)=>{const n=i.oklab(),s=t.oklab();return new Xt(n[0]+e*(s[0]-n[0]),n[1]+e*(s[1]-n[1]),n[2]+e*(s[2]-n[2]),"oklab")};nn.oklab=m8;const p8=(i,t,e)=>Ga(i,t,e,"oklch");nn.oklch=p8;const{pow:fc,sqrt:dc,PI:gc,cos:jp,sin:Hp,atan2:y8}=Math,x8=(i,t="lrgb",e=null)=>{const n=i.length;e||(e=Array.from(new Array(n)).map(()=>1));const s=n/e.reduce(function(_,E){return _+E});if(e.forEach((_,E)=>{e[E]*=s}),i=i.map(_=>new Xt(_)),t==="lrgb")return _8(i,e);const a=i.shift(),l=a.get(t),u=[];let c=0,p=0;for(let _=0;_<l.length;_++)if(l[_]=(l[_]||0)*e[0],u.push(isNaN(l[_])?0:e[0]),t.charAt(_)==="h"&&!isNaN(l[_])){const E=l[_]/180*gc;c+=jp(E)*e[0],p+=Hp(E)*e[0]}let y=a.alpha()*e[0];i.forEach((_,E)=>{const I=_.get(t);y+=_.alpha()*e[E+1];for(let S=0;S<l.length;S++)if(!isNaN(I[S]))if(u[S]+=e[E+1],t.charAt(S)==="h"){const R=I[S]/180*gc;c+=jp(R)*e[E+1],p+=Hp(R)*e[E+1]}else l[S]+=I[S]*e[E+1]});for(let _=0;_<l.length;_++)if(t.charAt(_)==="h"){let E=y8(p/u[_],c/u[_])/gc*180;for(;E<0;)E+=360;for(;E>=360;)E-=360;l[_]=E}else l[_]=l[_]/u[_];return y/=n,new Xt(l,t).alpha(y>.99999?1:y,!0)},_8=(i,t)=>{const e=i.length,n=[0,0,0,0];for(let s=0;s<i.length;s++){const a=i[s],l=t[s]/e,u=a._rgb;n[0]+=fc(u[0],2)*l,n[1]+=fc(u[1],2)*l,n[2]+=fc(u[2],2)*l,n[3]+=u[3]*l}return n[0]=dc(n[0]),n[1]=dc(n[1]),n[2]=dc(n[2]),n[3]>.9999999&&(n[3]=1),new Xt(p0(n))},{pow:w8}=Math;function Ih(i){let t="rgb",e=Re("#ccc"),n=0,s=[0,1],a=[],l=[0,0],u=!1,c=[],p=!1,y=0,_=1,E=!1,I={},S=!0,R=1;const D=function(z){if(z=z||["#fff","#000"],z&&Le(z)==="string"&&Re.brewer&&Re.brewer[z.toLowerCase()]&&(z=Re.brewer[z.toLowerCase()]),Le(z)==="array"){z.length===1&&(z=[z[0],z[0]]),z=z.slice(0);for(let q=0;q<z.length;q++)z[q]=Re(z[q]);a.length=0;for(let q=0;q<z.length;q++)a.push(q/(z.length-1))}return H(),c=z},T=function(z){if(u!=null){const q=u.length-1;let V=0;for(;V<q&&z>=u[V];)V++;return V-1}return 0};let v=z=>z,k=z=>z;const X=function(z,q){let V,nt;if(q==null&&(q=!1),isNaN(z)||z===null)return e;q?nt=z:u&&u.length>2?nt=T(z)/(u.length-2):_!==y?nt=(z-y)/(_-y):nt=1,nt=k(nt),q||(nt=v(nt)),R!==1&&(nt=w8(nt,R)),nt=l[0]+nt*(1-l[0]-l[1]),nt=wa(nt,0,1);const ot=Math.floor(nt*1e4);if(S&&I[ot])V=I[ot];else{if(Le(c)==="array")for(let j=0;j<a.length;j++){const tt=a[j];if(nt<=tt){V=c[j];break}if(nt>=tt&&j===a.length-1){V=c[j];break}if(nt>tt&&nt<a[j+1]){nt=(nt-tt)/(a[j+1]-tt),V=Re.interpolate(c[j],c[j+1],nt,t);break}}else Le(c)==="function"&&(V=c(nt));S&&(I[ot]=V)}return V};var H=()=>I={};D(i);const K=function(z){const q=Re(X(z));return p&&q[p]?q[p]():q};return K.classes=function(z){if(z!=null){if(Le(z)==="array")u=z,s=[z[0],z[z.length-1]];else{const q=Re.analyze(s);z===0?u=[q.min,q.max]:u=Re.limits(q,"e",z)}return K}return u},K.domain=function(z){if(!arguments.length)return s;y=z[0],_=z[z.length-1],a=[];const q=c.length;if(z.length===q&&y!==_)for(let V of Array.from(z))a.push((V-y)/(_-y));else{for(let V=0;V<q;V++)a.push(V/(q-1));if(z.length>2){const V=z.map((ot,j)=>j/(z.length-1)),nt=z.map(ot=>(ot-y)/(_-y));nt.every((ot,j)=>V[j]===ot)||(k=ot=>{if(ot<=0||ot>=1)return ot;let j=0;for(;ot>=nt[j+1];)j++;const tt=(ot-nt[j])/(nt[j+1]-nt[j]);return V[j]+tt*(V[j+1]-V[j])})}}return s=[y,_],K},K.mode=function(z){return arguments.length?(t=z,H(),K):t},K.range=function(z,q){return D(z),K},K.out=function(z){return p=z,K},K.spread=function(z){return arguments.length?(n=z,K):n},K.correctLightness=function(z){return z==null&&(z=!0),E=z,H(),E?v=function(q){const V=X(0,!0).lab()[0],nt=X(1,!0).lab()[0],ot=V>nt;let j=X(q,!0).lab()[0];const tt=V+(nt-V)*q;let N=j-tt,Z=0,ft=1,rt=20;for(;Math.abs(N)>.01&&rt-- >0;)(function(){return ot&&(N*=-1),N<0?(Z=q,q+=(ft-q)*.5):(ft=q,q+=(Z-q)*.5),j=X(q,!0).lab()[0],N=j-tt})();return q}:v=q=>q,K},K.padding=function(z){return z!=null?(Le(z)==="number"&&(z=[z,z]),l=z,K):l},K.colors=function(z,q){arguments.length<2&&(q="hex");let V=[];if(arguments.length===0)V=c.slice(0);else if(z===1)V=[K(.5)];else if(z>1){const nt=s[0],ot=s[1]-nt;V=b8(0,z,!1).map(j=>K(nt+j/(z-1)*ot))}else{i=[];let nt=[];if(u&&u.length>2)for(let ot=1,j=u.length,tt=1<=j;tt?ot<j:ot>j;tt?ot++:ot--)nt.push((u[ot-1]+u[ot])*.5);else nt=s;V=nt.map(ot=>K(ot))}return Re[q]&&(V=V.map(nt=>nt[q]())),V},K.cache=function(z){return z!=null?(S=z,K):S},K.gamma=function(z){return z!=null?(R=z,K):R},K.nodata=function(z){return z!=null?(e=Re(z),K):e},K}function b8(i,t,e){let n=[],s=i<t,a=e?s?t+1:t-1:t;for(let l=i;s?l<a:l>a;s?l++:l--)n.push(l);return n}const E8=function(i){let t=[1,1];for(let e=1;e<i;e++){let n=[1];for(let s=1;s<=t.length;s++)n[s]=(t[s]||0)+t[s-1];t=n}return t},I8=function(i){let t,e,n,s;if(i=i.map(a=>new Xt(a)),i.length===2)[e,n]=i.map(a=>a.lab()),t=function(a){const l=[0,1,2].map(u=>e[u]+a*(n[u]-e[u]));return new Xt(l,"lab")};else if(i.length===3)[e,n,s]=i.map(a=>a.lab()),t=function(a){const l=[0,1,2].map(u=>(1-a)*(1-a)*e[u]+2*(1-a)*a*n[u]+a*a*s[u]);return new Xt(l,"lab")};else if(i.length===4){let a;[e,n,s,a]=i.map(l=>l.lab()),t=function(l){const u=[0,1,2].map(c=>(1-l)*(1-l)*(1-l)*e[c]+3*(1-l)*(1-l)*l*n[c]+3*(1-l)*l*l*s[c]+l*l*l*a[c]);return new Xt(u,"lab")}}else if(i.length>=5){let a,l,u;a=i.map(c=>c.lab()),u=i.length-1,l=E8(u),t=function(c){const p=1-c,y=[0,1,2].map(_=>a.reduce((E,I,S)=>E+l[S]*p**(u-S)*c**S*I[_],0));return new Xt(y,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return t},C8=i=>{const t=I8(i);return t.scale=()=>Ih(t),t},ts=(i,t,e)=>{if(!ts[e])throw new Error("unknown blend mode "+e);return ts[e](i,t)},wr=i=>(t,e)=>{const n=Re(e).rgb(),s=Re(t).rgb();return Re.rgb(i(n,s))},br=i=>(t,e)=>{const n=[];return n[0]=i(t[0],e[0]),n[1]=i(t[1],e[1]),n[2]=i(t[2],e[2]),n},A8=i=>i,R8=(i,t)=>i*t/255,S8=(i,t)=>i>t?t:i,T8=(i,t)=>i>t?i:t,D8=(i,t)=>255*(1-(1-i/255)*(1-t/255)),M8=(i,t)=>t<128?2*i*t/255:255*(1-2*(1-i/255)*(1-t/255)),v8=(i,t)=>255*(1-(1-t/255)/(i/255)),O8=(i,t)=>i===255?255:(i=255*(t/255)/(1-i/255),i>255?255:i);ts.normal=wr(br(A8));ts.multiply=wr(br(R8));ts.screen=wr(br(D8));ts.overlay=wr(br(M8));ts.darken=wr(br(S8));ts.lighten=wr(br(T8));ts.dodge=wr(br(O8));ts.burn=wr(br(v8));const{pow:P8,sin:N8,cos:L8}=Math;function k8(i=300,t=-1.5,e=1,n=1,s=[0,1]){let a=0,l;Le(s)==="array"?l=s[1]-s[0]:(l=0,s=[s,s]);const u=function(c){const p=Ps*((i+120)/360+t*c),y=P8(s[0]+l*c,n),E=(a!==0?e[0]+c*a:e)*y*(1-y)/2,I=L8(p),S=N8(p),R=y+E*(-.14861*I+1.78277*S),D=y+E*(-.29227*I-.90649*S),T=y+E*(1.97294*I);return Re(p0([R*255,D*255,T*255,1]))};return u.start=function(c){return c==null?i:(i=c,u)},u.rotations=function(c){return c==null?t:(t=c,u)},u.gamma=function(c){return c==null?n:(n=c,u)},u.hue=function(c){return c==null?e:(e=c,Le(e)==="array"?(a=e[1]-e[0],a===0&&(e=e[1])):a=0,u)},u.lightness=function(c){return c==null?s:(Le(c)==="array"?(s=c,l=c[1]-c[0]):(s=[c,c],l=0),u)},u.scale=()=>Re.scale(u),u.hue(e),u}const F8="0123456789abcdef",{floor:B8,random:V8}=Math,G8=()=>{let i="#";for(let t=0;t<6;t++)i+=F8.charAt(B8(V8()*16));return new Xt(i,"hex")},{log:Yp,pow:z8,floor:U8,abs:W8}=Math;function Lx(i,t=null){const e={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return Le(i)==="object"&&(i=Object.values(i)),i.forEach(n=>{t&&Le(n)==="object"&&(n=n[t]),n!=null&&!isNaN(n)&&(e.values.push(n),e.sum+=n,n<e.min&&(e.min=n),n>e.max&&(e.max=n),e.count+=1)}),e.domain=[e.min,e.max],e.limits=(n,s)=>kx(e,n,s),e}function kx(i,t="equal",e=7){Le(i)=="array"&&(i=Lx(i));const{min:n,max:s}=i,a=i.values.sort((u,c)=>u-c);if(e===1)return[n,s];const l=[];if(t.substr(0,1)==="c"&&(l.push(n),l.push(s)),t.substr(0,1)==="e"){l.push(n);for(let u=1;u<e;u++)l.push(n+u/e*(s-n));l.push(s)}else if(t.substr(0,1)==="l"){if(n<=0)throw new Error("Logarithmic scales are only possible for values > 0");const u=Math.LOG10E*Yp(n),c=Math.LOG10E*Yp(s);l.push(n);for(let p=1;p<e;p++)l.push(z8(10,u+p/e*(c-u)));l.push(s)}else if(t.substr(0,1)==="q"){l.push(n);for(let u=1;u<e;u++){const c=(a.length-1)*u/e,p=U8(c);if(p===c)l.push(a[p]);else{const y=c-p;l.push(a[p]*(1-y)+a[p+1]*y)}}l.push(s)}else if(t.substr(0,1)==="k"){let u;const c=a.length,p=new Array(c),y=new Array(e);let _=!0,E=0,I=null;I=[],I.push(n);for(let D=1;D<e;D++)I.push(n+D/e*(s-n));for(I.push(s);_;){for(let T=0;T<e;T++)y[T]=0;for(let T=0;T<c;T++){const v=a[T];let k=Number.MAX_VALUE,X;for(let H=0;H<e;H++){const K=W8(I[H]-v);K<k&&(k=K,X=H),y[X]++,p[T]=X}}const D=new Array(e);for(let T=0;T<e;T++)D[T]=null;for(let T=0;T<c;T++)u=p[T],D[u]===null?D[u]=a[T]:D[u]+=a[T];for(let T=0;T<e;T++)D[T]*=1/y[T];_=!1;for(let T=0;T<e;T++)if(D[T]!==I[T]){_=!0;break}I=D,E++,E>200&&(_=!1)}const S={};for(let D=0;D<e;D++)S[D]=[];for(let D=0;D<c;D++)u=p[D],S[u].push(a[D]);let R=[];for(let D=0;D<e;D++)R.push(S[D][0]),R.push(S[D][S[D].length-1]);R=R.sort((D,T)=>D-T),l.push(R[0]);for(let D=1;D<R.length;D+=2){const T=R[D];!isNaN(T)&&l.indexOf(T)===-1&&l.push(T)}}return l}const X8=(i,t)=>{i=new Xt(i),t=new Xt(t);const e=i.luminance(),n=t.luminance();return e>n?(e+.05)/(n+.05):(n+.05)/(e+.05)},{sqrt:Ss,pow:vi,min:j8,max:H8,atan2:Zp,abs:Kp,cos:jl,sin:qp,exp:Y8,PI:$p}=Math;function Z8(i,t,e=1,n=1,s=1){var a=function(Pt){return 360*Pt/(2*$p)},l=function(Pt){return 2*$p*Pt/360};i=new Xt(i),t=new Xt(t);const[u,c,p]=Array.from(i.lab()),[y,_,E]=Array.from(t.lab()),I=(u+y)/2,S=Ss(vi(c,2)+vi(p,2)),R=Ss(vi(_,2)+vi(E,2)),D=(S+R)/2,T=.5*(1-Ss(vi(D,7)/(vi(D,7)+vi(25,7)))),v=c*(1+T),k=_*(1+T),X=Ss(vi(v,2)+vi(p,2)),H=Ss(vi(k,2)+vi(E,2)),K=(X+H)/2,z=a(Zp(p,v)),q=a(Zp(E,k)),V=z>=0?z:z+360,nt=q>=0?q:q+360,ot=Kp(V-nt)>180?(V+nt+360)/2:(V+nt)/2,j=1-.17*jl(l(ot-30))+.24*jl(l(2*ot))+.32*jl(l(3*ot+6))-.2*jl(l(4*ot-63));let tt=nt-V;tt=Kp(tt)<=180?tt:nt<=V?tt+360:tt-360,tt=2*Ss(X*H)*qp(l(tt)/2);const N=y-u,Z=H-X,ft=1+.015*vi(I-50,2)/Ss(20+vi(I-50,2)),rt=1+.045*K,At=1+.015*K*j,bt=30*Y8(-vi((ot-275)/25,2)),ct=-(2*Ss(vi(K,7)/(vi(K,7)+vi(25,7))))*qp(2*l(bt)),at=Ss(vi(N/(e*ft),2)+vi(Z/(n*rt),2)+vi(tt/(s*At),2)+ct*(Z/(n*rt))*(tt/(s*At)));return H8(0,j8(100,at))}function K8(i,t,e="lab"){i=new Xt(i),t=new Xt(t);const n=i.get(e),s=t.get(e);let a=0;for(let l in n){const u=(n[l]||0)-(s[l]||0);a+=u*u}return Math.sqrt(a)}const q8=(...i)=>{try{return new Xt(...i),!0}catch{return!1}},$8={cool(){return Ih([Re.hsl(180,1,.9),Re.hsl(250,.7,.4)])},hot(){return Ih(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Jl={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]};for(let i of Object.keys(Jl))Jl[i.toLowerCase()]=Jl[i];Object.assign(Re,{average:x8,bezier:C8,blend:ts,cubehelix:k8,mix:Ko,interpolate:Ko,random:G8,scale:Ih,analyze:Lx,contrast:X8,deltaE:Z8,distance:K8,limits:kx,valid:q8,scales:$8,input:Se,colors:Pa,brewer:Jl});function of(i){return Array.isArray(i)?Math.min(...i):i}class J8 extends vf{constructor(t,e,n,s,a,l,u){let c=t.getExtent();c&&t.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);let p=e.getExtent();p&&e.canWrapX()&&(p=p.slice(),p[0]=-1/0,p[2]=1/0);const y=p?kr(n,p):n,_=ps(y),E=Nc(t,e,_,s),I=yy,S=new xy(t,e,y,c,E*I,s),R=S.calculateSourceExtent(),D=Na(R)?null:l(R,E,a),T=D?se.IDLE:se.EMPTY,v=D?D.getPixelRatio():1;super(n,s,v,T),this.targetProj_=e,this.maxSourceExtent_=c,this.triangulation_=S,this.targetResolution_=s,this.targetExtent_=n,this.sourceImage_=D,this.sourcePixelRatio_=v,this.interpolate_=u,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==se.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const t=this.sourceImage_.getState();if(t==se.LOADED){const e=Ve(this.targetExtent_)/this.targetResolution_,n=Oi(this.targetExtent_)/this.targetResolution_;this.canvas_=_y(e,n,this.sourcePixelRatio_,of(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=t,this.changed()}load(){if(this.state==se.IDLE){this.state=se.LOADING,this.changed();const t=this.sourceImage_.getState();t==se.LOADED||t==se.ERROR?this.reproject_():(this.sourceListenerKey_=We(this.sourceImage_,_e.CHANGE,function(e){const n=this.sourceImage_.getState();(n==se.LOADED||n==se.ERROR)&&(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}}unlistenSource_(){oi(this.sourceListenerKey_),this.sourceListenerKey_=null}}const Hl=4,mc={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class Q8 extends ys{constructor(t,e){super(t),this.image=e}}class t6 extends Xf{constructor(t){super({attributions:t.attributions,projection:t.projection,state:t.state,interpolate:t.interpolate!==void 0?t.interpolate:!0}),this.on,this.once,this.un,this.loader=t.loader||null,this.resolutions_=t.resolutions!==void 0?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=t.loader?t.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(t){this.resolutions_=t}findNearestResolution(t){const e=this.getResolutions();if(e){const n=Ch(e,t,0);t=e[n]}return t}getImage(t,e,n,s){const a=this.getProjection();if(!a||!s||Ns(a,s))return a&&(s=a),this.getImageInternal(t,e,n,s);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Ns(this.reprojectedImage_.getProjection(),s)&&this.reprojectedImage_.getResolution()==e&&Ia(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new J8(a,s,t,e,n,(l,u,c)=>this.getImageInternal(l,u,c,a),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(t,e,n,s){if(this.loader){const a=i6(t,e,n,1),l=this.findNearestResolution(e);if(this.image&&(this.static_||this.wantedProjection_===s&&(this.wantedExtent_&&us(this.wantedExtent_,a)||us(this.image.getExtent(),a))&&(this.wantedResolution_&&of(this.wantedResolution_)===l||of(this.image.getResolution())===l)))return this.image;this.wantedProjection_=s,this.wantedExtent_=a,this.wantedResolution_=l,this.image=new vf(a,l,n,this.loader),this.image.addEventListener(_e.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(t){const e=t.target;let n;switch(e.getState()){case se.LOADING:this.loading=!0,n=mc.IMAGELOADSTART;break;case se.LOADED:this.loading=!1,n=mc.IMAGELOADEND;break;case se.ERROR:this.loading=!1,n=mc.IMAGELOADERROR;break;default:return}this.hasListener(n)&&this.dispatchEvent(new Q8(n,e))}}function e6(i,t){i.getImage().src=t}function i6(i,t,e,n){const s=t/e,a=ps(i),l=ar(Ve(i)/s,Hl),u=ar(Oi(i)/s,Hl),c=ar((n-1)*l/2,Hl),p=l+2*c,y=ar((n-1)*u/2,Hl),_=u+2*y;return th(a,s,0,[p,_])}function n6(i){const t=i.load||N2,e=i.imageExtent,n=new Image;return i.crossOrigin!==null&&(n.crossOrigin=i.crossOrigin),()=>t(n,i.url).then(s=>{const a=Ve(e)/s.width,l=Oi(e)/s.height;return{image:s,extent:e,resolution:a!==l?[a,l]:l,pixelRatio:1}})}class s6 extends t6{constructor(t){const e=t.crossOrigin!==void 0?t.crossOrigin:null,n=t.imageLoadFunction!==void 0?t.imageLoadFunction:e6;super({attributions:t.attributions,interpolate:t.interpolate,projection:li(t.projection)}),this.url_=t.url,this.imageExtent_=t.imageExtent,this.image=null,this.image=new vf(this.imageExtent_,void 0,1,n6({url:t.url,imageExtent:t.imageExtent,crossOrigin:e,load:(s,a)=>(this.image.setImage(s),n(this.image,a),N2(s))})),this.image.addEventListener(_e.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(t,e,n,s){return en(t,this.image.getExtent())?this.image:null}getUrl(){return this.url_}}async function r6(i){let t="";for(let n of XC){let s=i.get(n.attrid);if(s!=null){s=s.toString();let a;s&&s.startsWith("http://")||s.startsWith("https://")?a=`<a target="_blank" href="${s}">${s}</a></td></tr>`:a=s,t+=`<tr><td>${n.label}</td><td>${a}</td></tr>`}}const e=i.get(nr);if(e){const n=await cl.toDataURL(e);t+=`
                <tr><td>Auflösbarer Identifier</td><td><a target="_blank" href="${e}">${e}</a></td></tr>
                <tr><td>QR-Code</td><td style="text-align: center;"><img src="${n}"/></td></tr>`}return t}let Bn=!1;document.getElementById("loginBtn").onclick=i=>{const t=document.getElementById("user").value,e=document.getElementById("pwd").value;localStorage.setItem("lastUser",t),Fx(t,e)};try{const i=new AbortController,t=setTimeout(()=>i.abort(),1e3),e=await fetch(rs+"/geoserver/wfs?service=WFS&version=1.1.0&request=GetCapabilities",{signal:i.signal});clearTimeout(t);const n=await e.text();Bn=!0}catch{Bn=!1}if(!Bn){const i=localStorage.getItem("lastUser");Fx(i)}async function Fx(i,t){const e=document.getElementById("loginDiv");e.parentNode.removeChild(e);const n=await UI("hofapp",20,{upgrade(V,nt,ot,j,tt){V.objectStoreNames.contains("imgs")&&V.deleteObjectStore("imgs"),V.objectStoreNames.contains("txt")&&V.deleteObjectStore("txt"),V.objectStoreNames.contains("file")&&V.deleteObjectStore("file"),V.createObjectStore("imgs",{keyPath:"url"}).createIndex("url","url"),V.createObjectStore("txt",{keyPath:"url"}).createIndex("url","url");const ft=V.createObjectStore("file",{keyPath:"filename"});ft.createIndex("filename","filename"),ft.createIndex(nr,nr,{unique:!1}),ft.createIndex("uploadpending","uploadpending",{unique:!1}),ft.createIndex("removalpending","removalpending",{unique:!1})}});function s(V,nt={}){return ul(i,t,V,nt)}async function a(V,nt,ot){if(Bn){const j=await(await V(nt,ot)).text();return n.transaction("txt","readwrite").objectStore("txt").put({url:nt,data:j}),j}else return(await n.transaction("txt","readonly").objectStore("txt").get(nt)).data}async function l(V,nt){const ot=[];if(Bn){const j=await a(s,rs+"/geoserver/wfs/?service=WFS&version=2.0.0&request=GetFeature&typeNames="+er+"&cql_filter=mimetype=%27application%2Fgpx%2Bxml%27&outputformat=json"),tt=JSON.parse(j);for(const N of tt.features)ot.push(N.properties.fdata)}else{const tt=(await n.transaction("file","readonly").objectStore("file").index("removalpending").getAll(IDBKeyRange.only(0))).filter(N=>N.filename.indexOf(".gpx")>-1);for(const N of tt){let Z=await blobToBase64(N.blob);Z=Z.substring(Z.indexOf(",")+1),ot.push(Z)}}nt.getSource().clear();for(const j of ot){const tt=window.atob(j),N=nt.getSource().getFormat().readFeatures(tt,{featureProjection:V.getView().getProjection()});nt.getSource().addFeatures(N)}}function u(V,nt){let ot=1/0,j=-1/0;if(V.attributes.GridType===Vr.GridType1)V.getAllReferencedTZNCodes().forEach(N=>{const ft=nt.find(rt=>rt.attributes.TreatmentZoneCode===N)?.attributes.ProcessDataVariable?.[0];if(ft){const rt=ft.attributes.ProcessDataValue;rt&&(ot=Math.min(ot,rt),j=Math.max(j,rt))}});else{const tt=V.attributes.GridMaximumColumn,N=V.attributes.GridMaximumRow,Z=new Int32Array(V.binaryData.buffer);for(let ft=0;ft<N*tt;ft++)Z[ft]&&(ot=Math.min(ot,Z[ft]),j=Math.max(j,Z[ft]))}return ot===1/0?{min:0,max:0}:{min:ot,max:j}}function c(V,nt){const ot=V.attributes.GridMaximumColumn,j=V.attributes.GridMaximumRow,tt=document.createElement("canvas");tt.width=ot,tt.height=j;const N=Re.scale(Re.brewer.RdYlGn.slice(0).reverse()),Z=Re.scale(N.colors()).domain([nt.min,nt.max]),ft=tt.getContext("2d"),rt=ft.getImageData(0,0,tt.width,tt.height);if(V.attributes.GridType===Vr.GridType1){const At={};treatmentZones.forEach(Dt=>{const ct=Dt.attributes.TreatmentZoneCode,at=Dt.attributes.ProcessDataVariable?.[0]?.attributes.ProcessDataValue;At[ct]=at});const bt=new Uint8Array(V.binaryData.buffer);for(let Dt=0;Dt<j;Dt++)for(let ct=0;ct<ot;ct++){const at=bt[Dt*ot+ct],Pt=At[at];if(Pt===0||Pt===void 0)continue;const mt=Z(Pt).rgba(),Lt=4*((j-Dt-1)*ot+ct);rt.data[Lt+0]=mt[0],rt.data[Lt+1]=mt[1],rt.data[Lt+2]=mt[2],rt.data[Lt+3]=255}}else{const At=new Int32Array(V.binaryData.buffer);for(let bt=0;bt<j;bt++)for(let Dt=0;Dt<ot;Dt++){const ct=At[bt*ot+Dt];if(ct===0)continue;const at=Z(ct).rgba(),Pt=4*((j-bt-1)*ot+Dt);rt.data[Pt+0]=at[0],rt.data[Pt+1]=at[1],rt.data[Pt+2]=at[2],rt.data[Pt+3]=255}}return ft.putImageData(rt,0,0),tt.toDataURL()}async function p(V,nt){const ot=new Zo,j=[];if(Bn){const tt=await a(s,rs+"/geoserver/wfs/?service=WFS&version=2.0.0&request=GetFeature&typeNames="+er+"&cql_filter=mimetype=%27application%2Fisoxml%27&outputformat=json"),N=JSON.parse(tt);for(const Z of N.features)j.push(Z.properties.fdata)}else{const N=(await n.transaction("file","readonly").objectStore("file").index("removalpending").getAll(IDBKeyRange.only(0))).filter(Z=>Z.filename.indexOf(".isoxml")>-1);for(const Z of N){let ft=await blobToBase64(Z.blob);ft=ft.substring(ft.indexOf(",")+1),j.push(ft)}}nt.getSource().clear(),E.forEach(tt=>V.removeLayer(tt)),E.length=0;for(const tt of j){const N=Uint8Array.from(atob(tt),Z=>Z.charCodeAt(0));ot.parseISOXMLFile(N.buffer,"application/zip").then(()=>{const Z=ot.rootElement.attributes.Partfield||[],ft=ot.rootElement.attributes.Task.filter(rt=>rt.attributes.Grid.length>0);for(const rt of ft){const At=rt.attributes.Grid[0],bt=At.attributes,Dt=u(At,rt.attributes.TreatmentZone||[]),ct=c(At,Dt),at=[bt.GridMinimumEastPosition,bt.GridMinimumNorthPosition,bt.GridMinimumEastPosition+bt.GridCellEastSize*bt.GridMaximumColumn,bt.GridMinimumNorthPosition+bt.GridCellNorthSize*bt.GridMaximumRow],Pt=new yR({source:new s6({url:ct,projection:"EPSG:4326",imageExtent:at,interpolate:!1})});E.push(Pt),V.addLayer(Pt)}Z.forEach(rt=>{const At=rt.toGeoJSON(),bt=nt.getSource().getFormat().readFeatures(At,{featureProjection:V.getView().getProjection()});nt.getSource().addFeatures(bt),console.log(At)})})}}const y=new Ou({source:new Nu({format:new BE})}),_=new Ou({source:new Nu({format:new y1})});_.setZIndex(-1);const E=[];Bl.defs("EPSG:31287","+proj=lcc +lat_0=47.5 +lon_0=13.3333333333333 +lat_1=49 +lat_2=46 +x_0=400000 +y_0=400000 +ellps=bessel +towgs84=577.326,90.129,463.919,5.137,1.474,5.297,2.4232 +units=m +no_defs +type=crs"),Bl.defs("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs +type=crs"),Bl.defs("EPSG:3035","+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs"),OI(Bl);const I=await a(s,rs+"/geoserver/wfs?service=WFS&version=1.1.0&request=GetFeature&typename="+WC+"&outputFormat=application/json&srsname=EPSG:31287"),S=new Nu({features:new y1().readFeatures(I,{featureProjection:"EPSG:31287",dataProjection:"EPSG:31287"})}),R=new Ou({source:S,style:{"stroke-width":.75,"stroke-color":"white","fill-color":"rgba(255,0,0,0.5)"}}),D=new q3({target:"map",layers:[new lE({source:new EE({url:"https://mapproxy.rest-gdi.geo-data.space/tiles/osm/webmercator/{z}/{x}/{y}.png",maxZoom:19,tileLoadFunction:async function(V,nt){const ot=V.getImage(),j=(await n.transaction("imgs","readonly").objectStore("imgs").get(nt))?.data;if(j)ot.src=j;else{ot.src=nt;const N=await(await fetch(nt)).blob(),Z=new FileReader;Z.onload=ft=>{n.transaction("imgs","readwrite").objectStore("imgs").put({url:nt,data:Z.result})},Z.readAsDataURL(N)}}})}),R,y,_],view:new os({center:[401306,423398],zoom:8,projection:"EPSG:31287"})});D.getView().fit(S.getExtent()),D.getView().on("change",V=>{const nt=D.getView().getCenter(),ot=D.getView().getZoom();localStorage.setItem("center",JSON.stringify(nt)),localStorage.setItem("zoom",JSON.stringify(ot))});const T=document.getElementById("popup"),v=document.getElementById("popup-content"),k=document.getElementById("popup-closer"),X=new $3({element:T,autoPan:{animation:{duration:250}}});D.addOverlay(X);async function H(V){if(Bn)return JI(rs,er,i,t,V);{const ot=await n.transaction("file","readonly").objectStore("file").index("filename").openCursor(IDBKeyRange.only(V));if(ot){const j=ot?.value;return new File([j.blob],V)}}}async function K(V){if(Bn)await QI(rs,er,i,t,V),n.transaction("file","readwrite").objectStore("file").delete(V);else{const nt=await n.transaction("file","readonly").objectStore("file").get(V);nt.removalpending=1,n.transaction("file","readwrite").objectStore("file").put(nt)}}async function z(){let V=n.transaction("file","readonly").objectStore("file");const nt=await V.index("uploadpending").getAll(IDBKeyRange.only(1));for(const At of nt){const bt=new File([At.blob],At.filename);await D1(_h,rs,er,i,t,At[nr],At.filename,At.filesize,At.mimetype,At.userids,bt),At.uploadpending=0,n.transaction("file","readwrite").objectStore("file").put(At)}V=n.transaction("file","readonly").objectStore("file");const ot=await V.index("removalpending").getAll(IDBKeyRange.only(1));for(const At of ot)await K(At.filename);const j=await T1(rs,er,i,t),tt=new Map(j.map(At=>[At.filename,At])),N=await n.transaction("file","readonly").objectStore("file").getAll(),Z=new Map(N.map(At=>[At.filename,At])),ft=new Map(tt);Z.forEach(At=>ft.delete(At.filename));for(const[At,bt]of ft){const Dt=await H(At);let ct={...bt,uploadPending:0,blob:Dt};ct[nr]=bt.objectid,n.transaction("file","readwrite").objectStore("file").put(ct)}const rt=new Map(Z);tt.forEach(At=>rt.delete(At.filename));for(const At of rt.keys())n.transaction("file","readwrite").objectStore("file").delete(At)}Bn&&await z(),l(D,y);async function q(V,nt,ot,j){let tt=[];if(Bn)tt=await T1(rs,er,i,t,nt);else{const ft=n.transaction("file","readonly").objectStore("file").index(nr),rt=IDBKeyRange.only(nt);for await(const At of ft.iterate(rt)){const bt=At.value;bt.removalpending||tt.push(bt)}}ot.innerHTML=`
  <div style="margin-top: 10px"><b>Dateien:</b></div>
  <table id="fileTable" class="fileTable"> 
  <tr>
  <th align=left>Dateiname</th>
  <th align=left></th>
  <th align=left>Berechtigt</th>
  <th align=left>Sync</th>
  </tr>
  </table>`;const N=document.getElementById("fileTable");for(let Z of tt){const ft=document.createElement("tr");N.append(ft);const rt=document.createElement("td");ft.append(rt);const At=document.createElement("a");At.innerText=`${Z.filename} (${Z.filesize})`,At.setAttribute("href","#"),At.onclick=async at=>{const Pt=await H(Z.filename);KI.saveAs(Pt,Z.filename,"application/octet_stream"),at.preventDefault()},rt.appendChild(At);const bt=document.createElement("td");if(ft.append(bt),Z.userids&&Z.userids.length>0){const at=document.createElement("a");at.innerHTML='<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAmJLR0QA/4ePzL8AAAAHdElNRQfoCAYQKB0BpUZRAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDI0LTA4LTA2VDE2OjQwOjI4KzAwOjAw9vSFoAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyNC0wOC0wNlQxNjo0MDoyOCswMDowMIepPRwAAAHISURBVEhL7Za9rgFREMf/u66IBokoREFBg4hK4xkIIjwD8QIKD6DQikqr1BOlhyDRqDQEkUh83p25Z5e91+5eN3T3l5zMzJ7dM2dmz8yudFXAG/mVg0qlgtVqBZvNxvblcoHD4UCn04HT6eRrRlg68Hq9vLgRVvuThXzIdDrlxUulEi90P5rNJt/T6/VYGqGLYDabwW63s+7xeFAoFDAajTAejxGJRHA4HHhOlmW+z+fzIRAIYDKZYLlc8tzpdEIwGNTSSbthut0uOXrJqFarYtXrVYtgPp+j3W6j3+9zahqNBs7nM6fDCpfLhXq9DrfbjVqthmw2i1Qq9TVJDu4pl8u8i2ehZ8LhsLBu/HjJap7/AkX8HdNTtFgsIEkSWq0W28lkkm1iOByyPhgM2DbC1MFut2O5Xq91klD1zWbD0ghTB3Qc76V29BRU/f7aI0wdvIJ/B5aYOlDPtVob+/2eJXE8HnXSCFMHfr8fiUQC6XSabaXKkclkWI/FYojH44hGo2wbIipaI5/P/7lVhEIhYd146Tt4VBMfQmpQCqijUq+nFNHn0QxqF9vtlvVcLsdSh4hER7FY5JCfGUp7Fk/reftfxZvrAPgEzoWq38Rr1WYAAAAASUVORK5CYII="/>',at.setAttribute("href","#"),at.onclick=async Pt=>{Pt.preventDefault(),await K(Z.filename),setTimeout(()=>q(V,nt,ot,j),100)},bt.appendChild(at)}const Dt=document.createElement("td");ft.append(Dt),Dt.innerText=Z.userids;const ct=document.createElement("td");ft.append(ct),ct.innerText=Z.uploadpending?"N":"Y"}if(l(D,y),p(D,_),V.get("owner")==localStorage.getItem("lastUser")){const Z=document.createElement("input",{id:"fileInput"});Z.setAttribute("type","file"),ot.appendChild(Z),Z.addEventListener("change",async ft=>{var rt=ft.target.files[0];let At="application/octet-stream";const bt=rt.name.toLowerCase();bt.endsWith(".gpx")?At="application/gpx+xml":bt.endsWith(".isoxml")&&(At="application/isoxml");let Dt=window.prompt("Beistrich-getrennte Liste von zusätzlich leseberechtigten Benutzern:");Dt&&(Dt+=","),Dt+=localStorage.getItem("lastUser");const ct=await rt.arrayBuffer();Bn&&await D1(_h,rs,er,i,t,nt,rt.name,ct.byteLength,At,Dt,rt);const at=new Blob([ct],{type:At}),Pt=n.transaction("file","readwrite").objectStore("file");let mt={uploadpending:Bn?0:1,removalpending:0,mimetype:At,filesize:ct.byteLength,filename:rt.name,userids:Dt,blob:at};mt[nr]=nt,Pt.put(mt),q(V,nt,ot,j)})}X.setPosition(j)}D.on("click",async function(V){D.forEachFeatureAtPixel(V.pixel,async function(nt,ot){if(ot===R){const tt=nt.getProperties()[nr];v.innerHTML=`
            <div id="attrs">
            <b>Eigenschaften:</b>
            <table id="attrTable" class="fileTable"> 
            <tr>
            <th align=left>Eigenschaft</th>
            <th align=left>Wert</th>
            </tr>
            </table>
            </div>
            <div id="files" />`;const N=document.getElementById("files");let Z=await r6(nt);document.getElementById("attrTable").innerHTML=Z,q(nt,tt,N,V.coordinate)}})}),k.onclick=function(){return X.setPosition(void 0),k.blur(),!1}}
//# sourceMappingURL=index-Cyo4VF-V.js.map
